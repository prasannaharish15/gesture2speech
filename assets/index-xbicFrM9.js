function wI(n,t){for(var e=0;e<t.length;e++){const s=t[e];if(typeof s!="string"&&!Array.isArray(s)){for(const r in s)if(r!=="default"&&!(r in n)){const a=Object.getOwnPropertyDescriptor(s,r);a&&Object.defineProperty(n,r,a.get?a:{enumerable:!0,get:()=>s[r]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function e(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(r){if(r.ep)return;r.ep=!0;const a=e(r);fetch(r.href,a)}})();function Sm(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function Cz(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var t=n.default;if(typeof t=="function"){var e=function s(){return this instanceof s?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};e.prototype=t.prototype}else e={};return Object.defineProperty(e,"__esModule",{value:!0}),Object.keys(n).forEach(function(s){var r=Object.getOwnPropertyDescriptor(n,s);Object.defineProperty(e,s,r.get?r:{enumerable:!0,get:function(){return n[s]}})}),e}var zb={exports:{}},jc={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var L$;function Nz(){if(L$)return jc;L$=1;var n=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function e(s,r,a){var i=null;if(a!==void 0&&(i=""+a),r.key!==void 0&&(i=""+r.key),"key"in r){a={};for(var l in r)l!=="key"&&(a[l]=r[l])}else a=r;return r=a.ref,{$$typeof:n,type:s,key:i,ref:r!==void 0?r:null,props:a}}return jc.Fragment=t,jc.jsx=e,jc.jsxs=e,jc}var z$;function Tz(){return z$||(z$=1,zb.exports=Nz()),zb.exports}var Nt=Tz(),Mb={exports:{}},ee={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var M$;function $z(){if(M$)return ee;M$=1;var n=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),e=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),i=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),p=Symbol.iterator;function m(O){return O===null||typeof O!="object"?null:(O=p&&O[p]||O["@@iterator"],typeof O=="function"?O:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,x={};function v(O,V,P){this.props=O,this.context=V,this.refs=x,this.updater=P||y}v.prototype.isReactComponent={},v.prototype.setState=function(O,V){if(typeof O!="object"&&typeof O!="function"&&O!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,O,V,"setState")},v.prototype.forceUpdate=function(O){this.updater.enqueueForceUpdate(this,O,"forceUpdate")};function S(){}S.prototype=v.prototype;function C(O,V,P){this.props=O,this.context=V,this.refs=x,this.updater=P||y}var $=C.prototype=new S;$.constructor=C,b($,v.prototype),$.isPureReactComponent=!0;var T=Array.isArray,I={H:null,A:null,T:null,S:null,V:null},A=Object.prototype.hasOwnProperty;function R(O,V,P,H,Q,ot){return P=ot.ref,{$$typeof:n,type:O,key:V,ref:P!==void 0?P:null,props:ot}}function L(O,V){return R(O.type,V,void 0,void 0,void 0,O.props)}function _(O){return typeof O=="object"&&O!==null&&O.$$typeof===n}function M(O){var V={"=":"=0",":":"=2"};return"$"+O.replace(/[=:]/g,function(P){return V[P]})}var D=/\/+/g;function W(O,V){return typeof O=="object"&&O!==null&&O.key!=null?M(""+O.key):V.toString(36)}function et(){}function nt(O){switch(O.status){case"fulfilled":return O.value;case"rejected":throw O.reason;default:switch(typeof O.status=="string"?O.then(et,et):(O.status="pending",O.then(function(V){O.status==="pending"&&(O.status="fulfilled",O.value=V)},function(V){O.status==="pending"&&(O.status="rejected",O.reason=V)})),O.status){case"fulfilled":return O.value;case"rejected":throw O.reason}}throw O}function tt(O,V,P,H,Q){var ot=typeof O;(ot==="undefined"||ot==="boolean")&&(O=null);var lt=!1;if(O===null)lt=!0;else switch(ot){case"bigint":case"string":case"number":lt=!0;break;case"object":switch(O.$$typeof){case n:case t:lt=!0;break;case d:return lt=O._init,tt(lt(O._payload),V,P,H,Q)}}if(lt)return Q=Q(O),lt=H===""?"."+W(O,0):H,T(Q)?(P="",lt!=null&&(P=lt.replace(D,"$&/")+"/"),tt(Q,V,P,"",function(Ct){return Ct})):Q!=null&&(_(Q)&&(Q=L(Q,P+(Q.key==null||O&&O.key===Q.key?"":(""+Q.key).replace(D,"$&/")+"/")+lt)),V.push(Q)),1;lt=0;var ht=H===""?".":H+":";if(T(O))for(var xt=0;xt<O.length;xt++)H=O[xt],ot=ht+W(H,xt),lt+=tt(H,V,P,ot,Q);else if(xt=m(O),typeof xt=="function")for(O=xt.call(O),xt=0;!(H=O.next()).done;)H=H.value,ot=ht+W(H,xt++),lt+=tt(H,V,P,ot,Q);else if(ot==="object"){if(typeof O.then=="function")return tt(nt(O),V,P,H,Q);throw V=String(O),Error("Objects are not valid as a React child (found: "+(V==="[object Object]"?"object with keys {"+Object.keys(O).join(", ")+"}":V)+"). If you meant to render a collection of children, use an array instead.")}return lt}function U(O,V,P){if(O==null)return O;var H=[],Q=0;return tt(O,H,"","",function(ot){return V.call(P,ot,Q++)}),H}function Y(O){if(O._status===-1){var V=O._result;V=V(),V.then(function(P){(O._status===0||O._status===-1)&&(O._status=1,O._result=P)},function(P){(O._status===0||O._status===-1)&&(O._status=2,O._result=P)}),O._status===-1&&(O._status=0,O._result=V)}if(O._status===1)return O._result.default;throw O._result}var Z=typeof reportError=="function"?reportError:function(O){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var V=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof O=="object"&&O!==null&&typeof O.message=="string"?String(O.message):String(O),error:O});if(!window.dispatchEvent(V))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",O);return}console.error(O)};function G(){}return ee.Children={map:U,forEach:function(O,V,P){U(O,function(){V.apply(this,arguments)},P)},count:function(O){var V=0;return U(O,function(){V++}),V},toArray:function(O){return U(O,function(V){return V})||[]},only:function(O){if(!_(O))throw Error("React.Children.only expected to receive a single React element child.");return O}},ee.Component=v,ee.Fragment=e,ee.Profiler=r,ee.PureComponent=C,ee.StrictMode=s,ee.Suspense=u,ee.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=I,ee.__COMPILER_RUNTIME={__proto__:null,c:function(O){return I.H.useMemoCache(O)}},ee.cache=function(O){return function(){return O.apply(null,arguments)}},ee.cloneElement=function(O,V,P){if(O==null)throw Error("The argument must be a React element, but you passed "+O+".");var H=b({},O.props),Q=O.key,ot=void 0;if(V!=null)for(lt in V.ref!==void 0&&(ot=void 0),V.key!==void 0&&(Q=""+V.key),V)!A.call(V,lt)||lt==="key"||lt==="__self"||lt==="__source"||lt==="ref"&&V.ref===void 0||(H[lt]=V[lt]);var lt=arguments.length-2;if(lt===1)H.children=P;else if(1<lt){for(var ht=Array(lt),xt=0;xt<lt;xt++)ht[xt]=arguments[xt+2];H.children=ht}return R(O.type,Q,void 0,void 0,ot,H)},ee.createContext=function(O){return O={$$typeof:i,_currentValue:O,_currentValue2:O,_threadCount:0,Provider:null,Consumer:null},O.Provider=O,O.Consumer={$$typeof:a,_context:O},O},ee.createElement=function(O,V,P){var H,Q={},ot=null;if(V!=null)for(H in V.key!==void 0&&(ot=""+V.key),V)A.call(V,H)&&H!=="key"&&H!=="__self"&&H!=="__source"&&(Q[H]=V[H]);var lt=arguments.length-2;if(lt===1)Q.children=P;else if(1<lt){for(var ht=Array(lt),xt=0;xt<lt;xt++)ht[xt]=arguments[xt+2];Q.children=ht}if(O&&O.defaultProps)for(H in lt=O.defaultProps,lt)Q[H]===void 0&&(Q[H]=lt[H]);return R(O,ot,void 0,void 0,null,Q)},ee.createRef=function(){return{current:null}},ee.forwardRef=function(O){return{$$typeof:l,render:O}},ee.isValidElement=_,ee.lazy=function(O){return{$$typeof:d,_payload:{_status:-1,_result:O},_init:Y}},ee.memo=function(O,V){return{$$typeof:h,type:O,compare:V===void 0?null:V}},ee.startTransition=function(O){var V=I.T,P={};I.T=P;try{var H=O(),Q=I.S;Q!==null&&Q(P,H),typeof H=="object"&&H!==null&&typeof H.then=="function"&&H.then(G,Z)}catch(ot){Z(ot)}finally{I.T=V}},ee.unstable_useCacheRefresh=function(){return I.H.useCacheRefresh()},ee.use=function(O){return I.H.use(O)},ee.useActionState=function(O,V,P){return I.H.useActionState(O,V,P)},ee.useCallback=function(O,V){return I.H.useCallback(O,V)},ee.useContext=function(O){return I.H.useContext(O)},ee.useDebugValue=function(){},ee.useDeferredValue=function(O,V){return I.H.useDeferredValue(O,V)},ee.useEffect=function(O,V,P){var H=I.H;if(typeof P=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return H.useEffect(O,V)},ee.useId=function(){return I.H.useId()},ee.useImperativeHandle=function(O,V,P){return I.H.useImperativeHandle(O,V,P)},ee.useInsertionEffect=function(O,V){return I.H.useInsertionEffect(O,V)},ee.useLayoutEffect=function(O,V){return I.H.useLayoutEffect(O,V)},ee.useMemo=function(O,V){return I.H.useMemo(O,V)},ee.useOptimistic=function(O,V){return I.H.useOptimistic(O,V)},ee.useReducer=function(O,V,P){return I.H.useReducer(O,V,P)},ee.useRef=function(O){return I.H.useRef(O)},ee.useState=function(O){return I.H.useState(O)},ee.useSyncExternalStore=function(O,V,P){return I.H.useSyncExternalStore(O,V,P)},ee.useTransition=function(){return I.H.useTransition()},ee.version="19.1.0",ee}var B$;function Cm(){return B$||(B$=1,Mb.exports=$z()),Mb.exports}var Et=Cm();const Oo=Sm(Et),kz=wI({__proto__:null,default:Oo},[Et]);var Bb={exports:{}},qc={},Pb={exports:{}},Vb={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var P$;function Iz(){return P$||(P$=1,function(n){function t(U,Y){var Z=U.length;U.push(Y);t:for(;0<Z;){var G=Z-1>>>1,O=U[G];if(0<r(O,Y))U[G]=Y,U[Z]=O,Z=G;else break t}}function e(U){return U.length===0?null:U[0]}function s(U){if(U.length===0)return null;var Y=U[0],Z=U.pop();if(Z!==Y){U[0]=Z;t:for(var G=0,O=U.length,V=O>>>1;G<V;){var P=2*(G+1)-1,H=U[P],Q=P+1,ot=U[Q];if(0>r(H,Z))Q<O&&0>r(ot,H)?(U[G]=ot,U[Q]=Z,G=Q):(U[G]=H,U[P]=Z,G=P);else if(Q<O&&0>r(ot,Z))U[G]=ot,U[Q]=Z,G=Q;else break t}}return Y}function r(U,Y){var Z=U.sortIndex-Y.sortIndex;return Z!==0?Z:U.id-Y.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;n.unstable_now=function(){return a.now()}}else{var i=Date,l=i.now();n.unstable_now=function(){return i.now()-l}}var u=[],h=[],d=1,p=null,m=3,y=!1,b=!1,x=!1,v=!1,S=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,$=typeof setImmediate<"u"?setImmediate:null;function T(U){for(var Y=e(h);Y!==null;){if(Y.callback===null)s(h);else if(Y.startTime<=U)s(h),Y.sortIndex=Y.expirationTime,t(u,Y);else break;Y=e(h)}}function I(U){if(x=!1,T(U),!b)if(e(u)!==null)b=!0,A||(A=!0,W());else{var Y=e(h);Y!==null&&tt(I,Y.startTime-U)}}var A=!1,R=-1,L=5,_=-1;function M(){return v?!0:!(n.unstable_now()-_<L)}function D(){if(v=!1,A){var U=n.unstable_now();_=U;var Y=!0;try{t:{b=!1,x&&(x=!1,C(R),R=-1),y=!0;var Z=m;try{e:{for(T(U),p=e(u);p!==null&&!(p.expirationTime>U&&M());){var G=p.callback;if(typeof G=="function"){p.callback=null,m=p.priorityLevel;var O=G(p.expirationTime<=U);if(U=n.unstable_now(),typeof O=="function"){p.callback=O,T(U),Y=!0;break e}p===e(u)&&s(u),T(U)}else s(u);p=e(u)}if(p!==null)Y=!0;else{var V=e(h);V!==null&&tt(I,V.startTime-U),Y=!1}}break t}finally{p=null,m=Z,y=!1}Y=void 0}}finally{Y?W():A=!1}}}var W;if(typeof $=="function")W=function(){$(D)};else if(typeof MessageChannel<"u"){var et=new MessageChannel,nt=et.port2;et.port1.onmessage=D,W=function(){nt.postMessage(null)}}else W=function(){S(D,0)};function tt(U,Y){R=S(function(){U(n.unstable_now())},Y)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(U){U.callback=null},n.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<U?Math.floor(1e3/U):5},n.unstable_getCurrentPriorityLevel=function(){return m},n.unstable_next=function(U){switch(m){case 1:case 2:case 3:var Y=3;break;default:Y=m}var Z=m;m=Y;try{return U()}finally{m=Z}},n.unstable_requestPaint=function(){v=!0},n.unstable_runWithPriority=function(U,Y){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var Z=m;m=U;try{return Y()}finally{m=Z}},n.unstable_scheduleCallback=function(U,Y,Z){var G=n.unstable_now();switch(typeof Z=="object"&&Z!==null?(Z=Z.delay,Z=typeof Z=="number"&&0<Z?G+Z:G):Z=G,U){case 1:var O=-1;break;case 2:O=250;break;case 5:O=1073741823;break;case 4:O=1e4;break;default:O=5e3}return O=Z+O,U={id:d++,callback:Y,priorityLevel:U,startTime:Z,expirationTime:O,sortIndex:-1},Z>G?(U.sortIndex=Z,t(h,U),e(u)===null&&U===e(h)&&(x?(C(R),R=-1):x=!0,tt(I,Z-G))):(U.sortIndex=O,t(u,U),b||y||(b=!0,A||(A=!0,W()))),U},n.unstable_shouldYield=M,n.unstable_wrapCallback=function(U){var Y=m;return function(){var Z=m;m=Y;try{return U.apply(this,arguments)}finally{m=Z}}}}(Vb)),Vb}var V$;function Ez(){return V$||(V$=1,Pb.exports=Iz()),Pb.exports}var Ub={exports:{}},is={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var U$;function Dz(){if(U$)return is;U$=1;var n=Cm();function t(u){var h="https://react.dev/errors/"+u;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var d=2;d<arguments.length;d++)h+="&args[]="+encodeURIComponent(arguments[d])}return"Minified React error #"+u+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function e(){}var s={d:{f:e,r:function(){throw Error(t(522))},D:e,C:e,L:e,m:e,X:e,S:e,M:e},p:0,findDOMNode:null},r=Symbol.for("react.portal");function a(u,h,d){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:p==null?null:""+p,children:u,containerInfo:h,implementation:d}}var i=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function l(u,h){if(u==="font")return"";if(typeof h=="string")return h==="use-credentials"?h:""}return is.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,is.createPortal=function(u,h){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)throw Error(t(299));return a(u,h,null,d)},is.flushSync=function(u){var h=i.T,d=s.p;try{if(i.T=null,s.p=2,u)return u()}finally{i.T=h,s.p=d,s.d.f()}},is.preconnect=function(u,h){typeof u=="string"&&(h?(h=h.crossOrigin,h=typeof h=="string"?h==="use-credentials"?h:"":void 0):h=null,s.d.C(u,h))},is.prefetchDNS=function(u){typeof u=="string"&&s.d.D(u)},is.preinit=function(u,h){if(typeof u=="string"&&h&&typeof h.as=="string"){var d=h.as,p=l(d,h.crossOrigin),m=typeof h.integrity=="string"?h.integrity:void 0,y=typeof h.fetchPriority=="string"?h.fetchPriority:void 0;d==="style"?s.d.S(u,typeof h.precedence=="string"?h.precedence:void 0,{crossOrigin:p,integrity:m,fetchPriority:y}):d==="script"&&s.d.X(u,{crossOrigin:p,integrity:m,fetchPriority:y,nonce:typeof h.nonce=="string"?h.nonce:void 0})}},is.preinitModule=function(u,h){if(typeof u=="string")if(typeof h=="object"&&h!==null){if(h.as==null||h.as==="script"){var d=l(h.as,h.crossOrigin);s.d.M(u,{crossOrigin:d,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0})}}else h==null&&s.d.M(u)},is.preload=function(u,h){if(typeof u=="string"&&typeof h=="object"&&h!==null&&typeof h.as=="string"){var d=h.as,p=l(d,h.crossOrigin);s.d.L(u,d,{crossOrigin:p,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0,type:typeof h.type=="string"?h.type:void 0,fetchPriority:typeof h.fetchPriority=="string"?h.fetchPriority:void 0,referrerPolicy:typeof h.referrerPolicy=="string"?h.referrerPolicy:void 0,imageSrcSet:typeof h.imageSrcSet=="string"?h.imageSrcSet:void 0,imageSizes:typeof h.imageSizes=="string"?h.imageSizes:void 0,media:typeof h.media=="string"?h.media:void 0})}},is.preloadModule=function(u,h){if(typeof u=="string")if(h){var d=l(h.as,h.crossOrigin);s.d.m(u,{as:typeof h.as=="string"&&h.as!=="script"?h.as:void 0,crossOrigin:d,integrity:typeof h.integrity=="string"?h.integrity:void 0})}else s.d.m(u)},is.requestFormReset=function(u){s.d.r(u)},is.unstable_batchedUpdates=function(u,h){return u(h)},is.useFormState=function(u,h,d){return i.H.useFormState(u,h,d)},is.useFormStatus=function(){return i.H.useHostTransitionStatus()},is.version="19.1.0",is}var G$;function SI(){if(G$)return Ub.exports;G$=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(t){console.error(t)}}return n(),Ub.exports=Dz(),Ub.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var W$;function Az(){if(W$)return qc;W$=1;var n=Ez(),t=Cm(),e=SI();function s(o){var c="https://react.dev/errors/"+o;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var f=2;f<arguments.length;f++)c+="&args[]="+encodeURIComponent(arguments[f])}return"Minified React error #"+o+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11)}function a(o){var c=o,f=o;if(o.alternate)for(;c.return;)c=c.return;else{o=c;do c=o,(c.flags&4098)!==0&&(f=c.return),o=c.return;while(o)}return c.tag===3?f:null}function i(o){if(o.tag===13){var c=o.memoizedState;if(c===null&&(o=o.alternate,o!==null&&(c=o.memoizedState)),c!==null)return c.dehydrated}return null}function l(o){if(a(o)!==o)throw Error(s(188))}function u(o){var c=o.alternate;if(!c){if(c=a(o),c===null)throw Error(s(188));return c!==o?null:o}for(var f=o,g=c;;){var w=f.return;if(w===null)break;var N=w.alternate;if(N===null){if(g=w.return,g!==null){f=g;continue}break}if(w.child===N.child){for(N=w.child;N;){if(N===f)return l(w),o;if(N===g)return l(w),c;N=N.sibling}throw Error(s(188))}if(f.return!==g.return)f=w,g=N;else{for(var E=!1,z=w.child;z;){if(z===f){E=!0,f=w,g=N;break}if(z===g){E=!0,g=w,f=N;break}z=z.sibling}if(!E){for(z=N.child;z;){if(z===f){E=!0,f=N,g=w;break}if(z===g){E=!0,g=N,f=w;break}z=z.sibling}if(!E)throw Error(s(189))}}if(f.alternate!==g)throw Error(s(190))}if(f.tag!==3)throw Error(s(188));return f.stateNode.current===f?o:c}function h(o){var c=o.tag;if(c===5||c===26||c===27||c===6)return o;for(o=o.child;o!==null;){if(c=h(o),c!==null)return c;o=o.sibling}return null}var d=Object.assign,p=Symbol.for("react.element"),m=Symbol.for("react.transitional.element"),y=Symbol.for("react.portal"),b=Symbol.for("react.fragment"),x=Symbol.for("react.strict_mode"),v=Symbol.for("react.profiler"),S=Symbol.for("react.provider"),C=Symbol.for("react.consumer"),$=Symbol.for("react.context"),T=Symbol.for("react.forward_ref"),I=Symbol.for("react.suspense"),A=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),L=Symbol.for("react.lazy"),_=Symbol.for("react.activity"),M=Symbol.for("react.memo_cache_sentinel"),D=Symbol.iterator;function W(o){return o===null||typeof o!="object"?null:(o=D&&o[D]||o["@@iterator"],typeof o=="function"?o:null)}var et=Symbol.for("react.client.reference");function nt(o){if(o==null)return null;if(typeof o=="function")return o.$$typeof===et?null:o.displayName||o.name||null;if(typeof o=="string")return o;switch(o){case b:return"Fragment";case v:return"Profiler";case x:return"StrictMode";case I:return"Suspense";case A:return"SuspenseList";case _:return"Activity"}if(typeof o=="object")switch(o.$$typeof){case y:return"Portal";case $:return(o.displayName||"Context")+".Provider";case C:return(o._context.displayName||"Context")+".Consumer";case T:var c=o.render;return o=o.displayName,o||(o=c.displayName||c.name||"",o=o!==""?"ForwardRef("+o+")":"ForwardRef"),o;case R:return c=o.displayName||null,c!==null?c:nt(o.type)||"Memo";case L:c=o._payload,o=o._init;try{return nt(o(c))}catch{}}return null}var tt=Array.isArray,U=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Y=e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Z={pending:!1,data:null,method:null,action:null},G=[],O=-1;function V(o){return{current:o}}function P(o){0>O||(o.current=G[O],G[O]=null,O--)}function H(o,c){O++,G[O]=o.current,o.current=c}var Q=V(null),ot=V(null),lt=V(null),ht=V(null);function xt(o,c){switch(H(lt,c),H(ot,o),H(Q,null),c.nodeType){case 9:case 11:o=(o=c.documentElement)&&(o=o.namespaceURI)?c$(o):0;break;default:if(o=c.tagName,c=c.namespaceURI)c=c$(c),o=h$(c,o);else switch(o){case"svg":o=1;break;case"math":o=2;break;default:o=0}}P(Q),H(Q,o)}function Ct(){P(Q),P(ot),P(lt)}function Dt(o){o.memoizedState!==null&&H(ht,o);var c=Q.current,f=h$(c,o.type);c!==f&&(H(ot,o),H(Q,f))}function It(o){ot.current===o&&(P(Q),P(ot)),ht.current===o&&(P(ht),Vc._currentValue=Z)}var Ot=Object.prototype.hasOwnProperty,Xt=n.unstable_scheduleCallback,Kt=n.unstable_cancelCallback,Zt=n.unstable_shouldYield,Ht=n.unstable_requestPaint,jt=n.unstable_now,ie=n.unstable_getCurrentPriorityLevel,mn=n.unstable_ImmediatePriority,ve=n.unstable_UserBlockingPriority,Xe=n.unstable_NormalPriority,ke=n.unstable_LowPriority,tn=n.unstable_IdlePriority,en=n.log,hn=n.unstable_setDisableYieldValue,Ke=null,Oe=null;function nn(o){if(typeof en=="function"&&hn(o),Oe&&typeof Oe.setStrictMode=="function")try{Oe.setStrictMode(Ke,o)}catch{}}var Pe=Math.clz32?Math.clz32:Ku,Wr=Math.log,ss=Math.LN2;function Ku(o){return o>>>=0,o===0?32:31-(Wr(o)/ss|0)|0}var Vs=256,qa=4194304;function fa(o){var c=o&42;if(c!==0)return c;switch(o&-o){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return o&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return o}}function jd(o,c,f){var g=o.pendingLanes;if(g===0)return 0;var w=0,N=o.suspendedLanes,E=o.pingedLanes;o=o.warmLanes;var z=g&134217727;return z!==0?(g=z&~N,g!==0?w=fa(g):(E&=z,E!==0?w=fa(E):f||(f=z&~o,f!==0&&(w=fa(f))))):(z=g&~N,z!==0?w=fa(z):E!==0?w=fa(E):f||(f=g&~o,f!==0&&(w=fa(f)))),w===0?0:c!==0&&c!==w&&(c&N)===0&&(N=w&-w,f=c&-c,N>=f||N===32&&(f&4194048)!==0)?c:w}function Yu(o,c){return(o.pendingLanes&~(o.suspendedLanes&~o.pingedLanes)&c)===0}function c3(o,c){switch(o){case 1:case 2:case 4:case 8:case 64:return c+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function qS(){var o=Vs;return Vs<<=1,(Vs&4194048)===0&&(Vs=256),o}function XS(){var o=qa;return qa<<=1,(qa&62914560)===0&&(qa=4194304),o}function $y(o){for(var c=[],f=0;31>f;f++)c.push(o);return c}function Zu(o,c){o.pendingLanes|=c,c!==268435456&&(o.suspendedLanes=0,o.pingedLanes=0,o.warmLanes=0)}function h3(o,c,f,g,w,N){var E=o.pendingLanes;o.pendingLanes=f,o.suspendedLanes=0,o.pingedLanes=0,o.warmLanes=0,o.expiredLanes&=f,o.entangledLanes&=f,o.errorRecoveryDisabledLanes&=f,o.shellSuspendCounter=0;var z=o.entanglements,j=o.expirationTimes,dt=o.hiddenUpdates;for(f=E&~f;0<f;){var bt=31-Pe(f),wt=1<<bt;z[bt]=0,j[bt]=-1;var ft=dt[bt];if(ft!==null)for(dt[bt]=null,bt=0;bt<ft.length;bt++){var pt=ft[bt];pt!==null&&(pt.lane&=-536870913)}f&=~wt}g!==0&&KS(o,g,0),N!==0&&w===0&&o.tag!==0&&(o.suspendedLanes|=N&~(E&~c))}function KS(o,c,f){o.pendingLanes|=c,o.suspendedLanes&=~c;var g=31-Pe(c);o.entangledLanes|=c,o.entanglements[g]=o.entanglements[g]|1073741824|f&4194090}function YS(o,c){var f=o.entangledLanes|=c;for(o=o.entanglements;f;){var g=31-Pe(f),w=1<<g;w&c|o[g]&c&&(o[g]|=c),f&=~w}}function ky(o){switch(o){case 2:o=1;break;case 8:o=4;break;case 32:o=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:o=128;break;case 268435456:o=134217728;break;default:o=0}return o}function Iy(o){return o&=-o,2<o?8<o?(o&134217727)!==0?32:268435456:8:2}function ZS(){var o=Y.p;return o!==0?o:(o=window.event,o===void 0?32:D$(o.type))}function d3(o,c){var f=Y.p;try{return Y.p=o,c()}finally{Y.p=f}}var Xa=Math.random().toString(36).slice(2),rs="__reactFiber$"+Xa,xs="__reactProps$"+Xa,al="__reactContainer$"+Xa,Ey="__reactEvents$"+Xa,f3="__reactListeners$"+Xa,p3="__reactHandles$"+Xa,QS="__reactResources$"+Xa,Qu="__reactMarker$"+Xa;function Dy(o){delete o[rs],delete o[xs],delete o[Ey],delete o[f3],delete o[p3]}function il(o){var c=o[rs];if(c)return c;for(var f=o.parentNode;f;){if(c=f[al]||f[rs]){if(f=c.alternate,c.child!==null||f!==null&&f.child!==null)for(o=m$(o);o!==null;){if(f=o[rs])return f;o=m$(o)}return c}o=f,f=o.parentNode}return null}function ol(o){if(o=o[rs]||o[al]){var c=o.tag;if(c===5||c===6||c===13||c===26||c===27||c===3)return o}return null}function Ju(o){var c=o.tag;if(c===5||c===26||c===27||c===6)return o.stateNode;throw Error(s(33))}function ll(o){var c=o[QS];return c||(c=o[QS]={hoistableStyles:new Map,hoistableScripts:new Map}),c}function Fn(o){o[Qu]=!0}var JS=new Set,tC={};function Zi(o,c){ul(o,c),ul(o+"Capture",c)}function ul(o,c){for(tC[o]=c,o=0;o<c.length;o++)JS.add(c[o])}var m3=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),eC={},nC={};function g3(o){return Ot.call(nC,o)?!0:Ot.call(eC,o)?!1:m3.test(o)?nC[o]=!0:(eC[o]=!0,!1)}function qd(o,c,f){if(g3(c))if(f===null)o.removeAttribute(c);else{switch(typeof f){case"undefined":case"function":case"symbol":o.removeAttribute(c);return;case"boolean":var g=c.toLowerCase().slice(0,5);if(g!=="data-"&&g!=="aria-"){o.removeAttribute(c);return}}o.setAttribute(c,""+f)}}function Xd(o,c,f){if(f===null)o.removeAttribute(c);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":o.removeAttribute(c);return}o.setAttribute(c,""+f)}}function pa(o,c,f,g){if(g===null)o.removeAttribute(f);else{switch(typeof g){case"undefined":case"function":case"symbol":case"boolean":o.removeAttribute(f);return}o.setAttributeNS(c,f,""+g)}}var Ay,sC;function cl(o){if(Ay===void 0)try{throw Error()}catch(f){var c=f.stack.trim().match(/\n( *(at )?)/);Ay=c&&c[1]||"",sC=-1<f.stack.indexOf(`
    at`)?" (<anonymous>)":-1<f.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ay+o+sC}var Ry=!1;function Oy(o,c){if(!o||Ry)return"";Ry=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var g={DetermineComponentFrameRoot:function(){try{if(c){var wt=function(){throw Error()};if(Object.defineProperty(wt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(wt,[])}catch(pt){var ft=pt}Reflect.construct(o,[],wt)}else{try{wt.call()}catch(pt){ft=pt}o.call(wt.prototype)}}else{try{throw Error()}catch(pt){ft=pt}(wt=o())&&typeof wt.catch=="function"&&wt.catch(function(){})}}catch(pt){if(pt&&ft&&typeof pt.stack=="string")return[pt.stack,ft.stack]}return[null,null]}};g.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var w=Object.getOwnPropertyDescriptor(g.DetermineComponentFrameRoot,"name");w&&w.configurable&&Object.defineProperty(g.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var N=g.DetermineComponentFrameRoot(),E=N[0],z=N[1];if(E&&z){var j=E.split(`
`),dt=z.split(`
`);for(w=g=0;g<j.length&&!j[g].includes("DetermineComponentFrameRoot");)g++;for(;w<dt.length&&!dt[w].includes("DetermineComponentFrameRoot");)w++;if(g===j.length||w===dt.length)for(g=j.length-1,w=dt.length-1;1<=g&&0<=w&&j[g]!==dt[w];)w--;for(;1<=g&&0<=w;g--,w--)if(j[g]!==dt[w]){if(g!==1||w!==1)do if(g--,w--,0>w||j[g]!==dt[w]){var bt=`
`+j[g].replace(" at new "," at ");return o.displayName&&bt.includes("<anonymous>")&&(bt=bt.replace("<anonymous>",o.displayName)),bt}while(1<=g&&0<=w);break}}}finally{Ry=!1,Error.prepareStackTrace=f}return(f=o?o.displayName||o.name:"")?cl(f):""}function y3(o){switch(o.tag){case 26:case 27:case 5:return cl(o.type);case 16:return cl("Lazy");case 13:return cl("Suspense");case 19:return cl("SuspenseList");case 0:case 15:return Oy(o.type,!1);case 11:return Oy(o.type.render,!1);case 1:return Oy(o.type,!0);case 31:return cl("Activity");default:return""}}function rC(o){try{var c="";do c+=y3(o),o=o.return;while(o);return c}catch(f){return`
Error generating stack: `+f.message+`
`+f.stack}}function nr(o){switch(typeof o){case"bigint":case"boolean":case"number":case"string":case"undefined":return o;case"object":return o;default:return""}}function aC(o){var c=o.type;return(o=o.nodeName)&&o.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function b3(o){var c=aC(o)?"checked":"value",f=Object.getOwnPropertyDescriptor(o.constructor.prototype,c),g=""+o[c];if(!o.hasOwnProperty(c)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var w=f.get,N=f.set;return Object.defineProperty(o,c,{configurable:!0,get:function(){return w.call(this)},set:function(E){g=""+E,N.call(this,E)}}),Object.defineProperty(o,c,{enumerable:f.enumerable}),{getValue:function(){return g},setValue:function(E){g=""+E},stopTracking:function(){o._valueTracker=null,delete o[c]}}}}function Kd(o){o._valueTracker||(o._valueTracker=b3(o))}function iC(o){if(!o)return!1;var c=o._valueTracker;if(!c)return!0;var f=c.getValue(),g="";return o&&(g=aC(o)?o.checked?"true":"false":o.value),o=g,o!==f?(c.setValue(o),!0):!1}function Yd(o){if(o=o||(typeof document<"u"?document:void 0),typeof o>"u")return null;try{return o.activeElement||o.body}catch{return o.body}}var x3=/[\n"\\]/g;function sr(o){return o.replace(x3,function(c){return"\\"+c.charCodeAt(0).toString(16)+" "})}function _y(o,c,f,g,w,N,E,z){o.name="",E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"?o.type=E:o.removeAttribute("type"),c!=null?E==="number"?(c===0&&o.value===""||o.value!=c)&&(o.value=""+nr(c)):o.value!==""+nr(c)&&(o.value=""+nr(c)):E!=="submit"&&E!=="reset"||o.removeAttribute("value"),c!=null?Fy(o,E,nr(c)):f!=null?Fy(o,E,nr(f)):g!=null&&o.removeAttribute("value"),w==null&&N!=null&&(o.defaultChecked=!!N),w!=null&&(o.checked=w&&typeof w!="function"&&typeof w!="symbol"),z!=null&&typeof z!="function"&&typeof z!="symbol"&&typeof z!="boolean"?o.name=""+nr(z):o.removeAttribute("name")}function oC(o,c,f,g,w,N,E,z){if(N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"&&(o.type=N),c!=null||f!=null){if(!(N!=="submit"&&N!=="reset"||c!=null))return;f=f!=null?""+nr(f):"",c=c!=null?""+nr(c):f,z||c===o.value||(o.value=c),o.defaultValue=c}g=g??w,g=typeof g!="function"&&typeof g!="symbol"&&!!g,o.checked=z?o.checked:!!g,o.defaultChecked=!!g,E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"&&(o.name=E)}function Fy(o,c,f){c==="number"&&Yd(o.ownerDocument)===o||o.defaultValue===""+f||(o.defaultValue=""+f)}function hl(o,c,f,g){if(o=o.options,c){c={};for(var w=0;w<f.length;w++)c["$"+f[w]]=!0;for(f=0;f<o.length;f++)w=c.hasOwnProperty("$"+o[f].value),o[f].selected!==w&&(o[f].selected=w),w&&g&&(o[f].defaultSelected=!0)}else{for(f=""+nr(f),c=null,w=0;w<o.length;w++){if(o[w].value===f){o[w].selected=!0,g&&(o[w].defaultSelected=!0);return}c!==null||o[w].disabled||(c=o[w])}c!==null&&(c.selected=!0)}}function lC(o,c,f){if(c!=null&&(c=""+nr(c),c!==o.value&&(o.value=c),f==null)){o.defaultValue!==c&&(o.defaultValue=c);return}o.defaultValue=f!=null?""+nr(f):""}function uC(o,c,f,g){if(c==null){if(g!=null){if(f!=null)throw Error(s(92));if(tt(g)){if(1<g.length)throw Error(s(93));g=g[0]}f=g}f==null&&(f=""),c=f}f=nr(c),o.defaultValue=f,g=o.textContent,g===f&&g!==""&&g!==null&&(o.value=g)}function dl(o,c){if(c){var f=o.firstChild;if(f&&f===o.lastChild&&f.nodeType===3){f.nodeValue=c;return}}o.textContent=c}var v3=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function cC(o,c,f){var g=c.indexOf("--")===0;f==null||typeof f=="boolean"||f===""?g?o.setProperty(c,""):c==="float"?o.cssFloat="":o[c]="":g?o.setProperty(c,f):typeof f!="number"||f===0||v3.has(c)?c==="float"?o.cssFloat=f:o[c]=(""+f).trim():o[c]=f+"px"}function hC(o,c,f){if(c!=null&&typeof c!="object")throw Error(s(62));if(o=o.style,f!=null){for(var g in f)!f.hasOwnProperty(g)||c!=null&&c.hasOwnProperty(g)||(g.indexOf("--")===0?o.setProperty(g,""):g==="float"?o.cssFloat="":o[g]="");for(var w in c)g=c[w],c.hasOwnProperty(w)&&f[w]!==g&&cC(o,w,g)}else for(var N in c)c.hasOwnProperty(N)&&cC(o,N,c[N])}function Ly(o){if(o.indexOf("-")===-1)return!1;switch(o){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var w3=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),S3=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Zd(o){return S3.test(""+o)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":o}var zy=null;function My(o){return o=o.target||o.srcElement||window,o.correspondingUseElement&&(o=o.correspondingUseElement),o.nodeType===3?o.parentNode:o}var fl=null,pl=null;function dC(o){var c=ol(o);if(c&&(o=c.stateNode)){var f=o[xs]||null;t:switch(o=c.stateNode,c.type){case"input":if(_y(o,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name),c=f.name,f.type==="radio"&&c!=null){for(f=o;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll('input[name="'+sr(""+c)+'"][type="radio"]'),c=0;c<f.length;c++){var g=f[c];if(g!==o&&g.form===o.form){var w=g[xs]||null;if(!w)throw Error(s(90));_y(g,w.value,w.defaultValue,w.defaultValue,w.checked,w.defaultChecked,w.type,w.name)}}for(c=0;c<f.length;c++)g=f[c],g.form===o.form&&iC(g)}break t;case"textarea":lC(o,f.value,f.defaultValue);break t;case"select":c=f.value,c!=null&&hl(o,!!f.multiple,c,!1)}}}var By=!1;function fC(o,c,f){if(By)return o(c,f);By=!0;try{var g=o(c);return g}finally{if(By=!1,(fl!==null||pl!==null)&&(zf(),fl&&(c=fl,o=pl,pl=fl=null,dC(c),o)))for(c=0;c<o.length;c++)dC(o[c])}}function tc(o,c){var f=o.stateNode;if(f===null)return null;var g=f[xs]||null;if(g===null)return null;f=g[c];t:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(g=!g.disabled)||(o=o.type,g=!(o==="button"||o==="input"||o==="select"||o==="textarea")),o=!g;break t;default:o=!1}if(o)return null;if(f&&typeof f!="function")throw Error(s(231,c,typeof f));return f}var ma=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Py=!1;if(ma)try{var ec={};Object.defineProperty(ec,"passive",{get:function(){Py=!0}}),window.addEventListener("test",ec,ec),window.removeEventListener("test",ec,ec)}catch{Py=!1}var Ka=null,Vy=null,Qd=null;function pC(){if(Qd)return Qd;var o,c=Vy,f=c.length,g,w="value"in Ka?Ka.value:Ka.textContent,N=w.length;for(o=0;o<f&&c[o]===w[o];o++);var E=f-o;for(g=1;g<=E&&c[f-g]===w[N-g];g++);return Qd=w.slice(o,1<g?1-g:void 0)}function Jd(o){var c=o.keyCode;return"charCode"in o?(o=o.charCode,o===0&&c===13&&(o=13)):o=c,o===10&&(o=13),32<=o||o===13?o:0}function tf(){return!0}function mC(){return!1}function vs(o){function c(f,g,w,N,E){this._reactName=f,this._targetInst=w,this.type=g,this.nativeEvent=N,this.target=E,this.currentTarget=null;for(var z in o)o.hasOwnProperty(z)&&(f=o[z],this[z]=f?f(N):N[z]);return this.isDefaultPrevented=(N.defaultPrevented!=null?N.defaultPrevented:N.returnValue===!1)?tf:mC,this.isPropagationStopped=mC,this}return d(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=tf)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=tf)},persist:function(){},isPersistent:tf}),c}var Qi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(o){return o.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ef=vs(Qi),nc=d({},Qi,{view:0,detail:0}),C3=vs(nc),Uy,Gy,sc,nf=d({},nc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Hy,button:0,buttons:0,relatedTarget:function(o){return o.relatedTarget===void 0?o.fromElement===o.srcElement?o.toElement:o.fromElement:o.relatedTarget},movementX:function(o){return"movementX"in o?o.movementX:(o!==sc&&(sc&&o.type==="mousemove"?(Uy=o.screenX-sc.screenX,Gy=o.screenY-sc.screenY):Gy=Uy=0,sc=o),Uy)},movementY:function(o){return"movementY"in o?o.movementY:Gy}}),gC=vs(nf),N3=d({},nf,{dataTransfer:0}),T3=vs(N3),$3=d({},nc,{relatedTarget:0}),Wy=vs($3),k3=d({},Qi,{animationName:0,elapsedTime:0,pseudoElement:0}),I3=vs(k3),E3=d({},Qi,{clipboardData:function(o){return"clipboardData"in o?o.clipboardData:window.clipboardData}}),D3=vs(E3),A3=d({},Qi,{data:0}),yC=vs(A3),R3={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},O3={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_3={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function F3(o){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(o):(o=_3[o])?!!c[o]:!1}function Hy(){return F3}var L3=d({},nc,{key:function(o){if(o.key){var c=R3[o.key]||o.key;if(c!=="Unidentified")return c}return o.type==="keypress"?(o=Jd(o),o===13?"Enter":String.fromCharCode(o)):o.type==="keydown"||o.type==="keyup"?O3[o.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Hy,charCode:function(o){return o.type==="keypress"?Jd(o):0},keyCode:function(o){return o.type==="keydown"||o.type==="keyup"?o.keyCode:0},which:function(o){return o.type==="keypress"?Jd(o):o.type==="keydown"||o.type==="keyup"?o.keyCode:0}}),z3=vs(L3),M3=d({},nf,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),bC=vs(M3),B3=d({},nc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Hy}),P3=vs(B3),V3=d({},Qi,{propertyName:0,elapsedTime:0,pseudoElement:0}),U3=vs(V3),G3=d({},nf,{deltaX:function(o){return"deltaX"in o?o.deltaX:"wheelDeltaX"in o?-o.wheelDeltaX:0},deltaY:function(o){return"deltaY"in o?o.deltaY:"wheelDeltaY"in o?-o.wheelDeltaY:"wheelDelta"in o?-o.wheelDelta:0},deltaZ:0,deltaMode:0}),W3=vs(G3),H3=d({},Qi,{newState:0,oldState:0}),j3=vs(H3),q3=[9,13,27,32],jy=ma&&"CompositionEvent"in window,rc=null;ma&&"documentMode"in document&&(rc=document.documentMode);var X3=ma&&"TextEvent"in window&&!rc,xC=ma&&(!jy||rc&&8<rc&&11>=rc),vC=" ",wC=!1;function SC(o,c){switch(o){case"keyup":return q3.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function CC(o){return o=o.detail,typeof o=="object"&&"data"in o?o.data:null}var ml=!1;function K3(o,c){switch(o){case"compositionend":return CC(c);case"keypress":return c.which!==32?null:(wC=!0,vC);case"textInput":return o=c.data,o===vC&&wC?null:o;default:return null}}function Y3(o,c){if(ml)return o==="compositionend"||!jy&&SC(o,c)?(o=pC(),Qd=Vy=Ka=null,ml=!1,o):null;switch(o){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return xC&&c.locale!=="ko"?null:c.data;default:return null}}var Z3={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function NC(o){var c=o&&o.nodeName&&o.nodeName.toLowerCase();return c==="input"?!!Z3[o.type]:c==="textarea"}function TC(o,c,f,g){fl?pl?pl.push(g):pl=[g]:fl=g,c=Gf(c,"onChange"),0<c.length&&(f=new ef("onChange","change",null,f,g),o.push({event:f,listeners:c}))}var ac=null,ic=null;function Q3(o){a$(o,0)}function sf(o){var c=Ju(o);if(iC(c))return o}function $C(o,c){if(o==="change")return c}var kC=!1;if(ma){var qy;if(ma){var Xy="oninput"in document;if(!Xy){var IC=document.createElement("div");IC.setAttribute("oninput","return;"),Xy=typeof IC.oninput=="function"}qy=Xy}else qy=!1;kC=qy&&(!document.documentMode||9<document.documentMode)}function EC(){ac&&(ac.detachEvent("onpropertychange",DC),ic=ac=null)}function DC(o){if(o.propertyName==="value"&&sf(ic)){var c=[];TC(c,ic,o,My(o)),fC(Q3,c)}}function J3(o,c,f){o==="focusin"?(EC(),ac=c,ic=f,ac.attachEvent("onpropertychange",DC)):o==="focusout"&&EC()}function tL(o){if(o==="selectionchange"||o==="keyup"||o==="keydown")return sf(ic)}function eL(o,c){if(o==="click")return sf(c)}function nL(o,c){if(o==="input"||o==="change")return sf(c)}function sL(o,c){return o===c&&(o!==0||1/o===1/c)||o!==o&&c!==c}var Us=typeof Object.is=="function"?Object.is:sL;function oc(o,c){if(Us(o,c))return!0;if(typeof o!="object"||o===null||typeof c!="object"||c===null)return!1;var f=Object.keys(o),g=Object.keys(c);if(f.length!==g.length)return!1;for(g=0;g<f.length;g++){var w=f[g];if(!Ot.call(c,w)||!Us(o[w],c[w]))return!1}return!0}function AC(o){for(;o&&o.firstChild;)o=o.firstChild;return o}function RC(o,c){var f=AC(o);o=0;for(var g;f;){if(f.nodeType===3){if(g=o+f.textContent.length,o<=c&&g>=c)return{node:f,offset:c-o};o=g}t:{for(;f;){if(f.nextSibling){f=f.nextSibling;break t}f=f.parentNode}f=void 0}f=AC(f)}}function OC(o,c){return o&&c?o===c?!0:o&&o.nodeType===3?!1:c&&c.nodeType===3?OC(o,c.parentNode):"contains"in o?o.contains(c):o.compareDocumentPosition?!!(o.compareDocumentPosition(c)&16):!1:!1}function _C(o){o=o!=null&&o.ownerDocument!=null&&o.ownerDocument.defaultView!=null?o.ownerDocument.defaultView:window;for(var c=Yd(o.document);c instanceof o.HTMLIFrameElement;){try{var f=typeof c.contentWindow.location.href=="string"}catch{f=!1}if(f)o=c.contentWindow;else break;c=Yd(o.document)}return c}function Ky(o){var c=o&&o.nodeName&&o.nodeName.toLowerCase();return c&&(c==="input"&&(o.type==="text"||o.type==="search"||o.type==="tel"||o.type==="url"||o.type==="password")||c==="textarea"||o.contentEditable==="true")}var rL=ma&&"documentMode"in document&&11>=document.documentMode,gl=null,Yy=null,lc=null,Zy=!1;function FC(o,c,f){var g=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;Zy||gl==null||gl!==Yd(g)||(g=gl,"selectionStart"in g&&Ky(g)?g={start:g.selectionStart,end:g.selectionEnd}:(g=(g.ownerDocument&&g.ownerDocument.defaultView||window).getSelection(),g={anchorNode:g.anchorNode,anchorOffset:g.anchorOffset,focusNode:g.focusNode,focusOffset:g.focusOffset}),lc&&oc(lc,g)||(lc=g,g=Gf(Yy,"onSelect"),0<g.length&&(c=new ef("onSelect","select",null,c,f),o.push({event:c,listeners:g}),c.target=gl)))}function Ji(o,c){var f={};return f[o.toLowerCase()]=c.toLowerCase(),f["Webkit"+o]="webkit"+c,f["Moz"+o]="moz"+c,f}var yl={animationend:Ji("Animation","AnimationEnd"),animationiteration:Ji("Animation","AnimationIteration"),animationstart:Ji("Animation","AnimationStart"),transitionrun:Ji("Transition","TransitionRun"),transitionstart:Ji("Transition","TransitionStart"),transitioncancel:Ji("Transition","TransitionCancel"),transitionend:Ji("Transition","TransitionEnd")},Qy={},LC={};ma&&(LC=document.createElement("div").style,"AnimationEvent"in window||(delete yl.animationend.animation,delete yl.animationiteration.animation,delete yl.animationstart.animation),"TransitionEvent"in window||delete yl.transitionend.transition);function to(o){if(Qy[o])return Qy[o];if(!yl[o])return o;var c=yl[o],f;for(f in c)if(c.hasOwnProperty(f)&&f in LC)return Qy[o]=c[f];return o}var zC=to("animationend"),MC=to("animationiteration"),BC=to("animationstart"),aL=to("transitionrun"),iL=to("transitionstart"),oL=to("transitioncancel"),PC=to("transitionend"),VC=new Map,Jy="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Jy.push("scrollEnd");function Ir(o,c){VC.set(o,c),Zi(c,[o])}var UC=new WeakMap;function rr(o,c){if(typeof o=="object"&&o!==null){var f=UC.get(o);return f!==void 0?f:(c={value:o,source:c,stack:rC(c)},UC.set(o,c),c)}return{value:o,source:c,stack:rC(c)}}var ar=[],bl=0,t0=0;function rf(){for(var o=bl,c=t0=bl=0;c<o;){var f=ar[c];ar[c++]=null;var g=ar[c];ar[c++]=null;var w=ar[c];ar[c++]=null;var N=ar[c];if(ar[c++]=null,g!==null&&w!==null){var E=g.pending;E===null?w.next=w:(w.next=E.next,E.next=w),g.pending=w}N!==0&&GC(f,w,N)}}function af(o,c,f,g){ar[bl++]=o,ar[bl++]=c,ar[bl++]=f,ar[bl++]=g,t0|=g,o.lanes|=g,o=o.alternate,o!==null&&(o.lanes|=g)}function e0(o,c,f,g){return af(o,c,f,g),of(o)}function xl(o,c){return af(o,null,null,c),of(o)}function GC(o,c,f){o.lanes|=f;var g=o.alternate;g!==null&&(g.lanes|=f);for(var w=!1,N=o.return;N!==null;)N.childLanes|=f,g=N.alternate,g!==null&&(g.childLanes|=f),N.tag===22&&(o=N.stateNode,o===null||o._visibility&1||(w=!0)),o=N,N=N.return;return o.tag===3?(N=o.stateNode,w&&c!==null&&(w=31-Pe(f),o=N.hiddenUpdates,g=o[w],g===null?o[w]=[c]:g.push(c),c.lane=f|536870912),N):null}function of(o){if(50<Oc)throw Oc=0,ob=null,Error(s(185));for(var c=o.return;c!==null;)o=c,c=o.return;return o.tag===3?o.stateNode:null}var vl={};function lL(o,c,f,g){this.tag=o,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Gs(o,c,f,g){return new lL(o,c,f,g)}function n0(o){return o=o.prototype,!(!o||!o.isReactComponent)}function ga(o,c){var f=o.alternate;return f===null?(f=Gs(o.tag,c,o.key,o.mode),f.elementType=o.elementType,f.type=o.type,f.stateNode=o.stateNode,f.alternate=o,o.alternate=f):(f.pendingProps=c,f.type=o.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=o.flags&65011712,f.childLanes=o.childLanes,f.lanes=o.lanes,f.child=o.child,f.memoizedProps=o.memoizedProps,f.memoizedState=o.memoizedState,f.updateQueue=o.updateQueue,c=o.dependencies,f.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},f.sibling=o.sibling,f.index=o.index,f.ref=o.ref,f.refCleanup=o.refCleanup,f}function WC(o,c){o.flags&=65011714;var f=o.alternate;return f===null?(o.childLanes=0,o.lanes=c,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=f.childLanes,o.lanes=f.lanes,o.child=f.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=f.memoizedProps,o.memoizedState=f.memoizedState,o.updateQueue=f.updateQueue,o.type=f.type,c=f.dependencies,o.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext}),o}function lf(o,c,f,g,w,N){var E=0;if(g=o,typeof o=="function")n0(o)&&(E=1);else if(typeof o=="string")E=cz(o,f,Q.current)?26:o==="html"||o==="head"||o==="body"?27:5;else t:switch(o){case _:return o=Gs(31,f,c,w),o.elementType=_,o.lanes=N,o;case b:return eo(f.children,w,N,c);case x:E=8,w|=24;break;case v:return o=Gs(12,f,c,w|2),o.elementType=v,o.lanes=N,o;case I:return o=Gs(13,f,c,w),o.elementType=I,o.lanes=N,o;case A:return o=Gs(19,f,c,w),o.elementType=A,o.lanes=N,o;default:if(typeof o=="object"&&o!==null)switch(o.$$typeof){case S:case $:E=10;break t;case C:E=9;break t;case T:E=11;break t;case R:E=14;break t;case L:E=16,g=null;break t}E=29,f=Error(s(130,o===null?"null":typeof o,"")),g=null}return c=Gs(E,f,c,w),c.elementType=o,c.type=g,c.lanes=N,c}function eo(o,c,f,g){return o=Gs(7,o,g,c),o.lanes=f,o}function s0(o,c,f){return o=Gs(6,o,null,c),o.lanes=f,o}function r0(o,c,f){return c=Gs(4,o.children!==null?o.children:[],o.key,c),c.lanes=f,c.stateNode={containerInfo:o.containerInfo,pendingChildren:null,implementation:o.implementation},c}var wl=[],Sl=0,uf=null,cf=0,ir=[],or=0,no=null,ya=1,ba="";function so(o,c){wl[Sl++]=cf,wl[Sl++]=uf,uf=o,cf=c}function HC(o,c,f){ir[or++]=ya,ir[or++]=ba,ir[or++]=no,no=o;var g=ya;o=ba;var w=32-Pe(g)-1;g&=~(1<<w),f+=1;var N=32-Pe(c)+w;if(30<N){var E=w-w%5;N=(g&(1<<E)-1).toString(32),g>>=E,w-=E,ya=1<<32-Pe(c)+w|f<<w|g,ba=N+o}else ya=1<<N|f<<w|g,ba=o}function a0(o){o.return!==null&&(so(o,1),HC(o,1,0))}function i0(o){for(;o===uf;)uf=wl[--Sl],wl[Sl]=null,cf=wl[--Sl],wl[Sl]=null;for(;o===no;)no=ir[--or],ir[or]=null,ba=ir[--or],ir[or]=null,ya=ir[--or],ir[or]=null}var fs=null,sn=null,xe=!1,ro=null,Hr=!1,o0=Error(s(519));function ao(o){var c=Error(s(418,""));throw hc(rr(c,o)),o0}function jC(o){var c=o.stateNode,f=o.type,g=o.memoizedProps;switch(c[rs]=o,c[xs]=g,f){case"dialog":he("cancel",c),he("close",c);break;case"iframe":case"object":case"embed":he("load",c);break;case"video":case"audio":for(f=0;f<Fc.length;f++)he(Fc[f],c);break;case"source":he("error",c);break;case"img":case"image":case"link":he("error",c),he("load",c);break;case"details":he("toggle",c);break;case"input":he("invalid",c),oC(c,g.value,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name,!0),Kd(c);break;case"select":he("invalid",c);break;case"textarea":he("invalid",c),uC(c,g.value,g.defaultValue,g.children),Kd(c)}f=g.children,typeof f!="string"&&typeof f!="number"&&typeof f!="bigint"||c.textContent===""+f||g.suppressHydrationWarning===!0||u$(c.textContent,f)?(g.popover!=null&&(he("beforetoggle",c),he("toggle",c)),g.onScroll!=null&&he("scroll",c),g.onScrollEnd!=null&&he("scrollend",c),g.onClick!=null&&(c.onclick=Wf),c=!0):c=!1,c||ao(o)}function qC(o){for(fs=o.return;fs;)switch(fs.tag){case 5:case 13:Hr=!1;return;case 27:case 3:Hr=!0;return;default:fs=fs.return}}function uc(o){if(o!==fs)return!1;if(!xe)return qC(o),xe=!0,!1;var c=o.tag,f;if((f=c!==3&&c!==27)&&((f=c===5)&&(f=o.type,f=!(f!=="form"&&f!=="button")||Cb(o.type,o.memoizedProps)),f=!f),f&&sn&&ao(o),qC(o),c===13){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(s(317));t:{for(o=o.nextSibling,c=0;o;){if(o.nodeType===8)if(f=o.data,f==="/$"){if(c===0){sn=Dr(o.nextSibling);break t}c--}else f!=="$"&&f!=="$!"&&f!=="$?"||c++;o=o.nextSibling}sn=null}}else c===27?(c=sn,hi(o.type)?(o=kb,kb=null,sn=o):sn=c):sn=fs?Dr(o.stateNode.nextSibling):null;return!0}function cc(){sn=fs=null,xe=!1}function XC(){var o=ro;return o!==null&&(Cs===null?Cs=o:Cs.push.apply(Cs,o),ro=null),o}function hc(o){ro===null?ro=[o]:ro.push(o)}var l0=V(null),io=null,xa=null;function Ya(o,c,f){H(l0,c._currentValue),c._currentValue=f}function va(o){o._currentValue=l0.current,P(l0)}function u0(o,c,f){for(;o!==null;){var g=o.alternate;if((o.childLanes&c)!==c?(o.childLanes|=c,g!==null&&(g.childLanes|=c)):g!==null&&(g.childLanes&c)!==c&&(g.childLanes|=c),o===f)break;o=o.return}}function c0(o,c,f,g){var w=o.child;for(w!==null&&(w.return=o);w!==null;){var N=w.dependencies;if(N!==null){var E=w.child;N=N.firstContext;t:for(;N!==null;){var z=N;N=w;for(var j=0;j<c.length;j++)if(z.context===c[j]){N.lanes|=f,z=N.alternate,z!==null&&(z.lanes|=f),u0(N.return,f,o),g||(E=null);break t}N=z.next}}else if(w.tag===18){if(E=w.return,E===null)throw Error(s(341));E.lanes|=f,N=E.alternate,N!==null&&(N.lanes|=f),u0(E,f,o),E=null}else E=w.child;if(E!==null)E.return=w;else for(E=w;E!==null;){if(E===o){E=null;break}if(w=E.sibling,w!==null){w.return=E.return,E=w;break}E=E.return}w=E}}function dc(o,c,f,g){o=null;for(var w=c,N=!1;w!==null;){if(!N){if((w.flags&524288)!==0)N=!0;else if((w.flags&262144)!==0)break}if(w.tag===10){var E=w.alternate;if(E===null)throw Error(s(387));if(E=E.memoizedProps,E!==null){var z=w.type;Us(w.pendingProps.value,E.value)||(o!==null?o.push(z):o=[z])}}else if(w===ht.current){if(E=w.alternate,E===null)throw Error(s(387));E.memoizedState.memoizedState!==w.memoizedState.memoizedState&&(o!==null?o.push(Vc):o=[Vc])}w=w.return}o!==null&&c0(c,o,f,g),c.flags|=262144}function hf(o){for(o=o.firstContext;o!==null;){if(!Us(o.context._currentValue,o.memoizedValue))return!0;o=o.next}return!1}function oo(o){io=o,xa=null,o=o.dependencies,o!==null&&(o.firstContext=null)}function as(o){return KC(io,o)}function df(o,c){return io===null&&oo(o),KC(o,c)}function KC(o,c){var f=c._currentValue;if(c={context:c,memoizedValue:f,next:null},xa===null){if(o===null)throw Error(s(308));xa=c,o.dependencies={lanes:0,firstContext:c},o.flags|=524288}else xa=xa.next=c;return f}var uL=typeof AbortController<"u"?AbortController:function(){var o=[],c=this.signal={aborted:!1,addEventListener:function(f,g){o.push(g)}};this.abort=function(){c.aborted=!0,o.forEach(function(f){return f()})}},cL=n.unstable_scheduleCallback,hL=n.unstable_NormalPriority,In={$$typeof:$,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function h0(){return{controller:new uL,data:new Map,refCount:0}}function fc(o){o.refCount--,o.refCount===0&&cL(hL,function(){o.controller.abort()})}var pc=null,d0=0,Cl=0,Nl=null;function dL(o,c){if(pc===null){var f=pc=[];d0=0,Cl=pb(),Nl={status:"pending",value:void 0,then:function(g){f.push(g)}}}return d0++,c.then(YC,YC),c}function YC(){if(--d0===0&&pc!==null){Nl!==null&&(Nl.status="fulfilled");var o=pc;pc=null,Cl=0,Nl=null;for(var c=0;c<o.length;c++)(0,o[c])()}}function fL(o,c){var f=[],g={status:"pending",value:null,reason:null,then:function(w){f.push(w)}};return o.then(function(){g.status="fulfilled",g.value=c;for(var w=0;w<f.length;w++)(0,f[w])(c)},function(w){for(g.status="rejected",g.reason=w,w=0;w<f.length;w++)(0,f[w])(void 0)}),g}var ZC=U.S;U.S=function(o,c){typeof c=="object"&&c!==null&&typeof c.then=="function"&&dL(o,c),ZC!==null&&ZC(o,c)};var lo=V(null);function f0(){var o=lo.current;return o!==null?o:ze.pooledCache}function ff(o,c){c===null?H(lo,lo.current):H(lo,c.pool)}function QC(){var o=f0();return o===null?null:{parent:In._currentValue,pool:o}}var mc=Error(s(460)),JC=Error(s(474)),pf=Error(s(542)),p0={then:function(){}};function tN(o){return o=o.status,o==="fulfilled"||o==="rejected"}function mf(){}function eN(o,c,f){switch(f=o[f],f===void 0?o.push(c):f!==c&&(c.then(mf,mf),c=f),c.status){case"fulfilled":return c.value;case"rejected":throw o=c.reason,sN(o),o;default:if(typeof c.status=="string")c.then(mf,mf);else{if(o=ze,o!==null&&100<o.shellSuspendCounter)throw Error(s(482));o=c,o.status="pending",o.then(function(g){if(c.status==="pending"){var w=c;w.status="fulfilled",w.value=g}},function(g){if(c.status==="pending"){var w=c;w.status="rejected",w.reason=g}})}switch(c.status){case"fulfilled":return c.value;case"rejected":throw o=c.reason,sN(o),o}throw gc=c,mc}}var gc=null;function nN(){if(gc===null)throw Error(s(459));var o=gc;return gc=null,o}function sN(o){if(o===mc||o===pf)throw Error(s(483))}var Za=!1;function m0(o){o.updateQueue={baseState:o.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function g0(o,c){o=o.updateQueue,c.updateQueue===o&&(c.updateQueue={baseState:o.baseState,firstBaseUpdate:o.firstBaseUpdate,lastBaseUpdate:o.lastBaseUpdate,shared:o.shared,callbacks:null})}function Qa(o){return{lane:o,tag:0,payload:null,callback:null,next:null}}function Ja(o,c,f){var g=o.updateQueue;if(g===null)return null;if(g=g.shared,(Ne&2)!==0){var w=g.pending;return w===null?c.next=c:(c.next=w.next,w.next=c),g.pending=c,c=of(o),GC(o,null,f),c}return af(o,g,c,f),of(o)}function yc(o,c,f){if(c=c.updateQueue,c!==null&&(c=c.shared,(f&4194048)!==0)){var g=c.lanes;g&=o.pendingLanes,f|=g,c.lanes=f,YS(o,f)}}function y0(o,c){var f=o.updateQueue,g=o.alternate;if(g!==null&&(g=g.updateQueue,f===g)){var w=null,N=null;if(f=f.firstBaseUpdate,f!==null){do{var E={lane:f.lane,tag:f.tag,payload:f.payload,callback:null,next:null};N===null?w=N=E:N=N.next=E,f=f.next}while(f!==null);N===null?w=N=c:N=N.next=c}else w=N=c;f={baseState:g.baseState,firstBaseUpdate:w,lastBaseUpdate:N,shared:g.shared,callbacks:g.callbacks},o.updateQueue=f;return}o=f.lastBaseUpdate,o===null?f.firstBaseUpdate=c:o.next=c,f.lastBaseUpdate=c}var b0=!1;function bc(){if(b0){var o=Nl;if(o!==null)throw o}}function xc(o,c,f,g){b0=!1;var w=o.updateQueue;Za=!1;var N=w.firstBaseUpdate,E=w.lastBaseUpdate,z=w.shared.pending;if(z!==null){w.shared.pending=null;var j=z,dt=j.next;j.next=null,E===null?N=dt:E.next=dt,E=j;var bt=o.alternate;bt!==null&&(bt=bt.updateQueue,z=bt.lastBaseUpdate,z!==E&&(z===null?bt.firstBaseUpdate=dt:z.next=dt,bt.lastBaseUpdate=j))}if(N!==null){var wt=w.baseState;E=0,bt=dt=j=null,z=N;do{var ft=z.lane&-536870913,pt=ft!==z.lane;if(pt?(ge&ft)===ft:(g&ft)===ft){ft!==0&&ft===Cl&&(b0=!0),bt!==null&&(bt=bt.next={lane:0,tag:z.tag,payload:z.payload,callback:null,next:null});t:{var qt=o,Ut=z;ft=c;var De=f;switch(Ut.tag){case 1:if(qt=Ut.payload,typeof qt=="function"){wt=qt.call(De,wt,ft);break t}wt=qt;break t;case 3:qt.flags=qt.flags&-65537|128;case 0:if(qt=Ut.payload,ft=typeof qt=="function"?qt.call(De,wt,ft):qt,ft==null)break t;wt=d({},wt,ft);break t;case 2:Za=!0}}ft=z.callback,ft!==null&&(o.flags|=64,pt&&(o.flags|=8192),pt=w.callbacks,pt===null?w.callbacks=[ft]:pt.push(ft))}else pt={lane:ft,tag:z.tag,payload:z.payload,callback:z.callback,next:null},bt===null?(dt=bt=pt,j=wt):bt=bt.next=pt,E|=ft;if(z=z.next,z===null){if(z=w.shared.pending,z===null)break;pt=z,z=pt.next,pt.next=null,w.lastBaseUpdate=pt,w.shared.pending=null}}while(!0);bt===null&&(j=wt),w.baseState=j,w.firstBaseUpdate=dt,w.lastBaseUpdate=bt,N===null&&(w.shared.lanes=0),oi|=E,o.lanes=E,o.memoizedState=wt}}function rN(o,c){if(typeof o!="function")throw Error(s(191,o));o.call(c)}function aN(o,c){var f=o.callbacks;if(f!==null)for(o.callbacks=null,o=0;o<f.length;o++)rN(f[o],c)}var Tl=V(null),gf=V(0);function iN(o,c){o=ka,H(gf,o),H(Tl,c),ka=o|c.baseLanes}function x0(){H(gf,ka),H(Tl,Tl.current)}function v0(){ka=gf.current,P(Tl),P(gf)}var ti=0,oe=null,Ie=null,gn=null,yf=!1,$l=!1,uo=!1,bf=0,vc=0,kl=null,pL=0;function dn(){throw Error(s(321))}function w0(o,c){if(c===null)return!1;for(var f=0;f<c.length&&f<o.length;f++)if(!Us(o[f],c[f]))return!1;return!0}function S0(o,c,f,g,w,N){return ti=N,oe=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,U.H=o===null||o.memoizedState===null?GN:WN,uo=!1,N=f(g,w),uo=!1,$l&&(N=lN(c,f,g,w)),oN(o),N}function oN(o){U.H=Nf;var c=Ie!==null&&Ie.next!==null;if(ti=0,gn=Ie=oe=null,yf=!1,vc=0,kl=null,c)throw Error(s(300));o===null||Ln||(o=o.dependencies,o!==null&&hf(o)&&(Ln=!0))}function lN(o,c,f,g){oe=o;var w=0;do{if($l&&(kl=null),vc=0,$l=!1,25<=w)throw Error(s(301));if(w+=1,gn=Ie=null,o.updateQueue!=null){var N=o.updateQueue;N.lastEffect=null,N.events=null,N.stores=null,N.memoCache!=null&&(N.memoCache.index=0)}U.H=wL,N=c(f,g)}while($l);return N}function mL(){var o=U.H,c=o.useState()[0];return c=typeof c.then=="function"?wc(c):c,o=o.useState()[0],(Ie!==null?Ie.memoizedState:null)!==o&&(oe.flags|=1024),c}function C0(){var o=bf!==0;return bf=0,o}function N0(o,c,f){c.updateQueue=o.updateQueue,c.flags&=-2053,o.lanes&=~f}function T0(o){if(yf){for(o=o.memoizedState;o!==null;){var c=o.queue;c!==null&&(c.pending=null),o=o.next}yf=!1}ti=0,gn=Ie=oe=null,$l=!1,vc=bf=0,kl=null}function ws(){var o={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return gn===null?oe.memoizedState=gn=o:gn=gn.next=o,gn}function yn(){if(Ie===null){var o=oe.alternate;o=o!==null?o.memoizedState:null}else o=Ie.next;var c=gn===null?oe.memoizedState:gn.next;if(c!==null)gn=c,Ie=o;else{if(o===null)throw oe.alternate===null?Error(s(467)):Error(s(310));Ie=o,o={memoizedState:Ie.memoizedState,baseState:Ie.baseState,baseQueue:Ie.baseQueue,queue:Ie.queue,next:null},gn===null?oe.memoizedState=gn=o:gn=gn.next=o}return gn}function $0(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function wc(o){var c=vc;return vc+=1,kl===null&&(kl=[]),o=eN(kl,o,c),c=oe,(gn===null?c.memoizedState:gn.next)===null&&(c=c.alternate,U.H=c===null||c.memoizedState===null?GN:WN),o}function xf(o){if(o!==null&&typeof o=="object"){if(typeof o.then=="function")return wc(o);if(o.$$typeof===$)return as(o)}throw Error(s(438,String(o)))}function k0(o){var c=null,f=oe.updateQueue;if(f!==null&&(c=f.memoCache),c==null){var g=oe.alternate;g!==null&&(g=g.updateQueue,g!==null&&(g=g.memoCache,g!=null&&(c={data:g.data.map(function(w){return w.slice()}),index:0})))}if(c==null&&(c={data:[],index:0}),f===null&&(f=$0(),oe.updateQueue=f),f.memoCache=c,f=c.data[c.index],f===void 0)for(f=c.data[c.index]=Array(o),g=0;g<o;g++)f[g]=M;return c.index++,f}function wa(o,c){return typeof c=="function"?c(o):c}function vf(o){var c=yn();return I0(c,Ie,o)}function I0(o,c,f){var g=o.queue;if(g===null)throw Error(s(311));g.lastRenderedReducer=f;var w=o.baseQueue,N=g.pending;if(N!==null){if(w!==null){var E=w.next;w.next=N.next,N.next=E}c.baseQueue=w=N,g.pending=null}if(N=o.baseState,w===null)o.memoizedState=N;else{c=w.next;var z=E=null,j=null,dt=c,bt=!1;do{var wt=dt.lane&-536870913;if(wt!==dt.lane?(ge&wt)===wt:(ti&wt)===wt){var ft=dt.revertLane;if(ft===0)j!==null&&(j=j.next={lane:0,revertLane:0,action:dt.action,hasEagerState:dt.hasEagerState,eagerState:dt.eagerState,next:null}),wt===Cl&&(bt=!0);else if((ti&ft)===ft){dt=dt.next,ft===Cl&&(bt=!0);continue}else wt={lane:0,revertLane:dt.revertLane,action:dt.action,hasEagerState:dt.hasEagerState,eagerState:dt.eagerState,next:null},j===null?(z=j=wt,E=N):j=j.next=wt,oe.lanes|=ft,oi|=ft;wt=dt.action,uo&&f(N,wt),N=dt.hasEagerState?dt.eagerState:f(N,wt)}else ft={lane:wt,revertLane:dt.revertLane,action:dt.action,hasEagerState:dt.hasEagerState,eagerState:dt.eagerState,next:null},j===null?(z=j=ft,E=N):j=j.next=ft,oe.lanes|=wt,oi|=wt;dt=dt.next}while(dt!==null&&dt!==c);if(j===null?E=N:j.next=z,!Us(N,o.memoizedState)&&(Ln=!0,bt&&(f=Nl,f!==null)))throw f;o.memoizedState=N,o.baseState=E,o.baseQueue=j,g.lastRenderedState=N}return w===null&&(g.lanes=0),[o.memoizedState,g.dispatch]}function E0(o){var c=yn(),f=c.queue;if(f===null)throw Error(s(311));f.lastRenderedReducer=o;var g=f.dispatch,w=f.pending,N=c.memoizedState;if(w!==null){f.pending=null;var E=w=w.next;do N=o(N,E.action),E=E.next;while(E!==w);Us(N,c.memoizedState)||(Ln=!0),c.memoizedState=N,c.baseQueue===null&&(c.baseState=N),f.lastRenderedState=N}return[N,g]}function uN(o,c,f){var g=oe,w=yn(),N=xe;if(N){if(f===void 0)throw Error(s(407));f=f()}else f=c();var E=!Us((Ie||w).memoizedState,f);E&&(w.memoizedState=f,Ln=!0),w=w.queue;var z=dN.bind(null,g,w,o);if(Sc(2048,8,z,[o]),w.getSnapshot!==c||E||gn!==null&&gn.memoizedState.tag&1){if(g.flags|=2048,Il(9,wf(),hN.bind(null,g,w,f,c),null),ze===null)throw Error(s(349));N||(ti&124)!==0||cN(g,c,f)}return f}function cN(o,c,f){o.flags|=16384,o={getSnapshot:c,value:f},c=oe.updateQueue,c===null?(c=$0(),oe.updateQueue=c,c.stores=[o]):(f=c.stores,f===null?c.stores=[o]:f.push(o))}function hN(o,c,f,g){c.value=f,c.getSnapshot=g,fN(c)&&pN(o)}function dN(o,c,f){return f(function(){fN(c)&&pN(o)})}function fN(o){var c=o.getSnapshot;o=o.value;try{var f=c();return!Us(o,f)}catch{return!0}}function pN(o){var c=xl(o,2);c!==null&&Xs(c,o,2)}function D0(o){var c=ws();if(typeof o=="function"){var f=o;if(o=f(),uo){nn(!0);try{f()}finally{nn(!1)}}}return c.memoizedState=c.baseState=o,c.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:wa,lastRenderedState:o},c}function mN(o,c,f,g){return o.baseState=f,I0(o,Ie,typeof g=="function"?g:wa)}function gL(o,c,f,g,w){if(Cf(o))throw Error(s(485));if(o=c.action,o!==null){var N={payload:w,action:o,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(E){N.listeners.push(E)}};U.T!==null?f(!0):N.isTransition=!1,g(N),f=c.pending,f===null?(N.next=c.pending=N,gN(c,N)):(N.next=f.next,c.pending=f.next=N)}}function gN(o,c){var f=c.action,g=c.payload,w=o.state;if(c.isTransition){var N=U.T,E={};U.T=E;try{var z=f(w,g),j=U.S;j!==null&&j(E,z),yN(o,c,z)}catch(dt){A0(o,c,dt)}finally{U.T=N}}else try{N=f(w,g),yN(o,c,N)}catch(dt){A0(o,c,dt)}}function yN(o,c,f){f!==null&&typeof f=="object"&&typeof f.then=="function"?f.then(function(g){bN(o,c,g)},function(g){return A0(o,c,g)}):bN(o,c,f)}function bN(o,c,f){c.status="fulfilled",c.value=f,xN(c),o.state=f,c=o.pending,c!==null&&(f=c.next,f===c?o.pending=null:(f=f.next,c.next=f,gN(o,f)))}function A0(o,c,f){var g=o.pending;if(o.pending=null,g!==null){g=g.next;do c.status="rejected",c.reason=f,xN(c),c=c.next;while(c!==g)}o.action=null}function xN(o){o=o.listeners;for(var c=0;c<o.length;c++)(0,o[c])()}function vN(o,c){return c}function wN(o,c){if(xe){var f=ze.formState;if(f!==null){t:{var g=oe;if(xe){if(sn){e:{for(var w=sn,N=Hr;w.nodeType!==8;){if(!N){w=null;break e}if(w=Dr(w.nextSibling),w===null){w=null;break e}}N=w.data,w=N==="F!"||N==="F"?w:null}if(w){sn=Dr(w.nextSibling),g=w.data==="F!";break t}}ao(g)}g=!1}g&&(c=f[0])}}return f=ws(),f.memoizedState=f.baseState=c,g={pending:null,lanes:0,dispatch:null,lastRenderedReducer:vN,lastRenderedState:c},f.queue=g,f=PN.bind(null,oe,g),g.dispatch=f,g=D0(!1),N=L0.bind(null,oe,!1,g.queue),g=ws(),w={state:c,dispatch:null,action:o,pending:null},g.queue=w,f=gL.bind(null,oe,w,N,f),w.dispatch=f,g.memoizedState=o,[c,f,!1]}function SN(o){var c=yn();return CN(c,Ie,o)}function CN(o,c,f){if(c=I0(o,c,vN)[0],o=vf(wa)[0],typeof c=="object"&&c!==null&&typeof c.then=="function")try{var g=wc(c)}catch(E){throw E===mc?pf:E}else g=c;c=yn();var w=c.queue,N=w.dispatch;return f!==c.memoizedState&&(oe.flags|=2048,Il(9,wf(),yL.bind(null,w,f),null)),[g,N,o]}function yL(o,c){o.action=c}function NN(o){var c=yn(),f=Ie;if(f!==null)return CN(c,f,o);yn(),c=c.memoizedState,f=yn();var g=f.queue.dispatch;return f.memoizedState=o,[c,g,!1]}function Il(o,c,f,g){return o={tag:o,create:f,deps:g,inst:c,next:null},c=oe.updateQueue,c===null&&(c=$0(),oe.updateQueue=c),f=c.lastEffect,f===null?c.lastEffect=o.next=o:(g=f.next,f.next=o,o.next=g,c.lastEffect=o),o}function wf(){return{destroy:void 0,resource:void 0}}function TN(){return yn().memoizedState}function Sf(o,c,f,g){var w=ws();g=g===void 0?null:g,oe.flags|=o,w.memoizedState=Il(1|c,wf(),f,g)}function Sc(o,c,f,g){var w=yn();g=g===void 0?null:g;var N=w.memoizedState.inst;Ie!==null&&g!==null&&w0(g,Ie.memoizedState.deps)?w.memoizedState=Il(c,N,f,g):(oe.flags|=o,w.memoizedState=Il(1|c,N,f,g))}function $N(o,c){Sf(8390656,8,o,c)}function kN(o,c){Sc(2048,8,o,c)}function IN(o,c){return Sc(4,2,o,c)}function EN(o,c){return Sc(4,4,o,c)}function DN(o,c){if(typeof c=="function"){o=o();var f=c(o);return function(){typeof f=="function"?f():c(null)}}if(c!=null)return o=o(),c.current=o,function(){c.current=null}}function AN(o,c,f){f=f!=null?f.concat([o]):null,Sc(4,4,DN.bind(null,c,o),f)}function R0(){}function RN(o,c){var f=yn();c=c===void 0?null:c;var g=f.memoizedState;return c!==null&&w0(c,g[1])?g[0]:(f.memoizedState=[o,c],o)}function ON(o,c){var f=yn();c=c===void 0?null:c;var g=f.memoizedState;if(c!==null&&w0(c,g[1]))return g[0];if(g=o(),uo){nn(!0);try{o()}finally{nn(!1)}}return f.memoizedState=[g,c],g}function O0(o,c,f){return f===void 0||(ti&1073741824)!==0?o.memoizedState=c:(o.memoizedState=f,o=LT(),oe.lanes|=o,oi|=o,f)}function _N(o,c,f,g){return Us(f,c)?f:Tl.current!==null?(o=O0(o,f,g),Us(o,c)||(Ln=!0),o):(ti&42)===0?(Ln=!0,o.memoizedState=f):(o=LT(),oe.lanes|=o,oi|=o,c)}function FN(o,c,f,g,w){var N=Y.p;Y.p=N!==0&&8>N?N:8;var E=U.T,z={};U.T=z,L0(o,!1,c,f);try{var j=w(),dt=U.S;if(dt!==null&&dt(z,j),j!==null&&typeof j=="object"&&typeof j.then=="function"){var bt=fL(j,g);Cc(o,c,bt,qs(o))}else Cc(o,c,g,qs(o))}catch(wt){Cc(o,c,{then:function(){},status:"rejected",reason:wt},qs())}finally{Y.p=N,U.T=E}}function bL(){}function _0(o,c,f,g){if(o.tag!==5)throw Error(s(476));var w=LN(o).queue;FN(o,w,c,Z,f===null?bL:function(){return zN(o),f(g)})}function LN(o){var c=o.memoizedState;if(c!==null)return c;c={memoizedState:Z,baseState:Z,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:wa,lastRenderedState:Z},next:null};var f={};return c.next={memoizedState:f,baseState:f,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:wa,lastRenderedState:f},next:null},o.memoizedState=c,o=o.alternate,o!==null&&(o.memoizedState=c),c}function zN(o){var c=LN(o).next.queue;Cc(o,c,{},qs())}function F0(){return as(Vc)}function MN(){return yn().memoizedState}function BN(){return yn().memoizedState}function xL(o){for(var c=o.return;c!==null;){switch(c.tag){case 24:case 3:var f=qs();o=Qa(f);var g=Ja(c,o,f);g!==null&&(Xs(g,c,f),yc(g,c,f)),c={cache:h0()},o.payload=c;return}c=c.return}}function vL(o,c,f){var g=qs();f={lane:g,revertLane:0,action:f,hasEagerState:!1,eagerState:null,next:null},Cf(o)?VN(c,f):(f=e0(o,c,f,g),f!==null&&(Xs(f,o,g),UN(f,c,g)))}function PN(o,c,f){var g=qs();Cc(o,c,f,g)}function Cc(o,c,f,g){var w={lane:g,revertLane:0,action:f,hasEagerState:!1,eagerState:null,next:null};if(Cf(o))VN(c,w);else{var N=o.alternate;if(o.lanes===0&&(N===null||N.lanes===0)&&(N=c.lastRenderedReducer,N!==null))try{var E=c.lastRenderedState,z=N(E,f);if(w.hasEagerState=!0,w.eagerState=z,Us(z,E))return af(o,c,w,0),ze===null&&rf(),!1}catch{}finally{}if(f=e0(o,c,w,g),f!==null)return Xs(f,o,g),UN(f,c,g),!0}return!1}function L0(o,c,f,g){if(g={lane:2,revertLane:pb(),action:g,hasEagerState:!1,eagerState:null,next:null},Cf(o)){if(c)throw Error(s(479))}else c=e0(o,f,g,2),c!==null&&Xs(c,o,2)}function Cf(o){var c=o.alternate;return o===oe||c!==null&&c===oe}function VN(o,c){$l=yf=!0;var f=o.pending;f===null?c.next=c:(c.next=f.next,f.next=c),o.pending=c}function UN(o,c,f){if((f&4194048)!==0){var g=c.lanes;g&=o.pendingLanes,f|=g,c.lanes=f,YS(o,f)}}var Nf={readContext:as,use:xf,useCallback:dn,useContext:dn,useEffect:dn,useImperativeHandle:dn,useLayoutEffect:dn,useInsertionEffect:dn,useMemo:dn,useReducer:dn,useRef:dn,useState:dn,useDebugValue:dn,useDeferredValue:dn,useTransition:dn,useSyncExternalStore:dn,useId:dn,useHostTransitionStatus:dn,useFormState:dn,useActionState:dn,useOptimistic:dn,useMemoCache:dn,useCacheRefresh:dn},GN={readContext:as,use:xf,useCallback:function(o,c){return ws().memoizedState=[o,c===void 0?null:c],o},useContext:as,useEffect:$N,useImperativeHandle:function(o,c,f){f=f!=null?f.concat([o]):null,Sf(4194308,4,DN.bind(null,c,o),f)},useLayoutEffect:function(o,c){return Sf(4194308,4,o,c)},useInsertionEffect:function(o,c){Sf(4,2,o,c)},useMemo:function(o,c){var f=ws();c=c===void 0?null:c;var g=o();if(uo){nn(!0);try{o()}finally{nn(!1)}}return f.memoizedState=[g,c],g},useReducer:function(o,c,f){var g=ws();if(f!==void 0){var w=f(c);if(uo){nn(!0);try{f(c)}finally{nn(!1)}}}else w=c;return g.memoizedState=g.baseState=w,o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:o,lastRenderedState:w},g.queue=o,o=o.dispatch=vL.bind(null,oe,o),[g.memoizedState,o]},useRef:function(o){var c=ws();return o={current:o},c.memoizedState=o},useState:function(o){o=D0(o);var c=o.queue,f=PN.bind(null,oe,c);return c.dispatch=f,[o.memoizedState,f]},useDebugValue:R0,useDeferredValue:function(o,c){var f=ws();return O0(f,o,c)},useTransition:function(){var o=D0(!1);return o=FN.bind(null,oe,o.queue,!0,!1),ws().memoizedState=o,[!1,o]},useSyncExternalStore:function(o,c,f){var g=oe,w=ws();if(xe){if(f===void 0)throw Error(s(407));f=f()}else{if(f=c(),ze===null)throw Error(s(349));(ge&124)!==0||cN(g,c,f)}w.memoizedState=f;var N={value:f,getSnapshot:c};return w.queue=N,$N(dN.bind(null,g,N,o),[o]),g.flags|=2048,Il(9,wf(),hN.bind(null,g,N,f,c),null),f},useId:function(){var o=ws(),c=ze.identifierPrefix;if(xe){var f=ba,g=ya;f=(g&~(1<<32-Pe(g)-1)).toString(32)+f,c=""+c+"R"+f,f=bf++,0<f&&(c+="H"+f.toString(32)),c+=""}else f=pL++,c=""+c+"r"+f.toString(32)+"";return o.memoizedState=c},useHostTransitionStatus:F0,useFormState:wN,useActionState:wN,useOptimistic:function(o){var c=ws();c.memoizedState=c.baseState=o;var f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return c.queue=f,c=L0.bind(null,oe,!0,f),f.dispatch=c,[o,c]},useMemoCache:k0,useCacheRefresh:function(){return ws().memoizedState=xL.bind(null,oe)}},WN={readContext:as,use:xf,useCallback:RN,useContext:as,useEffect:kN,useImperativeHandle:AN,useInsertionEffect:IN,useLayoutEffect:EN,useMemo:ON,useReducer:vf,useRef:TN,useState:function(){return vf(wa)},useDebugValue:R0,useDeferredValue:function(o,c){var f=yn();return _N(f,Ie.memoizedState,o,c)},useTransition:function(){var o=vf(wa)[0],c=yn().memoizedState;return[typeof o=="boolean"?o:wc(o),c]},useSyncExternalStore:uN,useId:MN,useHostTransitionStatus:F0,useFormState:SN,useActionState:SN,useOptimistic:function(o,c){var f=yn();return mN(f,Ie,o,c)},useMemoCache:k0,useCacheRefresh:BN},wL={readContext:as,use:xf,useCallback:RN,useContext:as,useEffect:kN,useImperativeHandle:AN,useInsertionEffect:IN,useLayoutEffect:EN,useMemo:ON,useReducer:E0,useRef:TN,useState:function(){return E0(wa)},useDebugValue:R0,useDeferredValue:function(o,c){var f=yn();return Ie===null?O0(f,o,c):_N(f,Ie.memoizedState,o,c)},useTransition:function(){var o=E0(wa)[0],c=yn().memoizedState;return[typeof o=="boolean"?o:wc(o),c]},useSyncExternalStore:uN,useId:MN,useHostTransitionStatus:F0,useFormState:NN,useActionState:NN,useOptimistic:function(o,c){var f=yn();return Ie!==null?mN(f,Ie,o,c):(f.baseState=o,[o,f.queue.dispatch])},useMemoCache:k0,useCacheRefresh:BN},El=null,Nc=0;function Tf(o){var c=Nc;return Nc+=1,El===null&&(El=[]),eN(El,o,c)}function Tc(o,c){c=c.props.ref,o.ref=c!==void 0?c:null}function $f(o,c){throw c.$$typeof===p?Error(s(525)):(o=Object.prototype.toString.call(c),Error(s(31,o==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":o)))}function HN(o){var c=o._init;return c(o._payload)}function jN(o){function c(it,rt){if(o){var ct=it.deletions;ct===null?(it.deletions=[rt],it.flags|=16):ct.push(rt)}}function f(it,rt){if(!o)return null;for(;rt!==null;)c(it,rt),rt=rt.sibling;return null}function g(it){for(var rt=new Map;it!==null;)it.key!==null?rt.set(it.key,it):rt.set(it.index,it),it=it.sibling;return rt}function w(it,rt){return it=ga(it,rt),it.index=0,it.sibling=null,it}function N(it,rt,ct){return it.index=ct,o?(ct=it.alternate,ct!==null?(ct=ct.index,ct<rt?(it.flags|=67108866,rt):ct):(it.flags|=67108866,rt)):(it.flags|=1048576,rt)}function E(it){return o&&it.alternate===null&&(it.flags|=67108866),it}function z(it,rt,ct,vt){return rt===null||rt.tag!==6?(rt=s0(ct,it.mode,vt),rt.return=it,rt):(rt=w(rt,ct),rt.return=it,rt)}function j(it,rt,ct,vt){var zt=ct.type;return zt===b?bt(it,rt,ct.props.children,vt,ct.key):rt!==null&&(rt.elementType===zt||typeof zt=="object"&&zt!==null&&zt.$$typeof===L&&HN(zt)===rt.type)?(rt=w(rt,ct.props),Tc(rt,ct),rt.return=it,rt):(rt=lf(ct.type,ct.key,ct.props,null,it.mode,vt),Tc(rt,ct),rt.return=it,rt)}function dt(it,rt,ct,vt){return rt===null||rt.tag!==4||rt.stateNode.containerInfo!==ct.containerInfo||rt.stateNode.implementation!==ct.implementation?(rt=r0(ct,it.mode,vt),rt.return=it,rt):(rt=w(rt,ct.children||[]),rt.return=it,rt)}function bt(it,rt,ct,vt,zt){return rt===null||rt.tag!==7?(rt=eo(ct,it.mode,vt,zt),rt.return=it,rt):(rt=w(rt,ct),rt.return=it,rt)}function wt(it,rt,ct){if(typeof rt=="string"&&rt!==""||typeof rt=="number"||typeof rt=="bigint")return rt=s0(""+rt,it.mode,ct),rt.return=it,rt;if(typeof rt=="object"&&rt!==null){switch(rt.$$typeof){case m:return ct=lf(rt.type,rt.key,rt.props,null,it.mode,ct),Tc(ct,rt),ct.return=it,ct;case y:return rt=r0(rt,it.mode,ct),rt.return=it,rt;case L:var vt=rt._init;return rt=vt(rt._payload),wt(it,rt,ct)}if(tt(rt)||W(rt))return rt=eo(rt,it.mode,ct,null),rt.return=it,rt;if(typeof rt.then=="function")return wt(it,Tf(rt),ct);if(rt.$$typeof===$)return wt(it,df(it,rt),ct);$f(it,rt)}return null}function ft(it,rt,ct,vt){var zt=rt!==null?rt.key:null;if(typeof ct=="string"&&ct!==""||typeof ct=="number"||typeof ct=="bigint")return zt!==null?null:z(it,rt,""+ct,vt);if(typeof ct=="object"&&ct!==null){switch(ct.$$typeof){case m:return ct.key===zt?j(it,rt,ct,vt):null;case y:return ct.key===zt?dt(it,rt,ct,vt):null;case L:return zt=ct._init,ct=zt(ct._payload),ft(it,rt,ct,vt)}if(tt(ct)||W(ct))return zt!==null?null:bt(it,rt,ct,vt,null);if(typeof ct.then=="function")return ft(it,rt,Tf(ct),vt);if(ct.$$typeof===$)return ft(it,rt,df(it,ct),vt);$f(it,ct)}return null}function pt(it,rt,ct,vt,zt){if(typeof vt=="string"&&vt!==""||typeof vt=="number"||typeof vt=="bigint")return it=it.get(ct)||null,z(rt,it,""+vt,zt);if(typeof vt=="object"&&vt!==null){switch(vt.$$typeof){case m:return it=it.get(vt.key===null?ct:vt.key)||null,j(rt,it,vt,zt);case y:return it=it.get(vt.key===null?ct:vt.key)||null,dt(rt,it,vt,zt);case L:var ue=vt._init;return vt=ue(vt._payload),pt(it,rt,ct,vt,zt)}if(tt(vt)||W(vt))return it=it.get(ct)||null,bt(rt,it,vt,zt,null);if(typeof vt.then=="function")return pt(it,rt,ct,Tf(vt),zt);if(vt.$$typeof===$)return pt(it,rt,ct,df(rt,vt),zt);$f(rt,vt)}return null}function qt(it,rt,ct,vt){for(var zt=null,ue=null,Pt=rt,Gt=rt=0,Mn=null;Pt!==null&&Gt<ct.length;Gt++){Pt.index>Gt?(Mn=Pt,Pt=null):Mn=Pt.sibling;var be=ft(it,Pt,ct[Gt],vt);if(be===null){Pt===null&&(Pt=Mn);break}o&&Pt&&be.alternate===null&&c(it,Pt),rt=N(be,rt,Gt),ue===null?zt=be:ue.sibling=be,ue=be,Pt=Mn}if(Gt===ct.length)return f(it,Pt),xe&&so(it,Gt),zt;if(Pt===null){for(;Gt<ct.length;Gt++)Pt=wt(it,ct[Gt],vt),Pt!==null&&(rt=N(Pt,rt,Gt),ue===null?zt=Pt:ue.sibling=Pt,ue=Pt);return xe&&so(it,Gt),zt}for(Pt=g(Pt);Gt<ct.length;Gt++)Mn=pt(Pt,it,Gt,ct[Gt],vt),Mn!==null&&(o&&Mn.alternate!==null&&Pt.delete(Mn.key===null?Gt:Mn.key),rt=N(Mn,rt,Gt),ue===null?zt=Mn:ue.sibling=Mn,ue=Mn);return o&&Pt.forEach(function(gi){return c(it,gi)}),xe&&so(it,Gt),zt}function Ut(it,rt,ct,vt){if(ct==null)throw Error(s(151));for(var zt=null,ue=null,Pt=rt,Gt=rt=0,Mn=null,be=ct.next();Pt!==null&&!be.done;Gt++,be=ct.next()){Pt.index>Gt?(Mn=Pt,Pt=null):Mn=Pt.sibling;var gi=ft(it,Pt,be.value,vt);if(gi===null){Pt===null&&(Pt=Mn);break}o&&Pt&&gi.alternate===null&&c(it,Pt),rt=N(gi,rt,Gt),ue===null?zt=gi:ue.sibling=gi,ue=gi,Pt=Mn}if(be.done)return f(it,Pt),xe&&so(it,Gt),zt;if(Pt===null){for(;!be.done;Gt++,be=ct.next())be=wt(it,be.value,vt),be!==null&&(rt=N(be,rt,Gt),ue===null?zt=be:ue.sibling=be,ue=be);return xe&&so(it,Gt),zt}for(Pt=g(Pt);!be.done;Gt++,be=ct.next())be=pt(Pt,it,Gt,be.value,vt),be!==null&&(o&&be.alternate!==null&&Pt.delete(be.key===null?Gt:be.key),rt=N(be,rt,Gt),ue===null?zt=be:ue.sibling=be,ue=be);return o&&Pt.forEach(function(Sz){return c(it,Sz)}),xe&&so(it,Gt),zt}function De(it,rt,ct,vt){if(typeof ct=="object"&&ct!==null&&ct.type===b&&ct.key===null&&(ct=ct.props.children),typeof ct=="object"&&ct!==null){switch(ct.$$typeof){case m:t:{for(var zt=ct.key;rt!==null;){if(rt.key===zt){if(zt=ct.type,zt===b){if(rt.tag===7){f(it,rt.sibling),vt=w(rt,ct.props.children),vt.return=it,it=vt;break t}}else if(rt.elementType===zt||typeof zt=="object"&&zt!==null&&zt.$$typeof===L&&HN(zt)===rt.type){f(it,rt.sibling),vt=w(rt,ct.props),Tc(vt,ct),vt.return=it,it=vt;break t}f(it,rt);break}else c(it,rt);rt=rt.sibling}ct.type===b?(vt=eo(ct.props.children,it.mode,vt,ct.key),vt.return=it,it=vt):(vt=lf(ct.type,ct.key,ct.props,null,it.mode,vt),Tc(vt,ct),vt.return=it,it=vt)}return E(it);case y:t:{for(zt=ct.key;rt!==null;){if(rt.key===zt)if(rt.tag===4&&rt.stateNode.containerInfo===ct.containerInfo&&rt.stateNode.implementation===ct.implementation){f(it,rt.sibling),vt=w(rt,ct.children||[]),vt.return=it,it=vt;break t}else{f(it,rt);break}else c(it,rt);rt=rt.sibling}vt=r0(ct,it.mode,vt),vt.return=it,it=vt}return E(it);case L:return zt=ct._init,ct=zt(ct._payload),De(it,rt,ct,vt)}if(tt(ct))return qt(it,rt,ct,vt);if(W(ct)){if(zt=W(ct),typeof zt!="function")throw Error(s(150));return ct=zt.call(ct),Ut(it,rt,ct,vt)}if(typeof ct.then=="function")return De(it,rt,Tf(ct),vt);if(ct.$$typeof===$)return De(it,rt,df(it,ct),vt);$f(it,ct)}return typeof ct=="string"&&ct!==""||typeof ct=="number"||typeof ct=="bigint"?(ct=""+ct,rt!==null&&rt.tag===6?(f(it,rt.sibling),vt=w(rt,ct),vt.return=it,it=vt):(f(it,rt),vt=s0(ct,it.mode,vt),vt.return=it,it=vt),E(it)):f(it,rt)}return function(it,rt,ct,vt){try{Nc=0;var zt=De(it,rt,ct,vt);return El=null,zt}catch(Pt){if(Pt===mc||Pt===pf)throw Pt;var ue=Gs(29,Pt,null,it.mode);return ue.lanes=vt,ue.return=it,ue}finally{}}}var Dl=jN(!0),qN=jN(!1),lr=V(null),jr=null;function ei(o){var c=o.alternate;H(En,En.current&1),H(lr,o),jr===null&&(c===null||Tl.current!==null||c.memoizedState!==null)&&(jr=o)}function XN(o){if(o.tag===22){if(H(En,En.current),H(lr,o),jr===null){var c=o.alternate;c!==null&&c.memoizedState!==null&&(jr=o)}}else ni()}function ni(){H(En,En.current),H(lr,lr.current)}function Sa(o){P(lr),jr===o&&(jr=null),P(En)}var En=V(0);function kf(o){for(var c=o;c!==null;){if(c.tag===13){var f=c.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||f.data==="$?"||$b(f)))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===o)break;for(;c.sibling===null;){if(c.return===null||c.return===o)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}function z0(o,c,f,g){c=o.memoizedState,f=f(g,c),f=f==null?c:d({},c,f),o.memoizedState=f,o.lanes===0&&(o.updateQueue.baseState=f)}var M0={enqueueSetState:function(o,c,f){o=o._reactInternals;var g=qs(),w=Qa(g);w.payload=c,f!=null&&(w.callback=f),c=Ja(o,w,g),c!==null&&(Xs(c,o,g),yc(c,o,g))},enqueueReplaceState:function(o,c,f){o=o._reactInternals;var g=qs(),w=Qa(g);w.tag=1,w.payload=c,f!=null&&(w.callback=f),c=Ja(o,w,g),c!==null&&(Xs(c,o,g),yc(c,o,g))},enqueueForceUpdate:function(o,c){o=o._reactInternals;var f=qs(),g=Qa(f);g.tag=2,c!=null&&(g.callback=c),c=Ja(o,g,f),c!==null&&(Xs(c,o,f),yc(c,o,f))}};function KN(o,c,f,g,w,N,E){return o=o.stateNode,typeof o.shouldComponentUpdate=="function"?o.shouldComponentUpdate(g,N,E):c.prototype&&c.prototype.isPureReactComponent?!oc(f,g)||!oc(w,N):!0}function YN(o,c,f,g){o=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(f,g),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(f,g),c.state!==o&&M0.enqueueReplaceState(c,c.state,null)}function co(o,c){var f=c;if("ref"in c){f={};for(var g in c)g!=="ref"&&(f[g]=c[g])}if(o=o.defaultProps){f===c&&(f=d({},f));for(var w in o)f[w]===void 0&&(f[w]=o[w])}return f}var If=typeof reportError=="function"?reportError:function(o){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var c=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof o=="object"&&o!==null&&typeof o.message=="string"?String(o.message):String(o),error:o});if(!window.dispatchEvent(c))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",o);return}console.error(o)};function ZN(o){If(o)}function QN(o){console.error(o)}function JN(o){If(o)}function Ef(o,c){try{var f=o.onUncaughtError;f(c.value,{componentStack:c.stack})}catch(g){setTimeout(function(){throw g})}}function tT(o,c,f){try{var g=o.onCaughtError;g(f.value,{componentStack:f.stack,errorBoundary:c.tag===1?c.stateNode:null})}catch(w){setTimeout(function(){throw w})}}function B0(o,c,f){return f=Qa(f),f.tag=3,f.payload={element:null},f.callback=function(){Ef(o,c)},f}function eT(o){return o=Qa(o),o.tag=3,o}function nT(o,c,f,g){var w=f.type.getDerivedStateFromError;if(typeof w=="function"){var N=g.value;o.payload=function(){return w(N)},o.callback=function(){tT(c,f,g)}}var E=f.stateNode;E!==null&&typeof E.componentDidCatch=="function"&&(o.callback=function(){tT(c,f,g),typeof w!="function"&&(li===null?li=new Set([this]):li.add(this));var z=g.stack;this.componentDidCatch(g.value,{componentStack:z!==null?z:""})})}function SL(o,c,f,g,w){if(f.flags|=32768,g!==null&&typeof g=="object"&&typeof g.then=="function"){if(c=f.alternate,c!==null&&dc(c,f,w,!0),f=lr.current,f!==null){switch(f.tag){case 13:return jr===null?ub():f.alternate===null&&rn===0&&(rn=3),f.flags&=-257,f.flags|=65536,f.lanes=w,g===p0?f.flags|=16384:(c=f.updateQueue,c===null?f.updateQueue=new Set([g]):c.add(g),hb(o,g,w)),!1;case 22:return f.flags|=65536,g===p0?f.flags|=16384:(c=f.updateQueue,c===null?(c={transitions:null,markerInstances:null,retryQueue:new Set([g])},f.updateQueue=c):(f=c.retryQueue,f===null?c.retryQueue=new Set([g]):f.add(g)),hb(o,g,w)),!1}throw Error(s(435,f.tag))}return hb(o,g,w),ub(),!1}if(xe)return c=lr.current,c!==null?((c.flags&65536)===0&&(c.flags|=256),c.flags|=65536,c.lanes=w,g!==o0&&(o=Error(s(422),{cause:g}),hc(rr(o,f)))):(g!==o0&&(c=Error(s(423),{cause:g}),hc(rr(c,f))),o=o.current.alternate,o.flags|=65536,w&=-w,o.lanes|=w,g=rr(g,f),w=B0(o.stateNode,g,w),y0(o,w),rn!==4&&(rn=2)),!1;var N=Error(s(520),{cause:g});if(N=rr(N,f),Rc===null?Rc=[N]:Rc.push(N),rn!==4&&(rn=2),c===null)return!0;g=rr(g,f),f=c;do{switch(f.tag){case 3:return f.flags|=65536,o=w&-w,f.lanes|=o,o=B0(f.stateNode,g,o),y0(f,o),!1;case 1:if(c=f.type,N=f.stateNode,(f.flags&128)===0&&(typeof c.getDerivedStateFromError=="function"||N!==null&&typeof N.componentDidCatch=="function"&&(li===null||!li.has(N))))return f.flags|=65536,w&=-w,f.lanes|=w,w=eT(w),nT(w,o,f,g),y0(f,w),!1}f=f.return}while(f!==null);return!1}var sT=Error(s(461)),Ln=!1;function Kn(o,c,f,g){c.child=o===null?qN(c,null,f,g):Dl(c,o.child,f,g)}function rT(o,c,f,g,w){f=f.render;var N=c.ref;if("ref"in g){var E={};for(var z in g)z!=="ref"&&(E[z]=g[z])}else E=g;return oo(c),g=S0(o,c,f,E,N,w),z=C0(),o!==null&&!Ln?(N0(o,c,w),Ca(o,c,w)):(xe&&z&&a0(c),c.flags|=1,Kn(o,c,g,w),c.child)}function aT(o,c,f,g,w){if(o===null){var N=f.type;return typeof N=="function"&&!n0(N)&&N.defaultProps===void 0&&f.compare===null?(c.tag=15,c.type=N,iT(o,c,N,g,w)):(o=lf(f.type,null,g,c,c.mode,w),o.ref=c.ref,o.return=c,c.child=o)}if(N=o.child,!q0(o,w)){var E=N.memoizedProps;if(f=f.compare,f=f!==null?f:oc,f(E,g)&&o.ref===c.ref)return Ca(o,c,w)}return c.flags|=1,o=ga(N,g),o.ref=c.ref,o.return=c,c.child=o}function iT(o,c,f,g,w){if(o!==null){var N=o.memoizedProps;if(oc(N,g)&&o.ref===c.ref)if(Ln=!1,c.pendingProps=g=N,q0(o,w))(o.flags&131072)!==0&&(Ln=!0);else return c.lanes=o.lanes,Ca(o,c,w)}return P0(o,c,f,g,w)}function oT(o,c,f){var g=c.pendingProps,w=g.children,N=o!==null?o.memoizedState:null;if(g.mode==="hidden"){if((c.flags&128)!==0){if(g=N!==null?N.baseLanes|f:f,o!==null){for(w=c.child=o.child,N=0;w!==null;)N=N|w.lanes|w.childLanes,w=w.sibling;c.childLanes=N&~g}else c.childLanes=0,c.child=null;return lT(o,c,g,f)}if((f&536870912)!==0)c.memoizedState={baseLanes:0,cachePool:null},o!==null&&ff(c,N!==null?N.cachePool:null),N!==null?iN(c,N):x0(),XN(c);else return c.lanes=c.childLanes=536870912,lT(o,c,N!==null?N.baseLanes|f:f,f)}else N!==null?(ff(c,N.cachePool),iN(c,N),ni(),c.memoizedState=null):(o!==null&&ff(c,null),x0(),ni());return Kn(o,c,w,f),c.child}function lT(o,c,f,g){var w=f0();return w=w===null?null:{parent:In._currentValue,pool:w},c.memoizedState={baseLanes:f,cachePool:w},o!==null&&ff(c,null),x0(),XN(c),o!==null&&dc(o,c,g,!0),null}function Df(o,c){var f=c.ref;if(f===null)o!==null&&o.ref!==null&&(c.flags|=4194816);else{if(typeof f!="function"&&typeof f!="object")throw Error(s(284));(o===null||o.ref!==f)&&(c.flags|=4194816)}}function P0(o,c,f,g,w){return oo(c),f=S0(o,c,f,g,void 0,w),g=C0(),o!==null&&!Ln?(N0(o,c,w),Ca(o,c,w)):(xe&&g&&a0(c),c.flags|=1,Kn(o,c,f,w),c.child)}function uT(o,c,f,g,w,N){return oo(c),c.updateQueue=null,f=lN(c,g,f,w),oN(o),g=C0(),o!==null&&!Ln?(N0(o,c,N),Ca(o,c,N)):(xe&&g&&a0(c),c.flags|=1,Kn(o,c,f,N),c.child)}function cT(o,c,f,g,w){if(oo(c),c.stateNode===null){var N=vl,E=f.contextType;typeof E=="object"&&E!==null&&(N=as(E)),N=new f(g,N),c.memoizedState=N.state!==null&&N.state!==void 0?N.state:null,N.updater=M0,c.stateNode=N,N._reactInternals=c,N=c.stateNode,N.props=g,N.state=c.memoizedState,N.refs={},m0(c),E=f.contextType,N.context=typeof E=="object"&&E!==null?as(E):vl,N.state=c.memoizedState,E=f.getDerivedStateFromProps,typeof E=="function"&&(z0(c,f,E,g),N.state=c.memoizedState),typeof f.getDerivedStateFromProps=="function"||typeof N.getSnapshotBeforeUpdate=="function"||typeof N.UNSAFE_componentWillMount!="function"&&typeof N.componentWillMount!="function"||(E=N.state,typeof N.componentWillMount=="function"&&N.componentWillMount(),typeof N.UNSAFE_componentWillMount=="function"&&N.UNSAFE_componentWillMount(),E!==N.state&&M0.enqueueReplaceState(N,N.state,null),xc(c,g,N,w),bc(),N.state=c.memoizedState),typeof N.componentDidMount=="function"&&(c.flags|=4194308),g=!0}else if(o===null){N=c.stateNode;var z=c.memoizedProps,j=co(f,z);N.props=j;var dt=N.context,bt=f.contextType;E=vl,typeof bt=="object"&&bt!==null&&(E=as(bt));var wt=f.getDerivedStateFromProps;bt=typeof wt=="function"||typeof N.getSnapshotBeforeUpdate=="function",z=c.pendingProps!==z,bt||typeof N.UNSAFE_componentWillReceiveProps!="function"&&typeof N.componentWillReceiveProps!="function"||(z||dt!==E)&&YN(c,N,g,E),Za=!1;var ft=c.memoizedState;N.state=ft,xc(c,g,N,w),bc(),dt=c.memoizedState,z||ft!==dt||Za?(typeof wt=="function"&&(z0(c,f,wt,g),dt=c.memoizedState),(j=Za||KN(c,f,j,g,ft,dt,E))?(bt||typeof N.UNSAFE_componentWillMount!="function"&&typeof N.componentWillMount!="function"||(typeof N.componentWillMount=="function"&&N.componentWillMount(),typeof N.UNSAFE_componentWillMount=="function"&&N.UNSAFE_componentWillMount()),typeof N.componentDidMount=="function"&&(c.flags|=4194308)):(typeof N.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=g,c.memoizedState=dt),N.props=g,N.state=dt,N.context=E,g=j):(typeof N.componentDidMount=="function"&&(c.flags|=4194308),g=!1)}else{N=c.stateNode,g0(o,c),E=c.memoizedProps,bt=co(f,E),N.props=bt,wt=c.pendingProps,ft=N.context,dt=f.contextType,j=vl,typeof dt=="object"&&dt!==null&&(j=as(dt)),z=f.getDerivedStateFromProps,(dt=typeof z=="function"||typeof N.getSnapshotBeforeUpdate=="function")||typeof N.UNSAFE_componentWillReceiveProps!="function"&&typeof N.componentWillReceiveProps!="function"||(E!==wt||ft!==j)&&YN(c,N,g,j),Za=!1,ft=c.memoizedState,N.state=ft,xc(c,g,N,w),bc();var pt=c.memoizedState;E!==wt||ft!==pt||Za||o!==null&&o.dependencies!==null&&hf(o.dependencies)?(typeof z=="function"&&(z0(c,f,z,g),pt=c.memoizedState),(bt=Za||KN(c,f,bt,g,ft,pt,j)||o!==null&&o.dependencies!==null&&hf(o.dependencies))?(dt||typeof N.UNSAFE_componentWillUpdate!="function"&&typeof N.componentWillUpdate!="function"||(typeof N.componentWillUpdate=="function"&&N.componentWillUpdate(g,pt,j),typeof N.UNSAFE_componentWillUpdate=="function"&&N.UNSAFE_componentWillUpdate(g,pt,j)),typeof N.componentDidUpdate=="function"&&(c.flags|=4),typeof N.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof N.componentDidUpdate!="function"||E===o.memoizedProps&&ft===o.memoizedState||(c.flags|=4),typeof N.getSnapshotBeforeUpdate!="function"||E===o.memoizedProps&&ft===o.memoizedState||(c.flags|=1024),c.memoizedProps=g,c.memoizedState=pt),N.props=g,N.state=pt,N.context=j,g=bt):(typeof N.componentDidUpdate!="function"||E===o.memoizedProps&&ft===o.memoizedState||(c.flags|=4),typeof N.getSnapshotBeforeUpdate!="function"||E===o.memoizedProps&&ft===o.memoizedState||(c.flags|=1024),g=!1)}return N=g,Df(o,c),g=(c.flags&128)!==0,N||g?(N=c.stateNode,f=g&&typeof f.getDerivedStateFromError!="function"?null:N.render(),c.flags|=1,o!==null&&g?(c.child=Dl(c,o.child,null,w),c.child=Dl(c,null,f,w)):Kn(o,c,f,w),c.memoizedState=N.state,o=c.child):o=Ca(o,c,w),o}function hT(o,c,f,g){return cc(),c.flags|=256,Kn(o,c,f,g),c.child}var V0={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function U0(o){return{baseLanes:o,cachePool:QC()}}function G0(o,c,f){return o=o!==null?o.childLanes&~f:0,c&&(o|=ur),o}function dT(o,c,f){var g=c.pendingProps,w=!1,N=(c.flags&128)!==0,E;if((E=N)||(E=o!==null&&o.memoizedState===null?!1:(En.current&2)!==0),E&&(w=!0,c.flags&=-129),E=(c.flags&32)!==0,c.flags&=-33,o===null){if(xe){if(w?ei(c):ni(),xe){var z=sn,j;if(j=z){t:{for(j=z,z=Hr;j.nodeType!==8;){if(!z){z=null;break t}if(j=Dr(j.nextSibling),j===null){z=null;break t}}z=j}z!==null?(c.memoizedState={dehydrated:z,treeContext:no!==null?{id:ya,overflow:ba}:null,retryLane:536870912,hydrationErrors:null},j=Gs(18,null,null,0),j.stateNode=z,j.return=c,c.child=j,fs=c,sn=null,j=!0):j=!1}j||ao(c)}if(z=c.memoizedState,z!==null&&(z=z.dehydrated,z!==null))return $b(z)?c.lanes=32:c.lanes=536870912,null;Sa(c)}return z=g.children,g=g.fallback,w?(ni(),w=c.mode,z=Af({mode:"hidden",children:z},w),g=eo(g,w,f,null),z.return=c,g.return=c,z.sibling=g,c.child=z,w=c.child,w.memoizedState=U0(f),w.childLanes=G0(o,E,f),c.memoizedState=V0,g):(ei(c),W0(c,z))}if(j=o.memoizedState,j!==null&&(z=j.dehydrated,z!==null)){if(N)c.flags&256?(ei(c),c.flags&=-257,c=H0(o,c,f)):c.memoizedState!==null?(ni(),c.child=o.child,c.flags|=128,c=null):(ni(),w=g.fallback,z=c.mode,g=Af({mode:"visible",children:g.children},z),w=eo(w,z,f,null),w.flags|=2,g.return=c,w.return=c,g.sibling=w,c.child=g,Dl(c,o.child,null,f),g=c.child,g.memoizedState=U0(f),g.childLanes=G0(o,E,f),c.memoizedState=V0,c=w);else if(ei(c),$b(z)){if(E=z.nextSibling&&z.nextSibling.dataset,E)var dt=E.dgst;E=dt,g=Error(s(419)),g.stack="",g.digest=E,hc({value:g,source:null,stack:null}),c=H0(o,c,f)}else if(Ln||dc(o,c,f,!1),E=(f&o.childLanes)!==0,Ln||E){if(E=ze,E!==null&&(g=f&-f,g=(g&42)!==0?1:ky(g),g=(g&(E.suspendedLanes|f))!==0?0:g,g!==0&&g!==j.retryLane))throw j.retryLane=g,xl(o,g),Xs(E,o,g),sT;z.data==="$?"||ub(),c=H0(o,c,f)}else z.data==="$?"?(c.flags|=192,c.child=o.child,c=null):(o=j.treeContext,sn=Dr(z.nextSibling),fs=c,xe=!0,ro=null,Hr=!1,o!==null&&(ir[or++]=ya,ir[or++]=ba,ir[or++]=no,ya=o.id,ba=o.overflow,no=c),c=W0(c,g.children),c.flags|=4096);return c}return w?(ni(),w=g.fallback,z=c.mode,j=o.child,dt=j.sibling,g=ga(j,{mode:"hidden",children:g.children}),g.subtreeFlags=j.subtreeFlags&65011712,dt!==null?w=ga(dt,w):(w=eo(w,z,f,null),w.flags|=2),w.return=c,g.return=c,g.sibling=w,c.child=g,g=w,w=c.child,z=o.child.memoizedState,z===null?z=U0(f):(j=z.cachePool,j!==null?(dt=In._currentValue,j=j.parent!==dt?{parent:dt,pool:dt}:j):j=QC(),z={baseLanes:z.baseLanes|f,cachePool:j}),w.memoizedState=z,w.childLanes=G0(o,E,f),c.memoizedState=V0,g):(ei(c),f=o.child,o=f.sibling,f=ga(f,{mode:"visible",children:g.children}),f.return=c,f.sibling=null,o!==null&&(E=c.deletions,E===null?(c.deletions=[o],c.flags|=16):E.push(o)),c.child=f,c.memoizedState=null,f)}function W0(o,c){return c=Af({mode:"visible",children:c},o.mode),c.return=o,o.child=c}function Af(o,c){return o=Gs(22,o,null,c),o.lanes=0,o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},o}function H0(o,c,f){return Dl(c,o.child,null,f),o=W0(c,c.pendingProps.children),o.flags|=2,c.memoizedState=null,o}function fT(o,c,f){o.lanes|=c;var g=o.alternate;g!==null&&(g.lanes|=c),u0(o.return,c,f)}function j0(o,c,f,g,w){var N=o.memoizedState;N===null?o.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:g,tail:f,tailMode:w}:(N.isBackwards=c,N.rendering=null,N.renderingStartTime=0,N.last=g,N.tail=f,N.tailMode=w)}function pT(o,c,f){var g=c.pendingProps,w=g.revealOrder,N=g.tail;if(Kn(o,c,g.children,f),g=En.current,(g&2)!==0)g=g&1|2,c.flags|=128;else{if(o!==null&&(o.flags&128)!==0)t:for(o=c.child;o!==null;){if(o.tag===13)o.memoizedState!==null&&fT(o,f,c);else if(o.tag===19)fT(o,f,c);else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===c)break t;for(;o.sibling===null;){if(o.return===null||o.return===c)break t;o=o.return}o.sibling.return=o.return,o=o.sibling}g&=1}switch(H(En,g),w){case"forwards":for(f=c.child,w=null;f!==null;)o=f.alternate,o!==null&&kf(o)===null&&(w=f),f=f.sibling;f=w,f===null?(w=c.child,c.child=null):(w=f.sibling,f.sibling=null),j0(c,!1,w,f,N);break;case"backwards":for(f=null,w=c.child,c.child=null;w!==null;){if(o=w.alternate,o!==null&&kf(o)===null){c.child=w;break}o=w.sibling,w.sibling=f,f=w,w=o}j0(c,!0,f,null,N);break;case"together":j0(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function Ca(o,c,f){if(o!==null&&(c.dependencies=o.dependencies),oi|=c.lanes,(f&c.childLanes)===0)if(o!==null){if(dc(o,c,f,!1),(f&c.childLanes)===0)return null}else return null;if(o!==null&&c.child!==o.child)throw Error(s(153));if(c.child!==null){for(o=c.child,f=ga(o,o.pendingProps),c.child=f,f.return=c;o.sibling!==null;)o=o.sibling,f=f.sibling=ga(o,o.pendingProps),f.return=c;f.sibling=null}return c.child}function q0(o,c){return(o.lanes&c)!==0?!0:(o=o.dependencies,!!(o!==null&&hf(o)))}function CL(o,c,f){switch(c.tag){case 3:xt(c,c.stateNode.containerInfo),Ya(c,In,o.memoizedState.cache),cc();break;case 27:case 5:Dt(c);break;case 4:xt(c,c.stateNode.containerInfo);break;case 10:Ya(c,c.type,c.memoizedProps.value);break;case 13:var g=c.memoizedState;if(g!==null)return g.dehydrated!==null?(ei(c),c.flags|=128,null):(f&c.child.childLanes)!==0?dT(o,c,f):(ei(c),o=Ca(o,c,f),o!==null?o.sibling:null);ei(c);break;case 19:var w=(o.flags&128)!==0;if(g=(f&c.childLanes)!==0,g||(dc(o,c,f,!1),g=(f&c.childLanes)!==0),w){if(g)return pT(o,c,f);c.flags|=128}if(w=c.memoizedState,w!==null&&(w.rendering=null,w.tail=null,w.lastEffect=null),H(En,En.current),g)break;return null;case 22:case 23:return c.lanes=0,oT(o,c,f);case 24:Ya(c,In,o.memoizedState.cache)}return Ca(o,c,f)}function mT(o,c,f){if(o!==null)if(o.memoizedProps!==c.pendingProps)Ln=!0;else{if(!q0(o,f)&&(c.flags&128)===0)return Ln=!1,CL(o,c,f);Ln=(o.flags&131072)!==0}else Ln=!1,xe&&(c.flags&1048576)!==0&&HC(c,cf,c.index);switch(c.lanes=0,c.tag){case 16:t:{o=c.pendingProps;var g=c.elementType,w=g._init;if(g=w(g._payload),c.type=g,typeof g=="function")n0(g)?(o=co(g,o),c.tag=1,c=cT(null,c,g,o,f)):(c.tag=0,c=P0(null,c,g,o,f));else{if(g!=null){if(w=g.$$typeof,w===T){c.tag=11,c=rT(null,c,g,o,f);break t}else if(w===R){c.tag=14,c=aT(null,c,g,o,f);break t}}throw c=nt(g)||g,Error(s(306,c,""))}}return c;case 0:return P0(o,c,c.type,c.pendingProps,f);case 1:return g=c.type,w=co(g,c.pendingProps),cT(o,c,g,w,f);case 3:t:{if(xt(c,c.stateNode.containerInfo),o===null)throw Error(s(387));g=c.pendingProps;var N=c.memoizedState;w=N.element,g0(o,c),xc(c,g,null,f);var E=c.memoizedState;if(g=E.cache,Ya(c,In,g),g!==N.cache&&c0(c,[In],f,!0),bc(),g=E.element,N.isDehydrated)if(N={element:g,isDehydrated:!1,cache:E.cache},c.updateQueue.baseState=N,c.memoizedState=N,c.flags&256){c=hT(o,c,g,f);break t}else if(g!==w){w=rr(Error(s(424)),c),hc(w),c=hT(o,c,g,f);break t}else{switch(o=c.stateNode.containerInfo,o.nodeType){case 9:o=o.body;break;default:o=o.nodeName==="HTML"?o.ownerDocument.body:o}for(sn=Dr(o.firstChild),fs=c,xe=!0,ro=null,Hr=!0,f=qN(c,null,g,f),c.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling}else{if(cc(),g===w){c=Ca(o,c,f);break t}Kn(o,c,g,f)}c=c.child}return c;case 26:return Df(o,c),o===null?(f=x$(c.type,null,c.pendingProps,null))?c.memoizedState=f:xe||(f=c.type,o=c.pendingProps,g=Hf(lt.current).createElement(f),g[rs]=c,g[xs]=o,Zn(g,f,o),Fn(g),c.stateNode=g):c.memoizedState=x$(c.type,o.memoizedProps,c.pendingProps,o.memoizedState),null;case 27:return Dt(c),o===null&&xe&&(g=c.stateNode=g$(c.type,c.pendingProps,lt.current),fs=c,Hr=!0,w=sn,hi(c.type)?(kb=w,sn=Dr(g.firstChild)):sn=w),Kn(o,c,c.pendingProps.children,f),Df(o,c),o===null&&(c.flags|=4194304),c.child;case 5:return o===null&&xe&&((w=g=sn)&&(g=ZL(g,c.type,c.pendingProps,Hr),g!==null?(c.stateNode=g,fs=c,sn=Dr(g.firstChild),Hr=!1,w=!0):w=!1),w||ao(c)),Dt(c),w=c.type,N=c.pendingProps,E=o!==null?o.memoizedProps:null,g=N.children,Cb(w,N)?g=null:E!==null&&Cb(w,E)&&(c.flags|=32),c.memoizedState!==null&&(w=S0(o,c,mL,null,null,f),Vc._currentValue=w),Df(o,c),Kn(o,c,g,f),c.child;case 6:return o===null&&xe&&((o=f=sn)&&(f=QL(f,c.pendingProps,Hr),f!==null?(c.stateNode=f,fs=c,sn=null,o=!0):o=!1),o||ao(c)),null;case 13:return dT(o,c,f);case 4:return xt(c,c.stateNode.containerInfo),g=c.pendingProps,o===null?c.child=Dl(c,null,g,f):Kn(o,c,g,f),c.child;case 11:return rT(o,c,c.type,c.pendingProps,f);case 7:return Kn(o,c,c.pendingProps,f),c.child;case 8:return Kn(o,c,c.pendingProps.children,f),c.child;case 12:return Kn(o,c,c.pendingProps.children,f),c.child;case 10:return g=c.pendingProps,Ya(c,c.type,g.value),Kn(o,c,g.children,f),c.child;case 9:return w=c.type._context,g=c.pendingProps.children,oo(c),w=as(w),g=g(w),c.flags|=1,Kn(o,c,g,f),c.child;case 14:return aT(o,c,c.type,c.pendingProps,f);case 15:return iT(o,c,c.type,c.pendingProps,f);case 19:return pT(o,c,f);case 31:return g=c.pendingProps,f=c.mode,g={mode:g.mode,children:g.children},o===null?(f=Af(g,f),f.ref=c.ref,c.child=f,f.return=c,c=f):(f=ga(o.child,g),f.ref=c.ref,c.child=f,f.return=c,c=f),c;case 22:return oT(o,c,f);case 24:return oo(c),g=as(In),o===null?(w=f0(),w===null&&(w=ze,N=h0(),w.pooledCache=N,N.refCount++,N!==null&&(w.pooledCacheLanes|=f),w=N),c.memoizedState={parent:g,cache:w},m0(c),Ya(c,In,w)):((o.lanes&f)!==0&&(g0(o,c),xc(c,null,null,f),bc()),w=o.memoizedState,N=c.memoizedState,w.parent!==g?(w={parent:g,cache:g},c.memoizedState=w,c.lanes===0&&(c.memoizedState=c.updateQueue.baseState=w),Ya(c,In,g)):(g=N.cache,Ya(c,In,g),g!==w.cache&&c0(c,[In],f,!0))),Kn(o,c,c.pendingProps.children,f),c.child;case 29:throw c.pendingProps}throw Error(s(156,c.tag))}function Na(o){o.flags|=4}function gT(o,c){if(c.type!=="stylesheet"||(c.state.loading&4)!==0)o.flags&=-16777217;else if(o.flags|=16777216,!N$(c)){if(c=lr.current,c!==null&&((ge&4194048)===ge?jr!==null:(ge&62914560)!==ge&&(ge&536870912)===0||c!==jr))throw gc=p0,JC;o.flags|=8192}}function Rf(o,c){c!==null&&(o.flags|=4),o.flags&16384&&(c=o.tag!==22?XS():536870912,o.lanes|=c,_l|=c)}function $c(o,c){if(!xe)switch(o.tailMode){case"hidden":c=o.tail;for(var f=null;c!==null;)c.alternate!==null&&(f=c),c=c.sibling;f===null?o.tail=null:f.sibling=null;break;case"collapsed":f=o.tail;for(var g=null;f!==null;)f.alternate!==null&&(g=f),f=f.sibling;g===null?c||o.tail===null?o.tail=null:o.tail.sibling=null:g.sibling=null}}function Ye(o){var c=o.alternate!==null&&o.alternate.child===o.child,f=0,g=0;if(c)for(var w=o.child;w!==null;)f|=w.lanes|w.childLanes,g|=w.subtreeFlags&65011712,g|=w.flags&65011712,w.return=o,w=w.sibling;else for(w=o.child;w!==null;)f|=w.lanes|w.childLanes,g|=w.subtreeFlags,g|=w.flags,w.return=o,w=w.sibling;return o.subtreeFlags|=g,o.childLanes=f,c}function NL(o,c,f){var g=c.pendingProps;switch(i0(c),c.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ye(c),null;case 1:return Ye(c),null;case 3:return f=c.stateNode,g=null,o!==null&&(g=o.memoizedState.cache),c.memoizedState.cache!==g&&(c.flags|=2048),va(In),Ct(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(o===null||o.child===null)&&(uc(c)?Na(c):o===null||o.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,XC())),Ye(c),null;case 26:return f=c.memoizedState,o===null?(Na(c),f!==null?(Ye(c),gT(c,f)):(Ye(c),c.flags&=-16777217)):f?f!==o.memoizedState?(Na(c),Ye(c),gT(c,f)):(Ye(c),c.flags&=-16777217):(o.memoizedProps!==g&&Na(c),Ye(c),c.flags&=-16777217),null;case 27:It(c),f=lt.current;var w=c.type;if(o!==null&&c.stateNode!=null)o.memoizedProps!==g&&Na(c);else{if(!g){if(c.stateNode===null)throw Error(s(166));return Ye(c),null}o=Q.current,uc(c)?jC(c):(o=g$(w,g,f),c.stateNode=o,Na(c))}return Ye(c),null;case 5:if(It(c),f=c.type,o!==null&&c.stateNode!=null)o.memoizedProps!==g&&Na(c);else{if(!g){if(c.stateNode===null)throw Error(s(166));return Ye(c),null}if(o=Q.current,uc(c))jC(c);else{switch(w=Hf(lt.current),o){case 1:o=w.createElementNS("http://www.w3.org/2000/svg",f);break;case 2:o=w.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;default:switch(f){case"svg":o=w.createElementNS("http://www.w3.org/2000/svg",f);break;case"math":o=w.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;case"script":o=w.createElement("div"),o.innerHTML="<script><\/script>",o=o.removeChild(o.firstChild);break;case"select":o=typeof g.is=="string"?w.createElement("select",{is:g.is}):w.createElement("select"),g.multiple?o.multiple=!0:g.size&&(o.size=g.size);break;default:o=typeof g.is=="string"?w.createElement(f,{is:g.is}):w.createElement(f)}}o[rs]=c,o[xs]=g;t:for(w=c.child;w!==null;){if(w.tag===5||w.tag===6)o.appendChild(w.stateNode);else if(w.tag!==4&&w.tag!==27&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===c)break t;for(;w.sibling===null;){if(w.return===null||w.return===c)break t;w=w.return}w.sibling.return=w.return,w=w.sibling}c.stateNode=o;t:switch(Zn(o,f,g),f){case"button":case"input":case"select":case"textarea":o=!!g.autoFocus;break t;case"img":o=!0;break t;default:o=!1}o&&Na(c)}}return Ye(c),c.flags&=-16777217,null;case 6:if(o&&c.stateNode!=null)o.memoizedProps!==g&&Na(c);else{if(typeof g!="string"&&c.stateNode===null)throw Error(s(166));if(o=lt.current,uc(c)){if(o=c.stateNode,f=c.memoizedProps,g=null,w=fs,w!==null)switch(w.tag){case 27:case 5:g=w.memoizedProps}o[rs]=c,o=!!(o.nodeValue===f||g!==null&&g.suppressHydrationWarning===!0||u$(o.nodeValue,f)),o||ao(c)}else o=Hf(o).createTextNode(g),o[rs]=c,c.stateNode=o}return Ye(c),null;case 13:if(g=c.memoizedState,o===null||o.memoizedState!==null&&o.memoizedState.dehydrated!==null){if(w=uc(c),g!==null&&g.dehydrated!==null){if(o===null){if(!w)throw Error(s(318));if(w=c.memoizedState,w=w!==null?w.dehydrated:null,!w)throw Error(s(317));w[rs]=c}else cc(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;Ye(c),w=!1}else w=XC(),o!==null&&o.memoizedState!==null&&(o.memoizedState.hydrationErrors=w),w=!0;if(!w)return c.flags&256?(Sa(c),c):(Sa(c),null)}if(Sa(c),(c.flags&128)!==0)return c.lanes=f,c;if(f=g!==null,o=o!==null&&o.memoizedState!==null,f){g=c.child,w=null,g.alternate!==null&&g.alternate.memoizedState!==null&&g.alternate.memoizedState.cachePool!==null&&(w=g.alternate.memoizedState.cachePool.pool);var N=null;g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(N=g.memoizedState.cachePool.pool),N!==w&&(g.flags|=2048)}return f!==o&&f&&(c.child.flags|=8192),Rf(c,c.updateQueue),Ye(c),null;case 4:return Ct(),o===null&&bb(c.stateNode.containerInfo),Ye(c),null;case 10:return va(c.type),Ye(c),null;case 19:if(P(En),w=c.memoizedState,w===null)return Ye(c),null;if(g=(c.flags&128)!==0,N=w.rendering,N===null)if(g)$c(w,!1);else{if(rn!==0||o!==null&&(o.flags&128)!==0)for(o=c.child;o!==null;){if(N=kf(o),N!==null){for(c.flags|=128,$c(w,!1),o=N.updateQueue,c.updateQueue=o,Rf(c,o),c.subtreeFlags=0,o=f,f=c.child;f!==null;)WC(f,o),f=f.sibling;return H(En,En.current&1|2),c.child}o=o.sibling}w.tail!==null&&jt()>Ff&&(c.flags|=128,g=!0,$c(w,!1),c.lanes=4194304)}else{if(!g)if(o=kf(N),o!==null){if(c.flags|=128,g=!0,o=o.updateQueue,c.updateQueue=o,Rf(c,o),$c(w,!0),w.tail===null&&w.tailMode==="hidden"&&!N.alternate&&!xe)return Ye(c),null}else 2*jt()-w.renderingStartTime>Ff&&f!==536870912&&(c.flags|=128,g=!0,$c(w,!1),c.lanes=4194304);w.isBackwards?(N.sibling=c.child,c.child=N):(o=w.last,o!==null?o.sibling=N:c.child=N,w.last=N)}return w.tail!==null?(c=w.tail,w.rendering=c,w.tail=c.sibling,w.renderingStartTime=jt(),c.sibling=null,o=En.current,H(En,g?o&1|2:o&1),c):(Ye(c),null);case 22:case 23:return Sa(c),v0(),g=c.memoizedState!==null,o!==null?o.memoizedState!==null!==g&&(c.flags|=8192):g&&(c.flags|=8192),g?(f&536870912)!==0&&(c.flags&128)===0&&(Ye(c),c.subtreeFlags&6&&(c.flags|=8192)):Ye(c),f=c.updateQueue,f!==null&&Rf(c,f.retryQueue),f=null,o!==null&&o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(f=o.memoizedState.cachePool.pool),g=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(g=c.memoizedState.cachePool.pool),g!==f&&(c.flags|=2048),o!==null&&P(lo),null;case 24:return f=null,o!==null&&(f=o.memoizedState.cache),c.memoizedState.cache!==f&&(c.flags|=2048),va(In),Ye(c),null;case 25:return null;case 30:return null}throw Error(s(156,c.tag))}function TL(o,c){switch(i0(c),c.tag){case 1:return o=c.flags,o&65536?(c.flags=o&-65537|128,c):null;case 3:return va(In),Ct(),o=c.flags,(o&65536)!==0&&(o&128)===0?(c.flags=o&-65537|128,c):null;case 26:case 27:case 5:return It(c),null;case 13:if(Sa(c),o=c.memoizedState,o!==null&&o.dehydrated!==null){if(c.alternate===null)throw Error(s(340));cc()}return o=c.flags,o&65536?(c.flags=o&-65537|128,c):null;case 19:return P(En),null;case 4:return Ct(),null;case 10:return va(c.type),null;case 22:case 23:return Sa(c),v0(),o!==null&&P(lo),o=c.flags,o&65536?(c.flags=o&-65537|128,c):null;case 24:return va(In),null;case 25:return null;default:return null}}function yT(o,c){switch(i0(c),c.tag){case 3:va(In),Ct();break;case 26:case 27:case 5:It(c);break;case 4:Ct();break;case 13:Sa(c);break;case 19:P(En);break;case 10:va(c.type);break;case 22:case 23:Sa(c),v0(),o!==null&&P(lo);break;case 24:va(In)}}function kc(o,c){try{var f=c.updateQueue,g=f!==null?f.lastEffect:null;if(g!==null){var w=g.next;f=w;do{if((f.tag&o)===o){g=void 0;var N=f.create,E=f.inst;g=N(),E.destroy=g}f=f.next}while(f!==w)}}catch(z){_e(c,c.return,z)}}function si(o,c,f){try{var g=c.updateQueue,w=g!==null?g.lastEffect:null;if(w!==null){var N=w.next;g=N;do{if((g.tag&o)===o){var E=g.inst,z=E.destroy;if(z!==void 0){E.destroy=void 0,w=c;var j=f,dt=z;try{dt()}catch(bt){_e(w,j,bt)}}}g=g.next}while(g!==N)}}catch(bt){_e(c,c.return,bt)}}function bT(o){var c=o.updateQueue;if(c!==null){var f=o.stateNode;try{aN(c,f)}catch(g){_e(o,o.return,g)}}}function xT(o,c,f){f.props=co(o.type,o.memoizedProps),f.state=o.memoizedState;try{f.componentWillUnmount()}catch(g){_e(o,c,g)}}function Ic(o,c){try{var f=o.ref;if(f!==null){switch(o.tag){case 26:case 27:case 5:var g=o.stateNode;break;case 30:g=o.stateNode;break;default:g=o.stateNode}typeof f=="function"?o.refCleanup=f(g):f.current=g}}catch(w){_e(o,c,w)}}function qr(o,c){var f=o.ref,g=o.refCleanup;if(f!==null)if(typeof g=="function")try{g()}catch(w){_e(o,c,w)}finally{o.refCleanup=null,o=o.alternate,o!=null&&(o.refCleanup=null)}else if(typeof f=="function")try{f(null)}catch(w){_e(o,c,w)}else f.current=null}function vT(o){var c=o.type,f=o.memoizedProps,g=o.stateNode;try{t:switch(c){case"button":case"input":case"select":case"textarea":f.autoFocus&&g.focus();break t;case"img":f.src?g.src=f.src:f.srcSet&&(g.srcset=f.srcSet)}}catch(w){_e(o,o.return,w)}}function X0(o,c,f){try{var g=o.stateNode;jL(g,o.type,f,c),g[xs]=c}catch(w){_e(o,o.return,w)}}function wT(o){return o.tag===5||o.tag===3||o.tag===26||o.tag===27&&hi(o.type)||o.tag===4}function K0(o){t:for(;;){for(;o.sibling===null;){if(o.return===null||wT(o.return))return null;o=o.return}for(o.sibling.return=o.return,o=o.sibling;o.tag!==5&&o.tag!==6&&o.tag!==18;){if(o.tag===27&&hi(o.type)||o.flags&2||o.child===null||o.tag===4)continue t;o.child.return=o,o=o.child}if(!(o.flags&2))return o.stateNode}}function Y0(o,c,f){var g=o.tag;if(g===5||g===6)o=o.stateNode,c?(f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f).insertBefore(o,c):(c=f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f,c.appendChild(o),f=f._reactRootContainer,f!=null||c.onclick!==null||(c.onclick=Wf));else if(g!==4&&(g===27&&hi(o.type)&&(f=o.stateNode,c=null),o=o.child,o!==null))for(Y0(o,c,f),o=o.sibling;o!==null;)Y0(o,c,f),o=o.sibling}function Of(o,c,f){var g=o.tag;if(g===5||g===6)o=o.stateNode,c?f.insertBefore(o,c):f.appendChild(o);else if(g!==4&&(g===27&&hi(o.type)&&(f=o.stateNode),o=o.child,o!==null))for(Of(o,c,f),o=o.sibling;o!==null;)Of(o,c,f),o=o.sibling}function ST(o){var c=o.stateNode,f=o.memoizedProps;try{for(var g=o.type,w=c.attributes;w.length;)c.removeAttributeNode(w[0]);Zn(c,g,f),c[rs]=o,c[xs]=f}catch(N){_e(o,o.return,N)}}var Ta=!1,fn=!1,Z0=!1,CT=typeof WeakSet=="function"?WeakSet:Set,zn=null;function $L(o,c){if(o=o.containerInfo,wb=Zf,o=_C(o),Ky(o)){if("selectionStart"in o)var f={start:o.selectionStart,end:o.selectionEnd};else t:{f=(f=o.ownerDocument)&&f.defaultView||window;var g=f.getSelection&&f.getSelection();if(g&&g.rangeCount!==0){f=g.anchorNode;var w=g.anchorOffset,N=g.focusNode;g=g.focusOffset;try{f.nodeType,N.nodeType}catch{f=null;break t}var E=0,z=-1,j=-1,dt=0,bt=0,wt=o,ft=null;e:for(;;){for(var pt;wt!==f||w!==0&&wt.nodeType!==3||(z=E+w),wt!==N||g!==0&&wt.nodeType!==3||(j=E+g),wt.nodeType===3&&(E+=wt.nodeValue.length),(pt=wt.firstChild)!==null;)ft=wt,wt=pt;for(;;){if(wt===o)break e;if(ft===f&&++dt===w&&(z=E),ft===N&&++bt===g&&(j=E),(pt=wt.nextSibling)!==null)break;wt=ft,ft=wt.parentNode}wt=pt}f=z===-1||j===-1?null:{start:z,end:j}}else f=null}f=f||{start:0,end:0}}else f=null;for(Sb={focusedElem:o,selectionRange:f},Zf=!1,zn=c;zn!==null;)if(c=zn,o=c.child,(c.subtreeFlags&1024)!==0&&o!==null)o.return=c,zn=o;else for(;zn!==null;){switch(c=zn,N=c.alternate,o=c.flags,c.tag){case 0:break;case 11:case 15:break;case 1:if((o&1024)!==0&&N!==null){o=void 0,f=c,w=N.memoizedProps,N=N.memoizedState,g=f.stateNode;try{var qt=co(f.type,w,f.elementType===f.type);o=g.getSnapshotBeforeUpdate(qt,N),g.__reactInternalSnapshotBeforeUpdate=o}catch(Ut){_e(f,f.return,Ut)}}break;case 3:if((o&1024)!==0){if(o=c.stateNode.containerInfo,f=o.nodeType,f===9)Tb(o);else if(f===1)switch(o.nodeName){case"HEAD":case"HTML":case"BODY":Tb(o);break;default:o.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((o&1024)!==0)throw Error(s(163))}if(o=c.sibling,o!==null){o.return=c.return,zn=o;break}zn=c.return}}function NT(o,c,f){var g=f.flags;switch(f.tag){case 0:case 11:case 15:ri(o,f),g&4&&kc(5,f);break;case 1:if(ri(o,f),g&4)if(o=f.stateNode,c===null)try{o.componentDidMount()}catch(E){_e(f,f.return,E)}else{var w=co(f.type,c.memoizedProps);c=c.memoizedState;try{o.componentDidUpdate(w,c,o.__reactInternalSnapshotBeforeUpdate)}catch(E){_e(f,f.return,E)}}g&64&&bT(f),g&512&&Ic(f,f.return);break;case 3:if(ri(o,f),g&64&&(o=f.updateQueue,o!==null)){if(c=null,f.child!==null)switch(f.child.tag){case 27:case 5:c=f.child.stateNode;break;case 1:c=f.child.stateNode}try{aN(o,c)}catch(E){_e(f,f.return,E)}}break;case 27:c===null&&g&4&&ST(f);case 26:case 5:ri(o,f),c===null&&g&4&&vT(f),g&512&&Ic(f,f.return);break;case 12:ri(o,f);break;case 13:ri(o,f),g&4&&kT(o,f),g&64&&(o=f.memoizedState,o!==null&&(o=o.dehydrated,o!==null&&(f=FL.bind(null,f),JL(o,f))));break;case 22:if(g=f.memoizedState!==null||Ta,!g){c=c!==null&&c.memoizedState!==null||fn,w=Ta;var N=fn;Ta=g,(fn=c)&&!N?ai(o,f,(f.subtreeFlags&8772)!==0):ri(o,f),Ta=w,fn=N}break;case 30:break;default:ri(o,f)}}function TT(o){var c=o.alternate;c!==null&&(o.alternate=null,TT(c)),o.child=null,o.deletions=null,o.sibling=null,o.tag===5&&(c=o.stateNode,c!==null&&Dy(c)),o.stateNode=null,o.return=null,o.dependencies=null,o.memoizedProps=null,o.memoizedState=null,o.pendingProps=null,o.stateNode=null,o.updateQueue=null}var We=null,Ss=!1;function $a(o,c,f){for(f=f.child;f!==null;)$T(o,c,f),f=f.sibling}function $T(o,c,f){if(Oe&&typeof Oe.onCommitFiberUnmount=="function")try{Oe.onCommitFiberUnmount(Ke,f)}catch{}switch(f.tag){case 26:fn||qr(f,c),$a(o,c,f),f.memoizedState?f.memoizedState.count--:f.stateNode&&(f=f.stateNode,f.parentNode.removeChild(f));break;case 27:fn||qr(f,c);var g=We,w=Ss;hi(f.type)&&(We=f.stateNode,Ss=!1),$a(o,c,f),zc(f.stateNode),We=g,Ss=w;break;case 5:fn||qr(f,c);case 6:if(g=We,w=Ss,We=null,$a(o,c,f),We=g,Ss=w,We!==null)if(Ss)try{(We.nodeType===9?We.body:We.nodeName==="HTML"?We.ownerDocument.body:We).removeChild(f.stateNode)}catch(N){_e(f,c,N)}else try{We.removeChild(f.stateNode)}catch(N){_e(f,c,N)}break;case 18:We!==null&&(Ss?(o=We,p$(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,f.stateNode),Hc(o)):p$(We,f.stateNode));break;case 4:g=We,w=Ss,We=f.stateNode.containerInfo,Ss=!0,$a(o,c,f),We=g,Ss=w;break;case 0:case 11:case 14:case 15:fn||si(2,f,c),fn||si(4,f,c),$a(o,c,f);break;case 1:fn||(qr(f,c),g=f.stateNode,typeof g.componentWillUnmount=="function"&&xT(f,c,g)),$a(o,c,f);break;case 21:$a(o,c,f);break;case 22:fn=(g=fn)||f.memoizedState!==null,$a(o,c,f),fn=g;break;default:$a(o,c,f)}}function kT(o,c){if(c.memoizedState===null&&(o=c.alternate,o!==null&&(o=o.memoizedState,o!==null&&(o=o.dehydrated,o!==null))))try{Hc(o)}catch(f){_e(c,c.return,f)}}function kL(o){switch(o.tag){case 13:case 19:var c=o.stateNode;return c===null&&(c=o.stateNode=new CT),c;case 22:return o=o.stateNode,c=o._retryCache,c===null&&(c=o._retryCache=new CT),c;default:throw Error(s(435,o.tag))}}function Q0(o,c){var f=kL(o);c.forEach(function(g){var w=LL.bind(null,o,g);f.has(g)||(f.add(g),g.then(w,w))})}function Ws(o,c){var f=c.deletions;if(f!==null)for(var g=0;g<f.length;g++){var w=f[g],N=o,E=c,z=E;t:for(;z!==null;){switch(z.tag){case 27:if(hi(z.type)){We=z.stateNode,Ss=!1;break t}break;case 5:We=z.stateNode,Ss=!1;break t;case 3:case 4:We=z.stateNode.containerInfo,Ss=!0;break t}z=z.return}if(We===null)throw Error(s(160));$T(N,E,w),We=null,Ss=!1,N=w.alternate,N!==null&&(N.return=null),w.return=null}if(c.subtreeFlags&13878)for(c=c.child;c!==null;)IT(c,o),c=c.sibling}var Er=null;function IT(o,c){var f=o.alternate,g=o.flags;switch(o.tag){case 0:case 11:case 14:case 15:Ws(c,o),Hs(o),g&4&&(si(3,o,o.return),kc(3,o),si(5,o,o.return));break;case 1:Ws(c,o),Hs(o),g&512&&(fn||f===null||qr(f,f.return)),g&64&&Ta&&(o=o.updateQueue,o!==null&&(g=o.callbacks,g!==null&&(f=o.shared.hiddenCallbacks,o.shared.hiddenCallbacks=f===null?g:f.concat(g))));break;case 26:var w=Er;if(Ws(c,o),Hs(o),g&512&&(fn||f===null||qr(f,f.return)),g&4){var N=f!==null?f.memoizedState:null;if(g=o.memoizedState,f===null)if(g===null)if(o.stateNode===null){t:{g=o.type,f=o.memoizedProps,w=w.ownerDocument||w;e:switch(g){case"title":N=w.getElementsByTagName("title")[0],(!N||N[Qu]||N[rs]||N.namespaceURI==="http://www.w3.org/2000/svg"||N.hasAttribute("itemprop"))&&(N=w.createElement(g),w.head.insertBefore(N,w.querySelector("head > title"))),Zn(N,g,f),N[rs]=o,Fn(N),g=N;break t;case"link":var E=S$("link","href",w).get(g+(f.href||""));if(E){for(var z=0;z<E.length;z++)if(N=E[z],N.getAttribute("href")===(f.href==null||f.href===""?null:f.href)&&N.getAttribute("rel")===(f.rel==null?null:f.rel)&&N.getAttribute("title")===(f.title==null?null:f.title)&&N.getAttribute("crossorigin")===(f.crossOrigin==null?null:f.crossOrigin)){E.splice(z,1);break e}}N=w.createElement(g),Zn(N,g,f),w.head.appendChild(N);break;case"meta":if(E=S$("meta","content",w).get(g+(f.content||""))){for(z=0;z<E.length;z++)if(N=E[z],N.getAttribute("content")===(f.content==null?null:""+f.content)&&N.getAttribute("name")===(f.name==null?null:f.name)&&N.getAttribute("property")===(f.property==null?null:f.property)&&N.getAttribute("http-equiv")===(f.httpEquiv==null?null:f.httpEquiv)&&N.getAttribute("charset")===(f.charSet==null?null:f.charSet)){E.splice(z,1);break e}}N=w.createElement(g),Zn(N,g,f),w.head.appendChild(N);break;default:throw Error(s(468,g))}N[rs]=o,Fn(N),g=N}o.stateNode=g}else C$(w,o.type,o.stateNode);else o.stateNode=w$(w,g,o.memoizedProps);else N!==g?(N===null?f.stateNode!==null&&(f=f.stateNode,f.parentNode.removeChild(f)):N.count--,g===null?C$(w,o.type,o.stateNode):w$(w,g,o.memoizedProps)):g===null&&o.stateNode!==null&&X0(o,o.memoizedProps,f.memoizedProps)}break;case 27:Ws(c,o),Hs(o),g&512&&(fn||f===null||qr(f,f.return)),f!==null&&g&4&&X0(o,o.memoizedProps,f.memoizedProps);break;case 5:if(Ws(c,o),Hs(o),g&512&&(fn||f===null||qr(f,f.return)),o.flags&32){w=o.stateNode;try{dl(w,"")}catch(pt){_e(o,o.return,pt)}}g&4&&o.stateNode!=null&&(w=o.memoizedProps,X0(o,w,f!==null?f.memoizedProps:w)),g&1024&&(Z0=!0);break;case 6:if(Ws(c,o),Hs(o),g&4){if(o.stateNode===null)throw Error(s(162));g=o.memoizedProps,f=o.stateNode;try{f.nodeValue=g}catch(pt){_e(o,o.return,pt)}}break;case 3:if(Xf=null,w=Er,Er=jf(c.containerInfo),Ws(c,o),Er=w,Hs(o),g&4&&f!==null&&f.memoizedState.isDehydrated)try{Hc(c.containerInfo)}catch(pt){_e(o,o.return,pt)}Z0&&(Z0=!1,ET(o));break;case 4:g=Er,Er=jf(o.stateNode.containerInfo),Ws(c,o),Hs(o),Er=g;break;case 12:Ws(c,o),Hs(o);break;case 13:Ws(c,o),Hs(o),o.child.flags&8192&&o.memoizedState!==null!=(f!==null&&f.memoizedState!==null)&&(rb=jt()),g&4&&(g=o.updateQueue,g!==null&&(o.updateQueue=null,Q0(o,g)));break;case 22:w=o.memoizedState!==null;var j=f!==null&&f.memoizedState!==null,dt=Ta,bt=fn;if(Ta=dt||w,fn=bt||j,Ws(c,o),fn=bt,Ta=dt,Hs(o),g&8192)t:for(c=o.stateNode,c._visibility=w?c._visibility&-2:c._visibility|1,w&&(f===null||j||Ta||fn||ho(o)),f=null,c=o;;){if(c.tag===5||c.tag===26){if(f===null){j=f=c;try{if(N=j.stateNode,w)E=N.style,typeof E.setProperty=="function"?E.setProperty("display","none","important"):E.display="none";else{z=j.stateNode;var wt=j.memoizedProps.style,ft=wt!=null&&wt.hasOwnProperty("display")?wt.display:null;z.style.display=ft==null||typeof ft=="boolean"?"":(""+ft).trim()}}catch(pt){_e(j,j.return,pt)}}}else if(c.tag===6){if(f===null){j=c;try{j.stateNode.nodeValue=w?"":j.memoizedProps}catch(pt){_e(j,j.return,pt)}}}else if((c.tag!==22&&c.tag!==23||c.memoizedState===null||c===o)&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===o)break t;for(;c.sibling===null;){if(c.return===null||c.return===o)break t;f===c&&(f=null),c=c.return}f===c&&(f=null),c.sibling.return=c.return,c=c.sibling}g&4&&(g=o.updateQueue,g!==null&&(f=g.retryQueue,f!==null&&(g.retryQueue=null,Q0(o,f))));break;case 19:Ws(c,o),Hs(o),g&4&&(g=o.updateQueue,g!==null&&(o.updateQueue=null,Q0(o,g)));break;case 30:break;case 21:break;default:Ws(c,o),Hs(o)}}function Hs(o){var c=o.flags;if(c&2){try{for(var f,g=o.return;g!==null;){if(wT(g)){f=g;break}g=g.return}if(f==null)throw Error(s(160));switch(f.tag){case 27:var w=f.stateNode,N=K0(o);Of(o,N,w);break;case 5:var E=f.stateNode;f.flags&32&&(dl(E,""),f.flags&=-33);var z=K0(o);Of(o,z,E);break;case 3:case 4:var j=f.stateNode.containerInfo,dt=K0(o);Y0(o,dt,j);break;default:throw Error(s(161))}}catch(bt){_e(o,o.return,bt)}o.flags&=-3}c&4096&&(o.flags&=-4097)}function ET(o){if(o.subtreeFlags&1024)for(o=o.child;o!==null;){var c=o;ET(c),c.tag===5&&c.flags&1024&&c.stateNode.reset(),o=o.sibling}}function ri(o,c){if(c.subtreeFlags&8772)for(c=c.child;c!==null;)NT(o,c.alternate,c),c=c.sibling}function ho(o){for(o=o.child;o!==null;){var c=o;switch(c.tag){case 0:case 11:case 14:case 15:si(4,c,c.return),ho(c);break;case 1:qr(c,c.return);var f=c.stateNode;typeof f.componentWillUnmount=="function"&&xT(c,c.return,f),ho(c);break;case 27:zc(c.stateNode);case 26:case 5:qr(c,c.return),ho(c);break;case 22:c.memoizedState===null&&ho(c);break;case 30:ho(c);break;default:ho(c)}o=o.sibling}}function ai(o,c,f){for(f=f&&(c.subtreeFlags&8772)!==0,c=c.child;c!==null;){var g=c.alternate,w=o,N=c,E=N.flags;switch(N.tag){case 0:case 11:case 15:ai(w,N,f),kc(4,N);break;case 1:if(ai(w,N,f),g=N,w=g.stateNode,typeof w.componentDidMount=="function")try{w.componentDidMount()}catch(dt){_e(g,g.return,dt)}if(g=N,w=g.updateQueue,w!==null){var z=g.stateNode;try{var j=w.shared.hiddenCallbacks;if(j!==null)for(w.shared.hiddenCallbacks=null,w=0;w<j.length;w++)rN(j[w],z)}catch(dt){_e(g,g.return,dt)}}f&&E&64&&bT(N),Ic(N,N.return);break;case 27:ST(N);case 26:case 5:ai(w,N,f),f&&g===null&&E&4&&vT(N),Ic(N,N.return);break;case 12:ai(w,N,f);break;case 13:ai(w,N,f),f&&E&4&&kT(w,N);break;case 22:N.memoizedState===null&&ai(w,N,f),Ic(N,N.return);break;case 30:break;default:ai(w,N,f)}c=c.sibling}}function J0(o,c){var f=null;o!==null&&o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(f=o.memoizedState.cachePool.pool),o=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(o=c.memoizedState.cachePool.pool),o!==f&&(o!=null&&o.refCount++,f!=null&&fc(f))}function tb(o,c){o=null,c.alternate!==null&&(o=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==o&&(c.refCount++,o!=null&&fc(o))}function Xr(o,c,f,g){if(c.subtreeFlags&10256)for(c=c.child;c!==null;)DT(o,c,f,g),c=c.sibling}function DT(o,c,f,g){var w=c.flags;switch(c.tag){case 0:case 11:case 15:Xr(o,c,f,g),w&2048&&kc(9,c);break;case 1:Xr(o,c,f,g);break;case 3:Xr(o,c,f,g),w&2048&&(o=null,c.alternate!==null&&(o=c.alternate.memoizedState.cache),c=c.memoizedState.cache,c!==o&&(c.refCount++,o!=null&&fc(o)));break;case 12:if(w&2048){Xr(o,c,f,g),o=c.stateNode;try{var N=c.memoizedProps,E=N.id,z=N.onPostCommit;typeof z=="function"&&z(E,c.alternate===null?"mount":"update",o.passiveEffectDuration,-0)}catch(j){_e(c,c.return,j)}}else Xr(o,c,f,g);break;case 13:Xr(o,c,f,g);break;case 23:break;case 22:N=c.stateNode,E=c.alternate,c.memoizedState!==null?N._visibility&2?Xr(o,c,f,g):Ec(o,c):N._visibility&2?Xr(o,c,f,g):(N._visibility|=2,Al(o,c,f,g,(c.subtreeFlags&10256)!==0)),w&2048&&J0(E,c);break;case 24:Xr(o,c,f,g),w&2048&&tb(c.alternate,c);break;default:Xr(o,c,f,g)}}function Al(o,c,f,g,w){for(w=w&&(c.subtreeFlags&10256)!==0,c=c.child;c!==null;){var N=o,E=c,z=f,j=g,dt=E.flags;switch(E.tag){case 0:case 11:case 15:Al(N,E,z,j,w),kc(8,E);break;case 23:break;case 22:var bt=E.stateNode;E.memoizedState!==null?bt._visibility&2?Al(N,E,z,j,w):Ec(N,E):(bt._visibility|=2,Al(N,E,z,j,w)),w&&dt&2048&&J0(E.alternate,E);break;case 24:Al(N,E,z,j,w),w&&dt&2048&&tb(E.alternate,E);break;default:Al(N,E,z,j,w)}c=c.sibling}}function Ec(o,c){if(c.subtreeFlags&10256)for(c=c.child;c!==null;){var f=o,g=c,w=g.flags;switch(g.tag){case 22:Ec(f,g),w&2048&&J0(g.alternate,g);break;case 24:Ec(f,g),w&2048&&tb(g.alternate,g);break;default:Ec(f,g)}c=c.sibling}}var Dc=8192;function Rl(o){if(o.subtreeFlags&Dc)for(o=o.child;o!==null;)AT(o),o=o.sibling}function AT(o){switch(o.tag){case 26:Rl(o),o.flags&Dc&&o.memoizedState!==null&&dz(Er,o.memoizedState,o.memoizedProps);break;case 5:Rl(o);break;case 3:case 4:var c=Er;Er=jf(o.stateNode.containerInfo),Rl(o),Er=c;break;case 22:o.memoizedState===null&&(c=o.alternate,c!==null&&c.memoizedState!==null?(c=Dc,Dc=16777216,Rl(o),Dc=c):Rl(o));break;default:Rl(o)}}function RT(o){var c=o.alternate;if(c!==null&&(o=c.child,o!==null)){c.child=null;do c=o.sibling,o.sibling=null,o=c;while(o!==null)}}function Ac(o){var c=o.deletions;if((o.flags&16)!==0){if(c!==null)for(var f=0;f<c.length;f++){var g=c[f];zn=g,_T(g,o)}RT(o)}if(o.subtreeFlags&10256)for(o=o.child;o!==null;)OT(o),o=o.sibling}function OT(o){switch(o.tag){case 0:case 11:case 15:Ac(o),o.flags&2048&&si(9,o,o.return);break;case 3:Ac(o);break;case 12:Ac(o);break;case 22:var c=o.stateNode;o.memoizedState!==null&&c._visibility&2&&(o.return===null||o.return.tag!==13)?(c._visibility&=-3,_f(o)):Ac(o);break;default:Ac(o)}}function _f(o){var c=o.deletions;if((o.flags&16)!==0){if(c!==null)for(var f=0;f<c.length;f++){var g=c[f];zn=g,_T(g,o)}RT(o)}for(o=o.child;o!==null;){switch(c=o,c.tag){case 0:case 11:case 15:si(8,c,c.return),_f(c);break;case 22:f=c.stateNode,f._visibility&2&&(f._visibility&=-3,_f(c));break;default:_f(c)}o=o.sibling}}function _T(o,c){for(;zn!==null;){var f=zn;switch(f.tag){case 0:case 11:case 15:si(8,f,c);break;case 23:case 22:if(f.memoizedState!==null&&f.memoizedState.cachePool!==null){var g=f.memoizedState.cachePool.pool;g!=null&&g.refCount++}break;case 24:fc(f.memoizedState.cache)}if(g=f.child,g!==null)g.return=f,zn=g;else t:for(f=o;zn!==null;){g=zn;var w=g.sibling,N=g.return;if(TT(g),g===f){zn=null;break t}if(w!==null){w.return=N,zn=w;break t}zn=N}}}var IL={getCacheForType:function(o){var c=as(In),f=c.data.get(o);return f===void 0&&(f=o(),c.data.set(o,f)),f}},EL=typeof WeakMap=="function"?WeakMap:Map,Ne=0,ze=null,ce=null,ge=0,Te=0,js=null,ii=!1,Ol=!1,eb=!1,ka=0,rn=0,oi=0,fo=0,nb=0,ur=0,_l=0,Rc=null,Cs=null,sb=!1,rb=0,Ff=1/0,Lf=null,li=null,Yn=0,ui=null,Fl=null,Ll=0,ab=0,ib=null,FT=null,Oc=0,ob=null;function qs(){if((Ne&2)!==0&&ge!==0)return ge&-ge;if(U.T!==null){var o=Cl;return o!==0?o:pb()}return ZS()}function LT(){ur===0&&(ur=(ge&536870912)===0||xe?qS():536870912);var o=lr.current;return o!==null&&(o.flags|=32),ur}function Xs(o,c,f){(o===ze&&(Te===2||Te===9)||o.cancelPendingCommit!==null)&&(zl(o,0),ci(o,ge,ur,!1)),Zu(o,f),((Ne&2)===0||o!==ze)&&(o===ze&&((Ne&2)===0&&(fo|=f),rn===4&&ci(o,ge,ur,!1)),Kr(o))}function zT(o,c,f){if((Ne&6)!==0)throw Error(s(327));var g=!f&&(c&124)===0&&(c&o.expiredLanes)===0||Yu(o,c),w=g?RL(o,c):cb(o,c,!0),N=g;do{if(w===0){Ol&&!g&&ci(o,c,0,!1);break}else{if(f=o.current.alternate,N&&!DL(f)){w=cb(o,c,!1),N=!1;continue}if(w===2){if(N=c,o.errorRecoveryDisabledLanes&N)var E=0;else E=o.pendingLanes&-536870913,E=E!==0?E:E&536870912?536870912:0;if(E!==0){c=E;t:{var z=o;w=Rc;var j=z.current.memoizedState.isDehydrated;if(j&&(zl(z,E).flags|=256),E=cb(z,E,!1),E!==2){if(eb&&!j){z.errorRecoveryDisabledLanes|=N,fo|=N,w=4;break t}N=Cs,Cs=w,N!==null&&(Cs===null?Cs=N:Cs.push.apply(Cs,N))}w=E}if(N=!1,w!==2)continue}}if(w===1){zl(o,0),ci(o,c,0,!0);break}t:{switch(g=o,N=w,N){case 0:case 1:throw Error(s(345));case 4:if((c&4194048)!==c)break;case 6:ci(g,c,ur,!ii);break t;case 2:Cs=null;break;case 3:case 5:break;default:throw Error(s(329))}if((c&62914560)===c&&(w=rb+300-jt(),10<w)){if(ci(g,c,ur,!ii),jd(g,0,!0)!==0)break t;g.timeoutHandle=d$(MT.bind(null,g,f,Cs,Lf,sb,c,ur,fo,_l,ii,N,2,-0,0),w);break t}MT(g,f,Cs,Lf,sb,c,ur,fo,_l,ii,N,0,-0,0)}}break}while(!0);Kr(o)}function MT(o,c,f,g,w,N,E,z,j,dt,bt,wt,ft,pt){if(o.timeoutHandle=-1,wt=c.subtreeFlags,(wt&8192||(wt&16785408)===16785408)&&(Pc={stylesheets:null,count:0,unsuspend:hz},AT(c),wt=fz(),wt!==null)){o.cancelPendingCommit=wt(HT.bind(null,o,c,N,f,g,w,E,z,j,bt,1,ft,pt)),ci(o,N,E,!dt);return}HT(o,c,N,f,g,w,E,z,j)}function DL(o){for(var c=o;;){var f=c.tag;if((f===0||f===11||f===15)&&c.flags&16384&&(f=c.updateQueue,f!==null&&(f=f.stores,f!==null)))for(var g=0;g<f.length;g++){var w=f[g],N=w.getSnapshot;w=w.value;try{if(!Us(N(),w))return!1}catch{return!1}}if(f=c.child,c.subtreeFlags&16384&&f!==null)f.return=c,c=f;else{if(c===o)break;for(;c.sibling===null;){if(c.return===null||c.return===o)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function ci(o,c,f,g){c&=~nb,c&=~fo,o.suspendedLanes|=c,o.pingedLanes&=~c,g&&(o.warmLanes|=c),g=o.expirationTimes;for(var w=c;0<w;){var N=31-Pe(w),E=1<<N;g[N]=-1,w&=~E}f!==0&&KS(o,f,c)}function zf(){return(Ne&6)===0?(_c(0),!1):!0}function lb(){if(ce!==null){if(Te===0)var o=ce.return;else o=ce,xa=io=null,T0(o),El=null,Nc=0,o=ce;for(;o!==null;)yT(o.alternate,o),o=o.return;ce=null}}function zl(o,c){var f=o.timeoutHandle;f!==-1&&(o.timeoutHandle=-1,XL(f)),f=o.cancelPendingCommit,f!==null&&(o.cancelPendingCommit=null,f()),lb(),ze=o,ce=f=ga(o.current,null),ge=c,Te=0,js=null,ii=!1,Ol=Yu(o,c),eb=!1,_l=ur=nb=fo=oi=rn=0,Cs=Rc=null,sb=!1,(c&8)!==0&&(c|=c&32);var g=o.entangledLanes;if(g!==0)for(o=o.entanglements,g&=c;0<g;){var w=31-Pe(g),N=1<<w;c|=o[w],g&=~N}return ka=c,rf(),f}function BT(o,c){oe=null,U.H=Nf,c===mc||c===pf?(c=nN(),Te=3):c===JC?(c=nN(),Te=4):Te=c===sT?8:c!==null&&typeof c=="object"&&typeof c.then=="function"?6:1,js=c,ce===null&&(rn=1,Ef(o,rr(c,o.current)))}function PT(){var o=U.H;return U.H=Nf,o===null?Nf:o}function VT(){var o=U.A;return U.A=IL,o}function ub(){rn=4,ii||(ge&4194048)!==ge&&lr.current!==null||(Ol=!0),(oi&134217727)===0&&(fo&134217727)===0||ze===null||ci(ze,ge,ur,!1)}function cb(o,c,f){var g=Ne;Ne|=2;var w=PT(),N=VT();(ze!==o||ge!==c)&&(Lf=null,zl(o,c)),c=!1;var E=rn;t:do try{if(Te!==0&&ce!==null){var z=ce,j=js;switch(Te){case 8:lb(),E=6;break t;case 3:case 2:case 9:case 6:lr.current===null&&(c=!0);var dt=Te;if(Te=0,js=null,Ml(o,z,j,dt),f&&Ol){E=0;break t}break;default:dt=Te,Te=0,js=null,Ml(o,z,j,dt)}}AL(),E=rn;break}catch(bt){BT(o,bt)}while(!0);return c&&o.shellSuspendCounter++,xa=io=null,Ne=g,U.H=w,U.A=N,ce===null&&(ze=null,ge=0,rf()),E}function AL(){for(;ce!==null;)UT(ce)}function RL(o,c){var f=Ne;Ne|=2;var g=PT(),w=VT();ze!==o||ge!==c?(Lf=null,Ff=jt()+500,zl(o,c)):Ol=Yu(o,c);t:do try{if(Te!==0&&ce!==null){c=ce;var N=js;e:switch(Te){case 1:Te=0,js=null,Ml(o,c,N,1);break;case 2:case 9:if(tN(N)){Te=0,js=null,GT(c);break}c=function(){Te!==2&&Te!==9||ze!==o||(Te=7),Kr(o)},N.then(c,c);break t;case 3:Te=7;break t;case 4:Te=5;break t;case 7:tN(N)?(Te=0,js=null,GT(c)):(Te=0,js=null,Ml(o,c,N,7));break;case 5:var E=null;switch(ce.tag){case 26:E=ce.memoizedState;case 5:case 27:var z=ce;if(!E||N$(E)){Te=0,js=null;var j=z.sibling;if(j!==null)ce=j;else{var dt=z.return;dt!==null?(ce=dt,Mf(dt)):ce=null}break e}}Te=0,js=null,Ml(o,c,N,5);break;case 6:Te=0,js=null,Ml(o,c,N,6);break;case 8:lb(),rn=6;break t;default:throw Error(s(462))}}OL();break}catch(bt){BT(o,bt)}while(!0);return xa=io=null,U.H=g,U.A=w,Ne=f,ce!==null?0:(ze=null,ge=0,rf(),rn)}function OL(){for(;ce!==null&&!Zt();)UT(ce)}function UT(o){var c=mT(o.alternate,o,ka);o.memoizedProps=o.pendingProps,c===null?Mf(o):ce=c}function GT(o){var c=o,f=c.alternate;switch(c.tag){case 15:case 0:c=uT(f,c,c.pendingProps,c.type,void 0,ge);break;case 11:c=uT(f,c,c.pendingProps,c.type.render,c.ref,ge);break;case 5:T0(c);default:yT(f,c),c=ce=WC(c,ka),c=mT(f,c,ka)}o.memoizedProps=o.pendingProps,c===null?Mf(o):ce=c}function Ml(o,c,f,g){xa=io=null,T0(c),El=null,Nc=0;var w=c.return;try{if(SL(o,w,c,f,ge)){rn=1,Ef(o,rr(f,o.current)),ce=null;return}}catch(N){if(w!==null)throw ce=w,N;rn=1,Ef(o,rr(f,o.current)),ce=null;return}c.flags&32768?(xe||g===1?o=!0:Ol||(ge&536870912)!==0?o=!1:(ii=o=!0,(g===2||g===9||g===3||g===6)&&(g=lr.current,g!==null&&g.tag===13&&(g.flags|=16384))),WT(c,o)):Mf(c)}function Mf(o){var c=o;do{if((c.flags&32768)!==0){WT(c,ii);return}o=c.return;var f=NL(c.alternate,c,ka);if(f!==null){ce=f;return}if(c=c.sibling,c!==null){ce=c;return}ce=c=o}while(c!==null);rn===0&&(rn=5)}function WT(o,c){do{var f=TL(o.alternate,o);if(f!==null){f.flags&=32767,ce=f;return}if(f=o.return,f!==null&&(f.flags|=32768,f.subtreeFlags=0,f.deletions=null),!c&&(o=o.sibling,o!==null)){ce=o;return}ce=o=f}while(o!==null);rn=6,ce=null}function HT(o,c,f,g,w,N,E,z,j){o.cancelPendingCommit=null;do Bf();while(Yn!==0);if((Ne&6)!==0)throw Error(s(327));if(c!==null){if(c===o.current)throw Error(s(177));if(N=c.lanes|c.childLanes,N|=t0,h3(o,f,N,E,z,j),o===ze&&(ce=ze=null,ge=0),Fl=c,ui=o,Ll=f,ab=N,ib=w,FT=g,(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?(o.callbackNode=null,o.callbackPriority=0,zL(Xe,function(){return YT(),null})):(o.callbackNode=null,o.callbackPriority=0),g=(c.flags&13878)!==0,(c.subtreeFlags&13878)!==0||g){g=U.T,U.T=null,w=Y.p,Y.p=2,E=Ne,Ne|=4;try{$L(o,c,f)}finally{Ne=E,Y.p=w,U.T=g}}Yn=1,jT(),qT(),XT()}}function jT(){if(Yn===1){Yn=0;var o=ui,c=Fl,f=(c.flags&13878)!==0;if((c.subtreeFlags&13878)!==0||f){f=U.T,U.T=null;var g=Y.p;Y.p=2;var w=Ne;Ne|=4;try{IT(c,o);var N=Sb,E=_C(o.containerInfo),z=N.focusedElem,j=N.selectionRange;if(E!==z&&z&&z.ownerDocument&&OC(z.ownerDocument.documentElement,z)){if(j!==null&&Ky(z)){var dt=j.start,bt=j.end;if(bt===void 0&&(bt=dt),"selectionStart"in z)z.selectionStart=dt,z.selectionEnd=Math.min(bt,z.value.length);else{var wt=z.ownerDocument||document,ft=wt&&wt.defaultView||window;if(ft.getSelection){var pt=ft.getSelection(),qt=z.textContent.length,Ut=Math.min(j.start,qt),De=j.end===void 0?Ut:Math.min(j.end,qt);!pt.extend&&Ut>De&&(E=De,De=Ut,Ut=E);var it=RC(z,Ut),rt=RC(z,De);if(it&&rt&&(pt.rangeCount!==1||pt.anchorNode!==it.node||pt.anchorOffset!==it.offset||pt.focusNode!==rt.node||pt.focusOffset!==rt.offset)){var ct=wt.createRange();ct.setStart(it.node,it.offset),pt.removeAllRanges(),Ut>De?(pt.addRange(ct),pt.extend(rt.node,rt.offset)):(ct.setEnd(rt.node,rt.offset),pt.addRange(ct))}}}}for(wt=[],pt=z;pt=pt.parentNode;)pt.nodeType===1&&wt.push({element:pt,left:pt.scrollLeft,top:pt.scrollTop});for(typeof z.focus=="function"&&z.focus(),z=0;z<wt.length;z++){var vt=wt[z];vt.element.scrollLeft=vt.left,vt.element.scrollTop=vt.top}}Zf=!!wb,Sb=wb=null}finally{Ne=w,Y.p=g,U.T=f}}o.current=c,Yn=2}}function qT(){if(Yn===2){Yn=0;var o=ui,c=Fl,f=(c.flags&8772)!==0;if((c.subtreeFlags&8772)!==0||f){f=U.T,U.T=null;var g=Y.p;Y.p=2;var w=Ne;Ne|=4;try{NT(o,c.alternate,c)}finally{Ne=w,Y.p=g,U.T=f}}Yn=3}}function XT(){if(Yn===4||Yn===3){Yn=0,Ht();var o=ui,c=Fl,f=Ll,g=FT;(c.subtreeFlags&10256)!==0||(c.flags&10256)!==0?Yn=5:(Yn=0,Fl=ui=null,KT(o,o.pendingLanes));var w=o.pendingLanes;if(w===0&&(li=null),Iy(f),c=c.stateNode,Oe&&typeof Oe.onCommitFiberRoot=="function")try{Oe.onCommitFiberRoot(Ke,c,void 0,(c.current.flags&128)===128)}catch{}if(g!==null){c=U.T,w=Y.p,Y.p=2,U.T=null;try{for(var N=o.onRecoverableError,E=0;E<g.length;E++){var z=g[E];N(z.value,{componentStack:z.stack})}}finally{U.T=c,Y.p=w}}(Ll&3)!==0&&Bf(),Kr(o),w=o.pendingLanes,(f&4194090)!==0&&(w&42)!==0?o===ob?Oc++:(Oc=0,ob=o):Oc=0,_c(0)}}function KT(o,c){(o.pooledCacheLanes&=c)===0&&(c=o.pooledCache,c!=null&&(o.pooledCache=null,fc(c)))}function Bf(o){return jT(),qT(),XT(),YT()}function YT(){if(Yn!==5)return!1;var o=ui,c=ab;ab=0;var f=Iy(Ll),g=U.T,w=Y.p;try{Y.p=32>f?32:f,U.T=null,f=ib,ib=null;var N=ui,E=Ll;if(Yn=0,Fl=ui=null,Ll=0,(Ne&6)!==0)throw Error(s(331));var z=Ne;if(Ne|=4,OT(N.current),DT(N,N.current,E,f),Ne=z,_c(0,!1),Oe&&typeof Oe.onPostCommitFiberRoot=="function")try{Oe.onPostCommitFiberRoot(Ke,N)}catch{}return!0}finally{Y.p=w,U.T=g,KT(o,c)}}function ZT(o,c,f){c=rr(f,c),c=B0(o.stateNode,c,2),o=Ja(o,c,2),o!==null&&(Zu(o,2),Kr(o))}function _e(o,c,f){if(o.tag===3)ZT(o,o,f);else for(;c!==null;){if(c.tag===3){ZT(c,o,f);break}else if(c.tag===1){var g=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(li===null||!li.has(g))){o=rr(f,o),f=eT(2),g=Ja(c,f,2),g!==null&&(nT(f,g,c,o),Zu(g,2),Kr(g));break}}c=c.return}}function hb(o,c,f){var g=o.pingCache;if(g===null){g=o.pingCache=new EL;var w=new Set;g.set(c,w)}else w=g.get(c),w===void 0&&(w=new Set,g.set(c,w));w.has(f)||(eb=!0,w.add(f),o=_L.bind(null,o,c,f),c.then(o,o))}function _L(o,c,f){var g=o.pingCache;g!==null&&g.delete(c),o.pingedLanes|=o.suspendedLanes&f,o.warmLanes&=~f,ze===o&&(ge&f)===f&&(rn===4||rn===3&&(ge&62914560)===ge&&300>jt()-rb?(Ne&2)===0&&zl(o,0):nb|=f,_l===ge&&(_l=0)),Kr(o)}function QT(o,c){c===0&&(c=XS()),o=xl(o,c),o!==null&&(Zu(o,c),Kr(o))}function FL(o){var c=o.memoizedState,f=0;c!==null&&(f=c.retryLane),QT(o,f)}function LL(o,c){var f=0;switch(o.tag){case 13:var g=o.stateNode,w=o.memoizedState;w!==null&&(f=w.retryLane);break;case 19:g=o.stateNode;break;case 22:g=o.stateNode._retryCache;break;default:throw Error(s(314))}g!==null&&g.delete(c),QT(o,f)}function zL(o,c){return Xt(o,c)}var Pf=null,Bl=null,db=!1,Vf=!1,fb=!1,po=0;function Kr(o){o!==Bl&&o.next===null&&(Bl===null?Pf=Bl=o:Bl=Bl.next=o),Vf=!0,db||(db=!0,BL())}function _c(o,c){if(!fb&&Vf){fb=!0;do for(var f=!1,g=Pf;g!==null;){if(o!==0){var w=g.pendingLanes;if(w===0)var N=0;else{var E=g.suspendedLanes,z=g.pingedLanes;N=(1<<31-Pe(42|o)+1)-1,N&=w&~(E&~z),N=N&201326741?N&201326741|1:N?N|2:0}N!==0&&(f=!0,n$(g,N))}else N=ge,N=jd(g,g===ze?N:0,g.cancelPendingCommit!==null||g.timeoutHandle!==-1),(N&3)===0||Yu(g,N)||(f=!0,n$(g,N));g=g.next}while(f);fb=!1}}function ML(){JT()}function JT(){Vf=db=!1;var o=0;po!==0&&(qL()&&(o=po),po=0);for(var c=jt(),f=null,g=Pf;g!==null;){var w=g.next,N=t$(g,c);N===0?(g.next=null,f===null?Pf=w:f.next=w,w===null&&(Bl=f)):(f=g,(o!==0||(N&3)!==0)&&(Vf=!0)),g=w}_c(o)}function t$(o,c){for(var f=o.suspendedLanes,g=o.pingedLanes,w=o.expirationTimes,N=o.pendingLanes&-62914561;0<N;){var E=31-Pe(N),z=1<<E,j=w[E];j===-1?((z&f)===0||(z&g)!==0)&&(w[E]=c3(z,c)):j<=c&&(o.expiredLanes|=z),N&=~z}if(c=ze,f=ge,f=jd(o,o===c?f:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),g=o.callbackNode,f===0||o===c&&(Te===2||Te===9)||o.cancelPendingCommit!==null)return g!==null&&g!==null&&Kt(g),o.callbackNode=null,o.callbackPriority=0;if((f&3)===0||Yu(o,f)){if(c=f&-f,c===o.callbackPriority)return c;switch(g!==null&&Kt(g),Iy(f)){case 2:case 8:f=ve;break;case 32:f=Xe;break;case 268435456:f=tn;break;default:f=Xe}return g=e$.bind(null,o),f=Xt(f,g),o.callbackPriority=c,o.callbackNode=f,c}return g!==null&&g!==null&&Kt(g),o.callbackPriority=2,o.callbackNode=null,2}function e$(o,c){if(Yn!==0&&Yn!==5)return o.callbackNode=null,o.callbackPriority=0,null;var f=o.callbackNode;if(Bf()&&o.callbackNode!==f)return null;var g=ge;return g=jd(o,o===ze?g:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),g===0?null:(zT(o,g,c),t$(o,jt()),o.callbackNode!=null&&o.callbackNode===f?e$.bind(null,o):null)}function n$(o,c){if(Bf())return null;zT(o,c,!0)}function BL(){KL(function(){(Ne&6)!==0?Xt(mn,ML):JT()})}function pb(){return po===0&&(po=qS()),po}function s$(o){return o==null||typeof o=="symbol"||typeof o=="boolean"?null:typeof o=="function"?o:Zd(""+o)}function r$(o,c){var f=c.ownerDocument.createElement("input");return f.name=c.name,f.value=c.value,o.id&&f.setAttribute("form",o.id),c.parentNode.insertBefore(f,c),o=new FormData(o),f.parentNode.removeChild(f),o}function PL(o,c,f,g,w){if(c==="submit"&&f&&f.stateNode===w){var N=s$((w[xs]||null).action),E=g.submitter;E&&(c=(c=E[xs]||null)?s$(c.formAction):E.getAttribute("formAction"),c!==null&&(N=c,E=null));var z=new ef("action","action",null,g,w);o.push({event:z,listeners:[{instance:null,listener:function(){if(g.defaultPrevented){if(po!==0){var j=E?r$(w,E):new FormData(w);_0(f,{pending:!0,data:j,method:w.method,action:N},null,j)}}else typeof N=="function"&&(z.preventDefault(),j=E?r$(w,E):new FormData(w),_0(f,{pending:!0,data:j,method:w.method,action:N},N,j))},currentTarget:w}]})}}for(var mb=0;mb<Jy.length;mb++){var gb=Jy[mb],VL=gb.toLowerCase(),UL=gb[0].toUpperCase()+gb.slice(1);Ir(VL,"on"+UL)}Ir(zC,"onAnimationEnd"),Ir(MC,"onAnimationIteration"),Ir(BC,"onAnimationStart"),Ir("dblclick","onDoubleClick"),Ir("focusin","onFocus"),Ir("focusout","onBlur"),Ir(aL,"onTransitionRun"),Ir(iL,"onTransitionStart"),Ir(oL,"onTransitionCancel"),Ir(PC,"onTransitionEnd"),ul("onMouseEnter",["mouseout","mouseover"]),ul("onMouseLeave",["mouseout","mouseover"]),ul("onPointerEnter",["pointerout","pointerover"]),ul("onPointerLeave",["pointerout","pointerover"]),Zi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Zi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Zi("onBeforeInput",["compositionend","keypress","textInput","paste"]),Zi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Zi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Zi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Fc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),GL=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Fc));function a$(o,c){c=(c&4)!==0;for(var f=0;f<o.length;f++){var g=o[f],w=g.event;g=g.listeners;t:{var N=void 0;if(c)for(var E=g.length-1;0<=E;E--){var z=g[E],j=z.instance,dt=z.currentTarget;if(z=z.listener,j!==N&&w.isPropagationStopped())break t;N=z,w.currentTarget=dt;try{N(w)}catch(bt){If(bt)}w.currentTarget=null,N=j}else for(E=0;E<g.length;E++){if(z=g[E],j=z.instance,dt=z.currentTarget,z=z.listener,j!==N&&w.isPropagationStopped())break t;N=z,w.currentTarget=dt;try{N(w)}catch(bt){If(bt)}w.currentTarget=null,N=j}}}}function he(o,c){var f=c[Ey];f===void 0&&(f=c[Ey]=new Set);var g=o+"__bubble";f.has(g)||(i$(c,o,2,!1),f.add(g))}function yb(o,c,f){var g=0;c&&(g|=4),i$(f,o,g,c)}var Uf="_reactListening"+Math.random().toString(36).slice(2);function bb(o){if(!o[Uf]){o[Uf]=!0,JS.forEach(function(f){f!=="selectionchange"&&(GL.has(f)||yb(f,!1,o),yb(f,!0,o))});var c=o.nodeType===9?o:o.ownerDocument;c===null||c[Uf]||(c[Uf]=!0,yb("selectionchange",!1,c))}}function i$(o,c,f,g){switch(D$(c)){case 2:var w=gz;break;case 8:w=yz;break;default:w=Rb}f=w.bind(null,c,f,o),w=void 0,!Py||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(w=!0),g?w!==void 0?o.addEventListener(c,f,{capture:!0,passive:w}):o.addEventListener(c,f,!0):w!==void 0?o.addEventListener(c,f,{passive:w}):o.addEventListener(c,f,!1)}function xb(o,c,f,g,w){var N=g;if((c&1)===0&&(c&2)===0&&g!==null)t:for(;;){if(g===null)return;var E=g.tag;if(E===3||E===4){var z=g.stateNode.containerInfo;if(z===w)break;if(E===4)for(E=g.return;E!==null;){var j=E.tag;if((j===3||j===4)&&E.stateNode.containerInfo===w)return;E=E.return}for(;z!==null;){if(E=il(z),E===null)return;if(j=E.tag,j===5||j===6||j===26||j===27){g=N=E;continue t}z=z.parentNode}}g=g.return}fC(function(){var dt=N,bt=My(f),wt=[];t:{var ft=VC.get(o);if(ft!==void 0){var pt=ef,qt=o;switch(o){case"keypress":if(Jd(f)===0)break t;case"keydown":case"keyup":pt=z3;break;case"focusin":qt="focus",pt=Wy;break;case"focusout":qt="blur",pt=Wy;break;case"beforeblur":case"afterblur":pt=Wy;break;case"click":if(f.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":pt=gC;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":pt=T3;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":pt=P3;break;case zC:case MC:case BC:pt=I3;break;case PC:pt=U3;break;case"scroll":case"scrollend":pt=C3;break;case"wheel":pt=W3;break;case"copy":case"cut":case"paste":pt=D3;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":pt=bC;break;case"toggle":case"beforetoggle":pt=j3}var Ut=(c&4)!==0,De=!Ut&&(o==="scroll"||o==="scrollend"),it=Ut?ft!==null?ft+"Capture":null:ft;Ut=[];for(var rt=dt,ct;rt!==null;){var vt=rt;if(ct=vt.stateNode,vt=vt.tag,vt!==5&&vt!==26&&vt!==27||ct===null||it===null||(vt=tc(rt,it),vt!=null&&Ut.push(Lc(rt,vt,ct))),De)break;rt=rt.return}0<Ut.length&&(ft=new pt(ft,qt,null,f,bt),wt.push({event:ft,listeners:Ut}))}}if((c&7)===0){t:{if(ft=o==="mouseover"||o==="pointerover",pt=o==="mouseout"||o==="pointerout",ft&&f!==zy&&(qt=f.relatedTarget||f.fromElement)&&(il(qt)||qt[al]))break t;if((pt||ft)&&(ft=bt.window===bt?bt:(ft=bt.ownerDocument)?ft.defaultView||ft.parentWindow:window,pt?(qt=f.relatedTarget||f.toElement,pt=dt,qt=qt?il(qt):null,qt!==null&&(De=a(qt),Ut=qt.tag,qt!==De||Ut!==5&&Ut!==27&&Ut!==6)&&(qt=null)):(pt=null,qt=dt),pt!==qt)){if(Ut=gC,vt="onMouseLeave",it="onMouseEnter",rt="mouse",(o==="pointerout"||o==="pointerover")&&(Ut=bC,vt="onPointerLeave",it="onPointerEnter",rt="pointer"),De=pt==null?ft:Ju(pt),ct=qt==null?ft:Ju(qt),ft=new Ut(vt,rt+"leave",pt,f,bt),ft.target=De,ft.relatedTarget=ct,vt=null,il(bt)===dt&&(Ut=new Ut(it,rt+"enter",qt,f,bt),Ut.target=ct,Ut.relatedTarget=De,vt=Ut),De=vt,pt&&qt)e:{for(Ut=pt,it=qt,rt=0,ct=Ut;ct;ct=Pl(ct))rt++;for(ct=0,vt=it;vt;vt=Pl(vt))ct++;for(;0<rt-ct;)Ut=Pl(Ut),rt--;for(;0<ct-rt;)it=Pl(it),ct--;for(;rt--;){if(Ut===it||it!==null&&Ut===it.alternate)break e;Ut=Pl(Ut),it=Pl(it)}Ut=null}else Ut=null;pt!==null&&o$(wt,ft,pt,Ut,!1),qt!==null&&De!==null&&o$(wt,De,qt,Ut,!0)}}t:{if(ft=dt?Ju(dt):window,pt=ft.nodeName&&ft.nodeName.toLowerCase(),pt==="select"||pt==="input"&&ft.type==="file")var zt=$C;else if(NC(ft))if(kC)zt=nL;else{zt=tL;var ue=J3}else pt=ft.nodeName,!pt||pt.toLowerCase()!=="input"||ft.type!=="checkbox"&&ft.type!=="radio"?dt&&Ly(dt.elementType)&&(zt=$C):zt=eL;if(zt&&(zt=zt(o,dt))){TC(wt,zt,f,bt);break t}ue&&ue(o,ft,dt),o==="focusout"&&dt&&ft.type==="number"&&dt.memoizedProps.value!=null&&Fy(ft,"number",ft.value)}switch(ue=dt?Ju(dt):window,o){case"focusin":(NC(ue)||ue.contentEditable==="true")&&(gl=ue,Yy=dt,lc=null);break;case"focusout":lc=Yy=gl=null;break;case"mousedown":Zy=!0;break;case"contextmenu":case"mouseup":case"dragend":Zy=!1,FC(wt,f,bt);break;case"selectionchange":if(rL)break;case"keydown":case"keyup":FC(wt,f,bt)}var Pt;if(jy)t:{switch(o){case"compositionstart":var Gt="onCompositionStart";break t;case"compositionend":Gt="onCompositionEnd";break t;case"compositionupdate":Gt="onCompositionUpdate";break t}Gt=void 0}else ml?SC(o,f)&&(Gt="onCompositionEnd"):o==="keydown"&&f.keyCode===229&&(Gt="onCompositionStart");Gt&&(xC&&f.locale!=="ko"&&(ml||Gt!=="onCompositionStart"?Gt==="onCompositionEnd"&&ml&&(Pt=pC()):(Ka=bt,Vy="value"in Ka?Ka.value:Ka.textContent,ml=!0)),ue=Gf(dt,Gt),0<ue.length&&(Gt=new yC(Gt,o,null,f,bt),wt.push({event:Gt,listeners:ue}),Pt?Gt.data=Pt:(Pt=CC(f),Pt!==null&&(Gt.data=Pt)))),(Pt=X3?K3(o,f):Y3(o,f))&&(Gt=Gf(dt,"onBeforeInput"),0<Gt.length&&(ue=new yC("onBeforeInput","beforeinput",null,f,bt),wt.push({event:ue,listeners:Gt}),ue.data=Pt)),PL(wt,o,dt,f,bt)}a$(wt,c)})}function Lc(o,c,f){return{instance:o,listener:c,currentTarget:f}}function Gf(o,c){for(var f=c+"Capture",g=[];o!==null;){var w=o,N=w.stateNode;if(w=w.tag,w!==5&&w!==26&&w!==27||N===null||(w=tc(o,f),w!=null&&g.unshift(Lc(o,w,N)),w=tc(o,c),w!=null&&g.push(Lc(o,w,N))),o.tag===3)return g;o=o.return}return[]}function Pl(o){if(o===null)return null;do o=o.return;while(o&&o.tag!==5&&o.tag!==27);return o||null}function o$(o,c,f,g,w){for(var N=c._reactName,E=[];f!==null&&f!==g;){var z=f,j=z.alternate,dt=z.stateNode;if(z=z.tag,j!==null&&j===g)break;z!==5&&z!==26&&z!==27||dt===null||(j=dt,w?(dt=tc(f,N),dt!=null&&E.unshift(Lc(f,dt,j))):w||(dt=tc(f,N),dt!=null&&E.push(Lc(f,dt,j)))),f=f.return}E.length!==0&&o.push({event:c,listeners:E})}var WL=/\r\n?/g,HL=/\u0000|\uFFFD/g;function l$(o){return(typeof o=="string"?o:""+o).replace(WL,`
`).replace(HL,"")}function u$(o,c){return c=l$(c),l$(o)===c}function Wf(){}function Ee(o,c,f,g,w,N){switch(f){case"children":typeof g=="string"?c==="body"||c==="textarea"&&g===""||dl(o,g):(typeof g=="number"||typeof g=="bigint")&&c!=="body"&&dl(o,""+g);break;case"className":Xd(o,"class",g);break;case"tabIndex":Xd(o,"tabindex",g);break;case"dir":case"role":case"viewBox":case"width":case"height":Xd(o,f,g);break;case"style":hC(o,g,N);break;case"data":if(c!=="object"){Xd(o,"data",g);break}case"src":case"href":if(g===""&&(c!=="a"||f!=="href")){o.removeAttribute(f);break}if(g==null||typeof g=="function"||typeof g=="symbol"||typeof g=="boolean"){o.removeAttribute(f);break}g=Zd(""+g),o.setAttribute(f,g);break;case"action":case"formAction":if(typeof g=="function"){o.setAttribute(f,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof N=="function"&&(f==="formAction"?(c!=="input"&&Ee(o,c,"name",w.name,w,null),Ee(o,c,"formEncType",w.formEncType,w,null),Ee(o,c,"formMethod",w.formMethod,w,null),Ee(o,c,"formTarget",w.formTarget,w,null)):(Ee(o,c,"encType",w.encType,w,null),Ee(o,c,"method",w.method,w,null),Ee(o,c,"target",w.target,w,null)));if(g==null||typeof g=="symbol"||typeof g=="boolean"){o.removeAttribute(f);break}g=Zd(""+g),o.setAttribute(f,g);break;case"onClick":g!=null&&(o.onclick=Wf);break;case"onScroll":g!=null&&he("scroll",o);break;case"onScrollEnd":g!=null&&he("scrollend",o);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(s(61));if(f=g.__html,f!=null){if(w.children!=null)throw Error(s(60));o.innerHTML=f}}break;case"multiple":o.multiple=g&&typeof g!="function"&&typeof g!="symbol";break;case"muted":o.muted=g&&typeof g!="function"&&typeof g!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(g==null||typeof g=="function"||typeof g=="boolean"||typeof g=="symbol"){o.removeAttribute("xlink:href");break}f=Zd(""+g),o.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",f);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":g!=null&&typeof g!="function"&&typeof g!="symbol"?o.setAttribute(f,""+g):o.removeAttribute(f);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":g&&typeof g!="function"&&typeof g!="symbol"?o.setAttribute(f,""):o.removeAttribute(f);break;case"capture":case"download":g===!0?o.setAttribute(f,""):g!==!1&&g!=null&&typeof g!="function"&&typeof g!="symbol"?o.setAttribute(f,g):o.removeAttribute(f);break;case"cols":case"rows":case"size":case"span":g!=null&&typeof g!="function"&&typeof g!="symbol"&&!isNaN(g)&&1<=g?o.setAttribute(f,g):o.removeAttribute(f);break;case"rowSpan":case"start":g==null||typeof g=="function"||typeof g=="symbol"||isNaN(g)?o.removeAttribute(f):o.setAttribute(f,g);break;case"popover":he("beforetoggle",o),he("toggle",o),qd(o,"popover",g);break;case"xlinkActuate":pa(o,"http://www.w3.org/1999/xlink","xlink:actuate",g);break;case"xlinkArcrole":pa(o,"http://www.w3.org/1999/xlink","xlink:arcrole",g);break;case"xlinkRole":pa(o,"http://www.w3.org/1999/xlink","xlink:role",g);break;case"xlinkShow":pa(o,"http://www.w3.org/1999/xlink","xlink:show",g);break;case"xlinkTitle":pa(o,"http://www.w3.org/1999/xlink","xlink:title",g);break;case"xlinkType":pa(o,"http://www.w3.org/1999/xlink","xlink:type",g);break;case"xmlBase":pa(o,"http://www.w3.org/XML/1998/namespace","xml:base",g);break;case"xmlLang":pa(o,"http://www.w3.org/XML/1998/namespace","xml:lang",g);break;case"xmlSpace":pa(o,"http://www.w3.org/XML/1998/namespace","xml:space",g);break;case"is":qd(o,"is",g);break;case"innerText":case"textContent":break;default:(!(2<f.length)||f[0]!=="o"&&f[0]!=="O"||f[1]!=="n"&&f[1]!=="N")&&(f=w3.get(f)||f,qd(o,f,g))}}function vb(o,c,f,g,w,N){switch(f){case"style":hC(o,g,N);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(s(61));if(f=g.__html,f!=null){if(w.children!=null)throw Error(s(60));o.innerHTML=f}}break;case"children":typeof g=="string"?dl(o,g):(typeof g=="number"||typeof g=="bigint")&&dl(o,""+g);break;case"onScroll":g!=null&&he("scroll",o);break;case"onScrollEnd":g!=null&&he("scrollend",o);break;case"onClick":g!=null&&(o.onclick=Wf);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!tC.hasOwnProperty(f))t:{if(f[0]==="o"&&f[1]==="n"&&(w=f.endsWith("Capture"),c=f.slice(2,w?f.length-7:void 0),N=o[xs]||null,N=N!=null?N[f]:null,typeof N=="function"&&o.removeEventListener(c,N,w),typeof g=="function")){typeof N!="function"&&N!==null&&(f in o?o[f]=null:o.hasAttribute(f)&&o.removeAttribute(f)),o.addEventListener(c,g,w);break t}f in o?o[f]=g:g===!0?o.setAttribute(f,""):qd(o,f,g)}}}function Zn(o,c,f){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":he("error",o),he("load",o);var g=!1,w=!1,N;for(N in f)if(f.hasOwnProperty(N)){var E=f[N];if(E!=null)switch(N){case"src":g=!0;break;case"srcSet":w=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,c));default:Ee(o,c,N,E,f,null)}}w&&Ee(o,c,"srcSet",f.srcSet,f,null),g&&Ee(o,c,"src",f.src,f,null);return;case"input":he("invalid",o);var z=N=E=w=null,j=null,dt=null;for(g in f)if(f.hasOwnProperty(g)){var bt=f[g];if(bt!=null)switch(g){case"name":w=bt;break;case"type":E=bt;break;case"checked":j=bt;break;case"defaultChecked":dt=bt;break;case"value":N=bt;break;case"defaultValue":z=bt;break;case"children":case"dangerouslySetInnerHTML":if(bt!=null)throw Error(s(137,c));break;default:Ee(o,c,g,bt,f,null)}}oC(o,N,z,j,dt,E,w,!1),Kd(o);return;case"select":he("invalid",o),g=E=N=null;for(w in f)if(f.hasOwnProperty(w)&&(z=f[w],z!=null))switch(w){case"value":N=z;break;case"defaultValue":E=z;break;case"multiple":g=z;default:Ee(o,c,w,z,f,null)}c=N,f=E,o.multiple=!!g,c!=null?hl(o,!!g,c,!1):f!=null&&hl(o,!!g,f,!0);return;case"textarea":he("invalid",o),N=w=g=null;for(E in f)if(f.hasOwnProperty(E)&&(z=f[E],z!=null))switch(E){case"value":g=z;break;case"defaultValue":w=z;break;case"children":N=z;break;case"dangerouslySetInnerHTML":if(z!=null)throw Error(s(91));break;default:Ee(o,c,E,z,f,null)}uC(o,g,w,N),Kd(o);return;case"option":for(j in f)if(f.hasOwnProperty(j)&&(g=f[j],g!=null))switch(j){case"selected":o.selected=g&&typeof g!="function"&&typeof g!="symbol";break;default:Ee(o,c,j,g,f,null)}return;case"dialog":he("beforetoggle",o),he("toggle",o),he("cancel",o),he("close",o);break;case"iframe":case"object":he("load",o);break;case"video":case"audio":for(g=0;g<Fc.length;g++)he(Fc[g],o);break;case"image":he("error",o),he("load",o);break;case"details":he("toggle",o);break;case"embed":case"source":case"link":he("error",o),he("load",o);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(dt in f)if(f.hasOwnProperty(dt)&&(g=f[dt],g!=null))switch(dt){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,c));default:Ee(o,c,dt,g,f,null)}return;default:if(Ly(c)){for(bt in f)f.hasOwnProperty(bt)&&(g=f[bt],g!==void 0&&vb(o,c,bt,g,f,void 0));return}}for(z in f)f.hasOwnProperty(z)&&(g=f[z],g!=null&&Ee(o,c,z,g,f,null))}function jL(o,c,f,g){switch(c){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var w=null,N=null,E=null,z=null,j=null,dt=null,bt=null;for(pt in f){var wt=f[pt];if(f.hasOwnProperty(pt)&&wt!=null)switch(pt){case"checked":break;case"value":break;case"defaultValue":j=wt;default:g.hasOwnProperty(pt)||Ee(o,c,pt,null,g,wt)}}for(var ft in g){var pt=g[ft];if(wt=f[ft],g.hasOwnProperty(ft)&&(pt!=null||wt!=null))switch(ft){case"type":N=pt;break;case"name":w=pt;break;case"checked":dt=pt;break;case"defaultChecked":bt=pt;break;case"value":E=pt;break;case"defaultValue":z=pt;break;case"children":case"dangerouslySetInnerHTML":if(pt!=null)throw Error(s(137,c));break;default:pt!==wt&&Ee(o,c,ft,pt,g,wt)}}_y(o,E,z,j,dt,bt,N,w);return;case"select":pt=E=z=ft=null;for(N in f)if(j=f[N],f.hasOwnProperty(N)&&j!=null)switch(N){case"value":break;case"multiple":pt=j;default:g.hasOwnProperty(N)||Ee(o,c,N,null,g,j)}for(w in g)if(N=g[w],j=f[w],g.hasOwnProperty(w)&&(N!=null||j!=null))switch(w){case"value":ft=N;break;case"defaultValue":z=N;break;case"multiple":E=N;default:N!==j&&Ee(o,c,w,N,g,j)}c=z,f=E,g=pt,ft!=null?hl(o,!!f,ft,!1):!!g!=!!f&&(c!=null?hl(o,!!f,c,!0):hl(o,!!f,f?[]:"",!1));return;case"textarea":pt=ft=null;for(z in f)if(w=f[z],f.hasOwnProperty(z)&&w!=null&&!g.hasOwnProperty(z))switch(z){case"value":break;case"children":break;default:Ee(o,c,z,null,g,w)}for(E in g)if(w=g[E],N=f[E],g.hasOwnProperty(E)&&(w!=null||N!=null))switch(E){case"value":ft=w;break;case"defaultValue":pt=w;break;case"children":break;case"dangerouslySetInnerHTML":if(w!=null)throw Error(s(91));break;default:w!==N&&Ee(o,c,E,w,g,N)}lC(o,ft,pt);return;case"option":for(var qt in f)if(ft=f[qt],f.hasOwnProperty(qt)&&ft!=null&&!g.hasOwnProperty(qt))switch(qt){case"selected":o.selected=!1;break;default:Ee(o,c,qt,null,g,ft)}for(j in g)if(ft=g[j],pt=f[j],g.hasOwnProperty(j)&&ft!==pt&&(ft!=null||pt!=null))switch(j){case"selected":o.selected=ft&&typeof ft!="function"&&typeof ft!="symbol";break;default:Ee(o,c,j,ft,g,pt)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ut in f)ft=f[Ut],f.hasOwnProperty(Ut)&&ft!=null&&!g.hasOwnProperty(Ut)&&Ee(o,c,Ut,null,g,ft);for(dt in g)if(ft=g[dt],pt=f[dt],g.hasOwnProperty(dt)&&ft!==pt&&(ft!=null||pt!=null))switch(dt){case"children":case"dangerouslySetInnerHTML":if(ft!=null)throw Error(s(137,c));break;default:Ee(o,c,dt,ft,g,pt)}return;default:if(Ly(c)){for(var De in f)ft=f[De],f.hasOwnProperty(De)&&ft!==void 0&&!g.hasOwnProperty(De)&&vb(o,c,De,void 0,g,ft);for(bt in g)ft=g[bt],pt=f[bt],!g.hasOwnProperty(bt)||ft===pt||ft===void 0&&pt===void 0||vb(o,c,bt,ft,g,pt);return}}for(var it in f)ft=f[it],f.hasOwnProperty(it)&&ft!=null&&!g.hasOwnProperty(it)&&Ee(o,c,it,null,g,ft);for(wt in g)ft=g[wt],pt=f[wt],!g.hasOwnProperty(wt)||ft===pt||ft==null&&pt==null||Ee(o,c,wt,ft,g,pt)}var wb=null,Sb=null;function Hf(o){return o.nodeType===9?o:o.ownerDocument}function c$(o){switch(o){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function h$(o,c){if(o===0)switch(c){case"svg":return 1;case"math":return 2;default:return 0}return o===1&&c==="foreignObject"?0:o}function Cb(o,c){return o==="textarea"||o==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.children=="bigint"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var Nb=null;function qL(){var o=window.event;return o&&o.type==="popstate"?o===Nb?!1:(Nb=o,!0):(Nb=null,!1)}var d$=typeof setTimeout=="function"?setTimeout:void 0,XL=typeof clearTimeout=="function"?clearTimeout:void 0,f$=typeof Promise=="function"?Promise:void 0,KL=typeof queueMicrotask=="function"?queueMicrotask:typeof f$<"u"?function(o){return f$.resolve(null).then(o).catch(YL)}:d$;function YL(o){setTimeout(function(){throw o})}function hi(o){return o==="head"}function p$(o,c){var f=c,g=0,w=0;do{var N=f.nextSibling;if(o.removeChild(f),N&&N.nodeType===8)if(f=N.data,f==="/$"){if(0<g&&8>g){f=g;var E=o.ownerDocument;if(f&1&&zc(E.documentElement),f&2&&zc(E.body),f&4)for(f=E.head,zc(f),E=f.firstChild;E;){var z=E.nextSibling,j=E.nodeName;E[Qu]||j==="SCRIPT"||j==="STYLE"||j==="LINK"&&E.rel.toLowerCase()==="stylesheet"||f.removeChild(E),E=z}}if(w===0){o.removeChild(N),Hc(c);return}w--}else f==="$"||f==="$?"||f==="$!"?w++:g=f.charCodeAt(0)-48;else g=0;f=N}while(f);Hc(c)}function Tb(o){var c=o.firstChild;for(c&&c.nodeType===10&&(c=c.nextSibling);c;){var f=c;switch(c=c.nextSibling,f.nodeName){case"HTML":case"HEAD":case"BODY":Tb(f),Dy(f);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(f.rel.toLowerCase()==="stylesheet")continue}o.removeChild(f)}}function ZL(o,c,f,g){for(;o.nodeType===1;){var w=f;if(o.nodeName.toLowerCase()!==c.toLowerCase()){if(!g&&(o.nodeName!=="INPUT"||o.type!=="hidden"))break}else if(g){if(!o[Qu])switch(c){case"meta":if(!o.hasAttribute("itemprop"))break;return o;case"link":if(N=o.getAttribute("rel"),N==="stylesheet"&&o.hasAttribute("data-precedence"))break;if(N!==w.rel||o.getAttribute("href")!==(w.href==null||w.href===""?null:w.href)||o.getAttribute("crossorigin")!==(w.crossOrigin==null?null:w.crossOrigin)||o.getAttribute("title")!==(w.title==null?null:w.title))break;return o;case"style":if(o.hasAttribute("data-precedence"))break;return o;case"script":if(N=o.getAttribute("src"),(N!==(w.src==null?null:w.src)||o.getAttribute("type")!==(w.type==null?null:w.type)||o.getAttribute("crossorigin")!==(w.crossOrigin==null?null:w.crossOrigin))&&N&&o.hasAttribute("async")&&!o.hasAttribute("itemprop"))break;return o;default:return o}}else if(c==="input"&&o.type==="hidden"){var N=w.name==null?null:""+w.name;if(w.type==="hidden"&&o.getAttribute("name")===N)return o}else return o;if(o=Dr(o.nextSibling),o===null)break}return null}function QL(o,c,f){if(c==="")return null;for(;o.nodeType!==3;)if((o.nodeType!==1||o.nodeName!=="INPUT"||o.type!=="hidden")&&!f||(o=Dr(o.nextSibling),o===null))return null;return o}function $b(o){return o.data==="$!"||o.data==="$?"&&o.ownerDocument.readyState==="complete"}function JL(o,c){var f=o.ownerDocument;if(o.data!=="$?"||f.readyState==="complete")c();else{var g=function(){c(),f.removeEventListener("DOMContentLoaded",g)};f.addEventListener("DOMContentLoaded",g),o._reactRetry=g}}function Dr(o){for(;o!=null;o=o.nextSibling){var c=o.nodeType;if(c===1||c===3)break;if(c===8){if(c=o.data,c==="$"||c==="$!"||c==="$?"||c==="F!"||c==="F")break;if(c==="/$")return null}}return o}var kb=null;function m$(o){o=o.previousSibling;for(var c=0;o;){if(o.nodeType===8){var f=o.data;if(f==="$"||f==="$!"||f==="$?"){if(c===0)return o;c--}else f==="/$"&&c++}o=o.previousSibling}return null}function g$(o,c,f){switch(c=Hf(f),o){case"html":if(o=c.documentElement,!o)throw Error(s(452));return o;case"head":if(o=c.head,!o)throw Error(s(453));return o;case"body":if(o=c.body,!o)throw Error(s(454));return o;default:throw Error(s(451))}}function zc(o){for(var c=o.attributes;c.length;)o.removeAttributeNode(c[0]);Dy(o)}var cr=new Map,y$=new Set;function jf(o){return typeof o.getRootNode=="function"?o.getRootNode():o.nodeType===9?o:o.ownerDocument}var Ia=Y.d;Y.d={f:tz,r:ez,D:nz,C:sz,L:rz,m:az,X:oz,S:iz,M:lz};function tz(){var o=Ia.f(),c=zf();return o||c}function ez(o){var c=ol(o);c!==null&&c.tag===5&&c.type==="form"?zN(c):Ia.r(o)}var Vl=typeof document>"u"?null:document;function b$(o,c,f){var g=Vl;if(g&&typeof c=="string"&&c){var w=sr(c);w='link[rel="'+o+'"][href="'+w+'"]',typeof f=="string"&&(w+='[crossorigin="'+f+'"]'),y$.has(w)||(y$.add(w),o={rel:o,crossOrigin:f,href:c},g.querySelector(w)===null&&(c=g.createElement("link"),Zn(c,"link",o),Fn(c),g.head.appendChild(c)))}}function nz(o){Ia.D(o),b$("dns-prefetch",o,null)}function sz(o,c){Ia.C(o,c),b$("preconnect",o,c)}function rz(o,c,f){Ia.L(o,c,f);var g=Vl;if(g&&o&&c){var w='link[rel="preload"][as="'+sr(c)+'"]';c==="image"&&f&&f.imageSrcSet?(w+='[imagesrcset="'+sr(f.imageSrcSet)+'"]',typeof f.imageSizes=="string"&&(w+='[imagesizes="'+sr(f.imageSizes)+'"]')):w+='[href="'+sr(o)+'"]';var N=w;switch(c){case"style":N=Ul(o);break;case"script":N=Gl(o)}cr.has(N)||(o=d({rel:"preload",href:c==="image"&&f&&f.imageSrcSet?void 0:o,as:c},f),cr.set(N,o),g.querySelector(w)!==null||c==="style"&&g.querySelector(Mc(N))||c==="script"&&g.querySelector(Bc(N))||(c=g.createElement("link"),Zn(c,"link",o),Fn(c),g.head.appendChild(c)))}}function az(o,c){Ia.m(o,c);var f=Vl;if(f&&o){var g=c&&typeof c.as=="string"?c.as:"script",w='link[rel="modulepreload"][as="'+sr(g)+'"][href="'+sr(o)+'"]',N=w;switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":N=Gl(o)}if(!cr.has(N)&&(o=d({rel:"modulepreload",href:o},c),cr.set(N,o),f.querySelector(w)===null)){switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(f.querySelector(Bc(N)))return}g=f.createElement("link"),Zn(g,"link",o),Fn(g),f.head.appendChild(g)}}}function iz(o,c,f){Ia.S(o,c,f);var g=Vl;if(g&&o){var w=ll(g).hoistableStyles,N=Ul(o);c=c||"default";var E=w.get(N);if(!E){var z={loading:0,preload:null};if(E=g.querySelector(Mc(N)))z.loading=5;else{o=d({rel:"stylesheet",href:o,"data-precedence":c},f),(f=cr.get(N))&&Ib(o,f);var j=E=g.createElement("link");Fn(j),Zn(j,"link",o),j._p=new Promise(function(dt,bt){j.onload=dt,j.onerror=bt}),j.addEventListener("load",function(){z.loading|=1}),j.addEventListener("error",function(){z.loading|=2}),z.loading|=4,qf(E,c,g)}E={type:"stylesheet",instance:E,count:1,state:z},w.set(N,E)}}}function oz(o,c){Ia.X(o,c);var f=Vl;if(f&&o){var g=ll(f).hoistableScripts,w=Gl(o),N=g.get(w);N||(N=f.querySelector(Bc(w)),N||(o=d({src:o,async:!0},c),(c=cr.get(w))&&Eb(o,c),N=f.createElement("script"),Fn(N),Zn(N,"link",o),f.head.appendChild(N)),N={type:"script",instance:N,count:1,state:null},g.set(w,N))}}function lz(o,c){Ia.M(o,c);var f=Vl;if(f&&o){var g=ll(f).hoistableScripts,w=Gl(o),N=g.get(w);N||(N=f.querySelector(Bc(w)),N||(o=d({src:o,async:!0,type:"module"},c),(c=cr.get(w))&&Eb(o,c),N=f.createElement("script"),Fn(N),Zn(N,"link",o),f.head.appendChild(N)),N={type:"script",instance:N,count:1,state:null},g.set(w,N))}}function x$(o,c,f,g){var w=(w=lt.current)?jf(w):null;if(!w)throw Error(s(446));switch(o){case"meta":case"title":return null;case"style":return typeof f.precedence=="string"&&typeof f.href=="string"?(c=Ul(f.href),f=ll(w).hoistableStyles,g=f.get(c),g||(g={type:"style",instance:null,count:0,state:null},f.set(c,g)),g):{type:"void",instance:null,count:0,state:null};case"link":if(f.rel==="stylesheet"&&typeof f.href=="string"&&typeof f.precedence=="string"){o=Ul(f.href);var N=ll(w).hoistableStyles,E=N.get(o);if(E||(w=w.ownerDocument||w,E={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},N.set(o,E),(N=w.querySelector(Mc(o)))&&!N._p&&(E.instance=N,E.state.loading=5),cr.has(o)||(f={rel:"preload",as:"style",href:f.href,crossOrigin:f.crossOrigin,integrity:f.integrity,media:f.media,hrefLang:f.hrefLang,referrerPolicy:f.referrerPolicy},cr.set(o,f),N||uz(w,o,f,E.state))),c&&g===null)throw Error(s(528,""));return E}if(c&&g!==null)throw Error(s(529,""));return null;case"script":return c=f.async,f=f.src,typeof f=="string"&&c&&typeof c!="function"&&typeof c!="symbol"?(c=Gl(f),f=ll(w).hoistableScripts,g=f.get(c),g||(g={type:"script",instance:null,count:0,state:null},f.set(c,g)),g):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,o))}}function Ul(o){return'href="'+sr(o)+'"'}function Mc(o){return'link[rel="stylesheet"]['+o+"]"}function v$(o){return d({},o,{"data-precedence":o.precedence,precedence:null})}function uz(o,c,f,g){o.querySelector('link[rel="preload"][as="style"]['+c+"]")?g.loading=1:(c=o.createElement("link"),g.preload=c,c.addEventListener("load",function(){return g.loading|=1}),c.addEventListener("error",function(){return g.loading|=2}),Zn(c,"link",f),Fn(c),o.head.appendChild(c))}function Gl(o){return'[src="'+sr(o)+'"]'}function Bc(o){return"script[async]"+o}function w$(o,c,f){if(c.count++,c.instance===null)switch(c.type){case"style":var g=o.querySelector('style[data-href~="'+sr(f.href)+'"]');if(g)return c.instance=g,Fn(g),g;var w=d({},f,{"data-href":f.href,"data-precedence":f.precedence,href:null,precedence:null});return g=(o.ownerDocument||o).createElement("style"),Fn(g),Zn(g,"style",w),qf(g,f.precedence,o),c.instance=g;case"stylesheet":w=Ul(f.href);var N=o.querySelector(Mc(w));if(N)return c.state.loading|=4,c.instance=N,Fn(N),N;g=v$(f),(w=cr.get(w))&&Ib(g,w),N=(o.ownerDocument||o).createElement("link"),Fn(N);var E=N;return E._p=new Promise(function(z,j){E.onload=z,E.onerror=j}),Zn(N,"link",g),c.state.loading|=4,qf(N,f.precedence,o),c.instance=N;case"script":return N=Gl(f.src),(w=o.querySelector(Bc(N)))?(c.instance=w,Fn(w),w):(g=f,(w=cr.get(N))&&(g=d({},f),Eb(g,w)),o=o.ownerDocument||o,w=o.createElement("script"),Fn(w),Zn(w,"link",g),o.head.appendChild(w),c.instance=w);case"void":return null;default:throw Error(s(443,c.type))}else c.type==="stylesheet"&&(c.state.loading&4)===0&&(g=c.instance,c.state.loading|=4,qf(g,f.precedence,o));return c.instance}function qf(o,c,f){for(var g=f.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),w=g.length?g[g.length-1]:null,N=w,E=0;E<g.length;E++){var z=g[E];if(z.dataset.precedence===c)N=z;else if(N!==w)break}N?N.parentNode.insertBefore(o,N.nextSibling):(c=f.nodeType===9?f.head:f,c.insertBefore(o,c.firstChild))}function Ib(o,c){o.crossOrigin==null&&(o.crossOrigin=c.crossOrigin),o.referrerPolicy==null&&(o.referrerPolicy=c.referrerPolicy),o.title==null&&(o.title=c.title)}function Eb(o,c){o.crossOrigin==null&&(o.crossOrigin=c.crossOrigin),o.referrerPolicy==null&&(o.referrerPolicy=c.referrerPolicy),o.integrity==null&&(o.integrity=c.integrity)}var Xf=null;function S$(o,c,f){if(Xf===null){var g=new Map,w=Xf=new Map;w.set(f,g)}else w=Xf,g=w.get(f),g||(g=new Map,w.set(f,g));if(g.has(o))return g;for(g.set(o,null),f=f.getElementsByTagName(o),w=0;w<f.length;w++){var N=f[w];if(!(N[Qu]||N[rs]||o==="link"&&N.getAttribute("rel")==="stylesheet")&&N.namespaceURI!=="http://www.w3.org/2000/svg"){var E=N.getAttribute(c)||"";E=o+E;var z=g.get(E);z?z.push(N):g.set(E,[N])}}return g}function C$(o,c,f){o=o.ownerDocument||o,o.head.insertBefore(f,c==="title"?o.querySelector("head > title"):null)}function cz(o,c,f){if(f===1||c.itemProp!=null)return!1;switch(o){case"meta":case"title":return!0;case"style":if(typeof c.precedence!="string"||typeof c.href!="string"||c.href==="")break;return!0;case"link":if(typeof c.rel!="string"||typeof c.href!="string"||c.href===""||c.onLoad||c.onError)break;switch(c.rel){case"stylesheet":return o=c.disabled,typeof c.precedence=="string"&&o==null;default:return!0}case"script":if(c.async&&typeof c.async!="function"&&typeof c.async!="symbol"&&!c.onLoad&&!c.onError&&c.src&&typeof c.src=="string")return!0}return!1}function N$(o){return!(o.type==="stylesheet"&&(o.state.loading&3)===0)}var Pc=null;function hz(){}function dz(o,c,f){if(Pc===null)throw Error(s(475));var g=Pc;if(c.type==="stylesheet"&&(typeof f.media!="string"||matchMedia(f.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var w=Ul(f.href),N=o.querySelector(Mc(w));if(N){o=N._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(g.count++,g=Kf.bind(g),o.then(g,g)),c.state.loading|=4,c.instance=N,Fn(N);return}N=o.ownerDocument||o,f=v$(f),(w=cr.get(w))&&Ib(f,w),N=N.createElement("link"),Fn(N);var E=N;E._p=new Promise(function(z,j){E.onload=z,E.onerror=j}),Zn(N,"link",f),c.instance=N}g.stylesheets===null&&(g.stylesheets=new Map),g.stylesheets.set(c,o),(o=c.state.preload)&&(c.state.loading&3)===0&&(g.count++,c=Kf.bind(g),o.addEventListener("load",c),o.addEventListener("error",c))}}function fz(){if(Pc===null)throw Error(s(475));var o=Pc;return o.stylesheets&&o.count===0&&Db(o,o.stylesheets),0<o.count?function(c){var f=setTimeout(function(){if(o.stylesheets&&Db(o,o.stylesheets),o.unsuspend){var g=o.unsuspend;o.unsuspend=null,g()}},6e4);return o.unsuspend=c,function(){o.unsuspend=null,clearTimeout(f)}}:null}function Kf(){if(this.count--,this.count===0){if(this.stylesheets)Db(this,this.stylesheets);else if(this.unsuspend){var o=this.unsuspend;this.unsuspend=null,o()}}}var Yf=null;function Db(o,c){o.stylesheets=null,o.unsuspend!==null&&(o.count++,Yf=new Map,c.forEach(pz,o),Yf=null,Kf.call(o))}function pz(o,c){if(!(c.state.loading&4)){var f=Yf.get(o);if(f)var g=f.get(null);else{f=new Map,Yf.set(o,f);for(var w=o.querySelectorAll("link[data-precedence],style[data-precedence]"),N=0;N<w.length;N++){var E=w[N];(E.nodeName==="LINK"||E.getAttribute("media")!=="not all")&&(f.set(E.dataset.precedence,E),g=E)}g&&f.set(null,g)}w=c.instance,E=w.getAttribute("data-precedence"),N=f.get(E)||g,N===g&&f.set(null,w),f.set(E,w),this.count++,g=Kf.bind(this),w.addEventListener("load",g),w.addEventListener("error",g),N?N.parentNode.insertBefore(w,N.nextSibling):(o=o.nodeType===9?o.head:o,o.insertBefore(w,o.firstChild)),c.state.loading|=4}}var Vc={$$typeof:$,Provider:null,Consumer:null,_currentValue:Z,_currentValue2:Z,_threadCount:0};function mz(o,c,f,g,w,N,E,z){this.tag=1,this.containerInfo=o,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=$y(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=$y(0),this.hiddenUpdates=$y(null),this.identifierPrefix=g,this.onUncaughtError=w,this.onCaughtError=N,this.onRecoverableError=E,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=z,this.incompleteTransitions=new Map}function T$(o,c,f,g,w,N,E,z,j,dt,bt,wt){return o=new mz(o,c,f,E,z,j,dt,wt),c=1,N===!0&&(c|=24),N=Gs(3,null,null,c),o.current=N,N.stateNode=o,c=h0(),c.refCount++,o.pooledCache=c,c.refCount++,N.memoizedState={element:g,isDehydrated:f,cache:c},m0(N),o}function $$(o){return o?(o=vl,o):vl}function k$(o,c,f,g,w,N){w=$$(w),g.context===null?g.context=w:g.pendingContext=w,g=Qa(c),g.payload={element:f},N=N===void 0?null:N,N!==null&&(g.callback=N),f=Ja(o,g,c),f!==null&&(Xs(f,o,c),yc(f,o,c))}function I$(o,c){if(o=o.memoizedState,o!==null&&o.dehydrated!==null){var f=o.retryLane;o.retryLane=f!==0&&f<c?f:c}}function Ab(o,c){I$(o,c),(o=o.alternate)&&I$(o,c)}function E$(o){if(o.tag===13){var c=xl(o,67108864);c!==null&&Xs(c,o,67108864),Ab(o,67108864)}}var Zf=!0;function gz(o,c,f,g){var w=U.T;U.T=null;var N=Y.p;try{Y.p=2,Rb(o,c,f,g)}finally{Y.p=N,U.T=w}}function yz(o,c,f,g){var w=U.T;U.T=null;var N=Y.p;try{Y.p=8,Rb(o,c,f,g)}finally{Y.p=N,U.T=w}}function Rb(o,c,f,g){if(Zf){var w=Ob(g);if(w===null)xb(o,c,g,Qf,f),A$(o,g);else if(xz(w,o,c,f,g))g.stopPropagation();else if(A$(o,g),c&4&&-1<bz.indexOf(o)){for(;w!==null;){var N=ol(w);if(N!==null)switch(N.tag){case 3:if(N=N.stateNode,N.current.memoizedState.isDehydrated){var E=fa(N.pendingLanes);if(E!==0){var z=N;for(z.pendingLanes|=2,z.entangledLanes|=2;E;){var j=1<<31-Pe(E);z.entanglements[1]|=j,E&=~j}Kr(N),(Ne&6)===0&&(Ff=jt()+500,_c(0))}}break;case 13:z=xl(N,2),z!==null&&Xs(z,N,2),zf(),Ab(N,2)}if(N=Ob(g),N===null&&xb(o,c,g,Qf,f),N===w)break;w=N}w!==null&&g.stopPropagation()}else xb(o,c,g,null,f)}}function Ob(o){return o=My(o),_b(o)}var Qf=null;function _b(o){if(Qf=null,o=il(o),o!==null){var c=a(o);if(c===null)o=null;else{var f=c.tag;if(f===13){if(o=i(c),o!==null)return o;o=null}else if(f===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;o=null}else c!==o&&(o=null)}}return Qf=o,null}function D$(o){switch(o){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ie()){case mn:return 2;case ve:return 8;case Xe:case ke:return 32;case tn:return 268435456;default:return 32}default:return 32}}var Fb=!1,di=null,fi=null,pi=null,Uc=new Map,Gc=new Map,mi=[],bz="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function A$(o,c){switch(o){case"focusin":case"focusout":di=null;break;case"dragenter":case"dragleave":fi=null;break;case"mouseover":case"mouseout":pi=null;break;case"pointerover":case"pointerout":Uc.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":Gc.delete(c.pointerId)}}function Wc(o,c,f,g,w,N){return o===null||o.nativeEvent!==N?(o={blockedOn:c,domEventName:f,eventSystemFlags:g,nativeEvent:N,targetContainers:[w]},c!==null&&(c=ol(c),c!==null&&E$(c)),o):(o.eventSystemFlags|=g,c=o.targetContainers,w!==null&&c.indexOf(w)===-1&&c.push(w),o)}function xz(o,c,f,g,w){switch(c){case"focusin":return di=Wc(di,o,c,f,g,w),!0;case"dragenter":return fi=Wc(fi,o,c,f,g,w),!0;case"mouseover":return pi=Wc(pi,o,c,f,g,w),!0;case"pointerover":var N=w.pointerId;return Uc.set(N,Wc(Uc.get(N)||null,o,c,f,g,w)),!0;case"gotpointercapture":return N=w.pointerId,Gc.set(N,Wc(Gc.get(N)||null,o,c,f,g,w)),!0}return!1}function R$(o){var c=il(o.target);if(c!==null){var f=a(c);if(f!==null){if(c=f.tag,c===13){if(c=i(f),c!==null){o.blockedOn=c,d3(o.priority,function(){if(f.tag===13){var g=qs();g=ky(g);var w=xl(f,g);w!==null&&Xs(w,f,g),Ab(f,g)}});return}}else if(c===3&&f.stateNode.current.memoizedState.isDehydrated){o.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}o.blockedOn=null}function Jf(o){if(o.blockedOn!==null)return!1;for(var c=o.targetContainers;0<c.length;){var f=Ob(o.nativeEvent);if(f===null){f=o.nativeEvent;var g=new f.constructor(f.type,f);zy=g,f.target.dispatchEvent(g),zy=null}else return c=ol(f),c!==null&&E$(c),o.blockedOn=f,!1;c.shift()}return!0}function O$(o,c,f){Jf(o)&&f.delete(c)}function vz(){Fb=!1,di!==null&&Jf(di)&&(di=null),fi!==null&&Jf(fi)&&(fi=null),pi!==null&&Jf(pi)&&(pi=null),Uc.forEach(O$),Gc.forEach(O$)}function tp(o,c){o.blockedOn===c&&(o.blockedOn=null,Fb||(Fb=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,vz)))}var ep=null;function _$(o){ep!==o&&(ep=o,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){ep===o&&(ep=null);for(var c=0;c<o.length;c+=3){var f=o[c],g=o[c+1],w=o[c+2];if(typeof g!="function"){if(_b(g||f)===null)continue;break}var N=ol(f);N!==null&&(o.splice(c,3),c-=3,_0(N,{pending:!0,data:w,method:f.method,action:g},g,w))}}))}function Hc(o){function c(j){return tp(j,o)}di!==null&&tp(di,o),fi!==null&&tp(fi,o),pi!==null&&tp(pi,o),Uc.forEach(c),Gc.forEach(c);for(var f=0;f<mi.length;f++){var g=mi[f];g.blockedOn===o&&(g.blockedOn=null)}for(;0<mi.length&&(f=mi[0],f.blockedOn===null);)R$(f),f.blockedOn===null&&mi.shift();if(f=(o.ownerDocument||o).$$reactFormReplay,f!=null)for(g=0;g<f.length;g+=3){var w=f[g],N=f[g+1],E=w[xs]||null;if(typeof N=="function")E||_$(f);else if(E){var z=null;if(N&&N.hasAttribute("formAction")){if(w=N,E=N[xs]||null)z=E.formAction;else if(_b(w)!==null)continue}else z=E.action;typeof z=="function"?f[g+1]=z:(f.splice(g,3),g-=3),_$(f)}}}function Lb(o){this._internalRoot=o}np.prototype.render=Lb.prototype.render=function(o){var c=this._internalRoot;if(c===null)throw Error(s(409));var f=c.current,g=qs();k$(f,g,o,c,null,null)},np.prototype.unmount=Lb.prototype.unmount=function(){var o=this._internalRoot;if(o!==null){this._internalRoot=null;var c=o.containerInfo;k$(o.current,2,null,o,null,null),zf(),c[al]=null}};function np(o){this._internalRoot=o}np.prototype.unstable_scheduleHydration=function(o){if(o){var c=ZS();o={blockedOn:null,target:o,priority:c};for(var f=0;f<mi.length&&c!==0&&c<mi[f].priority;f++);mi.splice(f,0,o),f===0&&R$(o)}};var F$=t.version;if(F$!=="19.1.0")throw Error(s(527,F$,"19.1.0"));Y.findDOMNode=function(o){var c=o._reactInternals;if(c===void 0)throw typeof o.render=="function"?Error(s(188)):(o=Object.keys(o).join(","),Error(s(268,o)));return o=u(c),o=o!==null?h(o):null,o=o===null?null:o.stateNode,o};var wz={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:U,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var sp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!sp.isDisabled&&sp.supportsFiber)try{Ke=sp.inject(wz),Oe=sp}catch{}}return qc.createRoot=function(o,c){if(!r(o))throw Error(s(299));var f=!1,g="",w=ZN,N=QN,E=JN,z=null;return c!=null&&(c.unstable_strictMode===!0&&(f=!0),c.identifierPrefix!==void 0&&(g=c.identifierPrefix),c.onUncaughtError!==void 0&&(w=c.onUncaughtError),c.onCaughtError!==void 0&&(N=c.onCaughtError),c.onRecoverableError!==void 0&&(E=c.onRecoverableError),c.unstable_transitionCallbacks!==void 0&&(z=c.unstable_transitionCallbacks)),c=T$(o,1,!1,null,null,f,g,w,N,E,z,null),o[al]=c.current,bb(o),new Lb(c)},qc.hydrateRoot=function(o,c,f){if(!r(o))throw Error(s(299));var g=!1,w="",N=ZN,E=QN,z=JN,j=null,dt=null;return f!=null&&(f.unstable_strictMode===!0&&(g=!0),f.identifierPrefix!==void 0&&(w=f.identifierPrefix),f.onUncaughtError!==void 0&&(N=f.onUncaughtError),f.onCaughtError!==void 0&&(E=f.onCaughtError),f.onRecoverableError!==void 0&&(z=f.onRecoverableError),f.unstable_transitionCallbacks!==void 0&&(j=f.unstable_transitionCallbacks),f.formState!==void 0&&(dt=f.formState)),c=T$(o,1,!0,c,f??null,g,w,N,E,z,j,dt),c.context=$$(null),f=c.current,g=qs(),g=ky(g),w=Qa(g),w.callback=null,Ja(f,w,g),f=g,c.current.lanes=f,Zu(c,f),Kr(c),o[al]=c.current,bb(o),new np(c)},qc.version="19.1.0",qc}var H$;function Rz(){if(H$)return Bb.exports;H$=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(t){console.error(t)}}return n(),Bb.exports=Az(),Bb.exports}var Oz=Rz();const _z=Sm(Oz);SI();/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Pp(){return Pp=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(n[s]=e[s])}return n},Pp.apply(this,arguments)}var xi;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(xi||(xi={}));const j$="popstate";function Fz(n){n===void 0&&(n={});function t(s,r){let{pathname:a,search:i,hash:l}=s.location;return vx("",{pathname:a,search:i,hash:l},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function e(s,r){return typeof r=="string"?r:NI(r)}return zz(t,e,null,n)}function Rs(n,t){if(n===!1||n===null||typeof n>"u")throw new Error(t)}function CI(n,t){if(!n){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function Lz(){return Math.random().toString(36).substr(2,8)}function q$(n,t){return{usr:n.state,key:n.key,idx:t}}function vx(n,t,e,s){return e===void 0&&(e=null),Pp({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof t=="string"?Nm(t):t,{state:e,key:t&&t.key||s||Lz()})}function NI(n){let{pathname:t="/",search:e="",hash:s=""}=n;return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),s&&s!=="#"&&(t+=s.charAt(0)==="#"?s:"#"+s),t}function Nm(n){let t={};if(n){let e=n.indexOf("#");e>=0&&(t.hash=n.substr(e),n=n.substr(0,e));let s=n.indexOf("?");s>=0&&(t.search=n.substr(s),n=n.substr(0,s)),n&&(t.pathname=n)}return t}function zz(n,t,e,s){s===void 0&&(s={});let{window:r=document.defaultView,v5Compat:a=!1}=s,i=r.history,l=xi.Pop,u=null,h=d();h==null&&(h=0,i.replaceState(Pp({},i.state,{idx:h}),""));function d(){return(i.state||{idx:null}).idx}function p(){l=xi.Pop;let v=d(),S=v==null?null:v-h;h=v,u&&u({action:l,location:x.location,delta:S})}function m(v,S){l=xi.Push;let C=vx(x.location,v,S);h=d()+1;let $=q$(C,h),T=x.createHref(C);try{i.pushState($,"",T)}catch(I){if(I instanceof DOMException&&I.name==="DataCloneError")throw I;r.location.assign(T)}a&&u&&u({action:l,location:x.location,delta:1})}function y(v,S){l=xi.Replace;let C=vx(x.location,v,S);h=d();let $=q$(C,h),T=x.createHref(C);i.replaceState($,"",T),a&&u&&u({action:l,location:x.location,delta:0})}function b(v){let S=r.location.origin!=="null"?r.location.origin:r.location.href,C=typeof v=="string"?v:NI(v);return C=C.replace(/ $/,"%20"),Rs(S,"No window.location.(origin|href) available to create URL for href: "+C),new URL(C,S)}let x={get action(){return l},get location(){return n(r,i)},listen(v){if(u)throw new Error("A history only accepts one active listener");return r.addEventListener(j$,p),u=v,()=>{r.removeEventListener(j$,p),u=null}},createHref(v){return t(r,v)},createURL:b,encodeLocation(v){let S=b(v);return{pathname:S.pathname,search:S.search,hash:S.hash}},push:m,replace:y,go(v){return i.go(v)}};return x}var X$;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(X$||(X$={}));function Mz(n,t,e){return e===void 0&&(e="/"),Bz(n,t,e)}function Bz(n,t,e,s){let r=typeof t=="string"?Nm(t):t,a=kI(r.pathname||"/",e);if(a==null)return null;let i=TI(n);Pz(i);let l=null;for(let u=0;l==null&&u<i.length;++u){let h=Qz(a);l=Kz(i[u],h)}return l}function TI(n,t,e,s){t===void 0&&(t=[]),e===void 0&&(e=[]),s===void 0&&(s="");let r=(a,i,l)=>{let u={relativePath:l===void 0?a.path||"":l,caseSensitive:a.caseSensitive===!0,childrenIndex:i,route:a};u.relativePath.startsWith("/")&&(Rs(u.relativePath.startsWith(s),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(s.length));let h=tu([s,u.relativePath]),d=e.concat(u);a.children&&a.children.length>0&&(Rs(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+h+'".')),TI(a.children,t,d,h)),!(a.path==null&&!a.index)&&t.push({path:h,score:qz(h,a.index),routesMeta:d})};return n.forEach((a,i)=>{var l;if(a.path===""||!((l=a.path)!=null&&l.includes("?")))r(a,i);else for(let u of $I(a.path))r(a,i,u)}),t}function $I(n){let t=n.split("/");if(t.length===0)return[];let[e,...s]=t,r=e.endsWith("?"),a=e.replace(/\?$/,"");if(s.length===0)return r?[a,""]:[a];let i=$I(s.join("/")),l=[];return l.push(...i.map(u=>u===""?a:[a,u].join("/"))),r&&l.push(...i),l.map(u=>n.startsWith("/")&&u===""?"/":u)}function Pz(n){n.sort((t,e)=>t.score!==e.score?e.score-t.score:Xz(t.routesMeta.map(s=>s.childrenIndex),e.routesMeta.map(s=>s.childrenIndex)))}const Vz=/^:[\w-]+$/,Uz=3,Gz=2,Wz=1,Hz=10,jz=-2,K$=n=>n==="*";function qz(n,t){let e=n.split("/"),s=e.length;return e.some(K$)&&(s+=jz),t&&(s+=Gz),e.filter(r=>!K$(r)).reduce((r,a)=>r+(Vz.test(a)?Uz:a===""?Wz:Hz),s)}function Xz(n,t){return n.length===t.length&&n.slice(0,-1).every((s,r)=>s===t[r])?n[n.length-1]-t[t.length-1]:0}function Kz(n,t,e){let{routesMeta:s}=n,r={},a="/",i=[];for(let l=0;l<s.length;++l){let u=s[l],h=l===s.length-1,d=a==="/"?t:t.slice(a.length)||"/",p=Yz({path:u.relativePath,caseSensitive:u.caseSensitive,end:h},d),m=u.route;if(!p)return null;Object.assign(r,p.params),i.push({params:r,pathname:tu([a,p.pathname]),pathnameBase:Jz(tu([a,p.pathnameBase])),route:m}),p.pathnameBase!=="/"&&(a=tu([a,p.pathnameBase]))}return i}function Yz(n,t){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[e,s]=Zz(n.path,n.caseSensitive,n.end),r=t.match(e);if(!r)return null;let a=r[0],i=a.replace(/(.)\/+$/,"$1"),l=r.slice(1);return{params:s.reduce((h,d,p)=>{let{paramName:m,isOptional:y}=d;if(m==="*"){let x=l[p]||"";i=a.slice(0,a.length-x.length).replace(/(.)\/+$/,"$1")}const b=l[p];return y&&!b?h[m]=void 0:h[m]=(b||"").replace(/%2F/g,"/"),h},{}),pathname:a,pathnameBase:i,pattern:n}}function Zz(n,t,e){t===void 0&&(t=!1),e===void 0&&(e=!0),CI(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let s=[],r="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,l,u)=>(s.push({paramName:l,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(s.push({paramName:"*"}),r+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):e?r+="\\/*$":n!==""&&n!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,t?void 0:"i"),s]}function Qz(n){try{return n.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return CI(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),n}}function kI(n,t){if(t==="/")return n;if(!n.toLowerCase().startsWith(t.toLowerCase()))return null;let e=t.endsWith("/")?t.length-1:t.length,s=n.charAt(e);return s&&s!=="/"?null:n.slice(e)||"/"}const tu=n=>n.join("/").replace(/\/\/+/g,"/"),Jz=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/");function tM(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const II=["post","put","patch","delete"];new Set(II);const eM=["get",...II];new Set(eM);/**
 * React Router v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Vp(){return Vp=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(n[s]=e[s])}return n},Vp.apply(this,arguments)}const nM=Et.createContext(null),sM=Et.createContext(null),EI=Et.createContext(null),Tm=Et.createContext(null),$m=Et.createContext({outlet:null,matches:[],isDataRoute:!1}),DI=Et.createContext(null);function E1(){return Et.useContext(Tm)!=null}function rM(){return E1()||Rs(!1),Et.useContext(Tm).location}function aM(n,t){return iM(n,t)}function iM(n,t,e,s){E1()||Rs(!1);let{navigator:r,static:a}=Et.useContext(EI),{matches:i}=Et.useContext($m),l=i[i.length-1],u=l?l.params:{};l&&l.pathname;let h=l?l.pathnameBase:"/";l&&l.route;let d=rM(),p;if(t){var m;let S=typeof t=="string"?Nm(t):t;h==="/"||(m=S.pathname)!=null&&m.startsWith(h)||Rs(!1),p=S}else p=d;let y=p.pathname||"/",b=y;if(h!=="/"){let S=h.replace(/^\//,"").split("/");b="/"+y.replace(/^\//,"").split("/").slice(S.length).join("/")}let x=Mz(n,{pathname:b}),v=hM(x&&x.map(S=>Object.assign({},S,{params:Object.assign({},u,S.params),pathname:tu([h,r.encodeLocation?r.encodeLocation(S.pathname).pathname:S.pathname]),pathnameBase:S.pathnameBase==="/"?h:tu([h,r.encodeLocation?r.encodeLocation(S.pathnameBase).pathname:S.pathnameBase])})),i,e,s);return t&&v?Et.createElement(Tm.Provider,{value:{location:Vp({pathname:"/",search:"",hash:"",state:null,key:"default"},p),navigationType:xi.Pop}},v):v}function oM(){let n=mM(),t=tM(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),e=n instanceof Error?n.stack:null,r={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return Et.createElement(Et.Fragment,null,Et.createElement("h2",null,"Unexpected Application Error!"),Et.createElement("h3",{style:{fontStyle:"italic"}},t),e?Et.createElement("pre",{style:r},e):null,null)}const lM=Et.createElement(oM,null);class uM extends Et.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){console.error("React Router caught the following error during render",t,e)}render(){return this.state.error!==void 0?Et.createElement($m.Provider,{value:this.props.routeContext},Et.createElement(DI.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function cM(n){let{routeContext:t,match:e,children:s}=n,r=Et.useContext(nM);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),Et.createElement($m.Provider,{value:t},s)}function hM(n,t,e,s){var r;if(t===void 0&&(t=[]),e===void 0&&(e=null),s===void 0&&(s=null),n==null){var a;if(!e)return null;if(e.errors)n=e.matches;else if((a=s)!=null&&a.v7_partialHydration&&t.length===0&&!e.initialized&&e.matches.length>0)n=e.matches;else return null}let i=n,l=(r=e)==null?void 0:r.errors;if(l!=null){let d=i.findIndex(p=>p.route.id&&(l==null?void 0:l[p.route.id])!==void 0);d>=0||Rs(!1),i=i.slice(0,Math.min(i.length,d+1))}let u=!1,h=-1;if(e&&s&&s.v7_partialHydration)for(let d=0;d<i.length;d++){let p=i[d];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(h=d),p.route.id){let{loaderData:m,errors:y}=e,b=p.route.loader&&m[p.route.id]===void 0&&(!y||y[p.route.id]===void 0);if(p.route.lazy||b){u=!0,h>=0?i=i.slice(0,h+1):i=[i[0]];break}}}return i.reduceRight((d,p,m)=>{let y,b=!1,x=null,v=null;e&&(y=l&&p.route.id?l[p.route.id]:void 0,x=p.route.errorElement||lM,u&&(h<0&&m===0?(gM("route-fallback"),b=!0,v=null):h===m&&(b=!0,v=p.route.hydrateFallbackElement||null)));let S=t.concat(i.slice(0,m+1)),C=()=>{let $;return y?$=x:b?$=v:p.route.Component?$=Et.createElement(p.route.Component,null):p.route.element?$=p.route.element:$=d,Et.createElement(cM,{match:p,routeContext:{outlet:d,matches:S,isDataRoute:e!=null},children:$})};return e&&(p.route.ErrorBoundary||p.route.errorElement||m===0)?Et.createElement(uM,{location:e.location,revalidation:e.revalidation,component:x,error:y,children:C(),routeContext:{outlet:null,matches:S,isDataRoute:!0}}):C()},null)}var AI=function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n}(AI||{});function dM(n){let t=Et.useContext(sM);return t||Rs(!1),t}function fM(n){let t=Et.useContext($m);return t||Rs(!1),t}function pM(n){let t=fM(),e=t.matches[t.matches.length-1];return e.route.id||Rs(!1),e.route.id}function mM(){var n;let t=Et.useContext(DI),e=dM(AI.UseRouteError),s=pM();return t!==void 0?t:(n=e.errors)==null?void 0:n[s]}const Y$={};function gM(n,t,e){Y$[n]||(Y$[n]=!0)}function yM(n,t){n==null||n.v7_startTransition,n==null||n.v7_relativeSplatPath}function wx(n){Rs(!1)}function bM(n){let{basename:t="/",children:e=null,location:s,navigationType:r=xi.Pop,navigator:a,static:i=!1,future:l}=n;E1()&&Rs(!1);let u=t.replace(/^\/*/,"/"),h=Et.useMemo(()=>({basename:u,navigator:a,static:i,future:Vp({v7_relativeSplatPath:!1},l)}),[u,l,a,i]);typeof s=="string"&&(s=Nm(s));let{pathname:d="/",search:p="",hash:m="",state:y=null,key:b="default"}=s,x=Et.useMemo(()=>{let v=kI(d,u);return v==null?null:{location:{pathname:v,search:p,hash:m,state:y,key:b},navigationType:r}},[u,d,p,m,y,b,r]);return x==null?null:Et.createElement(EI.Provider,{value:h},Et.createElement(Tm.Provider,{children:e,value:x}))}function xM(n){let{children:t,location:e}=n;return aM(Sx(t),e)}new Promise(()=>{});function Sx(n,t){t===void 0&&(t=[]);let e=[];return Et.Children.forEach(n,(s,r)=>{if(!Et.isValidElement(s))return;let a=[...t,r];if(s.type===Et.Fragment){e.push.apply(e,Sx(s.props.children,a));return}s.type!==wx&&Rs(!1),!s.props.index||!s.props.children||Rs(!1);let i={id:s.props.id||a.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(i.children=Sx(s.props.children,a)),e.push(i)}),e}/**
 * React Router DOM v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const vM="6";try{window.__reactRouterVersion=vM}catch{}const wM="startTransition",Z$=kz[wM];function SM(n){let{basename:t,children:e,future:s,window:r}=n,a=Et.useRef();a.current==null&&(a.current=Fz({window:r,v5Compat:!0}));let i=a.current,[l,u]=Et.useState({action:i.action,location:i.location}),{v7_startTransition:h}=s||{},d=Et.useCallback(p=>{h&&Z$?Z$(()=>u(p)):u(p)},[u,h]);return Et.useLayoutEffect(()=>i.listen(d),[i,d]),Et.useEffect(()=>yM(s),[s]),Et.createElement(bM,{basename:t,children:e,location:l.location,navigationType:l.action,navigator:i,future:s})}var Q$;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(Q$||(Q$={}));var J$;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(J$||(J$={}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CM=1e-7,NM=1e-4;class RI{constructor(t,e){this.backend=t,this.dataMover=e,this.data=new WeakMap,this.dataIdsCount=0}get(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)}set(t,e){this.dataIdsCount++,this.data.set(t,e)}has(t){return this.data.has(t)}delete(t){return this.dataIdsCount--,this.data.delete(t)}numDataIds(){return this.dataIdsCount}}class D1{refCount(t){return Ns("refCount")}incRef(t){return Ns("incRef")}timerAvailable(){return!0}time(t){return Ns("time")}read(t){return Ns("read")}readSync(t){return Ns("readSync")}readToGPU(t,e){return Ns("readToGPU")}numDataIds(){return Ns("numDataIds")}disposeData(t,e){return Ns("disposeData")}write(t,e,s){return Ns("write")}move(t,e,s,r,a){return Ns("move")}createTensorFromGPUData(t,e,s){return Ns("createTensorFromGPUData")}memory(){return Ns("memory")}floatPrecision(){return Ns("floatPrecision")}epsilon(){return this.floatPrecision()===32?CM:NM}dispose(){return Ns("dispose")}}function Ns(n){throw new Error(`'${n}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TM(n){let t=n.length,e=0;for(;t>0;)e=Math.random()*t|0,t--,Kl(n,t,e)}function _o(n,t,e){return Math.max(n,Math.min(t,e))}function A1(n){return n%2===0?n:n+1}function Kl(n,t,e){const s=n[t];n[t]=n[e],n[e]=s}function $M(n){let t=0;for(let e=0;e<n.length;e++)t+=n[e];return t}function F(n,t){if(!n)throw new Error(typeof t=="string"?t:t())}function Bs(n,t,e=""){F(de(n,t),()=>e+` Shapes ${n} and ${t} must match`)}function Iu(n){F(n!=null,()=>"The input to the tensor constructor must be a non-null value.")}function mt(n){if(n.length===0)return 1;let t=n[0];for(let e=1;e<n.length;e++)t*=n[e];return t}function kM(n,t){if(n===t)return!0;if(n==null||t==null||n.length!==t.length)return!1;for(let e=0;e<n.length;e++)if(n[e]!==null&&t[e]!==null&&n[e]!==t[e])return!1;return!0}function de(n,t){if(n===t)return!0;if(n==null||t==null||n.length!==t.length)return!1;for(let e=0;e<n.length;e++)if(n[e]!==t[e])return!1;return!0}function uu(n){return n%1===0}function Cx(n){const t=Math.ceil(Math.sqrt(n));return[t,Math.ceil(n/t)]}function eu(n,t){return t<=n.length?n:n+" ".repeat(t-n.length)}function t2(n,t=r=>0,e,s){return new Promise((r,a)=>{let i=0;const l=()=>{if(n()){r();return}i++;const u=t(i);if(e!=null&&i>=e){a();return}s!=null?s(l,u):setTimeout(l,u)};l()})}function OI(n,t){let e=1,s=-1;for(let a=0;a<n.length;++a)if(n[a]>=0)e*=n[a];else if(n[a]===-1){if(s!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${s} and dim ${a}`);s=a}else if(n[a]<0)throw Error(`Shapes can not be < 0. Found ${n[a]} at dim ${a}`);if(s===-1){if(t>0&&t!==e)throw Error(`Size(${t}) must match the product of shape ${n}`);return n}if(e===0)throw Error(`Cannot infer the missing size in [${n}] when there are 0 elements`);if(t%e!==0)throw Error(`The implicit shape can't be a fractional number. Got ${t} / ${e}`);const r=n.slice();return r[s]=t/e,r}function re(n,t){const e=t.length;return n=n==null?t.map((s,r)=>r):[].concat(n),F(n.every(s=>s>=-e&&s<e),()=>`All values in axis param must be in range [-${e}, ${e}) but got axis ${n}`),F(n.every(s=>uu(s)),()=>`All values in axis param must be integers but got axis ${n}`),n.map(s=>s<0?e+s:s)}function Bi(n,t){const e=[],s=[],r=t!=null&&Array.isArray(t)&&t.length===0,a=t==null||r?null:re(t,n).sort();let i=0;for(let l=0;l<n.length;++l){if(a!=null){if(a[i]===l&&n[l]!==1)throw new Error(`Can't squeeze axis ${l} since its dim '${n[l]}' is not 1`);(a[i]==null||a[i]>l)&&n[l]===1&&(e.push(n[l]),s.push(l)),a[i]<=l&&i++}n[l]!==1&&(e.push(n[l]),s.push(l))}return{newShape:e,keptDims:s}}function Gn(n,t){return an(n,t)}function an(n,t){let e=null;if(n==null||n==="float32")e=new Float32Array(t);else if(n==="int32")e=new Int32Array(t);else if(n==="bool")e=new Uint8Array(t);else if(n==="string")e=new Array(t);else throw new Error(`Unknown data type ${n}`);return e}function IM(n,t){for(let e=0;e<n.length;e++){const s=n[e];if(isNaN(s)||!isFinite(s))throw Error(`A tensor of type ${t} being uploaded contains ${s}.`)}}function EM(n){return n==="bool"||n==="complex64"||n==="float32"||n==="int32"||n==="string"}function _I(n,t){return!(t==="complex64"||t==="float32"&&n!=="complex64"||t==="int32"&&n!=="float32"&&n!=="complex64"||t==="bool"&&n==="bool")}function Up(n){if(n==="float32"||n==="int32")return 4;if(n==="complex64")return 8;if(n==="bool")return 1;throw new Error(`Unknown dtype ${n}`)}function DM(n){if(n==null)return 0;let t=0;return n.forEach(e=>t+=e.length),t}function Ch(n){return typeof n=="string"||n instanceof String}function AM(n){return typeof n=="boolean"}function Nx(n){return typeof n=="number"}function Eu(n){return Array.isArray(n)?Eu(n[0]):n instanceof Float32Array?"float32":n instanceof Int32Array||n instanceof Uint8Array||n instanceof Uint8ClampedArray?"int32":Nx(n)?"float32":Ch(n)?"string":AM(n)?"bool":"float32"}function Tx(n){return!!(n&&n.constructor&&n.call&&n.apply)}function $x(n,t){for(let e=t;e<n;++e)if(n%e===0)return e;return n}function Bt(n){const t=n.length;if(t<2)return[];const e=new Array(t-1);e[t-2]=n[t-1];for(let s=t-3;s>=0;--s)e[s]=e[s+1]*n[s+1];return e}function FI(n,t,e,s=!1){const r=new Array;if(t.length===1){const a=t[0]*(s?2:1);for(let i=0;i<a;i++)r[i]=e[n+i]}else{const a=t[0],i=t.slice(1),l=i.reduce((u,h)=>u*h)*(s?2:1);for(let u=0;u<a;u++)r[u]=FI(n+u*l,i,e,s)}return r}function xr(n,t,e=!1){if(n.length===0)return t[0];const s=n.reduce((r,a)=>r*a)*(e?2:1);if(s===0)return[];if(s!==t.length)throw new Error(`[${n}] does not match the input size ${t.length}${e?" for a complex tensor":""}.`);return FI(0,n,t,e)}function RM(n,t){if(Array.isArray(n))return n;if(t==="float32")return n instanceof Float32Array?n:new Float32Array(n);if(t==="int32")return n instanceof Int32Array?n:new Int32Array(n);if(t==="bool"||t==="string")return Uint8Array.from(new Int32Array(n));throw new Error(`Unknown dtype ${t}`)}function R1(n,t){const e=ts(n,t);for(let s=0;s<e.length;s++)e[s]=1;return e}function ts(n,t){if(t==null||t==="float32"||t==="complex64")return new Float32Array(n);if(t==="int32")return new Int32Array(n);if(t==="bool")return new Uint8Array(n);throw new Error(`Unknown data type ${t}`)}function LI(n,t){const e=n.reduce((s,r)=>s*r,1);if(t==null||t==="float32")return xr(n,new Float32Array(e));if(t==="int32")return xr(n,new Int32Array(e));if(t==="bool")return xr(n,new Uint8Array(e));throw new Error(`Unknown data type ${t}`)}function tr(n){n.forEach(t=>{F(Number.isInteger(t)&&t>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${n}].`)})}function sa(n,t,e){if(t===0)return 0;if(t===1)return n[0];let s=n[n.length-1];for(let r=0;r<n.length-1;++r)s+=e[r]*n[r];return s}function Du(n,t,e){if(t===0)return[];if(t===1)return[n];const s=new Array(t);for(let r=0;r<s.length-1;++r)s[r]=Math.floor(n/e[r]),n-=s[r]*e[r];return s[s.length-1]=n,s}function Fo(n){return n&&n.then&&typeof n.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e2="tfjsflags";class OM{constructor(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=_M,this.populateURLFlags()}setPlatform(t,e){this.platform!=null&&(ut().getBool("IS_TEST")||ut().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${t}.`)),this.platformName=t,this.platform=e}registerFlag(t,e,s){if(this.flagRegistry[t]={evaluationFn:e,setHook:s},this.urlFlags[t]!=null){const r=this.urlFlags[t];ut().getBool("IS_TEST")||ut().getBool("PROD")||console.warn(`Setting feature override from URL ${t}: ${r}.`),this.set(t,r)}}async getAsync(t){return t in this.flags?this.flags[t]:(this.flags[t]=await this.evaluateFlag(t),this.flags[t])}get(t){if(t in this.flags)return this.flags[t];const e=this.evaluateFlag(t);if(Fo(e))throw new Error(`Flag ${t} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[t]=e,this.flags[t]}getNumber(t){return this.get(t)}getBool(t){return this.get(t)}getString(t){return this.get(t)}getFlags(){return this.flags}get features(){return this.flags}set(t,e){if(this.flagRegistry[t]==null)throw new Error(`Cannot set flag ${t} as it has not been registered.`);this.flags[t]=e,this.flagRegistry[t].setHook!=null&&this.flagRegistry[t].setHook(e)}evaluateFlag(t){if(this.flagRegistry[t]==null)throw new Error(`Cannot evaluate flag '${t}': no evaluation function found.`);return this.flagRegistry[t].evaluationFn()}setFlags(t){this.flags=Object.assign({},t)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const t=this.getQueryParams(this.global.location.search);e2 in t&&t[e2].split(",").forEach(s=>{const[r,a]=s.split(":");this.urlFlags[r]=LM(r,a)})}}function _M(n){const t={};return n.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(e,...s)=>(FM(t,s[0],s[1]),s.join("="))),t}function FM(n,t,e){n[decodeURIComponent(t)]=decodeURIComponent(e||"")}function LM(n,t){const e=t.toLowerCase();return e==="true"||e==="false"?e==="true":`${+e}`===e?+e:t}function ut(){return zI}let zI=null;function zM(n){zI=n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Gb;function MI(){if(Gb==null){let n;if(typeof window<"u")n=window;else if(typeof global<"u")n=global;else if(typeof process<"u")n=process;else if(typeof self<"u")n=self;else throw new Error("Could not find a global object");Gb=n}return Gb}function MM(){const n=MI();return n._tfGlobals==null&&(n._tfGlobals=new Map),n._tfGlobals}function O1(n,t){const e=MM();if(e.has(n))return e.get(n);{const s=t();return e.set(n,s),e.get(n)}}const km="Abs",Nh="Acos",Th="Acosh",Au="Add",Im="AddN",_1="All",F1="Any",Em="ArgMax",Dm="ArgMin",$h="Asin",kh="Asinh",Ih="Atan",Eh="Atanh",Dh="Atan2",Am="AvgPool",L1="AvgPoolGrad",Rm="AvgPool3D",z1="AvgPool3DGrad",Om="BatchMatMul",_m="BatchToSpaceND",M1="Bincount",Fm="BitwiseAnd",BM="BroadcastTo",B1="BroadcastArgs",Ah="Cast",Rh="Ceil",Oh="ClipByValue",P1="Complex",Lm="ComplexAbs",zm="Concat",Mm="Conv2D",V1="Conv2DBackpropFilter",Bm="Conv2DBackpropInput",Pm="Conv3D",U1="Conv3DBackpropFilterV2",G1="Conv3DBackpropInputV2",_h="Cos",Fh="Cosh",W1="Cumprod",Vm="Cumsum",H1="CropAndResize",j1="DenseBincount",q1="DepthToSpace",Um="DepthwiseConv2dNative",X1="DepthwiseConv2dNativeBackpropFilter",K1="DepthwiseConv2dNativeBackpropInput",Y1="Diag",Gm="Dilation2D",kx="Dilation2DBackpropInput",Ix="Dilation2DBackpropFilter",PM="Draw",Lh="RealDiv",Z1="Einsum",zh="Elu",Q1="EluGrad",Mh="Erf",Wm="Equal",Bh="Exp",Hm="ExpandDims",Ph="Expm1",J1="FFT",tv="Fill",ev="FlipLeftRight",Vh="Floor",Uh="FloorDiv",jm="FusedBatchNorm",qm="GatherV2",nv="GatherNd",Xm="Greater",Gh="GreaterEqual",Wh="Identity",sv="IFFT",rv="Imag",Hh="IsFinite",jh="IsInf",qh="IsNan",Km="LeakyRelu",Ym="Less",Zm="LessEqual",av="LinSpace",Xh="Log",Kh="Log1p",Qm="LogicalAnd",Jm="LogicalNot",tg="LogicalOr",VM="LogSoftmax",eg="LRN",iv="LRNGrad",ng="Max",Yh="Maximum",sg="MaxPool",ov="MaxPoolGrad",rg="MaxPool3D",lv="MaxPool3DGrad",uv="MaxPoolWithArgmax",ag="Mean",ig="Min",Zh="Minimum",og="MirrorPad",Qh="Mod",cv="Multinomial",Jh="Multiply",lg="Neg",ug="NotEqual",hv="NonMaxSuppressionV3",dv="NonMaxSuppressionV4",fv="NonMaxSuppressionV5",cg="OnesLike",hg="OneHot",dg="Pack",fg="PadV2",td="Pow",pg="Prelu",mg="Prod",pv="RaggedGather",mv="RaggedRange",gv="RaggedTensorToTensor",yv="Range",bv="Real",ed="Reciprocal",nd="Relu",gg="Reshape",yg="ResizeNearestNeighbor",xv="ResizeNearestNeighborGrad",bg="ResizeBilinear",vv="ResizeBilinearGrad",sd="Relu6",xg="Reverse",rd="Round",ad="Rsqrt",wv="ScatterNd",Sv="TensorScatterUpdate",Cv="SearchSorted",vg="Select",id="Selu",wg="Slice",od="Sin",ld="Sinh",ud="Sign",cd="Sigmoid",hd="Softplus",dd="Sqrt",Sg="Sum",Cg="SpaceToBatchND",Ng="SplitV",Tg="Softmax",Nv="SparseFillEmptyRows",Tv="SparseReshape",$v="SparseSegmentMean",kv="SparseSegmentSum",Iv="SparseToDense",fd="SquaredDifference",Ev="Square",$g="StaticRegexReplace",Dv="StridedSlice",Av="StringNGrams",Rv="StringSplit",Ov="StringToHashBucketFast",pd="Sub",md="Tan",gd="Tanh",yd="Tile",_v="TopK",Fv="Transform",nu="Transpose",Lv="Unique",kg="Unpack",Ig="UnsortedSegmentSum",Eg="ZerosLike",bd="Step",Ex="FromPixels",zv="RotateWithOffset",Gp="_FusedMatMul",Wp="FusedConv2D",Hp="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ys(...n){ut().getBool("IS_TEST")||ut().getBool("PROD")||console.warn(...n)}function UM(...n){ut().getBool("IS_TEST")||ut().getBool("PROD")||console.log(...n)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jp=O1("kernelRegistry",()=>new Map),Dx=O1("gradRegistry",()=>new Map);function Ax(n,t){const e=PI(n,t);return jp.get(e)}function n2(n){return Dx.get(n)}function s2(n){const t=jp.entries(),e=[];for(;;){const{done:s,value:r}=t.next();if(s)break;const[a,i]=r,[l]=a.split("_");l===n&&e.push(i)}return e}function BI(n){const{kernelName:t,backendName:e}=n,s=PI(t,e);jp.has(s)&&Ys(`The kernel '${t}' for backend '${e}' is already registered`),jp.set(s,n)}function GM(n){const{kernelName:t}=n;Dx.has(t)&&ut().getBool("DEBUG")&&Ys(`Overriding the gradient for '${t}'`),Dx.set(t,n)}function PI(n,t){return`${t}_${n}`}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VI(n){return n instanceof Float32Array||n instanceof Int32Array||n instanceof Uint8Array||n instanceof Uint8ClampedArray}var Wb,r2;function WM(){if(r2)return Wb;r2=1,Wb=t;var n=null;try{n=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function t(M,D,W){this.low=M|0,this.high=D|0,this.unsigned=!!W}t.prototype.__isLong__,Object.defineProperty(t.prototype,"__isLong__",{value:!0});function e(M){return(M&&M.__isLong__)===!0}t.isLong=e;var s={},r={};function a(M,D){var W,et,nt;return D?(M>>>=0,(nt=0<=M&&M<256)&&(et=r[M],et)?et:(W=l(M,(M|0)<0?-1:0,!0),nt&&(r[M]=W),W)):(M|=0,(nt=-128<=M&&M<128)&&(et=s[M],et)?et:(W=l(M,M<0?-1:0,!1),nt&&(s[M]=W),W))}t.fromInt=a;function i(M,D){if(isNaN(M))return D?C:S;if(D){if(M<0)return C;if(M>=b)return R}else{if(M<=-9223372036854776e3)return L;if(M+1>=x)return A}return M<0?i(-M,D).neg():l(M%y|0,M/y|0,D)}t.fromNumber=i;function l(M,D,W){return new t(M,D,W)}t.fromBits=l;var u=Math.pow;function h(M,D,W){if(M.length===0)throw Error("empty string");if(M==="NaN"||M==="Infinity"||M==="+Infinity"||M==="-Infinity")return S;if(typeof D=="number"?(W=D,D=!1):D=!!D,W=W||10,W<2||36<W)throw RangeError("radix");var et;if((et=M.indexOf("-"))>0)throw Error("interior hyphen");if(et===0)return h(M.substring(1),D,W).neg();for(var nt=i(u(W,8)),tt=S,U=0;U<M.length;U+=8){var Y=Math.min(8,M.length-U),Z=parseInt(M.substring(U,U+Y),W);if(Y<8){var G=i(u(W,Y));tt=tt.mul(G).add(i(Z))}else tt=tt.mul(nt),tt=tt.add(i(Z))}return tt.unsigned=D,tt}t.fromString=h;function d(M,D){return typeof M=="number"?i(M,D):typeof M=="string"?h(M,D):l(M.low,M.high,typeof D=="boolean"?D:M.unsigned)}t.fromValue=d;var p=65536,m=1<<24,y=p*p,b=y*y,x=b/2,v=a(m),S=a(0);t.ZERO=S;var C=a(0,!0);t.UZERO=C;var $=a(1);t.ONE=$;var T=a(1,!0);t.UONE=T;var I=a(-1);t.NEG_ONE=I;var A=l(-1,2147483647,!1);t.MAX_VALUE=A;var R=l(-1,-1,!0);t.MAX_UNSIGNED_VALUE=R;var L=l(0,-2147483648,!1);t.MIN_VALUE=L;var _=t.prototype;return _.toInt=function(){return this.unsigned?this.low>>>0:this.low},_.toNumber=function(){return this.unsigned?(this.high>>>0)*y+(this.low>>>0):this.high*y+(this.low>>>0)},_.toString=function(D){if(D=D||10,D<2||36<D)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(L)){var W=i(D),et=this.div(W),nt=et.mul(W).sub(this);return et.toString(D)+nt.toInt().toString(D)}else return"-"+this.neg().toString(D);for(var tt=i(u(D,6),this.unsigned),U=this,Y="";;){var Z=U.div(tt),G=U.sub(Z.mul(tt)).toInt()>>>0,O=G.toString(D);if(U=Z,U.isZero())return O+Y;for(;O.length<6;)O="0"+O;Y=""+O+Y}},_.getHighBits=function(){return this.high},_.getHighBitsUnsigned=function(){return this.high>>>0},_.getLowBits=function(){return this.low},_.getLowBitsUnsigned=function(){return this.low>>>0},_.getNumBitsAbs=function(){if(this.isNegative())return this.eq(L)?64:this.neg().getNumBitsAbs();for(var D=this.high!=0?this.high:this.low,W=31;W>0&&(D&1<<W)==0;W--);return this.high!=0?W+33:W+1},_.isZero=function(){return this.high===0&&this.low===0},_.eqz=_.isZero,_.isNegative=function(){return!this.unsigned&&this.high<0},_.isPositive=function(){return this.unsigned||this.high>=0},_.isOdd=function(){return(this.low&1)===1},_.isEven=function(){return(this.low&1)===0},_.equals=function(D){return e(D)||(D=d(D)),this.unsigned!==D.unsigned&&this.high>>>31===1&&D.high>>>31===1?!1:this.high===D.high&&this.low===D.low},_.eq=_.equals,_.notEquals=function(D){return!this.eq(D)},_.neq=_.notEquals,_.ne=_.notEquals,_.lessThan=function(D){return this.comp(D)<0},_.lt=_.lessThan,_.lessThanOrEqual=function(D){return this.comp(D)<=0},_.lte=_.lessThanOrEqual,_.le=_.lessThanOrEqual,_.greaterThan=function(D){return this.comp(D)>0},_.gt=_.greaterThan,_.greaterThanOrEqual=function(D){return this.comp(D)>=0},_.gte=_.greaterThanOrEqual,_.ge=_.greaterThanOrEqual,_.compare=function(D){if(e(D)||(D=d(D)),this.eq(D))return 0;var W=this.isNegative(),et=D.isNegative();return W&&!et?-1:!W&&et?1:this.unsigned?D.high>>>0>this.high>>>0||D.high===this.high&&D.low>>>0>this.low>>>0?-1:1:this.sub(D).isNegative()?-1:1},_.comp=_.compare,_.negate=function(){return!this.unsigned&&this.eq(L)?L:this.not().add($)},_.neg=_.negate,_.add=function(D){e(D)||(D=d(D));var W=this.high>>>16,et=this.high&65535,nt=this.low>>>16,tt=this.low&65535,U=D.high>>>16,Y=D.high&65535,Z=D.low>>>16,G=D.low&65535,O=0,V=0,P=0,H=0;return H+=tt+G,P+=H>>>16,H&=65535,P+=nt+Z,V+=P>>>16,P&=65535,V+=et+Y,O+=V>>>16,V&=65535,O+=W+U,O&=65535,l(P<<16|H,O<<16|V,this.unsigned)},_.subtract=function(D){return e(D)||(D=d(D)),this.add(D.neg())},_.sub=_.subtract,_.multiply=function(D){if(this.isZero())return S;if(e(D)||(D=d(D)),n){var W=n.mul(this.low,this.high,D.low,D.high);return l(W,n.get_high(),this.unsigned)}if(D.isZero())return S;if(this.eq(L))return D.isOdd()?L:S;if(D.eq(L))return this.isOdd()?L:S;if(this.isNegative())return D.isNegative()?this.neg().mul(D.neg()):this.neg().mul(D).neg();if(D.isNegative())return this.mul(D.neg()).neg();if(this.lt(v)&&D.lt(v))return i(this.toNumber()*D.toNumber(),this.unsigned);var et=this.high>>>16,nt=this.high&65535,tt=this.low>>>16,U=this.low&65535,Y=D.high>>>16,Z=D.high&65535,G=D.low>>>16,O=D.low&65535,V=0,P=0,H=0,Q=0;return Q+=U*O,H+=Q>>>16,Q&=65535,H+=tt*O,P+=H>>>16,H&=65535,H+=U*G,P+=H>>>16,H&=65535,P+=nt*O,V+=P>>>16,P&=65535,P+=tt*G,V+=P>>>16,P&=65535,P+=U*Z,V+=P>>>16,P&=65535,V+=et*O+nt*G+tt*Z+U*Y,V&=65535,l(H<<16|Q,V<<16|P,this.unsigned)},_.mul=_.multiply,_.divide=function(D){if(e(D)||(D=d(D)),D.isZero())throw Error("division by zero");if(n){if(!this.unsigned&&this.high===-2147483648&&D.low===-1&&D.high===-1)return this;var W=(this.unsigned?n.div_u:n.div_s)(this.low,this.high,D.low,D.high);return l(W,n.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?C:S;var et,nt,tt;if(this.unsigned){if(D.unsigned||(D=D.toUnsigned()),D.gt(this))return C;if(D.gt(this.shru(1)))return T;tt=C}else{if(this.eq(L)){if(D.eq($)||D.eq(I))return L;if(D.eq(L))return $;var U=this.shr(1);return et=U.div(D).shl(1),et.eq(S)?D.isNegative()?$:I:(nt=this.sub(D.mul(et)),tt=et.add(nt.div(D)),tt)}else if(D.eq(L))return this.unsigned?C:S;if(this.isNegative())return D.isNegative()?this.neg().div(D.neg()):this.neg().div(D).neg();if(D.isNegative())return this.div(D.neg()).neg();tt=S}for(nt=this;nt.gte(D);){et=Math.max(1,Math.floor(nt.toNumber()/D.toNumber()));for(var Y=Math.ceil(Math.log(et)/Math.LN2),Z=Y<=48?1:u(2,Y-48),G=i(et),O=G.mul(D);O.isNegative()||O.gt(nt);)et-=Z,G=i(et,this.unsigned),O=G.mul(D);G.isZero()&&(G=$),tt=tt.add(G),nt=nt.sub(O)}return tt},_.div=_.divide,_.modulo=function(D){if(e(D)||(D=d(D)),n){var W=(this.unsigned?n.rem_u:n.rem_s)(this.low,this.high,D.low,D.high);return l(W,n.get_high(),this.unsigned)}return this.sub(this.div(D).mul(D))},_.mod=_.modulo,_.rem=_.modulo,_.not=function(){return l(~this.low,~this.high,this.unsigned)},_.and=function(D){return e(D)||(D=d(D)),l(this.low&D.low,this.high&D.high,this.unsigned)},_.or=function(D){return e(D)||(D=d(D)),l(this.low|D.low,this.high|D.high,this.unsigned)},_.xor=function(D){return e(D)||(D=d(D)),l(this.low^D.low,this.high^D.high,this.unsigned)},_.shiftLeft=function(D){return e(D)&&(D=D.toInt()),(D&=63)===0?this:D<32?l(this.low<<D,this.high<<D|this.low>>>32-D,this.unsigned):l(0,this.low<<D-32,this.unsigned)},_.shl=_.shiftLeft,_.shiftRight=function(D){return e(D)&&(D=D.toInt()),(D&=63)===0?this:D<32?l(this.low>>>D|this.high<<32-D,this.high>>D,this.unsigned):l(this.high>>D-32,this.high>=0?0:-1,this.unsigned)},_.shr=_.shiftRight,_.shiftRightUnsigned=function(D){if(e(D)&&(D=D.toInt()),D&=63,D===0)return this;var W=this.high;if(D<32){var et=this.low;return l(et>>>D|W<<32-D,W>>>D,this.unsigned)}else return D===32?l(W,0,this.unsigned):l(W>>>D-32,0,this.unsigned)},_.shru=_.shiftRightUnsigned,_.shr_u=_.shiftRightUnsigned,_.toSigned=function(){return this.unsigned?l(this.low,this.high,!1):this},_.toUnsigned=function(){return this.unsigned?this:l(this.low,this.high,!0)},_.toBytes=function(D){return D?this.toBytesLE():this.toBytesBE()},_.toBytesLE=function(){var D=this.high,W=this.low;return[W&255,W>>>8&255,W>>>16&255,W>>>24,D&255,D>>>8&255,D>>>16&255,D>>>24]},_.toBytesBE=function(){var D=this.high,W=this.low;return[D>>>24,D>>>16&255,D>>>8&255,D&255,W>>>24,W>>>16&255,W>>>8&255,W&255]},t.fromBytes=function(D,W,et){return et?t.fromBytesLE(D,W):t.fromBytesBE(D,W)},t.fromBytesLE=function(D,W){return new t(D[0]|D[1]<<8|D[2]<<16|D[3]<<24,D[4]|D[5]<<8|D[6]<<16|D[7]<<24,W)},t.fromBytesBE=function(D,W){return new t(D[4]<<24|D[5]<<16|D[6]<<8|D[7],D[0]<<24|D[1]<<16|D[2]<<8|D[3],W)},Wb}var UI=WM();const GI=Sm(UI),HM=wI({__proto__:null,default:GI},[UI]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vo=GI||HM;function Dg(n){return vo.fromString(n,!0,16)}const WI=Dg("c3a5c85c97cb3127"),bo=Dg("b492b66fbe98f273"),ls=Dg("9ae16a3b2f90404f");function Rx(n){return n.xor(n.shru(47))}function HI(n,t,e){const s=n.slice(t,t+e);return vo.fromBytes(Array.from(s),!0,!0)}function Fe(n,t){return HI(n,t,8)}function a2(n,t){return HI(n,t,4)}function Dn(n,t){return t===0?n:n.shru(t).or(n.shl(64-t))}function Ci(n,t,e=Dg("9ddfea08eb382d69")){let s=n.xor(t).mul(e);s=s.xor(s.shru(47));let r=t.xor(s).mul(e);return r=r.xor(r.shru(47)),r=r.mul(e),r}function jM(n,t,e,s,r,a){r=r.add(n),a=Dn(a.add(r).add(s),21);const i=r;return r=r.add(t),r=r.add(e),a=a.add(Dn(r,44)),[r.add(s),a.add(i)]}function rp(n,t,e,s){return jM(Fe(n,t),Fe(n,t+8),Fe(n,t+16),Fe(n,t+24),e,s)}function qM(n,t=n.length){if(t>=8){const e=ls.add(t*2),s=Fe(n,0).add(ls),r=Fe(n,t-8),a=Dn(r,37).mul(e).add(s),i=Dn(s,25).add(r).mul(e);return Ci(a,i,e)}if(t>=4){const e=ls.add(t*2),s=a2(n,0);return Ci(s.shl(3).add(t),a2(n,t-4),e)}if(t>0){const e=n[0],s=n[t>>1],r=n[t-1],a=e+(s<<8),i=t+(r<<2);return Rx(ls.mul(a).xor(WI.mul(i))).mul(ls)}return ls}function XM(n,t=n.length){const e=ls.add(t*2),s=Fe(n,0).mul(bo),r=Fe(n,8),a=Fe(n,t-8).mul(e),i=Fe(n,t-16).mul(ls);return Ci(Dn(s.add(r),43).add(Dn(a,30)).add(i),s.add(Dn(r.add(ls),18)).add(a),e)}function KM(n,t=n.length){const e=ls.add(t*2),s=Fe(n,0).mul(ls),r=Fe(n,8),a=Fe(n,t-8).mul(e),i=Fe(n,t-16).mul(ls),l=Dn(s.add(r),43).add(Dn(a,30)).add(i),u=Ci(l,s.add(Dn(r.add(ls),18)).add(a),e),h=Fe(n,16).mul(e),d=Fe(n,24),p=l.add(Fe(n,t-32)).mul(e),m=u.add(Fe(n,t-24)).mul(e);return Ci(Dn(h.add(d),43).add(Dn(p,30)).add(m),h.add(Dn(d.add(s),18)).add(p),e)}function YM(n,t=n.length){const e=vo.fromNumber(81,!0);if(t<=32)return t<=16?qM(n,t):XM(n,t);if(t<=64)return KM(n,t);let s=e,r=e.mul(bo).add(113),a=Rx(r.mul(ls).add(113)).mul(ls),i=[vo.UZERO,vo.UZERO],l=[vo.UZERO,vo.UZERO];s=s.mul(ls).add(Fe(n,0));let u=0;const h=(t-1>>6)*64,d=h+(t-1&63)-63;do s=Dn(s.add(r).add(i[0]).add(Fe(n,u+8)),37).mul(bo),r=Dn(r.add(i[1]).add(Fe(n,u+48)),42).mul(bo),s=s.xor(l[1]),r=r.add(i[0]).add(Fe(n,u+40)),a=Dn(a.add(l[0]),33).mul(bo),i=rp(n,u,i[1].mul(bo),s.add(l[0])),l=rp(n,u+32,a.add(l[1]),r.add(Fe(n,u+16))),[a,s]=[s,a],u+=64;while(u!==h);const p=bo.add(a.and(255).shl(1));return u=d,l[0]=l[0].add(t-1&63),i[0]=i[0].add(l[0]),l[0]=l[0].add(i[0]),s=Dn(s.add(r).add(i[0]).add(Fe(n,u+8)),37).mul(p),r=Dn(r.add(i[1]).add(Fe(n,u+48)),42).mul(p),s=s.xor(l[1].mul(9)),r=r.add(i[0].mul(9).add(Fe(n,u+40))),a=Dn(a.add(l[0]),33).mul(p),i=rp(n,u,i[1].mul(p),s.add(l[0])),l=rp(n,u+32,a.add(l[1]),r.add(Fe(n,u+16))),[a,s]=[s,a],Ci(Ci(i[0],l[0],p).add(Rx(r).mul(WI)).add(a),Ci(i[1],l[1],p).add(s),p)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pi(n,t){return t==="string"?Ni(n):Ko([n],t)}function ZM(n,t){return n instanceof Float32Array&&t==="float32"||n instanceof Int32Array&&t==="int32"||n instanceof Uint8Array&&t==="bool"}function Ko(n,t){if(t==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(n)&&(n=Lo(n)),ut().getBool("DEBUG")&&IM(n,t),ZM(n,t))return n;if(t==null||t==="float32"||t==="complex64")return new Float32Array(n);if(t==="int32")return new Int32Array(n);if(t==="bool"){const e=new Uint8Array(n.length);for(let s=0;s<e.length;++s)Math.round(n[s])!==0&&(e[s]=1);return e}else throw new Error(`Unknown data type ${t}`)}function ps(){return ut().platform.now()}function QM(n,t){return ut().platform.fetch(n,t)}function Ni(n,t="utf-8"){return t=t||"utf-8",ut().platform.encode(n,t)}function ki(n,t="utf-8"){return t=t||"utf-8",ut().platform.decode(n,t)}function wr(n){return ut().platform.isTypedArray!=null?ut().platform.isTypedArray(n):VI(n)}function Lo(n,t=[],e=!1){if(t==null&&(t=[]),typeof n=="boolean"||typeof n=="number"||typeof n=="string"||Fo(n)||n==null||wr(n)&&e)t.push(n);else if(Array.isArray(n)||wr(n))for(let s=0;s<n.length;++s)Lo(n[s],t,e);else{let s=-1;for(const r of Object.keys(n))/^([1-9]+[0-9]*|0)$/.test(r)&&(s=Math.max(s,Number(r)));for(let r=0;r<=s;r++)Lo(n[r],t,e)}return t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class JM{constructor(t,e){this.backendTimer=t,this.logger=e,e==null&&(this.logger=new eB)}profileKernel(t,e,s){let r;const a=()=>{r=s()};let i;const l=ps();if(this.backendTimer.timerAvailable())i=this.backendTimer.time(a);else{a();for(const h of r)h.dataSync();i=Promise.resolve({kernelMs:ps()-l})}if(ut().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let h=0;h<r.length;h++){const d=r[h];d.data().then(p=>{tB(p,d.dtype,t)})}return{kernelName:t,outputs:r,inputs:e,timeMs:i.then(h=>h.kernelMs),extraInfo:i.then(h=>h.getExtraProfileInfo!=null?h.getExtraProfileInfo():"")}}logKernelProfile(t){const{kernelName:e,outputs:s,timeMs:r,inputs:a,extraInfo:i}=t;s.forEach(l=>{Promise.all([l.data(),r,i]).then(u=>{this.logger.logKernelProfile(e,l,u[0],u[1],a,u[2])})})}}function tB(n,t,e){if(t!=="float32")return!1;for(let s=0;s<n.length;s++){const r=n[s];if(isNaN(r)||!isFinite(r))return console.warn(`Found ${r} in the result of '${e}'`),!0}return!1}class eB{logKernelProfile(t,e,s,r,a,i){const l=typeof r=="number"?eu(`${r}ms`,9):r.error,u=eu(t,25),h=e.rank,d=e.size,p=eu(e.shape.toString(),14);let m="";for(const y in a){const b=a[y];if(b!=null){const x=b.shape||e.shape,v=x.length;m+=`${y}: ${v}D ${v>0?x:""} `}}console.log(`%c${u}	%c${l}	%c${h}D ${p}	%c${d}	%c${m}	%c${i}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nB(n,t,e){const s={},r={};for(let u=0;u<t.length;u++)s[t[u].id]=!0;for(let u=0;u<n.length;u++){const h=n[u],d=h.inputs;for(const p in d){const m=d[p];let y=!1;for(let b=0;b<t.length;b++)if(s[m.id]){h.outputs.forEach(x=>s[x.id]=!0),y=!0,r[h.id]=!0;break}if(y)break}}const a={};a[e.id]=!0;const i={};for(let u=n.length-1;u>=0;u--){const h=n[u],d=h.inputs;for(let p=0;p<h.outputs.length;p++)if(a[h.outputs[p].id]){for(const m in d)a[d[m].id]=!0,i[h.id]=!0;break}}const l=[];for(let u=0;u<n.length;u++){const h=n[u];if(r[h.id]&&i[h.id]){const d={};for(const m in h.inputs){const y=h.inputs[m];s[y.id]&&(d[m]=y)}const p=Object.assign({},h);p.inputs=d,p.outputs=h.outputs,l.push(p)}}return l}function sB(n,t,e,s){for(let r=t.length-1;r>=0;r--){const a=t[r],i=[];if(a.outputs.forEach(u=>{const h=n[u.id];h!=null?i.push(h):i.push(null)}),a.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${a.kernelName}.`);const l=a.gradient(i);for(const u in a.inputs){if(!(u in l))throw new Error(`Cannot backprop through input ${u}. Available gradients found: ${Object.keys(l)}.`);const h=e(()=>l[u]());if(h.dtype!=="float32")throw new Error(`Error in gradient for op ${a.kernelName}. The gradient of input ${u} must have 'float32' dtype, but has '${h.dtype}'`);const d=a.inputs[u];if(!de(h.shape,d.shape))throw new Error(`Error in gradient for op ${a.kernelName}. The gradient of input '${u}' has shape '${h.shape}', which does not match the shape of the input '${d.shape}'`);if(n[d.id]==null)n[d.id]=h;else{const p=n[d.id];n[d.id]=s(p,h),p.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i2=20,Xc=3,Hb=7;function rB(n,t,e,s){const r=Bt(t),a=aB(n,t,e,r),i=t.length,l=Sp(n,t,e,r,a),u=["Tensor"];return s&&(u.push(`  dtype: ${e}`),u.push(`  rank: ${i}`),u.push(`  shape: [${t}]`),u.push("  values:")),u.push(l.map(h=>"    "+h).join(`
`)),u.join(`
`)}function aB(n,t,e,s){const r=mt(t),a=s[s.length-1],i=new Array(a).fill(0),l=t.length,u=e==="complex64"?Jc(n):n;if(l>1)for(let h=0;h<r/a;h++){const d=h*a;for(let p=0;p<a;p++)i[p]=Math.max(i[p],Qc(u[d+p],0,e).length)}return i}function Qc(n,t,e){let s;return Array.isArray(n)?s=`${parseFloat(n[0].toFixed(Hb))} + ${parseFloat(n[1].toFixed(Hb))}j`:Ch(n)?s=`'${n}'`:e==="bool"?s=jI(n):s=parseFloat(n.toFixed(Hb)).toString(),eu(s,t)}function jI(n){return n===0?"false":"true"}function Sp(n,t,e,s,r,a=!0){const i=e==="complex64"?2:1,l=t[0],u=t.length;if(u===0){if(e==="complex64"){const x=Jc(n);return[Qc(x[0],0,e)]}return e==="bool"?[jI(n[0])]:[n[0].toString()]}if(u===1){if(l>i2){const v=Xc*i;let S=Array.from(n.slice(0,v)),C=Array.from(n.slice((l-Xc)*i,l*i));return e==="complex64"&&(S=Jc(S),C=Jc(C)),["["+S.map(($,T)=>Qc($,r[T],e)).join(", ")+", ..., "+C.map(($,T)=>Qc($,r[l-Xc+T],e)).join(", ")+"]"]}return["["+(e==="complex64"?Jc(n):Array.from(n)).map((v,S)=>Qc(v,r[S],e)).join(", ")+"]"]}const h=t.slice(1),d=s.slice(1),p=s[0]*i,m=[];if(l>i2){for(let x=0;x<Xc;x++){const v=x*p,S=v+p;m.push(...Sp(n.slice(v,S),h,e,d,r,!1))}m.push("...");for(let x=l-Xc;x<l;x++){const v=x*p,S=v+p;m.push(...Sp(n.slice(v,S),h,e,d,r,x===l-1))}}else for(let x=0;x<l;x++){const v=x*p,S=v+p;m.push(...Sp(n.slice(v,S),h,e,d,r,x===l-1))}const y=u===2?",":"";m[0]="["+(l>0?m[0]+y:"");for(let x=1;x<m.length-1;x++)m[x]=" "+m[x]+y;let b=`,
`;for(let x=2;x<u;x++)b+=`
`;return m[m.length-1]=" "+m[m.length-1]+"]"+(a?"":b),m}function Jc(n){const t=[];for(let e=0;e<n.length;e+=2)t.push([n[e],n[e+1]]);return t}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Cn{constructor(t,e,s){if(this.dtype=e,this.shape=t.slice(),this.size=mt(t),s!=null){const r=s.length;F(r===this.size,()=>`Length of values '${r}' does not match the size inferred by the shape '${this.size}'.`)}if(e==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=s||an(e,this.size),this.strides=Bt(t)}set(t,...e){e.length===0&&(e=[0]),F(e.length===this.rank,()=>`The number of provided coordinates (${e.length}) must match the rank (${this.rank})`);const s=this.locToIndex(e);this.values[s]=t}get(...t){t.length===0&&(t=[0]);let e=0;for(const r of t){if(r<0||r>=this.shape[e]){const a=`Requested out of range element at ${t}.   Buffer shape=${this.shape}`;throw new Error(a)}e++}let s=t[t.length-1];for(let r=0;r<t.length-1;++r)s+=this.strides[r]*t[r];return this.values[s]}locToIndex(t){if(this.rank===0)return 0;if(this.rank===1)return t[0];let e=t[t.length-1];for(let s=0;s<t.length-1;++s)e+=this.strides[s]*t[s];return e}indexToLoc(t){if(this.rank===0)return[];if(this.rank===1)return[t];const e=new Array(this.shape.length);for(let s=0;s<e.length-1;++s)e[s]=Math.floor(t/this.strides[s]),t-=e[s]*this.strides[s];return e[e.length-1]=t,e}get rank(){return this.shape.length}toTensor(){return Rr().makeTensor(this.values,this.shape,this.dtype)}}let Rr=null,Yl=null;function iB(n){Rr=n}function oB(n){Yl=n}class Me{constructor(t,e,s,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=e||"float32",this.size=mt(t),this.strides=Bt(t),this.dataId=s,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const t=await this.data();return Yl.buffer(this.shape,this.dtype,t)}bufferSync(){return Yl.buffer(this.shape,this.dtype,this.dataSync())}async array(){const t=await this.data();return xr(this.shape,t,this.dtype==="complex64")}arraySync(){return xr(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const t=Rr().read(this.dataId);if(this.dtype==="string"){const e=await t;try{return e.map(s=>ki(s))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return t}dataToGPU(t){return this.throwIfDisposed(),Rr().readToGPU(this.dataId,t)}dataSync(){this.throwIfDisposed();const t=Rr().readSync(this.dataId);if(this.dtype==="string")try{return t.map(e=>ki(e))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t}async bytes(){this.throwIfDisposed();const t=await Rr().read(this.dataId);return this.dtype==="string"?t:new Uint8Array(t.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),Rr().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(t=!1){return Yl.print(this,t)}clone(){return this.throwIfDisposed(),Yl.clone(this)}toString(t=!1){const e=this.dataSync();return rB(e,this.shape,this.dtype,t)}cast(t){return this.throwIfDisposed(),Yl.cast(this,t)}variable(t=!0,e,s){return this.throwIfDisposed(),Rr().makeVariable(this,t,e,s)}}Object.defineProperty(Me,Symbol.hasInstance,{value:n=>!!n&&n.data!=null&&n.dataSync!=null&&n.throwIfDisposed!=null});function gt(){return O1("Tensor",()=>Me)}gt();class qp extends Me{constructor(t,e,s,r){super(t.shape,t.dtype,t.dataId,r),this.trainable=e,this.name=s}assign(t){if(t.dtype!==this.dtype)throw new Error(`dtype of the new value (${t.dtype}) and previous value (${this.dtype}) must match`);if(!de(t.shape,this.shape))throw new Error(`shape of the new value (${t.shape}) and previous value (${this.shape}) must match`);Rr().disposeTensor(this),this.dataId=t.dataId,Rr().incRef(this,null)}dispose(){Rr().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(qp,Symbol.hasInstance,{value:n=>n instanceof Me&&n.assign!=null&&n.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var o2;(function(n){n.R0="R0",n.R1="R1",n.R2="R2",n.R3="R3",n.R4="R4",n.R5="R5",n.R6="R6"})(o2||(o2={}));var Ox;(function(n){n.float32="float32",n.int32="int32",n.bool="int32",n.complex64="complex64"})(Ox||(Ox={}));var _x;(function(n){n.float32="float32",n.int32="int32",n.bool="bool",n.complex64="complex64"})(_x||(_x={}));var Fx;(function(n){n.float32="float32",n.int32="float32",n.bool="float32",n.complex64="complex64"})(Fx||(Fx={}));var Lx;(function(n){n.float32="complex64",n.int32="complex64",n.bool="complex64",n.complex64="complex64"})(Lx||(Lx={}));const lB={float32:Fx,int32:Ox,bool:_x,complex64:Lx};function Os(n,t){if(n==="string"||t==="string"){if(n==="string"&&t==="string")return"string";throw new Error(`Can not upcast ${n} with ${t}`)}return lB[n][t]}function Mv(n){return Os(n,"int32")}function qI(n){return n!=null&&typeof n=="object"&&"texture"in n&&n.texture instanceof WebGLTexture}function XI(n){return typeof GPUBuffer<"u"&&n!=null&&typeof n=="object"&&"buffer"in n&&n.buffer instanceof GPUBuffer}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qe(n,t){if(n.dtype===t.dtype)return[n,t];const e=Os(n.dtype,t.dtype);return[n.cast(e),t.cast(e)]}function uB(n,t){F(n.dtype===t.dtype,()=>`The dtypes of the first(${n.dtype}) and second(${t.dtype}) input must match`)}function KI(n){const t=[];return YI(n,t,new Set),t}function YI(n,t,e){if(n==null)return;if(n instanceof Me){t.push(n);return}if(!cB(n))return;const s=n;for(const r in s){const a=s[r];e.has(a)||(e.add(a),YI(a,t,e))}}function cB(n){return Array.isArray(n)||typeof n=="object"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jb(n){return n.kernelName!=null}class l2{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(t=>t.name)))}}}dispose(){for(const t in this.registeredVariables)this.registeredVariables[t].dispose()}}class cu{constructor(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new l2}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const t=this.getSortedBackends();for(let e=0;e<t.length;e++){const s=t[e];if(await this.initializeBackend(s).success){await this.setBackend(s);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:t,asyncInit:e}=this.initializeBackendsAndReturnBest();if(e)throw new Error(`The highest priority backend '${t}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(t)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(t){if(!(t in this.registry))if(t in this.registryFactory){const{asyncInit:e}=this.initializeBackend(t);if(e)return null}else return null;return this.registry[t]}findBackendFactory(t){return t in this.registryFactory?this.registryFactory[t].factory:null}registerBackend(t,e,s=1){return t in this.registryFactory?(Ys(`${t} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[t]={factory:e,priority:s},!0)}async setBackend(t){if(this.registryFactory[t]==null)throw new Error(`Backend name '${t}' not found in registry`);if(this.backendName=t,this.registry[t]==null){this.backendInstance=null;const{success:e,asyncInit:s}=this.initializeBackend(t);if(!(s?await e:e))return!1}return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new JM(this.backendInstance),!0}setupRegisteredKernels(){s2(this.backendName).forEach(e=>{e.setupFunc!=null&&e.setupFunc(this.backendInstance)})}disposeRegisteredKernels(t){s2(t).forEach(s=>{s.disposeFunc!=null&&s.disposeFunc(this.registry[t])})}initializeBackend(t){const e=this.registryFactory[t];if(e==null)throw new Error(`Cannot initialize backend ${t}, no registration found.`);try{const s=e.factory();if(s&&!(s instanceof D1)&&typeof s.then=="function"){const r=++this.pendingBackendInitId,a=s.then(i=>r<this.pendingBackendInitId?!1:(this.registry[t]=i,this.pendingBackendInit=null,!0)).catch(i=>(r<this.pendingBackendInitId||(this.pendingBackendInit=null,Ys(`Initialization of backend ${t} failed`),Ys(i.stack||i.message)),!1));return this.pendingBackendInit=a,{success:a,asyncInit:!0}}else return this.registry[t]=s,{success:!0,asyncInit:!1}}catch(s){return Ys(`Initialization of backend ${t} failed`),Ys(s.stack||s.message),{success:!1,asyncInit:!1}}}removeBackend(t){if(!(t in this.registryFactory))throw new Error(`${t} backend not found in registry`);this.backendName===t&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((t,e)=>this.registryFactory[e].priority-this.registryFactory[t].priority)}initializeBackendsAndReturnBest(){const t=this.getSortedBackends();for(let e=0;e<t.length;e++){const s=t[e],{success:r,asyncInit:a}=this.initializeBackend(s);if(a||r)return{name:s,asyncInit:a}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(t,e){const s=this.state.tensorInfo.get(e),r=s.backend,a=this.readSync(e),i=r.refCount(e);r.disposeData(e,!0),s.backend=t,t.move(e,a,s.shape,s.dtype,i),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(t,e){let s=null;if(e==null){if(typeof t!="function")throw new Error("Please provide a function to tidy()");e=t}else{if(typeof t!="string"&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof e!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");s=t}let r;return this.scopedRun(()=>this.startScope(s),()=>this.endScope(r),()=>(r=e(),r instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r))}scopedRun(t,e,s){t();try{const r=s();return e(),r}catch(r){throw e(),r}}nextTensorId(){return cu.nextTensorId++}nextVariableId(){return cu.nextVariableId++}clone(t){const e=K.runKernel(Wh,{x:t}),s={x:t},r=i=>({x:()=>{const l="float32",u={x:i},h={dtype:l};return K.runKernel(Ah,u,h)}}),a=[];return this.addTapeNode(this.state.activeScope.name,s,[e],r,a,{}),e}runKernel(t,e,s){if(this.backendName==null&&this.backend,!(Ax(t,this.backendName)!=null))throw new Error(`Kernel '${t}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:t,inputs:e,attrs:s})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(t,e,s){const r=this.backend.numDataIds();let a=0;s.forEach(u=>{a+=u.dtype==="complex64"?3:1});const i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],l=r-e-a-i;if(l>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${l} data ids) after running '${t}'`)}runKernelFunc(t){let e,s=[];const r=this.isTapeOn(),a=this.state.numBytes,i=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let l;this.backendName==null&&this.backend;let u;const h=jb(t)?t.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(jb(t)){const{kernelName:b,inputs:x,attrs:v}=t;this.backendName==null&&this.backend;const S=Ax(b,this.backendName);F(S!=null,()=>`Cannot find registered kernel '${b}' for backend '${this.backendName}'`),l=()=>{const C=this.backend.numDataIds();u=S.kernelFunc({inputs:x,attrs:v,backend:this.backend});const $=Array.isArray(u)?u:[u];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(b,C,$);const T=$.map(I=>I.rank!=null?I:this.makeTensorFromTensorInfo(I));if(r){const I=this.getTensorsForGradient(b,x,T);s=this.saveTensorsForBackwardMode(I)}return T}}else{const{forwardFunc:b}=t,x=v=>{r&&(s=v.map(S=>this.keep(this.clone(S))))};l=()=>{const v=this.backend.numDataIds();u=this.tidy(()=>b(this.backend,x));const S=Array.isArray(u)?u:[u];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(h,v,S),S}}const{inputs:d,attrs:p}=t,m=jb(t)?null:t.backwardsFunc;let y;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?e=l():(y=this.profiler.profileKernel(h,d,()=>l()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(y),e=y.outputs)}),r&&this.addTapeNode(h,d,e,m,s,p),this.state.profiling&&this.state.activeProfile.kernels.push({name:h,bytesAdded:this.state.numBytes-a,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-i,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(d).map(b=>d[b]!=null?d[b].shape:null),outputShapes:e.map(b=>b.shape),kernelTimeMs:y.timeMs,extraInfo:y.extraInfo}),Array.isArray(u)?e:e[0]}saveTensorsForBackwardMode(t){return t.map(s=>this.keep(this.clone(s)))}getTensorsForGradient(t,e,s){const r=n2(t);if(r!=null){const a=r.inputsToSave||[],i=r.outputsToSave||[];let l;r.saveAllInputs?(F(Array.isArray(e),()=>"saveAllInputs is true, expected inputs to be an array."),l=Object.keys(e).map(h=>e[h])):l=a.map(h=>e[h]);const u=s.filter((h,d)=>i[d]);return l.concat(u)}return[]}makeTensor(t,e,s,r){if(t==null)throw new Error("Values passed to engine.makeTensor() are null");s=s||"float32",r=r||this.backend;let a=t;s==="string"&&Ch(t[0])&&(a=t.map(u=>Ni(u)));const i=r.write(a,e,s),l=new Me(e,s,i,this.nextTensorId());if(this.trackTensor(l,r),s==="string"){const u=this.state.tensorInfo.get(i),h=DM(a);this.state.numBytes+=h-u.bytes,u.bytes=h}return l}makeTensorFromDataId(t,e,s,r){s=s||"float32";const a={dataId:t,shape:e,dtype:s};return this.makeTensorFromTensorInfo(a,r)}makeTensorFromTensorInfo(t,e){const{dataId:s,shape:r,dtype:a}=t,i=new Me(r,a,s,this.nextTensorId());return this.trackTensor(i,e),i}makeVariable(t,e=!0,s,r){s=s||this.nextVariableId().toString(),r!=null&&r!==t.dtype&&(t=t.cast(r));const a=new qp(t,e,s,this.nextTensorId());if(this.state.registeredVariables[a.name]!=null)throw new Error(`Variable with name ${a.name} was already registered`);return this.state.registeredVariables[a.name]=a,this.incRef(a,this.backend),a}trackTensor(t,e){this.state.numTensors++,t.dtype==="string"&&this.state.numStringTensors++;let s=0;t.dtype!=="complex64"&&t.dtype!=="string"&&(s=t.size*Up(t.dtype)),this.state.numBytes+=s,this.state.tensorInfo.has(t.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(t.dataId,{backend:e||this.backend,dtype:t.dtype,shape:t.shape,bytes:s})),t instanceof qp||this.track(t)}incRef(t,e){this.trackTensor(t,e),this.backend.incRef(t.dataId)}removeDataId(t,e){this.state.tensorInfo.has(t)&&this.state.tensorInfo.get(t).backend===e&&(this.state.tensorInfo.delete(t),this.state.numDataBuffers--)}disposeTensor(t){if(!this.state.tensorInfo.has(t.dataId))return;const e=this.state.tensorInfo.get(t.dataId);if(this.state.numTensors--,t.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=e.bytes),t.dtype!=="complex64"&&t.dtype!=="string"){const s=t.size*Up(t.dtype);this.state.numBytes-=s}e.backend.disposeData(t.dataId)&&this.removeDataId(t.dataId,e.backend)}disposeVariables(){for(const t in this.state.registeredVariables){const e=this.state.registeredVariables[t];this.disposeVariable(e)}}disposeVariable(t){this.disposeTensor(t),this.state.registeredVariables[t.name]!=null&&delete this.state.registeredVariables[t.name]}memory(){const t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,t.reasons==null&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t}async profile(t){this.state.profiling=!0;const e=this.state.numBytes,s=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(r=>r.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-e,this.state.activeProfile.newTensors=this.state.numTensors-s;for(const r of this.state.activeProfile.kernels)r.kernelTimeMs=await r.kernelTimeMs,r.extraInfo=await r.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(t,e,s,r,a,i){const l={id:this.state.nextTapeNodeId++,kernelName:t,inputs:e,outputs:s,saved:a},u=n2(t);u!=null&&(r=u.gradFunc),r!=null&&(l.gradient=h=>(h=h.map((d,p)=>{if(d==null){const m=s[p],y=ts(m.size,m.dtype);return this.makeTensor(y,m.shape,m.dtype)}return d}),r(h.length>1?h:h[0],a,i))),this.state.activeTape.push(l)}keep(t){return t.kept=!0,t}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(t){const e={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(e.name=t),this.state.scopeStack.push(e),this.state.activeScope=e}endScope(t){const e=KI(t),s=new Set(e.map(a=>a.id));for(let a=0;a<this.state.activeScope.track.length;a++){const i=this.state.activeScope.track[a];!i.kept&&!s.has(i.id)&&i.dispose()}const r=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],e.forEach(a=>{!a.kept&&a.scopeId===r.id&&this.track(a)})}gradients(t,e,s,r=!1){if(F(e.length>0,()=>"gradients() received an empty list of xs."),s!=null&&s.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${s.dtype}'`);const a=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",t));F(a instanceof Me,()=>"The result y returned by f() must be a tensor.");const i=nB(this.state.activeTape,e,a);if(!r&&i.length===0&&e.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const l={};l[a.id]=s??hB(a.shape),sB(l,i,h=>this.tidy(h),dB);const u=e.map(h=>l[h.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(h=>{for(const d of h.saved)d.dispose()}),this.state.activeTape=null),{value:a,grads:u}})}customGrad(t){return F(Tx(t),()=>"The f passed in customGrad(f) must be a function."),(...e)=>{F(e.every(l=>l instanceof Me),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let s;const r={};e.forEach((l,u)=>{r[u]=l});const a=(l,u)=>(s=t(...e,u),F(s.value instanceof Me,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),F(Tx(s.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),s.value),i=(l,u)=>{const h=s.gradFunc(l,u),d=Array.isArray(h)?h:[h];F(d.length===e.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),F(d.every(m=>m instanceof Me),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const p={};return d.forEach((m,y)=>{p[y]=()=>m}),p};return this.runKernelFunc({forwardFunc:a,backwardsFunc:i,inputs:r})}}readSync(t){return this.state.tensorInfo.get(t).backend.readSync(t)}read(t){return this.state.tensorInfo.get(t).backend.read(t)}readToGPU(t,e){return this.state.tensorInfo.get(t).backend.readToGPU(t,e)}async time(t){const e=ps(),s=await this.backend.time(t);return s.wallMs=ps()-e,s}track(t){return this.state.activeScope!=null&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new l2;for(const t in this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}cu.nextTensorId=0;cu.nextVariableId=0;function hB(n){const t=R1(mt(n),"float32");return K.makeTensor(t,n,"float32")}function ZI(){const n=MI();if(n._tfengine==null){const t=new OM(n);n._tfengine=new cu(t)}return zM(n._tfengine.ENV),iB(()=>n._tfengine),n._tfengine}const K=ZI();function dB(n,t){const e={a:n,b:t};return K.runKernel(Au,e)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fB(){return typeof navigator<"u"&&navigator!=null}function QI(n){if(n||fB()){if(n||(n=navigator),n.product==="ReactNative")return!0;const t=n.userAgent||n.vendor||(typeof window<"u"?window.opera:"");if(!t){const e=n;return e.userAgentData&&e.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}return!1}function JI(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ys=ut();ys.registerFlag("DEBUG",()=>!1,n=>{n&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});ys.registerFlag("IS_BROWSER",()=>JI());ys.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");ys.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));ys.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));ys.registerFlag("PROD",()=>!1);ys.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>ys.getBool("DEBUG"));ys.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);ys.registerFlag("IS_TEST",()=>!1);ys.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>ys.getBool("DEBUG"));ys.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);ys.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);ys.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vi(n,t){let e=n;if(wr(n))return t==="string"?[]:[n.length];if(qI(n)){const r=n.channels||"RGBA";return[n.height,n.width*r.length]}else if(XI(n))return[n.buffer.size/(t==null?4:Up(t))];if(!Array.isArray(n))return[];const s=[];for(;Array.isArray(e)||wr(e)&&t!=="string";)s.push(e.length),e=e[0];return Array.isArray(n)&&ut().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&tE(n,s,[]),s}function tE(n,t,e){if(e=e||[],!Array.isArray(n)&&!wr(n)){F(t.length===0,()=>`Element arr[${e.join("][")}] is a primitive, but should be an array/TypedArray of ${t[0]} elements`);return}F(t.length>0,()=>`Element arr[${e.join("][")}] should be a primitive, but is an array of ${n.length} elements`),F(n.length===t[0],()=>`Element arr[${e.join("][")}] should have ${t[0]} elements, but has ${n.length} elements`);const s=t.slice(1);for(let r=0;r<n.length;++r)tE(n[r],s,e.concat(r))}function u2(n,t,e,s){if(n!=="string_or_numeric"){if(n==null)throw new Error("Expected dtype cannot be null.");if(n!=="numeric"&&n!==t||n==="numeric"&&t==="string")throw new Error(`Argument '${e}' passed to '${s}' must be ${n} tensor, but got ${t} tensor`)}}function B(n,t,e,s="numeric"){if(n instanceof gt())return u2(s,n.dtype,t,e),n;let r=Eu(n);if(r!=="string"&&["bool","int32","float32"].indexOf(s)>=0&&(r=s),u2(s,r,t,e),n==null||!wr(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string"){const u=n==null?"null":n.constructor.name;throw new Error(`Argument '${t}' passed to '${e}' must be a Tensor or TensorLike, but got '${u}'`)}const a=Vi(n,r);!wr(n)&&!Array.isArray(n)&&(n=[n]);const l=r!=="string"?Ko(n,r):Lo(n,[],!0);return K.makeTensor(l,a,r)}function Xp(n,t,e,s="numeric"){if(!Array.isArray(n))throw new Error(`Argument ${t} passed to ${e} must be a \`Tensor[]\` or \`TensorLike[]\``);return n.map((a,i)=>B(a,`${t}[${i}]`,e,s))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eE="__op";function q(n){const t=Object.keys(n);if(t.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${t.length} keys.`);let e=t[0];const s=n[e];e.endsWith("_")&&(e=e.substring(0,e.length-1)),e=e+eE;const r=(...a)=>{K.startScope(e);try{const i=s(...a);return Fo(i)&&console.error("Cannot return a Promise inside of tidy."),K.endScope(i),i}catch(i){throw K.endScope(null),i}};return Object.defineProperty(r,"name",{value:e,configurable:!0}),r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pB(n,t){const e=B(n,"real","complex"),s=B(t,"imag","complex");Bs(e.shape,s.shape,`real and imag shapes, ${e.shape} and ${s.shape}, must match in call to tf.complex().`);const r={real:e,imag:s};return K.runKernel(P1,r)}const Ii=q({complex_:pB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ui(n,t,e,s){if(s==null)s=Eu(n);else if(s==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(XI(n)||qI(n)){if(s!=="float32"&&s!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${s}.`);return K.backend.createTensorFromGPUData(n,t||e,s)}if(!wr(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(t!=null){tr(t);const r=mt(t),a=mt(e);F(r===a,()=>`Based on the provided shape, [${t}], the tensor should have ${r} values but has ${a}`);for(let i=0;i<e.length;++i){const l=e[i],u=i===e.length-1?l!==mt(t.slice(i)):!0;F(e[i]===t[i]||!u,()=>`Error creating a new Tensor. Inferred shape (${e}) does not match the provided shape (${t}). `)}}return!wr(n)&&!Array.isArray(n)&&(n=[n]),t=t||e,n=s!=="string"?Ko(n,s):Lo(n,[],!0),K.makeTensor(n,t,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _r(n,t,e){const s=Vi(n,e);return Ui(n,t,s,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zo={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};class Ur{static join(t){return new Ur(t).slice()}constructor(t){if(this.shards=[],this.previousShardIndex=0,t==null||(t instanceof Array||(t=[t]),t=t.map(s=>wr(s)?s.buffer:s),t.length===0))return;this.bufferUniformSize=t[0].byteLength;let e=0;for(let s=0;s<t.length;s++){const r=t[s];s!==t.length-1&&r.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const a=e+r.byteLength;this.shards.push({buffer:r,start:e,end:a}),e=a}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(t=0,e=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(t=isNaN(Number(t))?0:t,e=isNaN(Number(e))?0:e,t=Math.max(0,t),e=Math.min(this.byteLength,e),e<=t)return new ArrayBuffer(0);const s=this.findShardForByte(t);if(s===-1)throw new Error(`Could not find start shard for byte ${t}`);const r=e-t,a=new ArrayBuffer(r),i=new Uint8Array(a);let l=0;for(let u=s;u<this.shards.length;u++){const h=this.shards[u],p=t+l-h.start,m=l,b=Math.min(e,h.end)-h.start,x=new Uint8Array(h.buffer,p,b-p);if(i.set(x,m),l+=x.length,e<h.end)break}return a}findShardForByte(t){if(this.shards.length===0||t<0||t>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(t/this.bufferUniformSize),this.previousShardIndex;function e(r){return t<r.start?-1:t>=r.end?1:0}if(e(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;const s=mB(this.shards,e);return s===-1?-1:(this.previousShardIndex=s,this.previousShardIndex)}}function mB(n,t){let e=0,s=n.length;for(;e<=s;){const r=Math.floor((s-e)/2)+e,a=t(n[r]);if(a===0)return r;a<0?s=r:e=r+1}return-1}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zr(){return K}function c2(){return K.memory()}function at(n,t){return K.tidy(n,t)}function se(n){KI(n).forEach(e=>e.dispose())}function An(n){return K.keep(n)}function gB(){return K.ready()}function Bv(){return K.backendName}function nE(n,t,e=1){return K.registerBackend(n,t,e)}function sE(){return K.backend}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ei=4;async function zx(n,t){const e=[],s=[],r=Array.isArray(n)?n.map(i=>i.name):Object.keys(n);for(let i=0;i<r.length;++i){const l=r[i],u=Array.isArray(n)?n[i].tensor:n[l];if(u.dtype!=="float32"&&u.dtype!=="int32"&&u.dtype!=="bool"&&u.dtype!=="string"&&u.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${l}': ${u.dtype}`);const h={name:l,shape:u.shape,dtype:u.dtype};if(u.dtype==="string"){const d=new Promise(async p=>{const m=await u.bytes(),y=m.reduce((v,S)=>v+S.length,0)+Ei*m.length,b=new Uint8Array(y);let x=0;for(let v=0;v<m.length;v++){const S=m[v],C=new Uint8Array(new Uint32Array([S.length]).buffer);b.set(C,x),x+=Ei,b.set(S,x),x+=S.length}p(b)});s.push(d)}else s.push(u.data());t!=null&&(h.group=t),e.push(h)}const a=await Promise.all(s);return{data:xB(a),specs:e}}function rE(n,t){const e=new Ur(n),s={};let r=0;for(const a of t){const i=yB(a,(l,u)=>e.slice(r+l,r+u));s[a.name]=aE(a,e.slice(r,r+i)),r+=i}return s}function yB(n,t){const e=mt(n.shape);let s;if("quantization"in n){const r=n.quantization;s=zo[r.dtype]}else if(n.dtype==="string"){let r=0;for(let a=0;a<e;a++)r+=Ei+new Uint32Array(t(r,r+Ei))[0];return r}else s=zo[n.dtype];return e*s}async function bB(n,t){const e=mt(n.shape);let s;if("quantization"in n){const r=n.quantization;s=zo[r.dtype]}else if(n.dtype==="string"){let r=0;for(let a=0;a<e;a++)r+=Ei+new Uint32Array(await t(r,r+Ei))[0];return r}else s=zo[n.dtype];return e*s}function aE(n,t){const e=n.name,s=n.dtype,r=n.shape,a=mt(r);let i,l=0;if("quantization"in n){const u=n.quantization;if(u.dtype==="uint8"||u.dtype==="uint16"){if(!("min"in u&&"scale"in u))throw new Error(`Weight ${n.name} with quantization ${u.dtype} doesn't have corresponding metadata min and scale.`)}else if(u.dtype==="float16"){if(s!=="float32")throw new Error(`Weight ${n.name} is quantized with ${u.dtype} which only supports weights of type float32 not ${s}.`)}else throw new Error(`Weight ${n.name} has unknown quantization dtype ${u.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);const h=zo[u.dtype],d=u.dtype==="uint8"?new Uint8Array(t):new Uint16Array(t);if(s==="float32")if(u.dtype==="uint8"||u.dtype==="uint16"){i=new Float32Array(d.length);for(let p=0;p<d.length;p++){const m=d[p];i[p]=m*u.scale+u.min}}else if(u.dtype==="float16")i=TB()(d);else throw new Error(`Unsupported quantization type ${u.dtype} for weight type float32.`);else if(s==="int32"){if(u.dtype!=="uint8"&&u.dtype!=="uint16")throw new Error(`Unsupported quantization type ${u.dtype} for weight type int32.`);i=new Int32Array(d.length);for(let p=0;p<d.length;p++){const m=d[p];i[p]=Math.round(m*u.scale+u.min)}}else throw new Error(`Unsupported dtype in weight '${e}': ${s}`);l+=a*h}else if(s==="string"){const u=mt(n.shape);i=[];for(let h=0;h<u;h++){const d=new Uint32Array(t.slice(l,l+Ei))[0];l+=Ei;const p=new Uint8Array(t.slice(l,l+d));i.push(p),l+=d}}else{const u=zo[s];if(s==="float32")i=new Float32Array(t);else if(s==="int32")i=new Int32Array(t);else if(s==="bool")i=new Uint8Array(t);else if(s==="complex64"){i=new Float32Array(t);const h=new Float32Array(i.length/2),d=new Float32Array(i.length/2);for(let b=0;b<h.length;b++)h[b]=i[b*2],d[b]=i[b*2+1];const p=_r(h,r,"float32"),m=_r(d,r,"float32"),y=Ii(p,m);return p.dispose(),m.dispose(),y}else throw new Error(`Unsupported dtype in weight '${e}': ${s}`);l+=a*u}return _r(i,r,s)}async function h2(n,t,e){let s=new Uint8Array(t);for(;s.byteLength<e;){const{done:r,value:a}=await n.read();if(r&&a==null){const l=e-s.byteLength;throw new Error(`Reader is done but ${l} bytes are still expected`)}const i=new Uint8Array(s.length+a.byteLength);i.set(s,0),i.set(new Uint8Array(a),s.length),s=i}return s.buffer}async function iE(n,t){const e={},s=n.getReader();let r=new ArrayBuffer(0);for(const a of t){const i=await bB(a,async(h,d)=>(r=await h2(s,r,d),r.slice(h,d)));r=await h2(s,r,i);const l=r.slice(0,i);r=r.slice(i);const u=aE(a,l);if(e[a.name]=u,Bv()==="webgpu"){const h=sE();"uploadToGPU"in h&&mt(u.shape)>=ut().get("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD")&&h.uploadToGPU(u.dataId)}}return e}function xB(n){if(n===null)throw new Error(`Invalid input value: ${JSON.stringify(n)}`);let t=0;const e=[];n.forEach(a=>{if(t+=a.byteLength,e.push(a.byteLength===a.buffer.byteLength?a:new a.constructor(a)),!(a instanceof Float32Array||a instanceof Int32Array||a instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${a.constructor.name}`)});const s=new Uint8Array(t);let r=0;return e.forEach(a=>{s.set(new Uint8Array(a.buffer),r),r+=a.byteLength}),s.buffer}const Pv=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function d2(n){return Pv?Buffer.byteLength(n,"utf8"):new Blob([n]).size}function vB(n){if(Pv)return Buffer.from(n).toString("base64");const t=new Uint8Array(n);let e="";for(let s=0,r=t.length;s<r;s++)e+=String.fromCharCode(t[s]);return btoa(e)}function wB(n){if(Pv){const s=Buffer.from(n,"base64");return s.buffer.slice(s.byteOffset,s.byteOffset+s.byteLength)}const t=atob(n),e=new Uint8Array(t.length);for(let s=0;s<t.length;++s)e.set([t.charCodeAt(s)],s);return e.buffer}function oE(n){return Ur.join(n)}function f2(n){const t="/";for(n=n.trim();n.endsWith(t);)n=n.slice(0,n.length-1);const e=n.split(t);return e[e.length-1]}function lE(n,t){const e={modelTopology:n.modelTopology,format:n.format,generatedBy:n.generatedBy,convertedBy:n.convertedBy,weightsManifest:t};return n.signature!=null&&(e.signature=n.signature),n.userDefinedMetadata!=null&&(e.userDefinedMetadata=n.userDefinedMetadata),n.modelInitializer!=null&&(e.modelInitializer=n.modelInitializer),n.initializerSignature!=null&&(e.initializerSignature=n.initializerSignature),n.trainingConfig!=null&&(e.trainingConfig=n.trainingConfig),e}function uE(n,t,e){const s={modelTopology:n.modelTopology,format:n.format,generatedBy:n.generatedBy,convertedBy:n.convertedBy};if(n.trainingConfig!=null&&(s.trainingConfig=n.trainingConfig),n.weightsManifest!=null){if(!t)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!e)throw new Error("modelJSON has weightsManifest but weightData is null");s.weightSpecs=t,s.weightData=e}return n.signature!=null&&(s.signature=n.signature),n.userDefinedMetadata!=null&&(s.userDefinedMetadata=n.userDefinedMetadata),n.modelInitializer!=null&&(s.modelInitializer=n.modelInitializer),n.initializerSignature!=null&&(s.initializerSignature=n.initializerSignature),s}async function Vv(n,t){let e,s;return n.weightsManifest!=null&&([e,s]=await t(n.weightsManifest)),uE(n,e,s)}function xd(n){if(n.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:n.modelTopology==null?0:d2(JSON.stringify(n.modelTopology)),weightSpecsBytes:n.weightSpecs==null?0:d2(JSON.stringify(n.weightSpecs)),weightDataBytes:n.weightData==null?0:new Ur(n.weightData).byteLength}}function Mx(n){const t=[];for(const e of n)t.push(...e.weights);return t}function SB(){const n=e=>{let s=e<<13,r=0;for(;(s&8388608)===0;)r-=8388608,s<<=1;return s&=-8388609,r+=947912704,s|r},t=new Uint32Array(2048);t[0]=0;for(let e=1;e<1024;e++)t[e]=n(e);for(let e=1024;e<2048;e++)t[e]=939524096+(e-1024<<13);return t}function CB(){const n=new Uint32Array(64);n[0]=0,n[31]=1199570944,n[32]=2147483648,n[63]=3347054592;for(let t=1;t<31;t++)n[t]=t<<23;for(let t=33;t<63;t++)n[t]=2147483648+(t-32<<23);return n}function NB(){const n=new Uint32Array(64);for(let t=0;t<64;t++)n[t]=1024;return n[0]=n[32]=0,n}function TB(){const n=SB(),t=CB(),e=NB();return s=>{const r=new ArrayBuffer(4*s.length),a=new Uint32Array(r);for(let i=0;i<s.length;i++){const l=s[i],u=n[e[l>>10]+(l&1023)]+t[l>>10];a[i]=u}return new Float32Array(r)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class He{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return He.instance==null&&(He.instance=new He),He.instance}static registerSaveRouter(t){He.getInstance().saveRouters.push(t)}static registerLoadRouter(t){He.getInstance().loadRouters.push(t)}static getSaveHandlers(t){return He.getHandlers(t,"save")}static getLoadHandlers(t,e){return He.getHandlers(t,"load",e)}static getHandlers(t,e,s){const r=[];return(e==="load"?He.getInstance().loadRouters:He.getInstance().saveRouters).forEach(i=>{const l=i(t,s);l!==null&&r.push(l)}),r}}const $B=n=>He.registerSaveRouter(n),kB=n=>He.registerLoadRouter(n),cE=n=>He.getSaveHandlers(n),IB=(n,t)=>He.getLoadHandlers(n,t);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bx="tensorflowjs",Px=1,No="models_store",vi="model_info_store";function hE(){if(!ut().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const n=typeof window>"u"?self:window,t=n.indexedDB||n.mozIndexedDB||n.webkitIndexedDB||n.msIndexedDB||n.shimIndexedDB;if(t==null)throw new Error("The current browser does not appear to support IndexedDB.");return t}function Vx(n){const t=n.result;t.createObjectStore(No,{keyPath:"modelPath"}),t.createObjectStore(vi,{keyPath:"modelPath"})}class Mo{constructor(t){if(this.indexedDB=hE(),t==null||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,t)}async load(){return this.databaseAction(this.modelPath)}databaseAction(t,e){return new Promise((s,r)=>{const a=this.indexedDB.open(Bx,Px);a.onupgradeneeded=()=>Vx(a),a.onsuccess=()=>{const i=a.result;if(e==null){const l=i.transaction(No,"readonly"),h=l.objectStore(No).get(this.modelPath);h.onsuccess=()=>{if(h.result==null)return i.close(),r(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));s(h.result.modelArtifacts)},h.onerror=d=>(i.close(),r(h.error)),l.oncomplete=()=>i.close()}else{e.weightData=Ur.join(e.weightData);const l=xd(e),u=i.transaction(vi,"readwrite");let h=u.objectStore(vi),d;try{d=h.put({modelPath:this.modelPath,modelArtifactsInfo:l})}catch(m){return r(m)}let p;d.onsuccess=()=>{p=i.transaction(No,"readwrite");const m=p.objectStore(No);let y;try{y=m.put({modelPath:this.modelPath,modelArtifacts:e,modelArtifactsInfo:l})}catch(b){return r(b)}y.onsuccess=()=>s({modelArtifactsInfo:l}),y.onerror=b=>{h=u.objectStore(vi);const x=h.delete(this.modelPath);x.onsuccess=()=>(i.close(),r(y.error)),x.onerror=v=>(i.close(),r(y.error))}},d.onerror=m=>(i.close(),r(d.error)),u.oncomplete=()=>{p==null?i.close():p.oncomplete=()=>i.close()}}},a.onerror=i=>r(a.error)})}}Mo.URL_SCHEME="indexeddb://";const dE=n=>ut().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(Mo.URL_SCHEME)?EB(n.slice(Mo.URL_SCHEME.length)):null;He.registerSaveRouter(dE);He.registerLoadRouter(dE);function EB(n){return new Mo(n)}function DB(n){return n.startsWith(Mo.URL_SCHEME)?n.slice(Mo.URL_SCHEME.length):n}class AB{constructor(){this.indexedDB=hE()}async listModels(){return new Promise((t,e)=>{const s=this.indexedDB.open(Bx,Px);s.onupgradeneeded=()=>Vx(s),s.onsuccess=()=>{const r=s.result,a=r.transaction(vi,"readonly"),l=a.objectStore(vi).getAll();l.onsuccess=()=>{const u={};for(const h of l.result)u[h.modelPath]=h.modelArtifactsInfo;t(u)},l.onerror=u=>(r.close(),e(l.error)),a.oncomplete=()=>r.close()},s.onerror=r=>e(s.error)})}async removeModel(t){return t=DB(t),new Promise((e,s)=>{const r=this.indexedDB.open(Bx,Px);r.onupgradeneeded=()=>Vx(r),r.onsuccess=()=>{const a=r.result,i=a.transaction(vi,"readwrite"),l=i.objectStore(vi),u=l.get(t);let h;u.onsuccess=()=>{if(u.result==null)return a.close(),s(new Error(`Cannot find model with path '${t}' in IndexedDB.`));{const d=l.delete(t),p=()=>{h=a.transaction(No,"readwrite");const y=h.objectStore(No).delete(t);y.onsuccess=()=>e(u.result.modelArtifactsInfo),y.onerror=b=>s(u.error)};d.onsuccess=p,d.onerror=m=>(p(),a.close(),s(u.error))}},u.onerror=d=>(a.close(),s(u.error)),i.oncomplete=()=>{h==null?a.close():h.oncomplete=()=>a.close()}},r.onerror=a=>s(r.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oa="/",Zl="tensorflowjs_models",fE="info",RB="model_topology",OB="weight_specs",_B="weight_data",FB="model_metadata";function pE(n){return{info:[Zl,n,fE].join(Oa),topology:[Zl,n,RB].join(Oa),weightSpecs:[Zl,n,OB].join(Oa),weightData:[Zl,n,_B].join(Oa),modelMetadata:[Zl,n,FB].join(Oa)}}function mE(n){for(const t of Object.values(n))window.localStorage.removeItem(t)}function LB(n){const t=n.split(Oa);if(t.length<3)throw new Error(`Invalid key format: ${n}`);return t.slice(1,t.length-1).join(Oa)}function zB(n){return n.startsWith(Bo.URL_SCHEME)?n.slice(Bo.URL_SCHEME.length):n}class Bo{constructor(t){if(!ut().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,t==null||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=pE(this.modelPath)}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const e=JSON.stringify(t.modelTopology),s=JSON.stringify(t.weightSpecs),r=xd(t),a=Ur.join(t.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,e),this.LS.setItem(this.keys.weightSpecs,s),this.LS.setItem(this.keys.weightData,vB(a));const i={format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,signature:t.signature!=null?t.signature:void 0,userDefinedMetadata:t.userDefinedMetadata!=null?t.userDefinedMetadata:void 0,modelInitializer:t.modelInitializer!=null?t.modelInitializer:void 0,initializerSignature:t.initializerSignature!=null?t.initializerSignature:void 0,trainingConfig:t.trainingConfig!=null?t.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(i)),{modelArtifactsInfo:r}}catch{throw mE(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${r.modelTopologyBytes}, weightSpecsBytes=${r.weightSpecsBytes}, weightDataBytes=${r.weightDataBytes}.`)}}}async load(){const t=JSON.parse(this.LS.getItem(this.keys.info));if(t==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(t.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const e={},s=JSON.parse(this.LS.getItem(this.keys.topology));if(s==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);e.modelTopology=s;const r=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(r==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);e.weightSpecs=r;const a=this.LS.getItem(this.keys.modelMetadata);if(a!=null){const l=JSON.parse(a);e.format=l.format,e.generatedBy=l.generatedBy,e.convertedBy=l.convertedBy,l.signature!=null&&(e.signature=l.signature),l.userDefinedMetadata!=null&&(e.userDefinedMetadata=l.userDefinedMetadata),l.modelInitializer!=null&&(e.modelInitializer=l.modelInitializer),l.initializerSignature!=null&&(e.initializerSignature=l.initializerSignature),l.trainingConfig!=null&&(e.trainingConfig=l.trainingConfig)}const i=this.LS.getItem(this.keys.weightData);if(i==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return e.weightData=wB(i),e}}Bo.URL_SCHEME="localstorage://";const gE=n=>ut().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(Bo.URL_SCHEME)?MB(n.slice(Bo.URL_SCHEME.length)):null;He.registerSaveRouter(gE);He.registerLoadRouter(gE);function MB(n){return new Bo(n)}class BB{constructor(){F(ut().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),F(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const t={},e=Zl+Oa,s=Oa+fE;for(let r=0;r<this.LS.length;++r){const a=this.LS.key(r);if(a.startsWith(e)&&a.endsWith(s)){const i=LB(a);t[i]=JSON.parse(this.LS.getItem(a))}}return t}async removeModel(t){t=zB(t);const e=pE(t);if(this.LS.getItem(e.info)==null)throw new Error(`Cannot find model at path '${t}'`);const s=JSON.parse(this.LS.getItem(e.info));return mE(e),s}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const su="://";class os{constructor(){this.managers={}}static getInstance(){return os.instance==null&&(os.instance=new os),os.instance}static registerManager(t,e){F(t!=null,()=>"scheme must not be undefined or null."),t.endsWith(su)&&(t=t.slice(0,t.indexOf(su))),F(t.length>0,()=>"scheme must not be an empty string.");const s=os.getInstance();F(s.managers[t]==null,()=>`A model store manager is already registered for scheme '${t}'.`),s.managers[t]=e}static getManager(t){const e=os.getInstance().managers[t];if(e==null)throw new Error(`Cannot find model manager for scheme '${t}'`);return e}static getSchemes(){return Object.keys(os.getInstance().managers)}}function Cp(n){if(n.indexOf(su)===-1)throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${os.getSchemes().join(",")}`);return{scheme:n.split(su)[0],path:n.split(su)[1]}}async function yE(n,t,e=!1){F(n!==t,()=>`Old path and new path are the same: '${n}'`);const s=He.getLoadHandlers(n);F(s.length>0,()=>`Copying failed because no load handler is found for source URL ${n}.`),F(s.length<2,()=>`Copying failed because more than one (${s.length}) load handlers for source URL ${n}.`);const r=s[0],a=He.getSaveHandlers(t);F(a.length>0,()=>`Copying failed because no save handler is found for destination URL ${t}.`),F(a.length<2,()=>`Copying failed because more than one (${s.length}) save handlers for destination URL ${t}.`);const i=a[0],l=Cp(n).scheme,u=Cp(n).path,h=l===Cp(n).scheme,d=await r.load();e&&h&&await os.getManager(l).removeModel(u);const p=await i.save(d);return e&&!h&&await os.getManager(l).removeModel(u),p.modelArtifactsInfo}async function PB(){const n=os.getSchemes(),t={};for(const e of n){const s=await os.getManager(e).listModels();for(const r in s){const a=e+su+r;t[a]=s[r]}}return t}async function VB(n){const t=Cp(n);return os.getManager(t.scheme).removeModel(t.path)}async function UB(n,t){return yE(n,t,!1)}async function GB(n,t){return yE(n,t,!0)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class WB{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(t,e){return fetch(t,e)}now(){return performance.now()}encode(t,e){if(e!=="utf-8"&&e!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${e}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)}decode(t,e){return new TextDecoder(e).decode(t)}setTimeoutCustom(t,e){if(typeof window>"u"||!ut().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(t,e);return}this.functionRefs.push(t),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},e),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",s=>{if(s.source===window&&s.data.name===this.messageName){s.stopPropagation();const r=this.functionRefs[s.data.index];r(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(t){return VI(t)}}if(ut().get("IS_BROWSER")){ut().setPlatform("browser",new WB);try{os.registerManager(Bo.URL_SCHEME,new BB)}catch{}try{os.registerManager(Mo.URL_SCHEME,new AB)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HB={importFetch:()=>require("node-fetch")};let qb;class jB{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(t,e){return ut().global.fetch!=null?ut().global.fetch(t,e):(qb==null&&(qb=HB.importFetch()),qb(t,e))}now(){const t=process.hrtime();return t[0]*1e3+t[1]/1e6}encode(t,e){if(e!=="utf-8"&&e!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${e}`);return this.textEncoder.encode(t)}decode(t,e){return t.length===0?"":new this.util.TextDecoder(e).decode(t)}isTypedArray(t){return this.util.types.isFloat32Array(t)||this.util.types.isInt32Array(t)||this.util.types.isUint8Array(t)||this.util.types.isUint8ClampedArray(t)}}ut().get("IS_NODE")&&!ut().get("IS_BROWSER")&&ut().setPlatform("node",new jB);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function te(n,t="float32",e){return t=t||"float32",tr(n),new Cn(n,t,e)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qB(n,t){const e=B(n,"x","cast");if(!EM(t))throw new Error(`Failed to cast to unknown dtype ${t}`);if(t==="string"&&e.dtype!=="string"||t!=="string"&&e.dtype==="string")throw new Error("Only strings can be casted to strings");const s={x:e},r={dtype:t};return K.runKernel(Ah,s,r)}const kt=q({cast_:qB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XB(n){const e={x:B(n,"x","clone","string_or_numeric")};return K.runKernel(Wh,e)}const _a=q({clone_:XB});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bE(n,t=!1){console.log(n.toString(t))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ZI();const KB={buffer:te,cast:kt,clone:_a,print:bE};oB(KB);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YB(n,t){let e=B(n,"a","add"),s=B(t,"b","add");[e,s]=Qe(e,s);const r={a:e,b:s};return K.runKernel(Au,r)}const St=q({add_:YB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZB(n,t){let e=B(n,"a","floorDiv"),s=B(t,"b","floorDiv");[e,s]=Qe(e,s);const r={a:e,b:s};return K.runKernel(Uh,r)}const Uv=q({floorDiv_:ZB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QB(n,t){let e=B(n,"a","div"),s=B(t,"b","div");if([e,s]=Qe(e,s),e.dtype==="int32"&&s.dtype==="int32")return Uv(e,s);const r={a:e,b:s},a={};return K.runKernel(Lh,r,a)}const _t=q({div_:QB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JB(n,t){let e=B(n,"a","mul"),s=B(t,"b","mul");[e,s]=Qe(e,s);const r={a:e,b:s};return K.runKernel(Jh,r)}const X=q({mul_:JB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t4(n){const t=B(n,"x","abs");if(t.dtype==="complex64"){const e={x:t};return K.runKernel(Lm,e)}else{const e={x:t};return K.runKernel(km,e)}}const bn=q({abs_:t4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e4(n){const e={x:B(n,"x","acos")};return K.runKernel(Nh,e)}const xE=q({acos_:e4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n4(n){const e={x:B(n,"x","acosh")};return K.runKernel(Th,e)}const vE=q({acosh_:n4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s4(n){F(Array.isArray(n),()=>"The argument passed to tf.addN() must be a list of tensors"),F(n.length>=1,()=>`Must pass at least one tensor to tf.addN(), but got ${n.length}`);const t=n.map((r,a)=>B(r,`tensors${a}`,"addN")),e=t[0];t.forEach(r=>{if(r.dtype!==e.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),t.forEach(r=>{if(!de(r.shape,e.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});const s=t;return K.runKernel(Im,s)}const r4=q({addN_:s4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a4(n,t=null,e=!1){const r={x:B(n,"x","all","bool")},a={axis:t,keepDims:e};return K.runKernel(_1,r,a)}const Gv=q({all_:a4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i4(n,t=null,e=!1){const r={x:B(n,"x","any","bool")},a={axis:t,keepDims:e};return K.runKernel(F1,r,a)}const Kp=q({any_:i4});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o4(n,t=0){const s={x:B(n,"x","argMax")},r={axis:t};return K.runKernel(Em,s,r)}const hu=q({argMax_:o4});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l4(n,t=0){const s={x:B(n,"x","argMin")},r={axis:t};return K.runKernel(Dm,s,r)}const wE=q({argMin_:l4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u4(n){const e={x:B(n,"x","asin")};return K.runKernel($h,e)}const SE=q({asin_:u4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c4(n){const e={x:B(n,"x","asinh")};return K.runKernel(kh,e)}const CE=q({asinh_:c4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h4(n){const e={x:B(n,"x","atan")};return K.runKernel(Ih,e)}const NE=q({atan_:h4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d4(n,t){let e=B(n,"a","atan2"),s=B(t,"b","atan2");[e,s]=Qe(e,s);const r={a:e,b:s};return K.runKernel(Dh,r)}const TE=q({atan2_:d4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f4(n){const e={x:B(n,"x","atanh")};return K.runKernel(Eh,e)}const $E=q({atanh_:f4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vd(n,t,e,s,r="NHWC",a){const i=n[3],l=[...t,i],u=Ga(r);return On(n,l,e,a,s,null,null,u)}function Tr(n,t,e,s,r,a,i="channelsLast"){const[l,u]=oh(t);let h;if(i==="channelsLast")h=[l,u,n[3],n[3]];else if(i==="channelsFirst")h=[l,u,n[1],n[1]];else throw new Error(`Unknown dataFormat ${i}`);return On(n,h,e,s,r,a,!1,i)}function Ua(n,t,e,s,r,a,i="NDHWC"){const[l,u,h]=Ux(t);let d,p;if(i==="NDHWC")p="channelsLast",d=[l,u,h,n[4],n[4]];else if(i==="NCDHW")p="channelsFirst",d=[l,u,h,n[1],n[1]];else throw new Error(`Unknown dataFormat ${i}`);return Gi(n,d,e,s,r,!1,p,a)}function On(n,t,e,s,r,a,i=!1,l="channelsLast"){let[u,h,d,p]=[-1,-1,-1,-1];if(l==="channelsLast")[u,h,d,p]=n;else if(l==="channelsFirst")[u,p,h,d]=n;else throw new Error(`Unknown dataFormat ${l}`);const[m,y,,b]=t,[x,v]=oh(e),[S,C]=oh(s),$=ru(m,S),T=ru(y,C),{padInfo:I,outHeight:A,outWidth:R}=g4(r,h,d,x,v,$,T,a,l),L=i?b*p:b;let _;return l==="channelsFirst"?_=[u,L,A,R]:l==="channelsLast"&&(_=[u,A,R,L]),{batchSize:u,dataFormat:l,inHeight:h,inWidth:d,inChannels:p,outHeight:A,outWidth:R,outChannels:L,padInfo:I,strideHeight:x,strideWidth:v,filterHeight:m,filterWidth:y,effectiveFilterHeight:$,effectiveFilterWidth:T,dilationHeight:S,dilationWidth:C,inShape:n,outShape:_,filterShape:t}}function Gi(n,t,e,s,r,a=!1,i="channelsLast",l){let[u,h,d,p,m]=[-1,-1,-1,-1,-1];if(i==="channelsLast")[u,h,d,p,m]=n;else if(i==="channelsFirst")[u,m,h,d,p]=n;else throw new Error(`Unknown dataFormat ${i}`);const[y,b,x,,v]=t,[S,C,$]=Ux(e),[T,I,A]=Ux(s),R=ru(y,T),L=ru(b,I),_=ru(x,A),{padInfo:M,outDepth:D,outHeight:W,outWidth:et}=y4(r,h,d,p,S,C,$,R,L,_,l),nt=a?v*m:v;let tt;return i==="channelsFirst"?tt=[u,nt,D,W,et]:i==="channelsLast"&&(tt=[u,D,W,et,nt]),{batchSize:u,dataFormat:i,inDepth:h,inHeight:d,inWidth:p,inChannels:m,outDepth:D,outHeight:W,outWidth:et,outChannels:nt,padInfo:M,strideDepth:S,strideHeight:C,strideWidth:$,filterDepth:y,filterHeight:b,filterWidth:x,effectiveFilterDepth:R,effectiveFilterHeight:L,effectiveFilterWidth:_,dilationDepth:T,dilationHeight:I,dilationWidth:A,inShape:n,outShape:tt,filterShape:t}}function p4(n,t,e,s,r){s==null&&(s=Wv(n,t,e));const a=n[0],i=n[1],l=lh((a-t+2*s)/e+1,r),u=lh((i-t+2*s)/e+1,r);return[l,u]}function m4(n,t,e,s,r,a){r==null&&(r=Wv(n,t[0],s[0]));const i=[0,0,0,e];for(let l=0;l<3;l++)n[l]+2*r>=t[l]&&(i[l]=lh((n[l]-t[l]+2*r)/s[l]+1,a));return i}function Wv(n,t,e,s=1){const r=ru(t,s);return Math.floor((n[0]*(e-1)-e+r)/2)}function oh(n){return typeof n=="number"?[n,n,n]:n.length===2?[n[0],n[1],1]:n}function Ux(n){return typeof n=="number"?[n,n,n]:n}function ru(n,t){return t<=1?n:n+(n-1)*(t-1)}function g4(n,t,e,s,r,a,i,l,u){let h,d,p;if(typeof n=="number"){h={top:n,bottom:n,left:n,right:n,type:n===0?"VALID":"NUMBER"};const y=p4([t,e],a,s,n,l);d=y[0],p=y[1]}else if(n==="same"){d=Math.ceil(t/s),p=Math.ceil(e/r);const m=Math.max(0,(d-1)*s+a-t),y=Math.max(0,(p-1)*r+i-e),b=Math.floor(m/2),x=m-b,v=Math.floor(y/2),S=y-v;h={top:b,bottom:x,left:v,right:S,type:"SAME"}}else if(n==="valid")h={top:0,bottom:0,left:0,right:0,type:"VALID"},d=Math.ceil((t-a+1)/s),p=Math.ceil((e-i+1)/r);else if(typeof n=="object"){const m=u==="channelsLast"?n[1][0]:n[2][0],y=u==="channelsLast"?n[1][1]:n[2][1],b=u==="channelsLast"?n[2][0]:n[3][0],x=u==="channelsLast"?n[2][1]:n[3][1];h={top:m,bottom:y,left:b,right:x,type:m===0&&y===0&&b===0&&x===0?"VALID":"EXPLICIT"},d=lh((t-a+m+y)/s+1,l),p=lh((e-i+b+x)/r+1,l)}else throw Error(`Unknown padding parameter: ${n}`);return{padInfo:h,outHeight:d,outWidth:p}}function y4(n,t,e,s,r,a,i,l,u,h,d){let p,m,y,b;if(n==="valid"&&(n=0),typeof n=="number"){p={top:n,bottom:n,left:n,right:n,front:n,back:n,type:n===0?"VALID":"NUMBER"};const v=m4([t,e,s,1],[l,u,h],1,[r,a,i],n,d);m=v[0],y=v[1],b=v[2]}else if(n==="same"){m=Math.ceil(t/r),y=Math.ceil(e/a),b=Math.ceil(s/i);const x=(m-1)*r+l-t,v=(y-1)*a+u-e,S=(b-1)*i+h-s,C=Math.floor(x/2),$=x-C,T=Math.floor(v/2),I=v-T,A=Math.floor(S/2),R=S-A;p={top:T,bottom:I,left:A,right:R,front:C,back:$,type:"SAME"}}else throw Error(`Unknown padding parameter: ${n}`);return{padInfo:p,outDepth:m,outHeight:y,outWidth:b}}function lh(n,t){if(!t)return Math.trunc(n);switch(t){case"round":return Math.round(n);case"ceil":return Math.ceil(n);case"floor":return Math.floor(n);default:throw new Error(`Unknown roundingMode ${t}`)}}function Di(n){const[t,e,s]=oh(n);return t===1&&e===1&&s===1}function Hn(n,t){return Di(n)||Di(t)}function Po(n){return oh(n).every(t=>t>0)}function Ga(n){if(n==="NHWC")return"channelsLast";if(n==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${n}`)}function hs(n,t,e){if(e!=null){if(typeof t=="string")throw Error(`Error in ${n}: pad must be an integer when using dimRoundingMode ${e} but got pad ${t}.`);if(typeof t=="number")F(uu(t),()=>`Error in ${n}: pad must be an integer when using dimRoundingMode ${e} but got pad ${t}.`);else if(typeof t=="object")t.forEach(s=>{s.forEach(r=>{F(uu(r),()=>`Error in ${n}: pad must be an integer when using dimRoundingMode ${e} but got pad ${r}.`)})});else throw Error(`Error in ${n}: Unknown padding parameter: ${t}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b4(n,t){const s={x:B(n,"x","reshape","string_or_numeric")},r={shape:t};return K.runKernel(gg,s,r)}const J=q({reshape_:b4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x4(n,t,e,s,r){const a=B(n,"x","avgPool","float32"),i=1;F(Hn(e,i),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${e} and dilations '${i}'`);let l=a,u=!1;a.rank===3&&(u=!0,l=J(a,[1,a.shape[0],a.shape[1],a.shape[2]])),F(l.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${l.rank}.`),hs("avgPool",s,r);const h={x:l},d={filterSize:t,strides:e,pad:s,dimRoundingMode:r};let p=K.runKernel(Am,h,d);return p=kt(p,a.dtype),u?J(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const Ag=q({avgPool_:x4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v4(n,t,e,s,r,a="NDHWC"){const i=B(n,"x","avgPool3d","float32");let l=i,u=!1;i.rank===4&&(u=!0,l=J(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),F(l.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${l.rank}.`),F(a==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${a}`),F(typeof e=="number"&&e>0||Array.isArray(e)&&e[0]>0&&e[1]>0&&e[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${e}'`),hs("avgPool3d",s,r);const h={x:l},d={filterSize:t,strides:e,pad:s,dimRoundingMode:r,dataFormat:a};let p=K.runKernel(Rm,h,d);return p=kt(p,l.dtype),u?J(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}const kE=q({avgPool3d_:v4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w4(n,t=0){F(n.length>=1,()=>"Pass at least one tensor to concat");const e=Xp(n,"tensors","concat","string_or_numeric");if(e[0].dtype==="complex64"&&e.forEach(a=>{if(a.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${a.dtype}. `)}),e.length===1)return _a(e[0]);const s=e,r={axis:t};return K.runKernel(zm,s,r)}const pn=q({concat_:w4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S4(n,t,e=!1,s=!1){let r=B(n,"a","matMul"),a=B(t,"b","matMul");[r,a]=Qe(r,a);const i={a:r,b:a},l={transposeA:e,transposeB:s};return K.runKernel(Om,i,l)}const le=q({matMul_:S4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C4(n){const e={x:B(n,"x","sigmoid","float32")};return K.runKernel(cd,e)}const Fr=q({sigmoid_:C4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N4(n,t,e){const s=B(n,"x","slice","string_or_numeric");if(s.rank===0)throw new Error("Slicing scalar is not possible");const r={x:s},a={begin:t,size:e};return K.runKernel(wg,r,a)}const Qt=q({slice_:N4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T4(n){const e={x:B(n,"x","tanh","float32")};return K.runKernel(gd,e)}const Vo=q({tanh_:T4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $4(n,t,e,s,r,a){const i=B(n,"forgetBias","basicLSTMCell"),l=B(t,"lstmKernel","basicLSTMCell"),u=B(e,"lstmBias","basicLSTMCell"),h=B(s,"data","basicLSTMCell"),d=B(r,"c","basicLSTMCell"),p=B(a,"h","basicLSTMCell"),m=pn([h,p],1),y=le(m,l),b=St(y,u),x=b.shape[0],v=b.shape[1]/4,S=[x,v],C=Qt(b,[0,0],S),$=Qt(b,[0,v],S),T=Qt(b,[0,v*2],S),I=Qt(b,[0,v*3],S),A=St(X(Fr(C),Vo($)),X(d,Fr(St(i,T)))),R=X(Vo(A),Fr(I));return[A,R]}const k4=q({basicLSTMCell_:$4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I4(n,t,e){const s=B(n,"x","batchToSpaceND"),r=t.reduce((l,u)=>l*u);F(s.rank>=1+t.length,()=>`input rank is ${s.rank} but should be > than blockShape.length ${t.length}`),F(e.length===t.length,()=>`crops.length is ${e.length} but should be equal to blockShape.length  ${t.length}`),F(s.shape[0]%r===0,()=>`input tensor batch is ${s.shape[0]} but is not divisible by the product of the elements of blockShape ${t.join(" * ")} === ${r}`);const a={x:s},i={blockShape:t,crops:e};return K.runKernel(_m,a,i)}const Rg=q({batchToSpaceND_:I4});function E4(n){let t;return n.rank===0||n.rank===1?t=J(n,[1,1,1,n.size]):n.rank===2?t=J(n,[1,1,n.shape[0],n.shape[1]]):n.rank===3?t=J(n,[1,n.shape[0],n.shape[1],n.shape[2]]):t=n,t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D4(n,t,e,s,r,a){a==null&&(a=.001);const i=B(n,"x","batchNorm"),l=B(t,"mean","batchNorm"),u=B(e,"variance","batchNorm");let h;r!=null&&(h=B(r,"scale","batchNorm"));let d;s!=null&&(d=B(s,"offset","batchNorm")),F(l.rank===u.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),F(d==null||l.rank===d.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),F(h==null||l.rank===h.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const m={x:E4(i),scale:h,offset:d,mean:l,variance:u},y={varianceEpsilon:a},b=K.runKernel(jm,m,y);return J(b,i.shape)}const wd=q({batchNorm_:D4});function A4(n,t,e,s,r,a){const i=B(n,"x","batchNorm"),l=B(t,"mean","batchNorm"),u=B(e,"variance","batchNorm");let h;r!=null&&(h=B(r,"scale","batchNorm"));let d;return s!=null&&(d=B(s,"offset","batchNorm")),F(i.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${i.rank}.`),F(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${l.rank}.`),F(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${u.rank}.`),h!=null&&F(h.rank===2||h.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${h.rank}.`),d!=null&&F(d.rank===2||d.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${d.rank}.`),wd(i,l,u,d,h,a)}const IE=q({batchNorm2d_:A4});function R4(n,t,e,s,r,a){const i=B(n,"x","batchNorm"),l=B(t,"mean","batchNorm"),u=B(e,"variance","batchNorm");let h;r!=null&&(h=B(r,"scale","batchNorm"));let d;return s!=null&&(d=B(s,"offset","batchNorm")),F(i.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${i.rank}.`),F(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${l.rank}.`),F(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${u.rank}.`),h!=null&&F(h.rank===3||h.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${h.rank}.`),d!=null&&F(d.rank===3||d.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${d.rank}.`),wd(i,l,u,d,h,a)}const EE=q({batchNorm3d_:R4});function O4(n,t,e,s,r,a){const i=B(n,"x","batchNorm"),l=B(t,"mean","batchNorm"),u=B(e,"variance","batchNorm");let h;r!=null&&(h=B(r,"scale","batchNorm"));let d;return s!=null&&(d=B(s,"offset","batchNorm")),F(i.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${i.rank}.`),F(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${l.rank}.`),F(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${u.rank}.`),h!=null&&F(h.rank===4||h.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${h.rank}.`),d!=null&&F(d.rank===4||d.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${d.rank}.`),wd(i,l,u,d,h,a)}const DE=q({batchNorm4d_:O4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _4(n,t,e){const s=B(n,"x","bincount"),r=B(t,"weights","bincount");F(s.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${s.dtype}`),F(e>=0,()=>`size must be non-negative, but got ${e}.`),F(r.size===s.size||r.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${s.shape}, weights shape: ${r.shape}.`);const a={x:s,weights:r},i={size:e};return K.runKernel(M1,a,i)}const AE=q({bincount_:_4});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F4(n,t){const e=B(n,"x","bitwiseAnd"),s=B(t,"y","bitwiseAnd");if(!de(e.shape,s.shape))throw new Error(`BitwiseAnd: Tensors must have the same shape. x: ${e.shape}, y: ${s.shape}`);if(e.dtype!=="int32"||s.dtype!=="int32")throw new Error(`BitwiseAnd: Only supports 'int32' values in tensor, found type of x: ${e.dtype} and type of y: ${s.dtype}`);const r={a:e,b:s};return K.runKernel(Fm,r)}const L4=q({bitwiseAnd_:F4});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z4(n,t){const e=B(n,"s0","broadcastArgs","int32"),s=B(t,"s1","broadcastArgs","int32");if(e.rank!==1)throw new Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${e.rank}`);if(s.rank!==1)throw new Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${s.rank}`);const r={s0:e,s1:s};return K.runKernel(B1,r)}const M4=q({broadcastArgs_:z4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B4(n,t){let e=B(n,"broadcastTo","x");const s=e.shape;if(tr(t),t.length<e.rank)throw new Error(`broadcastTo(): shape.length=${t.length} < input.rank=${e.rank}.`);if(t.length>e.rank){const h=e.shape.slice();for(;h.length<t.length;)h.unshift(1);e=J(e,h)}const r=e.shape,a=Array.from(t);for(let h=t.length-1;h>=0;h--)if(r[h]===t[h])a[h]=1;else if(e.shape[h]!==1)throw new Error(`broadcastTo(): [${s}] cannot be broadcast to [${t}].`);if(a.map((h,d)=>h>1?d:-1).filter(h=>h>=0).length===0)return _a(e);const l={x:e},u={reps:a};return K.runKernel(yd,l,u)}const au=q({broadcastTo_:B4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P4(n){const e={x:B(n,"x","ceil","float32")};return K.runKernel(Rh,e)}const RE=q({ceil_:P4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ru(n,t,e){tr(n),e=e||Eu(t);const s={shape:n,value:t,dtype:e};return K.runKernel(tv,{},s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V4(n,t,e){const s=B(n,"x","clipByValue");if(F(t<=e,()=>`Error in clip: min (${t}) must be less than or equal to max (${e}).`),t===e)return Ru(s.shape,t,s.dtype);const r={x:s},a={clipValueMin:t,clipValueMax:e};return K.runKernel(Oh,r,a)}const _s=q({clipByValue_:V4});function U4(n){return pn(n,0)}const OE=q({concat1d_:U4});function G4(n,t){return pn(n,t)}const Hv=q({concat2d_:G4});function W4(n,t){return pn(n,t)}const _E=q({concat3d_:W4});function H4(n,t){return pn(n,t)}const FE=q({concat4d_:H4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j4(n,t,e,s,r="NHWC",a=[1,1],i){const l=B(n,"x","conv2d","float32"),u=B(t,"filter","conv2d","float32");let h=l,d=!1;l.rank===3&&(d=!0,h=J(l,[1,l.shape[0],l.shape[1],l.shape[2]])),F(h.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${h.rank}.`),F(u.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${u.rank}.`),hs("conv2d",s,i);const p=r==="NHWC"?h.shape[3]:h.shape[1];F(p===u.shape[2],()=>`Error in conv2d: depth of input (${p}) must match input depth for filter ${u.shape[2]}.`),F(Hn(e,a),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${e} and dilations '${a}'`),F(Po(a),()=>"Error in conv2D: Dilated rates should be larger than 0."),F(Po(e),()=>"Error in conv2D: Strides should be larger than 0.");const m={x:h,filter:u},y={strides:e,pad:s,dataFormat:r,dilations:a,dimRoundingMode:i},b=K.runKernel(Mm,m,y);return d?J(b,[b.shape[1],b.shape[2],b.shape[3]]):b}const Ai=q({conv2d_:j4});function q4(n,t,e,s,r="NWC",a=1,i){const l=B(n,"x","conv1d"),u=B(t,"filter","conv1d");let h=l,d=!1;l.rank===2&&(d=!0,h=J(l,[1,l.shape[0],l.shape[1]])),F(h.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${h.rank}.`),F(u.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${u.rank}.`),hs("conv1d",s,i),F(h.shape[2]===u.shape[1],()=>`Error in conv1d: depth of input (${h.shape[2]}) must match input depth for filter ${u.shape[1]}.`),F(Hn(e,a),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${e} and dilation '${a}'`),F(Po(a),()=>"Error in conv1D: Dilated rates should be larger than 0."),F(Po(e),()=>"Error in conv1D: Stride should be larger than 0."),F(r==="NWC",()=>`Error in conv1d: got dataFormat of ${r} but only NWC is currently supported.`);const p=J(u,[1,u.shape[0],u.shape[1],u.shape[2]]),m=J(h,[h.shape[0],1,h.shape[1],h.shape[2]]),v=Ai(m,p,[1,e],s,"NHWC",[1,a],i);return d?J(v,[v.shape[2],v.shape[3]]):J(v,[v.shape[0],v.shape[2],v.shape[3]])}const jv=q({conv1d_:q4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X4(n,t,e,s,r,a="NHWC",i){F(n.length===t.rank,()=>`Length of inShape (${n.length}) and rank of dy (${t.rank}) must match`);let l=n,u=t,h=!1;t.rank===3&&(h=!0,u=J(t,[1,t.shape[0],t.shape[1],t.shape[2]]),l=[1,n[0],n[1],n[2]]),F(l.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${l.length}.`),F(u.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${u.rank}`),F(e.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${e.rank}`);const d=a==="NHWC"?l[3]:l[1],p=a==="NHWC"?u.shape[3]:u.shape[1];F(d===e.shape[2],()=>`Error in conv2dDerInput: depth of input (${d}) must match input depth for filter ${e.shape[2]}.`),F(p===e.shape[3],()=>`Error in conv2dDerInput: depth of output (${p}) must match output depth for filter ${e.shape[3]}.`),hs("conv2dDerInput",r,i);const m={dy:u,filter:e},y={strides:s,pad:r,dataFormat:a,dimRoundingMode:i,inputShape:l},b=K.runKernel(Bm,m,y);return h?J(b,[b.shape[1],b.shape[2],b.shape[3]]):b}const qv=q({conv2DBackpropInput_:X4});function K4(n,t,e,s,r,a){const i=B(n,"x","conv2dTranspose"),l=B(t,"filter","conv2dTranspose");return qv(e,i,l,s,r,"NHWC",a)}const Xv=q({conv2dTranspose_:K4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y4(n,t,e,s,r="NDHWC",a=[1,1,1]){const i=B(n,"x","conv3d"),l=B(t,"filter","conv3d");let u=i,h=!1;i.rank===4&&(h=!0,u=J(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),F(u.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${u.rank}.`),F(l.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${l.rank}.`),F(u.shape[4]===l.shape[3],()=>`Error in conv3d: depth of input (${u.shape[4]}) must match input depth for filter ${l.shape[3]}.`),F(Hn(e,a),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${e} and dilations '${a}'`),F(r==="NDHWC",()=>`Error in conv3d: got dataFormat of ${r} but only NDHWC is currently supported.`),F(Po(a),()=>"Error in conv3D: Dilated rates should be larger than 0."),F(Po(e),()=>"Error in conv3D: Strides should be larger than 0.");const d={x:u,filter:l},p={strides:e,pad:s,dataFormat:r,dilations:a},m=K.runKernel(Pm,d,p);return h?J(m,[m.shape[1],m.shape[2],m.shape[3],m.shape[4]]):m}const LE=q({conv3d_:Y4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z4(n,t,e,s,r){F(n.length===t.rank,()=>`Length of inShape (${n.length}) and rank of dy (${t.rank}) must match`);let a=n,i=t,l=!1;t.rank===4&&(l=!0,i=J(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]),a=[1,n[0],n[1],n[2],n[3]]);const u=a[4],h=i.shape[4];F(a.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${a.length}.`),F(i.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${i.rank}`),F(e.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${e.rank}`),F(u===e.shape[3],()=>`Error in conv3dDerInput: depth of input (${u}) must match input depth for filter ${e.shape[3]}.`),F(h===e.shape[4],()=>`Error in conv3dDerInput: depth of output (${h}) must match output depth for filter ${e.shape[4]}.`);const d={dy:i,filter:e},p={pad:r,strides:s,inputShape:a},m=K.runKernel(G1,d,p);return l?J(m,[m.shape[1],m.shape[2],m.shape[3],m.shape[4]]):m}const zE=q({conv3DBackpropInput_:Z4});function Q4(n,t,e,s,r){const a=B(n,"x","conv3dTranspose"),i=B(t,"filter","conv3dTranspose");return zE(e,a,i,s,r)}const ME=q({conv3dTranspose_:Q4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J4(n){const e={x:B(n,"x","cos","float32")};return K.runKernel(_h,e)}const Og=q({cos_:J4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tP(n){const e={x:B(n,"x","cosh","float32")};return K.runKernel(Fh,e)}const Kv=q({cosh_:tP});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eP(n,t=0,e=!1,s=!1){const a={x:B(n,"x","cumprod")},i={axis:t,exclusive:e,reverse:s};return K.runKernel(W1,a,i)}const Yp=q({cumprod_:eP});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nP(n,t=0,e=!1,s=!1){const a={x:B(n,"x","cumsum")},i={axis:t,exclusive:e,reverse:s};return K.runKernel(Vm,a,i)}const Yv=q({cumsum_:nP});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sP(n,t,e,s=!1){const r=B(n,"x","denseBincount"),a=B(t,"weights","denseBincount");F(r.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${r.dtype}`),F(r.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${r.rank}.`),F(e>=0,()=>`size must be non-negative, but got ${e}.`),F(a.size===r.size||a.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${r.shape}, weights shape: ${a.shape}.`);const i={x:r,weights:a},l={size:e,binaryOutput:s};return K.runKernel(j1,i,l)}const Gx=q({denseBincount_:sP});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rP(n,t,e="NHWC"){const s=B(n,"x","depthToSpace","float32"),r=e==="NHWC"?s.shape[1]:s.shape[2],a=e==="NHWC"?s.shape[2]:s.shape[3],i=e==="NHWC"?s.shape[3]:s.shape[1];F(t>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${t}`),F(r*t>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${r} and ${t}  for depthToSpace with input shape
    ${s.shape}`),F(a*t>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${a} and ${t} for depthToSpace with input shape
        ${s.shape}`),F(i%(t*t)===0,()=>`Dimension size must be evenly divisible by ${t*t} but is ${i} for depthToSpace with input shape ${s.shape}`);const l={x:s},u={blockSize:t,dataFormat:e};return K.runKernel(q1,l,u)}const BE=q({depthToSpace_:rP});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aP(n,t,e,s,r="NHWC",a=[1,1],i){const l=B(n,"x","depthwiseConv2d","float32"),u=B(t,"filter","depthwiseConv2d","float32");let h=l,d=!1;l.rank===3&&(d=!0,h=J(l,[1,l.shape[0],l.shape[1],l.shape[2]])),F(h.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${h.rank}.`),F(u.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${u.rank}.`);const p=r==="NHWC"?h.shape[3]:h.shape[1];F(p===u.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${p}) must match the inChannels dimension in filter ${u.shape[2]}.`),hs("depthwiseConv2d",s,i);const m={x:h,filter:u},y={strides:e,pad:s,dataFormat:r,dilations:a,dimRoundingMode:i},b=K.runKernel(Um,m,y);return d?J(b,[b.shape[1],b.shape[2],b.shape[3]]):b}const Sd=q({depthwiseConv2d_:aP});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iP(n){const e={x:B(n,"x","diag")};return K.runKernel(Y1,e)}const oP=q({diag_:iP});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lP(n,t,e,s,r=[1,1],a="NHWC"){const i=B(n,"x","dilation2d"),l=B(t,"filter","dilation2d");F(i.rank===3||i.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${i.rank}.`),F(l.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${l.rank}.`),F(a==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${a}`);let u=i,h=!1;i.rank===3&&(u=J(i,[1,i.shape[0],i.shape[1],i.shape[2]]),h=!0),F(u.shape[3]===l.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${u.shape[3]} vs ${l.shape[2]}`);const d={x:u,filter:l},p={strides:e,pad:s,dilations:r},m=K.runKernel(Gm,d,p);return h?J(m,[m.shape[1],m.shape[2],m.shape[3]]):m}const PE=q({dilation2d_:lP});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function du(n,t){const e=n.length,s=[];for(let r=0;r<e;r++){const a=e-1-r,i=n[a]||1;(t[t.length-1-r]||1)>1&&i===1&&s.unshift(a)}return s}function $n(n,t){const e=[];for(let s=0;s<t.length;s++){const r=n[n.length-s-1],a=t.length-s-1,i=t[a];(r==null||r===1&&i>1)&&e.unshift(a)}return e}function Yt(n,t){const e=Math.max(n.length,t.length),s=new Array(e);for(let r=0;r<e;r++){let a=n[n.length-r-1];a==null&&(a=1);let i=t[t.length-r-1];if(i==null&&(i=1),a===1)s[e-r-1]=i;else if(i===1)s[e-r-1]=a;else if(a!==i){const l=`Operands could not be broadcast together with shapes ${n} and ${t}.`;throw Error(l)}else s[e-r-1]=a}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uP(n,t){let e=B(n,"a","equal","string_or_numeric"),s=B(t,"b","equal","string_or_numeric");[e,s]=Qe(e,s),Yt(e.shape,s.shape);const r={a:e,b:s};return K.runKernel(Wm,r)}const Mr=q({equal_:uP});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cP(n,t,e){const s=B(t,"a","where"),r=B(e,"b","where"),a=B(n,"condition","where","bool"),i=Yt(Yt(a.shape,s.shape),r.shape),l=au(a,i),u=au(s,i),h=au(r,i),d={condition:l,t:u,e:h};return K.runKernel(vg,d)}const Jn=q({where_:cP});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hP(n){const e={x:B(n,"x","zerosLike")};return K.runKernel(Eg,e)}const pe=q({zerosLike_:hP});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dP(n,t){let e=B(n,"a","div"),s=B(t,"b","div");[e,s]=Qe(e,s);const r=_t(e,s),a=pe(r),i=Mr(s,a);return Jn(i,a,r)}const VE=q({divNoNan_:dP});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fP(n,t){const e=B(n,"t1","dot"),s=B(t,"t2","dot");F((e.rank===1||e.rank===2)&&(s.rank===1||s.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${e.rank} and ${s.rank}.`);const r=e.rank===1?e.size:e.shape[1],a=s.rank===1?s.size:s.shape[0];if(F(r===a,()=>`Error in dot: inner dimensions of inputs must match, but got ${r} and ${a}.`),e.rank===1&&s.rank===1){const i=J(e,[1,-1]),l=J(s,[-1,1]),u=le(i,l);return J(u,[])}else if(e.rank===1&&s.rank===2){const i=J(e,[1,-1]),l=J(s,[s.shape[0],s.shape[1]]),u=le(i,l);return J(u,[u.size])}else if(e.rank===2&&s.rank===1){const i=J(s,[-1,1]),l=le(e,i);return J(l,[l.size])}else{const i=J(s,[s.shape[0],s.shape[1]]);return le(e,i)}}const UE=q({dot_:fP});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pP(n,...t){const e=t.map((r,a)=>B(r,`tensors${a}`,"einsum")),s={equation:n};return K.runKernel(Z1,e,s)}const Ql=q({einsum_:pP});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mP(n){const e={x:B(n,"x","elu","float32")};return K.runKernel(zh,e)}const Cd=q({elu_:mP});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gP(n,t){const e=B(n,"x","ensureShape","string_or_numeric");if(!kM(e.shape,t))throw new Error(`EnsureShape: Shape of tensor ${e.shape} is not compatible with expected shape ${t}`);return n}const yP=q({ensureShape_:gP});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bP(n){let t=B(n,"x","erf");F(t.dtype==="int32"||t.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),t.dtype==="int32"&&(t=kt(t,"float32"));const e={x:t};return K.runKernel(Mh,e)}const Zv=q({erf_:bP});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qv(n,t){for(let e=0;e<n.length;++e)if(n[n.length-e-1]!==t-1-e)return!1;return!0}function GE(n,t,e){const s=n.length+t.length,r=[];let a=0,i=0;for(let l=0;l<s;l++)e.indexOf(l)===-1?r.push(n[a++]):r.push(t[i++]);return r}function _n(n,t){const e=[],s=n.length;for(let a=0;a<s;a++)t.indexOf(a)===-1&&e.push(n[a]);const r=t.map(a=>n[a]);return[e,r]}function on(n,t){const e=t.map(s=>1);return GE(n,e,t)}function jn(n,t,e){F(Qv(t,e),()=>`${n} supports only inner-most axes for now. Got axes ${t} and rank-${e} input.`)}function qe(n,t){if(Qv(n,t))return null;const e=[];for(let s=0;s<t;++s)n.indexOf(s)===-1&&e.push(s);return n.forEach(s=>e.push(s)),e}function Wi(n){return n.map((t,e)=>[e,t]).sort((t,e)=>t[1]-e[1]).map(t=>t[0])}function ln(n,t){const e=[];for(let s=t-n;s<t;++s)e.push(s);return e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xP(n,t=null,e=!1){const r={x:B(n,"x","max")},a={reductionIndices:t,keepDims:e};return K.runKernel(ng,r,a)}const vr=q({max_:xP});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vP(n,t=null,e=!1){const r={x:B(n,"x","min")},a={axis:t,keepDims:e};return K.runKernel(ig,r,a)}const uh=q({min_:vP});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wP(n,t){let e=B(n,"base","pow"),s=B(t,"exp","pow");[e,s]=Qe(e,s);const r={a:e,b:s};return K.runKernel(td,r)}const La=q({pow_:wP});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vt(n,t){if((wr(n)&&t!=="string"||Array.isArray(n))&&t!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(t==="string"&&wr(n)&&!(n instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Ui(n,[],[],t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SP(n){const e={x:B(n,"x","sqrt","float32")};return K.runKernel(dd,e)}const Wn=q({sqrt_:SP});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CP(n){const t=B(n,"x","square"),e={};return K.runKernel("Square",{x:t},e)}const Ae=q({square_:CP});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NP(n,t=null,e=!1){let s=B(n,"x","sum");s.dtype==="bool"&&(s=kt(s,"int32"));const r={x:s},a={axis:t,keepDims:e};return K.runKernel(Sg,r,a)}const Ft=q({sum_:NP});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TP(n,t="euclidean",e=null,s=!1){n=B(n,"x","norm");const r=WE(n,t,e);let a=r.shape;if(s){const i=re(e,n.shape);a=on(r.shape,i)}return J(r,a)}function WE(n,t,e=null){if(n.rank===0)return bn(n);if(n.rank!==1&&e===null)return WE(J(n,[-1]),t,e);if(n.rank===1||typeof e=="number"||Array.isArray(e)&&e.length===1){if(t===1)return Ft(bn(n),e);if(t===1/0)return vr(bn(n),e);if(t===-1/0)return uh(bn(n),e);if(t==="euclidean"||t===2)return Wn(Ft(La(bn(n),Vt(2,"int32")),e));throw new Error(`Error in norm: invalid ord value: ${t}`)}if(Array.isArray(e)&&e.length===2){if(t===1)return vr(Ft(bn(n),e[0]),e[1]-1);if(t===1/0)return vr(Ft(bn(n),e[1]),e[0]);if(t===-1/0)return uh(Ft(bn(n),e[1]),e[0]);if(t==="fro"||t==="euclidean")return Wn(Ft(Ae(n),e));throw new Error(`Error in norm: invalid ord value: ${t}`)}throw new Error(`Error in norm: invalid axis: ${e}`)}const Nd=q({norm_:TP});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $P(n,t=null,e=!1){return Nd(n,"euclidean",t,e)}const HE=q({euclideanNorm_:$P});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kP(n){const e={x:B(n,"x","exp")};return K.runKernel(Bh,e)}const Fs=q({exp_:kP});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IP(n,t=0){const e=B(n,"x","expandDims","string_or_numeric");F(t<=e.rank,()=>"Axis must be <= rank of the tensor");const s={input:e},r={dim:t};return K.runKernel(Hm,s,r)}const Qn=q({expandDims_:IP});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EP(n){const e={x:B(n,"x","expm1")};return K.runKernel(Ph,e)}const jE=q({expm1_:EP});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DP(n,t){const e=B(n,"x","tile","string_or_numeric");F(e.rank===t.length,()=>`Error in transpose: rank of input ${e.rank} must match length of reps ${t}.`);const s={x:e},r={reps:t};return K.runKernel(yd,s,r)}const gr=q({tile_:DP});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AP(n,t,e,s="float32"){t==null&&(t=n);const r=te([n,t],s),a=n<=t?n:t;for(let l=0;l<a;++l)r.set(1,l,l);const i=J(r.toTensor(),[n,t]);if(e==null)return i;if(e.length===1)return gr(Qn(i,0),[e[0],1,1]);if(e.length===2)return gr(Qn(Qn(i,0),0),[e[0],e[1],1,1]);if(e.length===3)return gr(Qn(Qn(Qn(i,0),0),0),[e[0],e[1],e[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${e.length}D.`)}const Jv=q({eye_:AP});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RP(n){const e={x:B(n,"x","floor","float32")};return K.runKernel(Vh,e)}const Td=q({floor_:RP});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OP(n,t,e=0,s=0){const r=B(n,"x","gather"),a=B(t,"indices","gather","int32"),i={x:r,indices:a},l={axis:e,batchDims:s};return K.runKernel(qm,i,l)}const $d=q({gather_:OP});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _P(n,t){let e=B(n,"a","greater","string_or_numeric"),s=B(t,"b","greater","string_or_numeric");[e,s]=Qe(e,s),Yt(e.shape,s.shape);const r={a:e,b:s};return K.runKernel(Xm,r)}const Ps=q({greater_:_P});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FP(n,t){let e=B(n,"a","greaterEqual","string_or_numeric"),s=B(t,"b","greaterEqual","string_or_numeric");[e,s]=Qe(e,s),Yt(e.shape,s.shape);const r={a:e,b:s};return K.runKernel(Gh,r)}const Hi=q({greaterEqual_:FP});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LP(n){const e={input:B(n,"input","imag")};return K.runKernel(rv,e)}const _g=q({imag_:LP});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zP(n){const e={x:B(n,"x","isFinite")};return K.runKernel(Hh,e)}const qE=q({isFinite_:zP});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MP(n){const e={x:B(n,"x","isInf")};return K.runKernel(jh,e)}const XE=q({isInf_:MP});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BP(n){const e={x:B(n,"x","isNaN")};return K.runKernel(qh,e)}const KE=q({isNaN_:BP});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PP(n,t=.2){const s={x:B(n,"x","leakyRelu")},r={alpha:t};return K.runKernel(Km,s,r)}const Fg=q({leakyRelu_:PP});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VP(n,t){let e=B(n,"a","less","string_or_numeric"),s=B(t,"b","less","string_or_numeric");[e,s]=Qe(e,s),Yt(e.shape,s.shape);const r={a:e,b:s};return K.runKernel(Ym,r)}const ch=q({less_:VP});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UP(n,t){let e=B(n,"a","lessEqual","string_or_numeric"),s=B(t,"b","lessEqual","string_or_numeric");[e,s]=Qe(e,s),Yt(e.shape,s.shape);const r={a:e,b:s};return K.runKernel(Zm,r)}const Yo=q({lessEqual_:UP});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GP(n,t,e){if(e<=0)throw new Error("The number of values should be positive.");const s={start:n,stop:t,num:e};return K.runKernel(av,{},s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WP(n,t=5,e=1,s=1,r=.5){const a=B(n,"x","localResponseNormalization");F(a.rank===4||a.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${a.rank}.`),F(uu(t),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${t}.`);let i=a,l=!1;a.rank===3&&(l=!0,i=J(a,[1,a.shape[0],a.shape[1],a.shape[2]]));const u={x:i},h={depthRadius:t,bias:e,alpha:s,beta:r},d=K.runKernel(eg,u,h);return l?J(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const YE=q({localResponseNormalization_:WP});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HP(n){const e={x:B(n,"x","log","float32")};return K.runKernel(Xh,e)}const Qs=q({log_:HP});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jP(n){const e={x:B(n,"x","log1p")};return K.runKernel(Kh,e)}const Lg=q({log1p_:jP});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qP(n,t){F(Tx(n),()=>"The f passed in variableGrads(f) must be a function"),F(t==null||Array.isArray(t)&&t.every(h=>h instanceof qp),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const e=t!=null;if(!e){t=[];for(const h in K.registeredVariables)t.push(K.registeredVariables[h])}const s=e?t.filter(h=>!h.trainable):null,r=t.length;t=t.filter(h=>h.trainable),F(t.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${r} variables is trainable.`);const a=!0,{value:i,grads:l}=K.gradients(n,t,null,a);F(l.some(h=>h!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),F(i.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${i.rank} tensor`);const u={};return t.forEach((h,d)=>{l[d]!=null&&(u[h.name]=l[d])}),s!=null&&s.forEach(h=>u[h.name]=null),{value:i,grads:u}}function za(n){return K.customGrad(n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XP(n){const e={x:B(n,"x","neg")};return K.runKernel(lg,e)}const Be=q({neg_:XP});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KP(n){const e={x:B(n,"x","softplus")};return K.runKernel(hd,e)}const Ou=q({softplus_:KP});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YP(n){const t=B(n,"x","logSigmoid");return za(s=>({value:Be(Ou(Be(s))),gradFunc:i=>X(i,Fr(Be(s)))}))(t)}const ZE=q({logSigmoid_:YP});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZP(n,t){let e=B(n,"a","sub"),s=B(t,"b","sub");[e,s]=Qe(e,s);const r={a:e,b:s};return K.runKernel(pd,r)}const Rt=q({sub_:ZP});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QP(n,t=-1){const e=B(n,"logits","logSoftmax");if(t===-1&&(t=e.rank-1),t!==e.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${e.rank} and axis was ${t}`);return za((r,a)=>{const l=vr(r,t,!0),u=Rt(r,l),h=Rt(kt(u,"float32"),Qs(Ft(Fs(u),t,!0)));return a([h]),{value:h,gradFunc:(p,m)=>{const[y]=m,b=!0,x=Fs(y);return Rt(p,X(Ft(p,t,b),x))}}})(e)}const tw=q({logSoftmax_:QP});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JP(n,t=null,e=!1){const s=B(n,"x","logSumExp"),r=re(t,s.shape),a=vr(s,r,!0),i=Rt(s,a),l=Fs(i),u=Ft(l,r),h=Qs(u),d=St(J(a,h.shape),h);if(e){const p=on(d.shape,r);return J(d,p)}return d}const zg=q({logSumExp_:JP});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tV(n,t){const e=B(n,"a","logicalAnd","bool"),s=B(t,"b","logicalAnd","bool");Yt(e.shape,s.shape);const r={a:e,b:s};return K.runKernel(Qm,r)}const oa=q({logicalAnd_:tV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eV(n){const e={x:B(n,"x","logicalNot","bool")};return K.runKernel(Jm,e)}const Mg=q({logicalNot_:eV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nV(n,t){const e=B(n,"a","logicalOr","bool"),s=B(t,"b","logicalOr","bool");Yt(e.shape,s.shape);const r={a:e,b:s};return K.runKernel(tg,r)}const ew=q({logicalOr_:nV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sV(n,t){const e=B(n,"a","logicalXor","bool"),s=B(t,"b","logicalXor","bool");return Yt(e.shape,s.shape),oa(ew(n,t),Mg(oa(n,t)))}const QE=q({logicalXor_:sV});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ap=2147483648;function rV(n,t,e="left"){const s=B(n,"sortedSequence","searchSorted"),r=B(t,"values","searchSorted"),a=s.shape[s.shape.length-1],i=r.shape[r.shape.length-1],l=J(s,[-1,a]),u=J(r,[-1,i]);if(l.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(l.shape[0]!==u.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(mt(u.shape)>=ap)throw new Error(`values tensor size must less than ${ap}`);if(l.shape[1]>=ap)throw new Error(`trailing dim_size must less than ${ap} for int32 output type, was ${l.shape[1]}`);const h={sortedSequence:l,values:u},d={side:e};return K.runKernel(Cv,h,d)}const nw=q({searchSorted_:rV});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aV(n,t){return nw(n,t,"left")}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iV(n,t,e,s,r){const a=B(n,"x","maxPool"),i=1;let l=a,u=!1;a.rank===3&&(u=!0,l=J(a,[1,a.shape[0],a.shape[1],a.shape[2]])),F(l.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${l.rank}.`),F(Hn(e,i),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${e} and dilations '${i}'`),hs("maxPool",s,r);const h={x:l},d={filterSize:t,strides:e,pad:s,dimRoundingMode:r},p=K.runKernel(sg,h,d);return u?J(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const Bg=q({maxPool_:iV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oV(n,t=[1,1,1],e,s,r,a="NDHWC"){const i=B(n,"x","maxPool3d");let l=i,u=!1;i.rank===4&&(u=!0,l=J(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),F(l.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${l.rank}.`),F(a==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${a}`),hs("maxPool3d",s,r);const h={x:l},d={filterSize:t,strides:e,pad:s,dimRoundingMode:r,dataFormat:a},p=K.runKernel(rg,h,d);return u?J(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}const JE=q({maxPool3d_:oV});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lV(n,t,e,s,r=!1){const i={x:B(n,"x","maxPoolWithArgmax")},l={filterSize:t,strides:e,pad:s,includeBatchInIndex:r},u=K.runKernel(uv,i,l);return{result:u[0],indexes:u[1]}}const uV=q({maxPoolWithArgmax_:lV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cV(n,t){let e=B(n,"a","maximum"),s=B(t,"b","maximum");[e,s]=Qe(e,s),e.dtype==="bool"&&(e=kt(e,"int32"),s=kt(s,"int32")),Yt(e.shape,s.shape);const r={a:e,b:s};return K.runKernel(Yh,r)}const Wa=q({maximum_:cV});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hV(n,t=null,e=!1){const r={x:B(n,"x","mean")},a={axis:t,keepDims:e};return K.runKernel(ag,r,a)}const Ze=q({mean_:hV});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vn(n,t="float32"){if(tr(n),t==="complex64"){const s=vn(n,"float32"),r=vn(n,"float32");return Ii(s,r)}const e=ts(mt(n),t);return K.makeTensor(e,n,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Is(n,t="float32"){if(tr(n),t==="complex64"){const s=Is(n,"float32"),r=vn(n,"float32");return Ii(s,r)}const e=R1(mt(n),t);return K.makeTensor(e,n,t)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dV(n,t,{indexing:e="xy"}={}){if(e!=="xy"&&e!=="ij")throw new TypeError(`${e} is not a valid third argument to meshgrid`);if(n===void 0)return[];let s=B(n,"x","meshgrid",n instanceof Me?n.dtype:"float32");if(t===void 0)return[s];let r=B(t,"y","meshgrid",t instanceof Me?t.dtype:"float32");const a=mt(s.shape),i=mt(r.shape);return e==="xy"?(s=J(s,[1,-1]),r=J(r,[-1,1]),[le(Is([i,1],s.dtype),s),le(r,Is([1,a],r.dtype))]):(s=J(s,[-1,1]),r=J(r,[1,-1]),[le(s,Is([1,i],s.dtype)),le(Is([a,1],r.dtype),r)])}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fV(n,t){let e=B(n,"a","minimum"),s=B(t,"b","minimum");[e,s]=Qe(e,s),e.dtype==="bool"&&(e=kt(e,"int32"),s=kt(s,"int32")),Yt(e.shape,s.shape);const r={a:e,b:s};return K.runKernel(Zh,r)}const Uo=q({minimum_:fV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pV(n,t,e){F(e==="reflect"||e==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${e}.`);const s=B(n,"x","mirrorPad");if(s.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");F(t.length===s.rank,()=>`Padding doesn't match input. Must be ${s.rank}. Got ${t.length}.`);const r=e==="reflect"?1:0;for(let l=0;l<s.rank;l++)F(t[l].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),F(t[l][0]>=0&&t[l][0]<=s.shape[l]-r&&t[l][1]>=0&&t[l][1]<=s.shape[l]-r,()=>`Padding in dimension ${l} cannot be greater than or equal to ${s.shape[l]-r} or less than 0 for input of shape ${s.shape}`);const a={paddings:t,mode:e},i={x:s};return K.runKernel(og,i,a)}const tD=q({mirrorPad_:pV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mV(n,t){let e=B(n,"a","mod"),s=B(t,"b","mod");[e,s]=Qe(e,s);const r={a:e,b:s};return K.runKernel(Qh,r)}const eD=q({mod_:mV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gV(n,t=null,e=!1){n=B(n,"x","moments");const s=re(t,n.shape),r=Ze(n,s,e);let a=r.shape;e||(a=on(r.shape,s));const i=Ae(Rt(kt(n,"float32"),J(r,a))),l=Ze(i,s,e);return{mean:r,variance:l}}const Pg=q({moments_:gV});function yV(n,t,e,s){const r=B(t,"data","multiRNNCell"),a=Xp(e,"c","multiRNNCell"),i=Xp(s,"h","multiRNNCell");let l=r;const u=[];for(let p=0;p<n.length;p++){const m=n[p](l,a[p],i[p]);u.push(m[0]),u.push(m[1]),l=m[1]}const h=[],d=[];for(let p=0;p<u.length;p+=2)h.push(u[p]),d.push(u[p+1]);return[h,d]}const bV=q({multiRNNCell_:yV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xV(n,t,e,s=!1){const r=B(n,"logits","multinomial"),a=r.size,i=r.rank;if(a<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${a}.`);if(i>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${i}`);e=e||Math.random();const u={logits:i===1?J(r,[1,-1]):r},h={numSamples:t,seed:e,normalized:s},d=K.runKernel(cv,u,h);return i===1?J(d,[d.size]):d}const vV=q({multinomial_:xV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wV(n,t){let e=B(n,"a","notEqual","string_or_numeric"),s=B(t,"b","notEqual","string_or_numeric");[e,s]=Qe(e,s),Yt(e.shape,s.shape);const r={a:e,b:s};return K.runKernel(ug,r)}const fu=q({notEqual_:wV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SV(n,t,e=1,s=0,r="int32"){if(t<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${t}`);const i={indices:B(n,"indices","oneHot","int32")},l={dtype:r,depth:t,onValue:e,offValue:s};return K.runKernel(hg,i,l)}const sw=q({oneHot_:SV});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CV(n){const e={x:B(n,"x","onesLike")};return K.runKernel(cg,e)}const Js=q({onesLike_:CV});function NV(n,t){const e=B(n,"v1","outerProduct"),s=B(t,"v2","outerProduct");F(e.rank===1&&s.rank===1,()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${e.rank} and ${s.rank}.`);const r=J(e,[-1,1]),a=J(s,[1,-1]);return le(r,a)}const TV=q({outerProduct_:NV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $V(n,t,e=0){const s=B(n,"x","pad");if(s.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const r={paddings:t,constantValue:e},a={x:s};return K.runKernel(fg,a,r)}const ji=q({pad_:$V});function kV(n,t,e=0){return F(t.length===2,()=>"Invalid number of paddings. Must be length of 2."),ji(n,[t],e)}const IV=q({pad1d_:kV});function EV(n,t,e=0){return F(t.length===2&&t[0].length===2&&t[1].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),ji(n,t,e)}const DV=q({pad2d_:EV});function AV(n,t,e=0){return F(t.length===3&&t[0].length===2&&t[1].length===2&&t[2].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),ji(n,t,e)}const RV=q({pad3d_:AV});function OV(n,t,e=0){return F(t.length===4&&t[0].length===2&&t[1].length===2&&t[2].length===2&&t[3].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),ji(n,t,e)}const _V=q({pad4d_:OV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FV(n,t,e){const s=B(n,"x","spaceToBatchND");F(s.rank>=1+t.length,()=>`input rank ${s.rank} should be > than [blockShape] ${t.length}`),F(e.length===t.length,()=>`paddings.shape[0] ${e.length} must be equal to [blockShape] ${t.length}`),F(s.shape.reduce((i,l,u)=>u>0&&u<=t.length?i&&(l+e[u-1][0]+e[u-1][1])%t[u-1]===0:i,!0),()=>`input spatial dimensions ${s.shape.slice(1)} with paddings ${e.toString()} must be divisible by blockShapes ${t.toString()}`);const r={x:s},a={blockShape:t,paddings:e};return K.runKernel(Cg,r,a)}const Vg=q({spaceToBatchND_:FV});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LV(n,t,e,s,r,a,i){r==null&&(r=[1,1]),a==null&&(a=1),s===0&&(s="valid");const l=B(n,"x","maxPool");let u=l,h=!1;l.rank===3&&(h=!0,u=J(l,[1,l.shape[0],l.shape[1],l.shape[2]])),F(Hn(a,r),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${a} and dilations '${r}'`);const d=Tr(u.shape,t,a,r,s),p=[d.dilationHeight,d.dilationWidth];let m;s==="same"?m=MV([d.filterHeight,d.filterWidth],p):m=[[0,0],[0,0]];const y=p[0]===1&&p[1]===1,[b,x]=zV([d.inHeight,d.inWidth],p,m),v=y?s:"valid",S=y?u:Vg(u,p,b),$=(e==="avg"?()=>Ag(S,t,a,v,i):()=>Bg(S,t,a,v,i))(),T=y?$:Rg($,p,x);return h?J(T,[T.shape[1],T.shape[2],T.shape[3]]):T}function zV(n,t,e){const s=e.map(d=>d[0]),r=e.map(d=>d[1]),a=n.concat(s,r),i=t.map((d,p)=>(d-a[p]%d)%d),l=r.map((d,p)=>d+i[p]),u=t.map((d,p)=>[s[p],l[p]]),h=t.map((d,p)=>[0,i[p]]);return[u,h]}function MV(n,t){const s=n.map((i,l)=>i+(i-1)*(t[l]-1)).map(i=>i-1),r=s.map(i=>Math.floor(i/2)),a=s.map((i,l)=>i-r[l]);return s.map((i,l)=>[r[l],a[l]])}const nD=q({pool_:LV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BV(n,t){const e=B(n,"x","prelu"),s=B(t,"alpha","prelu"),r={x:e,alpha:s};return K.runKernel(pg,r)}const Ug=q({prelu_:BV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PV(n,t=null,e=!1){let s=B(n,"x","prod");s.dtype==="bool"&&(s=kt(s,"int32"));const r={x:s},a={axis:t,keepDims:e};return K.runKernel(mg,r,a)}const sD=q({prod_:PV});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VV(n,t,e,s){const r=n.map((d,p)=>B(d,`tensors${p}`,"raggedGather","int32")),a=B(t,"paramsDenseValues","raggedGather"),i=B(e,"indices","raggedGather","int32"),l={paramsNestedSplits:r,paramsDenseValues:a,indices:i},u={outputRaggedRank:s},h=K.runKernel(pv,l,u);return{outputNestedSplits:h.slice(0,h.length-1),outputDenseValues:h[h.length-1]}}const UV=q({raggedGather_:VV});/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GV(n,t,e){const s=B(n,"starts","raggedRange"),r=B(t,"limits","raggedRange",s.dtype),a=B(e,"deltas","raggedRange",s.dtype),i={starts:s,limits:r,deltas:a},l=K.runKernel(mv,i);return{rtNestedSplits:l[0],rtDenseValues:l[1]}}const WV=q({raggedRange_:GV});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HV(n,t,e,s,r){const a=B(n,"shape","raggedTensorToTensor","int32"),i=B(t,"values","raggedTensorToTensor"),l=B(e,"defaultValue","raggedTensorToTensor",i.dtype),u=s.map((p,m)=>B(p,`tensors${m}`,"raggedTensorToTensor","int32")),h={shape:a,values:i,defaultValue:l,rowPartitionTensors:u},d={rowPartitionTypes:r};return K.runKernel(gv,h,d)}const jV=q({raggedTensorToTensor_:HV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qV(n,t,e){tr(n);const s=mt(n);let r=null;if(e==null||e==="float32")r=new Float32Array(s);else if(e==="int32")r=new Int32Array(s);else if(e==="bool")r=new Uint8Array(s);else throw new Error(`Unknown data type ${e}`);for(let a=0;a<s;a++)r[a]=t();return K.makeTensor(r,n,e)}const XV=q({rand_:qV});var Np={exports:{}},KV=Np.exports,p2;function YV(){return p2||(p2=1,function(n){(function(t,e,s){function r(u){var h=this,d=l();h.next=function(){var p=2091639*h.s0+h.c*23283064365386963e-26;return h.s0=h.s1,h.s1=h.s2,h.s2=p-(h.c=p|0)},h.c=1,h.s0=d(" "),h.s1=d(" "),h.s2=d(" "),h.s0-=d(u),h.s0<0&&(h.s0+=1),h.s1-=d(u),h.s1<0&&(h.s1+=1),h.s2-=d(u),h.s2<0&&(h.s2+=1),d=null}function a(u,h){return h.c=u.c,h.s0=u.s0,h.s1=u.s1,h.s2=u.s2,h}function i(u,h){var d=new r(u),p=h&&h.state,m=d.next;return m.int32=function(){return d.next()*4294967296|0},m.double=function(){return m()+(m()*2097152|0)*11102230246251565e-32},m.quick=m,p&&(typeof p=="object"&&a(p,d),m.state=function(){return a(d,{})}),m}function l(){var u=4022871197,h=function(d){d=String(d);for(var p=0;p<d.length;p++){u+=d.charCodeAt(p);var m=.02519603282416938*u;u=m>>>0,m-=u,m*=u,u=m>>>0,m-=u,u+=m*4294967296}return(u>>>0)*23283064365386963e-26};return h}e&&e.exports?e.exports=i:this.alea=i})(KV,n)}(Np)),Np.exports}var Tp={exports:{}},ZV=Tp.exports,m2;function QV(){return m2||(m2=1,function(n){(function(t,e,s){function r(l){var u=this,h="";u.x=0,u.y=0,u.z=0,u.w=0,u.next=function(){var p=u.x^u.x<<11;return u.x=u.y,u.y=u.z,u.z=u.w,u.w^=u.w>>>19^p^p>>>8},l===(l|0)?u.x=l:h+=l;for(var d=0;d<h.length+64;d++)u.x^=h.charCodeAt(d)|0,u.next()}function a(l,u){return u.x=l.x,u.y=l.y,u.z=l.z,u.w=l.w,u}function i(l,u){var h=new r(l),d=u&&u.state,p=function(){return(h.next()>>>0)/4294967296};return p.double=function(){do var m=h.next()>>>11,y=(h.next()>>>0)/4294967296,b=(m+y)/(1<<21);while(b===0);return b},p.int32=h.next,p.quick=p,d&&(typeof d=="object"&&a(d,h),p.state=function(){return a(h,{})}),p}e&&e.exports?e.exports=i:this.xor128=i})(ZV,n)}(Tp)),Tp.exports}var $p={exports:{}},JV=$p.exports,g2;function tU(){return g2||(g2=1,function(n){(function(t,e,s){function r(l){var u=this,h="";u.next=function(){var p=u.x^u.x>>>2;return u.x=u.y,u.y=u.z,u.z=u.w,u.w=u.v,(u.d=u.d+362437|0)+(u.v=u.v^u.v<<4^(p^p<<1))|0},u.x=0,u.y=0,u.z=0,u.w=0,u.v=0,l===(l|0)?u.x=l:h+=l;for(var d=0;d<h.length+64;d++)u.x^=h.charCodeAt(d)|0,d==h.length&&(u.d=u.x<<10^u.x>>>4),u.next()}function a(l,u){return u.x=l.x,u.y=l.y,u.z=l.z,u.w=l.w,u.v=l.v,u.d=l.d,u}function i(l,u){var h=new r(l),d=u&&u.state,p=function(){return(h.next()>>>0)/4294967296};return p.double=function(){do var m=h.next()>>>11,y=(h.next()>>>0)/4294967296,b=(m+y)/(1<<21);while(b===0);return b},p.int32=h.next,p.quick=p,d&&(typeof d=="object"&&a(d,h),p.state=function(){return a(h,{})}),p}e&&e.exports?e.exports=i:this.xorwow=i})(JV,n)}($p)),$p.exports}var kp={exports:{}},eU=kp.exports,y2;function nU(){return y2||(y2=1,function(n){(function(t,e,s){function r(l){var u=this;u.next=function(){var d=u.x,p=u.i,m,y;return m=d[p],m^=m>>>7,y=m^m<<24,m=d[p+1&7],y^=m^m>>>10,m=d[p+3&7],y^=m^m>>>3,m=d[p+4&7],y^=m^m<<7,m=d[p+7&7],m=m^m<<13,y^=m^m<<9,d[p]=y,u.i=p+1&7,y};function h(d,p){var m,y=[];if(p===(p|0))y[0]=p;else for(p=""+p,m=0;m<p.length;++m)y[m&7]=y[m&7]<<15^p.charCodeAt(m)+y[m+1&7]<<13;for(;y.length<8;)y.push(0);for(m=0;m<8&&y[m]===0;++m);for(m==8?y[7]=-1:y[m],d.x=y,d.i=0,m=256;m>0;--m)d.next()}h(u,l)}function a(l,u){return u.x=l.x.slice(),u.i=l.i,u}function i(l,u){l==null&&(l=+new Date);var h=new r(l),d=u&&u.state,p=function(){return(h.next()>>>0)/4294967296};return p.double=function(){do var m=h.next()>>>11,y=(h.next()>>>0)/4294967296,b=(m+y)/(1<<21);while(b===0);return b},p.int32=h.next,p.quick=p,d&&(d.x&&a(d,h),p.state=function(){return a(h,{})}),p}e&&e.exports?e.exports=i:this.xorshift7=i})(eU,n)}(kp)),kp.exports}var Ip={exports:{}},sU=Ip.exports,b2;function rU(){return b2||(b2=1,function(n){(function(t,e,s){function r(l){var u=this;u.next=function(){var d=u.w,p=u.X,m=u.i,y,b;return u.w=d=d+1640531527|0,b=p[m+34&127],y=p[m=m+1&127],b^=b<<13,y^=y<<17,b^=b>>>15,y^=y>>>12,b=p[m]=b^y,u.i=m,b+(d^d>>>16)|0};function h(d,p){var m,y,b,x,v,S=[],C=128;for(p===(p|0)?(y=p,p=null):(p=p+"\0",y=0,C=Math.max(C,p.length)),b=0,x=-32;x<C;++x)p&&(y^=p.charCodeAt((x+32)%p.length)),x===0&&(v=y),y^=y<<10,y^=y>>>15,y^=y<<4,y^=y>>>13,x>=0&&(v=v+1640531527|0,m=S[x&127]^=y+v,b=m==0?b+1:0);for(b>=128&&(S[(p&&p.length||0)&127]=-1),b=127,x=4*128;x>0;--x)y=S[b+34&127],m=S[b=b+1&127],y^=y<<13,m^=m<<17,y^=y>>>15,m^=m>>>12,S[b]=y^m;d.w=v,d.X=S,d.i=b}h(u,l)}function a(l,u){return u.i=l.i,u.w=l.w,u.X=l.X.slice(),u}function i(l,u){l==null&&(l=+new Date);var h=new r(l),d=u&&u.state,p=function(){return(h.next()>>>0)/4294967296};return p.double=function(){do var m=h.next()>>>11,y=(h.next()>>>0)/4294967296,b=(m+y)/(1<<21);while(b===0);return b},p.int32=h.next,p.quick=p,d&&(d.X&&a(d,h),p.state=function(){return a(h,{})}),p}e&&e.exports?e.exports=i:this.xor4096=i})(sU,n)}(Ip)),Ip.exports}var Ep={exports:{}},aU=Ep.exports,x2;function iU(){return x2||(x2=1,function(n){(function(t,e,s){function r(l){var u=this,h="";u.next=function(){var p=u.b,m=u.c,y=u.d,b=u.a;return p=p<<25^p>>>7^m,m=m-y|0,y=y<<24^y>>>8^b,b=b-p|0,u.b=p=p<<20^p>>>12^m,u.c=m=m-y|0,u.d=y<<16^m>>>16^b,u.a=b-p|0},u.a=0,u.b=0,u.c=-1640531527,u.d=1367130551,l===Math.floor(l)?(u.a=l/4294967296|0,u.b=l|0):h+=l;for(var d=0;d<h.length+20;d++)u.b^=h.charCodeAt(d)|0,u.next()}function a(l,u){return u.a=l.a,u.b=l.b,u.c=l.c,u.d=l.d,u}function i(l,u){var h=new r(l),d=u&&u.state,p=function(){return(h.next()>>>0)/4294967296};return p.double=function(){do var m=h.next()>>>11,y=(h.next()>>>0)/4294967296,b=(m+y)/(1<<21);while(b===0);return b},p.int32=h.next,p.quick=p,d&&(typeof d=="object"&&a(d,h),p.state=function(){return a(h,{})}),p}e&&e.exports?e.exports=i:this.tychei=i})(aU,n)}(Ep)),Ep.exports}var Dp={exports:{}};const oU={},lU=Object.freeze(Object.defineProperty({__proto__:null,default:oU},Symbol.toStringTag,{value:"Module"})),uU=Cz(lU);var cU=Dp.exports,v2;function hU(){return v2||(v2=1,function(n){(function(t,e,s){var r=256,a=6,i=52,l="random",u=s.pow(r,a),h=s.pow(2,i),d=h*2,p=r-1,m;function y(T,I,A){var R=[];I=I==!0?{entropy:!0}:I||{};var L=S(v(I.entropy?[T,$(e)]:T??C(),3),R),_=new b(R),M=function(){for(var D=_.g(a),W=u,et=0;D<h;)D=(D+et)*r,W*=r,et=_.g(1);for(;D>=d;)D/=2,W/=2,et>>>=1;return(D+et)/W};return M.int32=function(){return _.g(4)|0},M.quick=function(){return _.g(4)/4294967296},M.double=M,S($(_.S),e),(I.pass||A||function(D,W,et,nt){return nt&&(nt.S&&x(nt,_),D.state=function(){return x(_,{})}),et?(s[l]=D,W):D})(M,L,"global"in I?I.global:this==s,I.state)}function b(T){var I,A=T.length,R=this,L=0,_=R.i=R.j=0,M=R.S=[];for(A||(T=[A++]);L<r;)M[L]=L++;for(L=0;L<r;L++)M[L]=M[_=p&_+T[L%A]+(I=M[L])],M[_]=I;(R.g=function(D){for(var W,et=0,nt=R.i,tt=R.j,U=R.S;D--;)W=U[nt=p&nt+1],et=et*r+U[p&(U[nt]=U[tt=p&tt+W])+(U[tt]=W)];return R.i=nt,R.j=tt,et})(r)}function x(T,I){return I.i=T.i,I.j=T.j,I.S=T.S.slice(),I}function v(T,I){var A=[],R=typeof T,L;if(I&&R=="object")for(L in T)try{A.push(v(T[L],I-1))}catch{}return A.length?A:R=="string"?T:T+"\0"}function S(T,I){for(var A=T+"",R,L=0;L<A.length;)I[p&L]=p&(R^=I[p&L]*19)+A.charCodeAt(L++);return $(I)}function C(){try{var T;return m&&(T=m.randomBytes)?T=T(r):(T=new Uint8Array(r),(t.crypto||t.msCrypto).getRandomValues(T)),$(T)}catch{var I=t.navigator,A=I&&I.plugins;return[+new Date,t,A,t.screen,$(e)]}}function $(T){return String.fromCharCode.apply(0,T)}if(S(s.random(),e),n.exports){n.exports=y;try{m=uU}catch{}}else s["seed"+l]=y})(typeof self<"u"?self:cU,[],Math)}(Dp)),Dp.exports}var Xb,w2;function dU(){if(w2)return Xb;w2=1;var n=YV(),t=QV(),e=tU(),s=nU(),r=rU(),a=iU(),i=hU();return i.alea=n,i.xor128=t,i.xorwow=e,i.xorshift7=s,i.xor4096=r,i.tychei=a,Xb=i,Xb}var Gg=dU();/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rw{constructor(t,e,s,r,a){this.mean=t,this.stdDev=e,this.dtype=s,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const i=a||Math.random();this.random=Gg.alea(i.toString())}nextValue(){if(!isNaN(this.nextVal)){const r=this.nextVal;return this.nextVal=NaN,r}let t,e,s=!1;for(;!s;){let r,a,i;do r=2*this.random()-1,a=2*this.random()-1,i=r*r+a*a;while(i>=1||i===0);const l=Math.sqrt(-2*Math.log(i)/i);t=this.mean+this.stdDev*r*l,e=this.mean+this.stdDev*a*l,(!this.truncated||this.isValidTruncated(t))&&(s=!0)}return(!this.truncated||this.isValidTruncated(e))&&(this.nextVal=this.convertValue(e)),this.convertValue(t)}convertValue(t){return this.dtype==null||this.dtype==="float32"?t:Math.round(t)}isValidTruncated(t){return t<=this.upper&&t>=this.lower}}class fU{constructor(t,e,s,r){this.alpha=t,this.beta=1/e,this.dtype=s;const a=r||Math.random();this.randu=Gg.alea(a.toString()),this.randn=new rw(0,1,s,!1,this.randu()),t<1?this.d=t+2/3:this.d=t-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let t,e,s,r,a,i;for(;;){do r=this.randn.nextValue(),i=1+this.c*r;while(i<=0);if(i*=i*i,t=r*r,e=1-.331*t*t,s=.5*t+this.d*(1-i+Math.log(i)),a=this.randu(),a<e||Math.log(a)<s)break}return i=1/this.beta*this.d*i,this.alpha<1&&(i*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(i)}convertValue(t){return this.dtype==="float32"?t:Math.round(t)}}class pU{constructor(t=0,e=1,s,r){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=t,this.range=e-t,this.dtype=s,r==null&&(r=Math.random()),typeof r=="number"&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${t} - ${e} <= 1 and dtype is not float`);this.random=Gg.alea(r)}convertValue(t){return this.canReturnFloat()?t:Math.round(t)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mU(n,t,e=1,s="float32",r){if(tr(n),e==null&&(e=1),s==null&&(s="float32"),s!=="float32"&&s!=="int32")throw new Error(`Unsupported data type ${s}`);const a=new fU(t,e,s,r),i=te(n,s);for(let l=0;l<i.values.length;l++)i.values[l]=a.nextValue();return i.toTensor()}const gU=q({randomGamma_:mU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yU(n,t=0,e=1,s,r){if(tr(n),s!=null&&s==="bool")throw new Error(`Unsupported data type ${s}`);const a=new rw(t,e,s,!1,r),i=te(n,s);for(let l=0;l<i.values.length;l++)i.values[l]=a.nextValue();return i.toTensor()}const aw=q({randomNormal_:yU});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bU(n,t,e){if(t!=null&&t==="bool")throw new Error(`Unsupported data type ${t}`);return aw(n,0,1,t,e)}const xU=q({randomStandardNormal_:bU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vU(n,t=0,e=1,s="float32",r){tr(n);const a=te(n,s),i=new pU(t,e,null,r);for(let l=0;l<a.values.length;l++)a.values[l]=i.nextValue();return a.toTensor()}const Zo=q({randomUniform_:vU});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wU(n,t,e,s){return Zo(n,t,e,"int32",s)}const SU=q({randomUniformInt_:wU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pu(n,t,e=1,s="float32"){if(e===0)throw new Error("Cannot have a step of zero");const r={start:n,stop:t,step:e,dtype:s};return K.runKernel(yv,{},r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CU(n){const e={input:B(n,"input","real")};return K.runKernel(bv,e)}const hh=q({real_:CU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NU(n){const e={x:B(n,"x","reciprocal")};return K.runKernel(ed,e)}const rD=q({reciprocal_:NU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TU(n){const e={x:B(n,"x","relu")};return K.runKernel(nd,e)}const ca=q({relu_:TU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $U(n){const e={x:B(n,"x","relu6")};return K.runKernel(sd,e)}const iw=q({relu6_:$U});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kU(n,t){const s={x:B(n,"x","reverse")},r={dims:t};return K.runKernel(xg,s,r)}const Sr=q({reverse_:kU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IU(n){const t=B(n,"x","reverse");return F(t.rank===1,()=>`Error in reverse1D: x must be rank 1 but got rank ${t.rank}.`),Sr(t,0)}const EU=q({reverse1d_:IU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DU(n,t){const e=B(n,"x","reverse");return F(e.rank===2,()=>`Error in reverse2D: x must be rank 2 but got rank ${e.rank}.`),Sr(e,t)}const AU=q({reverse2d_:DU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RU(n,t){const e=B(n,"x","reverse");return F(e.rank===3,()=>`Error in reverse3D: x must be rank 3 but got rank ${e.rank}.`),Sr(e,t)}const OU=q({reverse3d_:RU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _U(n,t){const e=B(n,"x","reverse");return F(e.rank===4,()=>`Error in reverse4D: x must be rank 4 but got rank ${e.rank}.`),Sr(e,t)}const FU=q({reverse4d_:_U});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LU(n){const e={x:B(n,"x","round")};return K.runKernel(rd,e)}const ow=q({round_:LU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zU(n){const e={x:B(n,"x","rsqrt","float32")};return K.runKernel(ad,e)}const lw=q({rsqrt_:zU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MU(n){const e={x:B(n,"x","selu")};return K.runKernel(id,e)}const uw=q({selu_:MU});function BU(n,t,e,s,r,a=[1,1],i="NHWC"){const l=B(n,"x","separableConv2d"),u=B(t,"depthwiseFilter","separableConv2d"),h=B(e,"pointwiseFilter","separableConv2d");let d=l,p=!1;if(l.rank===3&&(p=!0,d=J(l,[1,l.shape[0],l.shape[1],l.shape[2]])),i==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");F(d.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${d.rank}.`),F(u.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${u.rank}.`),F(h.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${u.rank}.`),F(h.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${h.shape[0]}.`),F(h.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${h.shape[1]}.`);const m=u.shape[2],y=u.shape[3];F(h.shape[2]===m*y,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${m*y}, but got ${h.shape[2]}.`);const b=Sd(d,u,s,r,i,a),v=Ai(b,h,1,"valid",i);return p?J(v,[v.shape[1],v.shape[2],v.shape[3]]):v}const cw=q({separableConv2d_:BU});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function PU(n,t){const e=B(n,"x","setdiff1d"),s=B(t,"y","setdiff1d");F(e.dtype===s.dtype,()=>`x and y should have the same dtype, but got x (${e.dtype}) and y (${s.dtype}).`),F(e.rank===1,()=>`x should be 1D tensor, but got x (${e.shape}).`),F(s.rank===1,()=>`y should be 1D tensor, but got y (${s.shape}).`);const r=await e.data(),a=await s.data(),i=new Set(a);let l=0;for(let d=0;d<r.length;d++)i.has(r[d])||l++;const u=new Cn([l],e.dtype),h=new Cn([l],"int32");for(let d=0,p=0;d<r.length;d++)i.has(r[d])||(u.values[p]=r[d],h.values[p]=d,p++);return[u.toTensor(),h.toTensor()]}const VU=PU;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UU(n){const e={x:B(n,"x","sign")};return K.runKernel(ud,e)}const aD=q({sign_:UU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GU(n){const e={x:B(n,"x","sin","float32")};return K.runKernel(od,e)}const hw=q({sin_:GU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WU(n){const e={x:B(n,"x","sinh")};return K.runKernel(ld,e)}const dw=q({sinh_:WU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HU(n,t,e){const s=B(n,"x","slice1d");return F(s.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${s.rank} tensor`),Qt(s,[t],[e])}const Wg=q({slice1d_:HU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jU(n,t,e){const s=B(n,"x","slice2d");return F(s.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${s.rank} tensor`),Qt(s,t,e)}const fw=q({slice2d_:jU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qU(n,t,e){const s=B(n,"x","slice3d");return F(s.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${s.rank} tensor`),Qt(s,t,e)}const Hg=q({slice3d_:qU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XU(n,t,e){const s=B(n,"x","slice4d");return F(s.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${s.rank} tensor`),Qt(s,t,e)}const dh=q({slice4d_:XU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KU(n,t=-1){const e=B(n,"logits","softmax","float32");if(t===-1&&(t=e.rank-1),t!==e.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${e.rank} and dim was ${t}`);const s={logits:e},r={dim:t};return K.runKernel(Tg,s,r)}const jg=q({softmax_:KU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YU(n){F(n.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${n.dtype}.`);const t={input:n};return K.runKernel(J1,t)}const qg=q({fft_:YU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZU(n){F(n.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${n.dtype}.`);const t={input:n};return K.runKernel(sv,t)}const fh=q({ifft_:ZU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QU(n){const t=n.shape[n.shape.length-1],e=n.size/t;let s;if(t<=2){const r=J(n,[e,t]);s=fh(r)}else{const r=[e,2*(t-1)],a=J(hh(n),[e,t]),i=J(_g(n),[e,t]),l=Sr(Qt(a,[0,1],[e,t-2]),1),u=X(Sr(Qt(i,[0,1],[e,t-2]),1),Vt(-1)),h=pn([a,l],1),d=pn([i,u],1),p=J(Ii(h,d),[r[0],r[1]]);s=fh(p)}if(s=hh(s),n.rank===3&&n.shape[0]!==0){const r=s,a=n.shape[0];s=J(s,[a,s.shape[0]/a,s.shape[1]]),r.dispose()}return s}const pw=q({irfft_:QU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JU(n,t,e=0){const r={x:B(n,"x","split")},a={numOrSizeSplits:t,axis:e};return K.runKernel(Ng,r,a)}const As=q({split_:JU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tG(n,t){F(n.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${n.dtype}`);let e=n.shape[n.shape.length-1];const s=n.size/e;let r;if(t!=null&&t<e){const b=n.shape.map(v=>0),x=n.shape.map(v=>v);x[n.shape.length-1]=t,r=Qt(n,b,x),e=t}else if(t!=null&&t>e){const b=n.shape.map(x=>x);b[n.shape.length-1]=t-e,r=pn([n,vn(b)],n.shape.length-1),e=t}else r=n;const a=pe(r),i=J(Ii(r,a),[s,e]),l=qg(i),u=Math.floor(e/2)+1,h=hh(l),d=_g(l),p=As(h,[u,e-u],h.shape.length-1),m=As(d,[u,e-u],d.shape.length-1),y=r.shape.slice();return y[r.shape.length-1]=u,J(Ii(p[0],m[0]),y)}const Xg=q({rfft_:tG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eG(n,t){let e=B(n,"a","squaredDifference"),s=B(t,"b","squaredDifference");[e,s]=Qe(e,s),Yt(e.shape,s.shape);const r={a:e,b:s},a={};return K.runKernel(fd,r,a)}const mw=q({squaredDifference_:eG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nG(n,t){const e=B(n,"x","squeeze","string_or_numeric");return J(e,Bi(e.shape,t).newShape)}const Ma=q({squeeze_:nG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sG(n,t=0){const e=Xp(n,"tensors","stack","string_or_numeric");F(e.length>=1,()=>"Pass at least one tensor to tf.stack"),e.length>0&&F(t<=e[0].rank,()=>"Axis must be <= rank of the tensor");const s=e,r={axis:t};return K.runKernel(dg,s,r)}const Ls=q({stack_:sG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rG(n,t=0){const s={x:B(n,"x","step")},r={alpha:t};return K.runKernel(bd,s,r)}const _u=q({step_:rG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aG(n,t,e,s,r=0,a=0,i=0,l=0,u=0){const d={x:B(n,"x","stridedSlice","string_or_numeric")},p={begin:t,end:e,strides:s,beginMask:r,endMask:a,ellipsisMask:i,newAxisMask:l,shrinkAxisMask:u};return K.runKernel(Dv,d,p)}const iD=q({stridedSlice_:aG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iG(n){const e={x:B(n,"x","tan","float32")};return K.runKernel(md,e)}const oD=q({tan_:iG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Un(n,t){Iu(n);const e=Vi(n,t);if(e.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Ui(n,null,e,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iu(n,t,e){if(Iu(n),t!=null&&t.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const s=Vi(n,e);if(s.length!==2&&s.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(s.length===1&&t==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Ui(n,t,s,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lD(n,t,e){if(Iu(n),t!=null&&t.length!==3)throw new Error("tensor3d() requires shape to have three numbers");const s=Vi(n,e);if(s.length!==3&&s.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(s.length===1&&t==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Ui(n,t,s,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oG(n,t,e){if(Iu(n),t!=null&&t.length!==4)throw new Error("tensor4d() requires shape to have four numbers");const s=Vi(n,e);if(s.length!==4&&s.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(s.length===1&&t==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Ui(n,t,s,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lG(n,t,e){if(Iu(n),t!=null&&t.length!==5)throw new Error("tensor5d() requires shape to have five numbers");const s=Vi(n,e);if(s.length!==5&&s.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(s.length===1&&t==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Ui(n,t,s,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uG(n,t,e){if(Iu(n),t!=null&&t.length!==6)throw new Error("tensor6d() requires shape to have six numbers");const s=Vi(n,e);if(s.length!==6&&s.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(s.length===1&&t==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return t=t||s,Ui(n,t,s,e)}function uD(n,t,e){const s=t.rank>1?t.shape[t.rank-1]:1,r=t.rank>1?t.rank-1:1,a=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${e.shape}, indices.shape: ${t.shape}, shape: ${n}, sliceDim: ${s}, and batchDim: ${r}.`;if(e.rank<r)throw new Error(a+` update.rank < ${r}. `);if(n.length<s+(e.rank-r))throw new Error(a+` Output shape length < ${s+(e.rank-r)}`);if(e.rank!==r+n.length-s)throw new Error(a+` update.rank != ${r+n.length-s}`);for(let i=0;i<r;++i)if(e.shape[i]!==t.shape[i])throw new Error(a+` updates.shape[${i}] (${e.shape[i]}) != indices.shape[${i}] (${t.shape[i]}).`);for(let i=0;i<e.rank-r;++i)if(e.shape[i+r]!==n[i+s])throw new Error(a+` updates.shape[${i+r}] (${e.shape[i+r]}) != shape[${i+r}] (${n[i+r]})`)}function gw(n,t,e){if(t.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${t.rank}.`);if(n.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${n.rank}.`);if(t.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${t.dtype}`);if(e.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${e}`);if(e.length===0){if(t.size===0)throw new Error(`Indices specified for empty output. indices shape: ${t.shape}`);if(n.size===0)throw new Error(`Updates specified for empty output. updates shape: ${n.shape}`)}uD(e,t,n)}function Qo(n,t,e){const s=t.shape.length,r=s>1?t.shape[s-1]:1,a=e.length;let i=1;for(let p=r;p<a;++p)i*=e[p];const l=r<1?1:r,u=mt(t.shape)/l,h=[...Bt(e.slice(0,r)),1],d=mt(e);return{sliceRank:r,numUpdates:u,sliceSize:i,strides:h,outputSize:d}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cG(n,t,e){const s=B(n,"tensor","tensorScatterupdate"),r=B(t,"indices","tensorScatterupdate","int32"),a=B(e,"updates","tensorScatterupdate");if(gw(a,r,s.shape),s.dtype!==a.dtype)throw new Error(`tensor and updates must have the same dtype, instead they are ${s.dtype} and ${a.dtype}.`);const i={tensor:s,indices:r,updates:a},l={};return K.runKernel(Sv,i,l)}const hG=q({tensorScatterUpdate_:cG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dG(n,t=1,e=!0){const s=B(n,"x","topk");if(s.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const r=s.shape[s.shape.length-1];if(t<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${t}`);if(t>r)throw new Error(`'k' passed to topk() must be <= the last dimension (${r}) but got ${t}`);const a={x:s},i={k:t,sorted:e},[l,u]=K.runKernel(_v,a,i);return{values:l,indices:u}}const cD=q({topk_:dG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fG(n,t=0,e=1,s,r){if(tr(n),s!=null&&s==="bool")throw new Error("Unsupported data type $ { dtype }");const a=new rw(t,e,s,!0,r),i=te(n,s);for(let l=0;l<i.values.length;l++)i.values[l]=a.nextValue();return i.toTensor()}const yw=q({truncatedNormal_:fG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pG(n,t=0){const e=B(n,"x","unique","string_or_numeric");F(e.rank>0,()=>"The input tensor must be at least 1D");const s={x:e},r={axis:t},[a,i]=K.runKernel(Lv,s,r);return{values:a,indices:i}}const hD=q({unique_:pG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mG(n,t,e){const s=B(n,"x","unsortedSegmentSum"),r=B(t,"segmentIds","unsortedSegmentSum","int32");F(uu(e),()=>"numSegments must be of dtype int");const a={x:s,segmentIds:r},i={numSegments:e};return K.runKernel(Ig,a,i)}const bw=q({unsortedSegmentSum_:mG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gG(n,t=0){const e=B(n,"x","unstack","string_or_numeric");F(t>=-e.shape.length&&t<e.shape.length,()=>`Axis = ${t} is not in [-${e.shape.length}, ${e.shape.length})`);const s={value:e},r={axis:t};return K.runKernel(kg,s,r)}const Cr=q({unstack_:gG});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yG(n,t){return nw(n,t,"right")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dD(n,t=!0,e,s){return K.makeVariable(n,t,e,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xw(n,t){const e=[];for(let a=0;a<t.length;a++)t[a]&&e.push(a);const s=te(n,"int32"),r=te([e.length,n.length],"int32");for(let a=0;a<e.length;a++){const i=s.indexToLoc(e[a]),l=a*n.length;r.values.set(i,l)}return r.toTensor()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function bG(n){const t=B(n,"condition","whereAsync","bool"),e=await t.data(),s=xw(t.shape,e);return n!==t&&t.dispose(),s}const fD=bG;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function xG(n,t,e){const s=B(n,"tensor","boolMask"),r=B(t,"mask","boolMask","bool"),a=e??0,i=r.rank,l=s.shape;F(i>0,()=>"mask cannot be scalar"),Bs(l.slice(a,a+i),r.shape,"mask's shape must match the first K dimensions of tensor's shape,");let u=1;for(let x=a;x<a+i;x++)u*=l[x];const h=l.slice(0,a).concat([u],l.slice(a+i)),d=J(s,h),p=J(r,[-1]),m=await fD(p),y=Ma(m,[1]),b=$d(d,y,a);return n!==s&&s.dispose(),t!==r&&r.dispose(),y.dispose(),d.dispose(),p.dispose(),m.dispose(),b}const vG=xG;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wG(n,t,e){const s=B(n,"x","transpose");if(t==null&&(t=s.shape.map((i,l)=>l).reverse()),F(s.rank===t.length,()=>`Error in transpose: rank of input ${s.rank} must match length of perm ${t}.`),t.forEach(i=>{F(i>=0&&i<s.rank,()=>`All entries in 'perm' must be between 0 and ${s.rank-1} but got ${t}`)}),s.rank<=1)return s.clone();const r={x:s},a={perm:t};return s.dtype==="complex64"?at(()=>{let i=hh(s),l=_g(s);return i=K.runKernel(nu,{x:i},a),l=K.runKernel(nu,{x:l},a),e&&(l=Be(l)),Ii(i,l)}):K.runKernel(nu,r,a)}const fe=q({transpose_:wG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SG(n,t,e,s,r=!0){const a=B(n,"v","movingAverage"),i=B(t,"x","movingAverage"),l=B(e,"decay","movingAverage");uB(a,i),F(de(a.shape,i.shape),()=>"Shape mismatch in v and x");const u=Vt(1),h=Rt(u,l);let d=X(Rt(i,a),h);if(r){F(s!=null,()=>"When using zeroDebias: true, step is required.");const p=B(s,"step","movingAverage");d=_t(d,Rt(u,La(l,p)))}return St(a,d)}const CG=q({movingAverage_:SG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NG(n,t,e){tr(e);const s=B(n,"indices","scatterND","int32"),r=B(t,"updates","scatterND");gw(r,s,e);const a={indices:s,updates:r},i={shape:e};return K.runKernel(wv,a,i)}const TG=q({scatterND_:NG});function $G(n,t,e,s){if(n.dtype!=="int32")throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${n.dtype}.`);if(n.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${n.shape}.`);const r=n.rank>0?n.shape[0]:1,a=n.rank>1?n.shape[1]:1;if(e.length!==a)throw new Error(`outputShape has incorrect number of elements:, ${e.length}, should be: ${a}.`);const i=t.size;if(!(t.rank===0||t.rank===1&&i===r))throw new Error(`sparseValues has incorrect shape ${t.shape}, should be [] or [${r}]`);if(t.dtype!==s.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kG(n,t,e,s=0){tr(e);const r=B(n,"sparseIndices","sparseToDense","int32"),a=B(t,"sparseValues","sparseToDense","string_or_numeric"),i=B(s,"defaultValue","sparseToDense",a.dtype);$G(r,a,e,i);const l={sparseIndices:r,sparseValues:a,defaultValue:i},u={outputShape:e};return K.runKernel(Iv,l,u)}const IG=q({sparseToDense_:kG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EG(n,t){const e=B(t,"indices","gatherND","int32"),r={params:B(n,"x","gatherND","string_or_numeric"),indices:e};return K.runKernel(nv,r)}const DG=q({gatherND_:EG});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AG(n,t){if(t==null)return n.shape.slice();if(de(n.shape,t))return t;if(n.shape.length===t.length){const e=[];for(let s=0;s<n.shape.length;s++)t[s]==null&&n.shape[s]!=null?e.push(n.shape[s]):e.push(t[s]);return e}return t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RG(n,t,e,s){const r=B(n,"x","dropout");if(F(r.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${r.dtype} tensor instead.`),F(t>=0&&t<1,()=>`rate must be a float in the range [0, 1), but got ${t}.`),t===0)return n instanceof Me?r.clone():r;const a=AG(r,e),i=1-t,l=_t(Td(St(Zo(a,0,1,"float32",s),i)),i);return X(r,l)}const pD=q({dropout_:RG});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mD(n){return Math.floor(Math.pow(2,Math.ceil(Math.log(n)/Math.log(2))))}function vw(n,t,e){const s=1-n%2,r=new Float32Array(n);for(let a=0;a<n;++a){const i=2*Math.PI*a/(n+s-1);r[a]=t-e*Math.cos(i)}return Un(r,"float32")}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function OG(n,t,e=1){const s=B(n,"predictions","inTopK"),r=B(t,"targets","inTopK");F(s.rank>1,()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${s.rank}`),F(s.rank-1===r.rank,()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${s.rank} and targets rank ${r.rank}`),Bs(s.shape.slice(0,s.shape.length-1),r.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const a=s.shape[s.shape.length-1];F(e>0&&e<=a,()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${a}), but got ${e}`);const i=await s.data(),l=await r.data(),[u,h]=[i.length/a,a],d=Gn("bool",u);for(let p=0;p<u;p++){const m=p*h,y=i.subarray(m,m+h),b=[];for(let x=0;x<y.length;x++)b.push({value:y[x],index:x});b.sort((x,v)=>v.value-x.value),d[p]=0;for(let x=0;x<e;x++)if(b[x].index===l[p]){d[p]=1;break}}return n!==s&&s.dispose(),t!==r&&r.dispose(),_r(d,r.shape,"bool")}const _G=OG;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FG(n,t,e,s,r,a="NHWC",i){let l=n;n.rank===3&&(l=J(n,[1,n.shape[0],n.shape[1],n.shape[2]]));let u=t;u.rank===3&&(u=J(t,[1,t.shape[0],t.shape[1],t.shape[2]])),F(l.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${l.shape}.`),F(u.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${u.shape}.`),F(e.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${e}.`);const h=a==="NHWC"?l.shape[3]:l.shape[1],d=a==="NHWC"?u.shape[3]:u.shape[1];F(h===e[2],()=>`Error in conv2dDerFilter: depth of input ${h}) must match input depth in filter (${e[2]}.`),F(d===e[3],()=>`Error in conv2dDerFilter: depth of dy (${d}) must match output depth for filter (${e[3]}).`),hs("conv2dDerFilter",r,i);const p={x:l,dy:u},m={strides:s,pad:r,dataFormat:a,dimRoundingMode:i,filterShape:e};return K.runKernel(V1,p,m)}const ww=q({conv2DBackpropFilter_:FG});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kg(n,t,e){if(e==null||e==="linear")return n;if(e==="relu")return X(n,_u(t));throw new Error(`Cannot compute gradient for fused activation ${e}.`)}function Yg(n,t){let e=t;const s=$n(n.shape,t.shape);return s.length>0&&(e=Ft(e,s)),J(e,n.shape)}function Zg(n,t,e,s){if(t==="linear")return n;if(t==="relu")return ca(n);if(t==="elu")return Cd(n);if(t==="relu6")return iw(n);if(t==="prelu")return Ug(n,e);if(t==="leakyrelu")return Fg(n,s);if(t==="sigmoid")return Fr(n);throw new Error(`Unknown fused activation ${t}.`)}const Qg=(n,t)=>!(n>0)||t==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LG({x:n,filter:t,strides:e,pad:s,dataFormat:r="NHWC",dilations:a=[1,1],dimRoundingMode:i,bias:l,activation:u="linear",preluActivationWeights:h,leakyreluAlpha:d}){if(u=u||"linear",Qg(K.state.gradientDepth,u)===!1){F(r==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${r} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let A=Ai(n,t,e,s,r,a,i);return l!=null&&(A=St(A,l)),Zg(A,u,h,d)}const p=B(n,"x","conv2d","float32"),m=B(t,"filter","conv2d","float32");let y=p,b=!1;p.rank===3&&(b=!0,y=J(p,[1,p.shape[0],p.shape[1],p.shape[2]])),F(y.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${y.rank}.`),F(m.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${m.rank}.`),hs("fused conv2d",s,i);const x=r==="NHWC"?y.shape[3]:y.shape[1];F(m.shape[2]===x,()=>`Error in conv2d: depth of input (${x}) must match input depth for filter ${m.shape[2]}.`),F(Hn(e,a),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${e} and dilations '${a}'`);const v=On(y.shape,m.shape,e,a,s,i);let S;l!=null&&(S=B(l,"bias","fused conv2d"),[S]=Qe(S,p),r==="NHWC"?Yt(v.outShape,S.shape):(F(S.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${S.shape.length}.`),F(S.shape.length===0||S.shape[0]===v.outChannels||S.shape[0]===1,()=>`Error in fused conv2d: bias shape (${S.shape}) is not compatible with the number of output channels (${v.outChannels})`)));let C;if(h!=null){const A=h.shape;if(F(A.length<=1||A.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${A.length}.`),A.length===1)F(A[0]===1||A[0]===v.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${A}) is not compatible with the number of output channels (${v.outChannels}).`);else if(A.length===3)try{Yt(A,v.outShape)}catch{const L=`Error in fused conv2d: PReLU activation weights (${A}) is not compatible with the output shape of the conv2d (${v.outShape}).`;throw Error(L)}C=B(h,"prelu weights","fused conv2d")}const $=(A,R)=>{F(r==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${r} but only NHWC is currently supported.`);const[L,_,M,D]=R,W=Kg(A,M,u);F(Di(a),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${a}'`);const et=qv(_.shape,W,L,e,s),nt=ww(_,W,L.shape,e,s),tt=[et,nt];if(D!=null){const U=Yg(D,W);tt.push(U)}return tt},T={x:y,filter:m,bias:S,preluActivationWeights:C},I={strides:e,pad:s,dataFormat:r,dilations:a,dimRoundingMode:i,activation:u,leakyreluAlpha:d};return l==null?za((R,L,_)=>{let M=K.runKernel(Wp,T,I);return _([L,R,M]),b&&(M=J(M,[M.shape[1],M.shape[2],M.shape[3]])),{value:M,gradFunc:$}})(y,m):za((R,L,_,M)=>{let D=K.runKernel(Wp,T,I);return M([L,R,D,_]),b&&(D=J(D,[D.shape[1],D.shape[2],D.shape[3]])),{value:D,gradFunc:$}})(y,m,S)}const gD=q({fusedConv2d_:LG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zG(n,t,e,s,r,a=[1,1],i){let l=n;n.rank===3&&(l=J(n,[1,n.shape[0],n.shape[1],n.shape[2]]));let u=t;u.rank===3&&(u=J(t,[1,t.shape[0],t.shape[1],t.shape[2]]));const h={x:l,dy:u},d={strides:s,pad:r,dimRoundingMode:i,dilations:a,filterShape:e};return K.runKernel(X1,h,d)}const yD=q({depthwiseConv2dNativeBackpropFilter_:zG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MG(n,t,e,s,r,a=[1,1],i){let l=t,u=!1;t.rank===3&&(u=!0,l=J(t,[1,t.shape[0],t.shape[1],t.shape[2]]));const h={dy:l,filter:e},d={strides:s,pad:r,dimRoundingMode:i,dilations:a,inputShape:n},p=K.runKernel(K1,h,d);return u?J(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const bD=q({depthwiseConv2dNativeBackpropInput_:MG});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BG({x:n,filter:t,strides:e,pad:s,dataFormat:r="NHWC",dilations:a=[1,1],dimRoundingMode:i,bias:l,activation:u="linear",preluActivationWeights:h,leakyreluAlpha:d}){if(Qg(K.state.gradientDepth,u)===!1){let I=Sd(n,t,e,s,r,a,i);return l!=null&&(I=St(I,l)),Zg(I,u,h,d)}const p=B(n,"x","depthwiseConv2d","float32"),m=B(t,"filter","depthwiseConv2d","float32");let y=p,b=!1;p.rank===3&&(b=!0,y=J(p,[1,p.shape[0],p.shape[1],p.shape[2]])),F(y.rank===4,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${y.rank}.`),F(m.rank===4,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${m.rank}.`),F(y.shape[3]===m.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${y.shape[3]}) must match the inChannels dimension in filter ${m.shape[2]}.`),a==null&&(a=[1,1]),F(Hn(e,a),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${e} and dilations '${a}'`),hs("fused depthwiseConv2d",s,i);const x=On(y.shape,m.shape,e,a,s,i,!0);let v;l!=null&&(v=B(l,"bias","fused conv2d"),[v]=Qe(v,p),Yt(x.outShape,v.shape));let S;h!=null&&(S=B(h,"prelu weights","fused depthwiseConv2d"));const C=(I,A)=>{F(Di(a),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${a}'`);const[R,L,_,M]=A,D=Kg(I,_,u),W=bD(L.shape,D,R,e,s,a,i),et=yD(L,D,R.shape,e,s,a,i);if(M!=null){const nt=Yg(v,D);return[W,et,nt]}return[W,et]},$={x:y,filter:m,bias:v,preluActivationWeights:S},T={strides:e,pad:s,dataFormat:r,dilations:a,dimRoundingMode:i,activation:u,leakyreluAlpha:d};return l==null?za((A,R,L)=>{let _=K.runKernel(Hp,$,T);return L([R,A,_]),b&&(_=J(_,[_.shape[1],_.shape[2],_.shape[3]])),{value:_,gradFunc:C}})(y,m):za((A,R,L,_)=>{let M=K.runKernel(Hp,$,T);return _([R,A,M,L]),b&&(M=J(M,[M.shape[1],M.shape[2],M.shape[3]])),{value:M,gradFunc:C}})(y,m,v)}const PG=q({fusedDepthwiseConv2d_:BG});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VG({a:n,b:t,transposeA:e=!1,transposeB:s=!1,bias:r,activation:a="linear",preluActivationWeights:i,leakyreluAlpha:l=.2}){if(Qg(K.state.gradientDepth,a)===!1){let D=le(n,t,e,s);return r!=null&&(D=St(D,r)),Zg(D,a,i,l)}let u=B(n,"a","fused matMul"),h=B(t,"b","fused matMul");[u,h]=Qe(u,h);const d=e?u.shape[u.rank-2]:u.shape[u.rank-1],p=s?h.shape[h.rank-1]:h.shape[h.rank-2],m=e?u.shape[u.rank-1]:u.shape[u.rank-2],y=s?h.shape[h.rank-2]:h.shape[h.rank-1],b=u.shape.slice(0,-2),x=h.shape.slice(0,-2),v=mt(b),S=mt(x);F(d===p,()=>`Error in fused matMul: inner shapes (${d}) and (${p}) of Tensors with shapes ${u.shape} and ${h.shape} and transposeA=${e} and transposeB=${s} must match.`);const $=Yt(u.shape.slice(0,-2),h.shape.slice(0,-2)).concat([m,y]),T=e?J(u,[v,d,m]):J(u,[v,m,d]),I=s?J(h,[S,y,p]):J(h,[S,p,y]);let A;r!=null&&(A=B(r,"bias","fused matMul"),[A]=Qe(A,u),Yt($,A.shape));let R;i!=null&&(R=B(i,"prelu weights","fused matMul"));const L=(D,W)=>{const[et,nt,tt,U]=W,Y=Kg(J(D,tt.shape),tt,a);let Z,G;if(!e&&!s?(Z=le(Y,nt,!1,!0),G=le(et,Y,!0,!1)):!e&&s?(Z=le(Y,nt,!1,!1),G=le(Y,et,!0,!1)):e&&!s?(Z=le(nt,Y,!1,!0),G=le(et,Y,!1,!1)):(Z=le(nt,Y,!0,!0),G=le(Y,et,!0,!0)),r!=null){const O=Yg(U,Y);return[Z,G,O]}else return[Z,G]},_={a:T,b:I,bias:A,preluActivationWeights:R},M={transposeA:e,transposeB:s,activation:a,leakyreluAlpha:l};return r==null?za((W,et,nt)=>{const tt=K.runKernel(Gp,_,M);return nt([W,et,tt]),{value:J(tt,$),gradFunc:L}})(T,I):za((W,et,nt,tt)=>{const U=K.runKernel(Gp,_,M);return tt([W,et,U,nt]),{value:J(U,$),gradFunc:L}})(T,I,A)}const Wx=q({fusedMatMul_:VG});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UG=Object.freeze(Object.defineProperty({__proto__:null,conv2d:gD,depthwiseConv2d:PG,matMul:Wx},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GG(n){return vw(n,.54,.46)}const WG=q({hammingWindow_:GG});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HG(n){return vw(n,.5,.5)}const xD=q({hannWindow_:HG});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jG(n,t,e,s=!1,r=0){let a=0;const i=[];for(;a+t<=n.size;)i.push(Qt(n,a,t)),a+=e;if(s)for(;a<n.size;){const l=a+t-n.size,u=pn([Qt(n,a,t-l),Ru([l],r)]);i.push(u),a+=e}return i.length===0?iu([],[0,t]):J(pn(i),[i.length,t])}const vD=q({frame_:jG});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qG(n,t,e,s,r=xD){s==null&&(s=mD(t));const a=vD(n,t,e),i=X(a,r(t));return Xg(i,s)}const XG=q({stft_:qG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KG(n,t,e,s,r="bilinear",a=0){const i=B(n,"image","cropAndResize"),l=B(t,"boxes","cropAndResize","float32"),u=B(e,"boxInd","cropAndResize","int32"),h=l.shape[0];F(i.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${i.rank}.`),F(l.rank===2&&l.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${h},4] but had shape ${l.shape}.`),F(u.rank===1&&u.shape[0]===h,()=>`Error in cropAndResize: boxInd must be have size [${h}] but had shape ${l.shape}.`),F(s.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${s.length}.`),F(s[0]>=1&&s[1]>=1,()=>`cropSize must be atleast [1,1], but was ${s}`),F(r==="bilinear"||r==="nearest",()=>`method must be bilinear or nearest, but was ${r}`);const d={image:i,boxes:l,boxInd:u},p={method:r,extrapolationValue:a,cropSize:s};return K.runKernel(H1,d,p)}const YG=q({cropAndResize_:KG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZG(n){const t=B(n,"image","flipLeftRight","float32");F(t.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${t.rank}.`);const e={image:t};return K.runKernel(ev,e,{})}const QG=q({flipLeftRight_:ZG});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JG(n){const t=B(n,"image","grayscaleToRGB"),e=t.rank-1,s=t.shape[e];F(t.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${t.rank}.`),F(s===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${s}.`);const r=new Array(t.rank);return r.fill(1,0,e),r[e]=3,gr(t,r)}const tW=q({grayscaleToRGB_:JG});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eW(n){const t=B(n,"image","RGBToGrayscale"),e=t.rank-1,s=t.shape[e];F(t.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${t.rank}.`),F(s===3,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${s}.`);const r=t.dtype,a=kt(t,"float32"),i=Un([.2989,.587,.114]);let l;switch(t.rank){case 2:l=Ql("ij,j->i",a,i);break;case 3:l=Ql("ijk,k->ij",a,i);break;case 4:l=Ql("ijkl,l->ijk",a,i);break;case 5:l=Ql("ijklm,m->ijkl",a,i);break;case 6:l=Ql("ijklmn,n->ijklm",a,i);break;default:throw new Error("Not a valid tensor rank.")}return l=Qn(l,-1),kt(l,r)}const nW=q({rgbToGrayscale_:eW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sW(n,t,e=0,s=.5){const r=B(n,"image","rotateWithOffset","float32");F(r.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${r.rank}.`);const a={image:r},i={radians:t,fillValue:e,center:s};return K.runKernel(zv,a,i)}const rW=q({rotateWithOffset_:sW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fu(n,t,e,s,r,a){s==null&&(s=.5),r==null&&(r=Number.NEGATIVE_INFINITY),a==null&&(a=0);const i=n.shape[0];return e=Math.min(e,i),F(0<=s&&s<=1,()=>`iouThreshold must be in [0, 1], but was '${s}'`),F(n.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${n.rank}'`),F(n.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${n.shape[1]}`),F(t.rank===1,()=>"scores must be a 1D tensor"),F(t.shape[0]===i,()=>`scores has incompatible shape with boxes. Expected ${i}, but was ${t.shape[0]}`),F(0<=a&&a<=1,()=>`softNmsSigma must be in [0, 1], but was '${a}'`),{maxOutputSize:e,iouThreshold:s,scoreThreshold:r,softNmsSigma:a}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aW(n,t,e,s=.5,r=Number.NEGATIVE_INFINITY){const a=B(n,"boxes","nonMaxSuppression","float32"),i=B(t,"scores","nonMaxSuppression","float32"),l=Fu(a,i,e,s,r);e=l.maxOutputSize,s=l.iouThreshold,r=l.scoreThreshold;const u={maxOutputSize:e,iouThreshold:s,scoreThreshold:r};return K.runKernel(hv,{boxes:a,scores:i},u)}const iW=q({nonMaxSuppression_:aW});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oW(n,t,e){const s=lW(n,t,e),r=s<0?-(s+1):s;n.splice(r,0,t)}function lW(n,t,e){return cW(n,t,e||uW)}function uW(n,t){return n>t?1:n<t?-1:0}function cW(n,t,e){let s=0,r=n.length,a=0,i=!1;for(;s<r;){a=s+(r-s>>>1);const l=e(t,n[a]);l>0?s=a+1:(r=a,i=!l)}return i?s:-s-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sw(n,t,e,s,r){return Tw(n,t,e,s,r,0)}function Cw(n,t,e,s,r,a){return Tw(n,t,e,s,r,0,!1,a,!0)}function Nw(n,t,e,s,r,a){return Tw(n,t,e,s,r,a,!0)}function Tw(n,t,e,s,r,a,i=!1,l=!1,u=!1){const h=[];for(let v=0;v<t.length;v++)t[v]>r&&h.push({score:t[v],boxIndex:v,suppressBeginIndex:0});h.sort(S2);const d=a>0?-.5/a:0,p=[],m=[];for(;p.length<e&&h.length>0;){const v=h.pop(),{score:S,boxIndex:C,suppressBeginIndex:$}=v;if(S<r)break;let T=!1;for(let I=p.length-1;I>=$;--I){const A=hW(n,C,p[I]);if(A>=s){T=!0;break}if(v.score=v.score*dW(s,d,A),v.score<=r)break}v.suppressBeginIndex=p.length,T||(v.score===S?(p.push(C),m.push(v.score)):v.score>r&&oW(h,v,S2))}const y=p.length,b=e-y;l&&b>0&&(p.push(...new Array(b).fill(0)),m.push(...new Array(b).fill(0)));const x={selectedIndices:p};return i&&(x.selectedScores=m),u&&(x.validOutputs=y),x}function hW(n,t,e){const s=n.subarray(t*4,t*4+4),r=n.subarray(e*4,e*4+4),a=Math.min(s[0],s[2]),i=Math.min(s[1],s[3]),l=Math.max(s[0],s[2]),u=Math.max(s[1],s[3]),h=Math.min(r[0],r[2]),d=Math.min(r[1],r[3]),p=Math.max(r[0],r[2]),m=Math.max(r[1],r[3]),y=(l-a)*(u-i),b=(p-h)*(m-d);if(y<=0||b<=0)return 0;const x=Math.max(a,h),v=Math.max(i,d),S=Math.min(l,p),C=Math.min(u,m),$=Math.max(S-x,0)*Math.max(C-v,0);return $/(y+b-$)}function dW(n,t,e){const s=Math.exp(t*e*e);return e<=n?s:0}function S2(n,t){return n.score-t.score||n.score===t.score&&t.boxIndex-n.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function fW(n,t,e,s=.5,r=Number.NEGATIVE_INFINITY){const a=B(n,"boxes","nonMaxSuppressionAsync"),i=B(t,"scores","nonMaxSuppressionAsync"),l=Fu(a,i,e,s,r);e=l.maxOutputSize,s=l.iouThreshold,r=l.scoreThreshold;const u=await Promise.all([a.data(),i.data()]),h=u[0],d=u[1],{selectedIndices:p}=Sw(h,d,e,s,r);return a!==n&&a.dispose(),i!==t&&i.dispose(),Un(p,"int32")}const pW=fW;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mW(n,t,e,s=.5,r=Number.NEGATIVE_INFINITY,a=0){const i=B(n,"boxes","nonMaxSuppression"),l=B(t,"scores","nonMaxSuppression"),u=Fu(i,l,e,s,r,a);e=u.maxOutputSize,s=u.iouThreshold,r=u.scoreThreshold,a=u.softNmsSigma;const h={boxes:i,scores:l},d={maxOutputSize:e,iouThreshold:s,scoreThreshold:r,softNmsSigma:a},p=K.runKernel(fv,h,d);return{selectedIndices:p[0],selectedScores:p[1]}}const gW=q({nonMaxSuppressionWithScore_:mW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function yW(n,t,e,s=.5,r=Number.NEGATIVE_INFINITY,a=0){const i=B(n,"boxes","nonMaxSuppressionAsync"),l=B(t,"scores","nonMaxSuppressionAsync"),u=Fu(i,l,e,s,r,a);e=u.maxOutputSize,s=u.iouThreshold,r=u.scoreThreshold,a=u.softNmsSigma;const h=await Promise.all([i.data(),l.data()]),d=h[0],p=h[1],{selectedIndices:m,selectedScores:y}=Nw(d,p,e,s,r,a);return i!==n&&i.dispose(),l!==t&&l.dispose(),{selectedIndices:Un(m,"int32"),selectedScores:Un(y)}}const bW=yW;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xW(n,t,e,s=.5,r=Number.NEGATIVE_INFINITY,a=!1){const i=B(n,"boxes","nonMaxSuppression"),l=B(t,"scores","nonMaxSuppression"),u=Fu(i,l,e,s,r,null),h=u.maxOutputSize,d=u.iouThreshold,p=u.scoreThreshold,m={boxes:i,scores:l},y={maxOutputSize:h,iouThreshold:d,scoreThreshold:p,padToMaxOutputSize:a},b=K.runKernel(dv,m,y);return{selectedIndices:b[0],validOutputs:b[1]}}const vW=q({nonMaxSuppressionPadded_:xW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function wW(n,t,e,s=.5,r=Number.NEGATIVE_INFINITY,a=!1){const i=B(n,"boxes","nonMaxSuppressionAsync"),l=B(t,"scores","nonMaxSuppressionAsync"),u=Fu(i,l,e,s,r,null),h=u.maxOutputSize,d=u.iouThreshold,p=u.scoreThreshold,[m,y]=await Promise.all([i.data(),l.data()]),{selectedIndices:b,validOutputs:x}=Cw(m,y,h,d,p,a);return i!==n&&i.dispose(),l!==t&&l.dispose(),{selectedIndices:Un(b,"int32"),validOutputs:Vt(x,"int32")}}const SW=wW;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CW(n,t,e=!1,s=!1){const r=B(n,"images","resizeBilinear");F(r.rank===3||r.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${r.rank}.`),F(t.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${t}.`),F(s===!1||e===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let a=r,i=!1;r.rank===3&&(i=!0,a=J(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const l={images:a},u={alignCorners:e,halfPixelCenters:s,size:t},h=K.runKernel(bg,l,u);return i?J(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const wD=q({resizeBilinear_:CW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NW(n,t,e=!1,s=!1){const r=B(n,"images","resizeNearestNeighbor");F(r.rank===3||r.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${r.rank}.`),F(t.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${t}.`),F(r.dtype==="float32"||r.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),F(s===!1||e===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let a=r,i=!1;r.rank===3&&(i=!0,a=J(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const l={images:a},u={alignCorners:e,halfPixelCenters:s,size:t},h=K.runKernel(yg,l,u);return i?J(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const SD=q({resizeNearestNeighbor_:NW});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TW(n,t="binary",e=!1,s=.5){const r=B(n,"image","threshold"),a=.2989,i=.587,l=.114,u=r.shape[0]*r.shape[1];let h=X(Un([s]),255),d,p,m,y;if(F(r.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${r.rank}.`),F(r.shape[2]===3||r.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${r.shape[2]}.`),F(r.dtype==="int32"||r.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${r.dtype}.`),F(t==="otsu"||t==="binary",()=>`Method must be binary or otsu, but was ${t}`),r.shape[2]===3){[d,p,m]=As(r,[1,1,1],-1);const v=X(d,a),S=X(p,i),C=X(m,l);y=St(St(v,S),C)}else y=n;if(t==="otsu"){const v=AE(kt(ow(y),"int32"),_r([]),256);h=$W(v,u)}const b=e?Yo(y,h):Ps(y,h);return kt(X(b,255),"int32")}function $W(n,t){let e=Un([-1]),s=Un([0]),r=Un([0]),a,i,l,u,h,d;for(let p=0;p<n.size-1;p++){a=Qt(n,0,p+1),i=Qt(n,p+1),h=_t(Ft(a),t),d=_t(Ft(i),t);const m=Ft(X(a,pu(0,a.size)));l=_t(m,Ft(a));const y=Ru(i.shape,a.size),b=St(pu(0,i.size),y),x=X(i,b);u=_t(Ft(x),Ft(i));const v=Rt(l,u),S=Rt(l,u),C=X(h,d);r=X(X(C,v),S);const $=Ps(r,s);s=Jn($,r,s),e=Jn($,Un([p]),e)}return e}const kW=q({threshold_:TW});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IW(n,t,e="nearest",s="constant",r=0,a){const i=B(n,"image","transform","float32"),l=B(t,"transforms","transform","float32");F(i.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${i.rank}.`),F(l.rank===2&&(l.shape[0]===i.shape[0]||l.shape[0]===1)&&l.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),F(a==null||a.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${a}.`);const u={image:i,transforms:l},h={interpolation:e,fillMode:s,fillValue:r,outputShape:a};return K.runKernel(Fv,u,h)}const EW=q({transform_:IW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DW(n,t,e){const s=B(n,"a","bandPart");F(s.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${s.rank}.`);const r=s.shape,[a,i]=s.shape.slice(-2);let l,u;typeof t=="number"?(F(t%1===0,()=>`bandPart(): numLower must be an integer, got ${t}.`),F(t<=a,()=>`bandPart(): numLower (${t}) must not be greater than the number of rows (${a}).`),l=B(t<0?a:t,"numLower","bandPart")):(F(t.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),l=Jn(ch(t,0),a,Uo(t,a))),typeof e=="number"?(F(e%1===0,()=>`bandPart(): numUpper must be an integer, got ${e}.`),F(e<=i,()=>`bandPart(): numUpper (${e}) must not be greater than the number of columns (${i}).`),u=B(e<0?i:e,"numUpper","bandPart")):(F(e.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),u=Jn(ch(e,0),i,Uo(e,i)));const h=J(pu(0,a,1,"int32"),[-1,1]),d=pu(0,i,1,"int32"),p=Rt(h,d),m=oa(Yo(p,l),Hi(p,Be(u))),y=vn([a,i],s.dtype);return J(Ls(Cr(J(s,[-1,a,i])).map(b=>Jn(m,b,y))),r)}const AW=q({bandPart_:DW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RW(n){let t;if(Array.isArray(n)){t=!1,F(n!=null&&n.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const r=n[0].shape[0];for(let a=1;a<n.length;++a)F(n[a].shape[0]===r,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${n[a].shape[0]} vs. ${r})`)}else t=!0,n=As(n,n.shape[0],0).map(r=>Ma(r,[0]));F(n.length<=n[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${n.length}) exceeds number of dimensions (${n[0].shape[0]}).`);const e=[],s=n;for(let r=0;r<n.length;++r)e.push(K.tidy(()=>{let a=s[r];if(r>0)for(let i=0;i<r;++i){const l=X(Ft(X(e[i],a)),e[i]);a=Rt(a,l)}return _t(a,Nd(a,"euclidean"))}));return t?Ls(e,0):e}const OW=q({gramSchmidt_:RW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _W(n,t=!1){if(F(n.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${n.rank}`),n.rank===2)return C2(n,t);{const e=n.shape.slice(0,n.shape.length-2).reduce((u,h)=>u*h),s=Cr(J(n,[e,n.shape[n.shape.length-2],n.shape[n.shape.length-1]]),0),r=[],a=[];s.forEach(u=>{const[h,d]=C2(u,t);r.push(h),a.push(d)});const i=J(Ls(r,0),n.shape),l=J(Ls(a,0),n.shape);return[i,l]}}function C2(n,t=!1){return K.tidy(()=>{F(n.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${n.shape.length}D Tensor.`);const e=n.shape[0],s=n.shape[1];let r=Jv(e),a=_a(n);const i=iu([[1]],[1,1]);let l=_a(i);const u=e>=s?s:e;for(let h=0;h<u;++h){const d=a,p=l,m=r;[l,a,r]=K.tidy(()=>{const y=Qt(a,[h,h],[e-h,1]),b=Nd(y),x=Qt(a,[h,h],[1,1]),v=Jn(Ps(x,0),iu([[-1]]),iu([[1]])),S=Rt(x,X(v,b)),C=_t(y,S);C.shape[0]===1?l=_a(i):l=pn([i,Qt(C,[1,0],[C.shape[0]-1,C.shape[1]])],0);const $=Be(_t(le(v,S),b)),T=Qt(a,[h,0],[e-h,s]),I=X($,l),A=fe(l);if(h===0)a=Rt(T,le(I,le(A,T)));else{const _=Rt(T,le(I,le(A,T)));a=pn([Qt(a,[0,0],[h,s]),_],0)}const R=fe(I),L=Qt(r,[0,h],[e,r.shape[1]-h]);if(h===0)r=Rt(L,le(le(L,l),R));else{const _=Rt(L,le(le(L,l),R));r=pn([Qt(r,[0,0],[e,h]),_],1)}return[l,a,r]}),se([d,p,m])}return!t&&e>s&&(r=Qt(r,[0,0],[e,s]),a=Qt(a,[0,0],[s,s])),[r,a]})}const FW=q({qr_:_W});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var gs;(function(n){n[n.NONE=0]="NONE",n[n.MEAN=1]="MEAN",n[n.SUM=2]="SUM",n[n.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(gs||(gs={}));function LW(n,t,e=gs.SUM_BY_NONZERO_WEIGHTS){const s=B(n,"losses","computeWeightedLoss");let r=null;t!=null&&(r=B(t,"weights","computeWeightedLoss"));const a=r==null?s:X(s,r);if(e===gs.NONE)return a;if(e===gs.SUM)return Ft(a);if(e===gs.MEAN){if(r==null)return Ze(a);{const i=s.size/r.size,l=_t(Ft(a),Ft(r));return i>1?_t(l,Vt(i)):l}}if(e===gs.SUM_BY_NONZERO_WEIGHTS){if(r==null)return _t(Ft(a),Vt(s.size));{const i=X(r,Is(s.shape)),l=kt(Ft(fu(i,Vt(0))),"float32");return _t(Ft(a),l)}}throw Error(`Unknown reduction: ${e}`)}const Ha=q({computeWeightedLoss_:LW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zW(n,t,e,s=gs.SUM_BY_NONZERO_WEIGHTS){const r=B(n,"labels","absoluteDifference"),a=B(t,"predictions","absoluteDifference");let i=null;e!=null&&(i=B(e,"weights","absoluteDifference")),Bs(r.shape,a.shape,"Error in absoluteDifference: ");const l=bn(Rt(r,a));return Ha(l,i,s)}const MW=q({absoluteDifference_:zW});function BW(n,t,e,s,r=gs.SUM_BY_NONZERO_WEIGHTS){const a=B(n,"labels","cosineDistance"),i=B(t,"predictions","cosineDistance");let l=null;s!=null&&(l=B(s,"weights","cosineDistance")),Bs(a.shape,i.shape,"Error in cosineDistance: ");const u=Vt(1),h=Rt(u,Ft(X(a,i),e,!0));return Ha(h,l,r)}const PW=q({cosineDistance_:BW});function VW(n,t,e,s=gs.SUM_BY_NONZERO_WEIGHTS){let r=B(n,"labels","hingeLoss");const a=B(t,"predictions","hingeLoss");let i=null;e!=null&&(i=B(e,"weights","hingeLoss")),Bs(r.shape,a.shape,"Error in hingeLoss: ");const l=Vt(1);r=Rt(X(Vt(2),r),l);const u=ca(Rt(l,X(r,a)));return Ha(u,i,s)}const UW=q({hingeLoss_:VW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GW(n,t,e,s=1,r=gs.SUM_BY_NONZERO_WEIGHTS){const a=B(n,"labels","huberLoss"),i=B(t,"predictions","huberLoss");let l=null;e!=null&&(l=B(e,"weights","huberLoss")),Bs(a.shape,i.shape,"Error in huberLoss: ");const u=Vt(s),h=bn(Rt(i,a)),d=Uo(h,u),p=Rt(h,d),m=St(X(Vt(.5),Ae(d)),X(u,p));return Ha(m,l,r)}const WW=q({huberLoss_:GW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HW(n,t,e,s=1e-7,r=gs.SUM_BY_NONZERO_WEIGHTS){const a=B(n,"labels","logLoss"),i=B(t,"predictions","logLoss");let l=null;e!=null&&(l=B(e,"weights","logLoss")),Bs(a.shape,i.shape,"Error in logLoss: ");const u=Vt(1),h=Vt(s),d=Be(X(a,Qs(St(i,h)))),p=X(Rt(u,a),Qs(St(Rt(u,i),h))),m=Rt(d,p);return Ha(m,l,r)}const jW=q({logLoss_:HW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qW(n,t,e,s=gs.SUM_BY_NONZERO_WEIGHTS){const r=B(n,"labels","meanSquaredError"),a=B(t,"predictions","meanSquaredError");let i=null;e!=null&&(i=B(e,"weights","meanSquaredError")),Bs(r.shape,a.shape,"Error in meanSquaredError: ");const l=mw(r,a);return Ha(l,i,s)}const XW=q({meanSquaredError_:qW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KW(n,t){const e=B(n,"labels","sigmoidCrossEntropyWithLogits"),s=B(t,"logits","sigmoidCrossEntropyWithLogits");Bs(e.shape,s.shape,"Error in sigmoidCrossEntropyWithLogits: ");const r=ca(s),a=X(s,e),i=Lg(Fs(Be(bn(s))));return St(Rt(r,a),i)}function YW(n,t,e,s=0,r=gs.SUM_BY_NONZERO_WEIGHTS){let a=B(n,"multiClassLabels","sigmoidCrossEntropy");const i=B(t,"logits","sigmoidCrossEntropy");let l=null;if(e!=null&&(l=B(e,"weights","sigmoidCrossEntropy")),Bs(a.shape,i.shape,"Error in sigmoidCrossEntropy: "),s>0){const h=Vt(s),d=Vt(1),p=Vt(.5);a=St(X(a,Rt(d,h)),X(p,h))}const u=KW(a,i);return Ha(u,l,r)}const ZW=q({sigmoidCrossEntropy_:YW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QW(n,t,e=-1){if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${t.rank} and dim was ${e}`);return za((r,a,i)=>{const u=zg(a,[e],!0),h=Rt(kt(a,"float32"),u);i([r,h]);const d=Be(X(h,r));return{value:Ft(d,[e]),gradFunc:(y,b)=>{const[x,v]=b,S=on(y.shape,[e]);return[X(J(y,S),Rt(kt(x,"float32"),Fs(v))),X(J(y,S),Rt(Fs(v),kt(x,"float32")))]}}})(n,t)}function JW(n,t,e,s=0,r=gs.SUM_BY_NONZERO_WEIGHTS){let a=B(n,"onehotLabels","softmaxCrossEntropy");const i=B(t,"logits","softmaxCrossEntropy");let l=null;if(e!=null&&(l=B(e,"weights","softmaxCrossEntropy")),Bs(a.shape,i.shape,"Error in softmaxCrossEntropy: "),s>0){const h=Vt(s),d=Vt(1),p=Vt(a.shape[1]);a=St(X(a,Rt(d,h)),_t(h,p))}const u=QW(a,i);return Ha(u,l,r)}const tH=q({softmaxCrossEntropy_:JW});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eH(n,t,e,s){const r=B(n,"indices","sparseFillEmptyRows","int32"),a=B(t,"values","sparseFillEmptyRows"),i=B(e,"denseShape","sparseFillEmptyRows","int32"),l=B(s,"defaultValue","sparseFillEmptyRows",a.dtype);if(r.rank!==2)throw new Error(`Indices should be Tensor2D but received shape
        ${r.shape}`);if(a.rank!==1)throw new Error(`Values should be Tensor1D but received shape ${a.shape}`);if(i.rank!==1)throw new Error(`Dense shape should be Tensor1D but received shape ${i.shape}`);if(l.rank!==0)throw new Error(`Default value should be a scalar but received shape ${l.shape}`);const u={indices:r,values:a,denseShape:i,defaultValue:l},h=K.runKernel(Nv,u);return{outputIndices:h[0],outputValues:h[1],emptyRowIndicator:h[2],reverseIndexMap:h[3]}}const nH=q({sparseFillEmptyRows_:eH});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sH(n,t,e){const s=B(n,"inputIndices","sparseReshape","int32"),r=B(t,"inputShape","sparseReshape","int32"),a=B(e,"newShape","sparseReshape","int32");if(s.rank!==2)throw new Error(`Input indices should be Tensor2D but received shape
        ${s.shape}`);if(r.rank!==1)throw new Error(`Input shape should be Tensor1D but received shape ${r.shape}`);if(a.rank!==1)throw new Error(`New shape should be Tensor1D but received shape ${a.shape}`);const i={inputIndices:s,inputShape:r,newShape:a},l=K.runKernel(Tv,i);return{outputIndices:l[0],outputShape:l[1]}}const rH=q({sparseReshape_:sH});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aH(n,t,e){const s=B(n,"data","sparseSegmentMean"),r=B(t,"indices","sparseSegmentMean","int32"),a=B(e,"segmentIds","sparseSegmentMean","int32");if(s.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
          ${r.shape}`);if(a.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
          ${a.shape}`);const i={data:s,indices:r,segmentIds:a};return K.runKernel($v,i)}const iH=q({sparseSegmentMean_:aH});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oH(n,t,e){const s=B(n,"data","sparseSegmentSum"),r=B(t,"indices","sparseSegmentSum","int32"),a=B(e,"segmentIds","sparseSegmentSum","int32");if(s.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
         ${r.shape}`);if(a.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
         ${a.shape}`);const i={data:s,indices:r,segmentIds:a};return K.runKernel(kv,i)}const lH=q({sparseSegmentSum_:oH});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uH(n,t,e,s,r,a,i,l){const u=B(n,"data","stringNGrams","string");if(u.dtype!=="string")throw new Error("Data must be of datatype string");if(u.shape.length!==1)throw new Error(`Data must be a vector, saw: ${u.shape}`);const h=B(t,"dataSplits","stringNGrams");if(h.dtype!=="int32")throw new Error("Data splits must be of datatype int32");const d={separator:e,nGramWidths:s,leftPad:r,rightPad:a,padWidth:i,preserveShortSequences:l},p={data:u,dataSplits:h},m=K.runKernel(Av,p,d);return{nGrams:m[0],nGramsSplits:m[1]}}const cH=q({stringNGrams_:uH});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hH(n,t,e=!0){const s=B(n,"input","stringSplit","string"),r=B(t,"delimiter","stringSplit","string");if(s.rank!==1)throw new Error(`Input should be Tensor1D but received shape ${s.shape}`);if(r.rank!==0)throw new Error(`Delimiter should be a scalar but received shape ${r.shape}`);const a={skipEmpty:e},i={input:s,delimiter:r},l=K.runKernel(Rv,i,a);return{indices:l[0],values:l[1],shape:l[2]}}const dH=q({stringSplit_:hH});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fH(n,t){const e=B(n,"input","stringToHashBucketFast","string"),s={numBuckets:t};if(t<=0)throw new Error("Number of buckets must be at least 1");const r={input:e};return K.runKernel(Ov,r,s)}const pH=q({stringToHashBucketFast_:fH});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mH(n,t,e,s=!0){const r=B(n,"input","staticRegexReplace","string"),a={pattern:t,rewrite:e,replaceGlobal:s};return K.runKernel($g,{x:r},a)}const gH=q({staticRegexReplace_:mH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yH={fft:qg,ifft:fh,rfft:Xg,irfft:pw},bH={hammingWindow:WG,hannWindow:xD,frame:vD,stft:XG},Es={flipLeftRight:QG,grayscaleToRGB:tW,resizeNearestNeighbor:SD,resizeBilinear:wD,rgbToGrayscale:nW,rotateWithOffset:rW,cropAndResize:YG,nonMaxSuppression:iW,nonMaxSuppressionAsync:pW,nonMaxSuppressionWithScore:gW,nonMaxSuppressionWithScoreAsync:bW,nonMaxSuppressionPadded:vW,nonMaxSuppressionPaddedAsync:SW,threshold:kW,transform:EW},CD={bandPart:AW,gramSchmidt:OW,qr:FW},xH={absoluteDifference:MW,computeWeightedLoss:Ha,cosineDistance:PW,hingeLoss:UW,huberLoss:WW,logLoss:jW,meanSquaredError:XW,sigmoidCrossEntropy:ZW,softmaxCrossEntropy:tH},vH={sparseFillEmptyRows:nH,sparseReshape:rH,sparseSegmentMean:iH,sparseSegmentSum:lH},wH={stringNGrams:cH,stringSplit:dH,stringToHashBucketFast:pH,staticRegexReplace:gH};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SH=new Map,CH=new Map;class Lu{getClassName(){return this.constructor.className}static fromConfig(t,e){return new t(e)}}class mr{constructor(){this.classNameMap={}}static getMap(){return mr.instance==null&&(mr.instance=new mr),mr.instance}static register(t){mr.getMap().classNameMap[t.className]=[t,t.fromConfig]}}function Tt(n,t,e){F(n.className!=null,()=>"Class being registered does not have the static className property defined."),F(typeof n.className=="string",()=>"className is required to be a string, but got type "+typeof n.className),F(n.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof t>"u"&&(t="Custom"),typeof e>"u"&&(e=n.className);const s=e,r=t+">"+s;return mr.register(n),SH.set(r,n),CH.set(n,r),n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qi extends Lu{minimize(t,e=!1,s){const{value:r,grads:a}=this.computeGradients(t,s);if(s!=null){const i=s.map(l=>({name:l.name,tensor:a[l.name]}));this.applyGradients(i)}else this.applyGradients(a);return se(a),e?r:(r.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(t,e){return qP(t,e)}dispose(){this.iterations_!=null&&se(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:Vt(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(t){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(t){return this.iterations_=(await t[0].tensor.data())[0],t.slice(1)}}Object.defineProperty(qi,Symbol.hasInstance,{value:n=>n.minimize!=null&&n.computeGradients!=null&&n.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ND extends qi{static get className(){return"Adadelta"}constructor(t,e,s=null){super(),this.learningRate=t,this.rho=e,this.epsilon=s,this.accumulatedGrads=[],this.accumulatedUpdates=[],s==null&&(this.epsilon=K.backend.epsilon())}applyGradients(t){(Array.isArray(t)?t.map(s=>s.name):Object.keys(t)).forEach((s,r)=>{const a=K.registeredVariables[s],i=!1;this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${s}/accum_grad`,variable:at(()=>pe(a).variable(i))}),this.accumulatedUpdates[r]==null&&(this.accumulatedUpdates[r]={originalName:`${s}/accum_var`,variable:at(()=>pe(a).variable(i))});const l=Array.isArray(t)?t[r].tensor:t[s];if(l==null)return;const u=this.accumulatedGrads[r].variable,h=this.accumulatedUpdates[r].variable;at(()=>{const d=St(X(u,this.rho),X(Ae(l),1-this.rho)),p=X(_t(Wn(St(h,this.epsilon)),Wn(St(u,this.epsilon))),l),m=St(X(h,this.rho),X(Ae(p),1-this.rho));u.assign(d),h.assign(m);const y=St(X(p,-this.learningRate),a);a.assign(y)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(se(this.accumulatedGrads.map(t=>t.variable)),se(this.accumulatedUpdates.map(t=>t.variable)))}async getWeights(){const t=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(t.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(t){t=await this.extractIterations(t);const e=t.length/2,s=!1;this.accumulatedGrads=t.slice(0,e).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedUpdates=t.slice(e,e*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(t,e){return new t(e.learningRate,e.rho,e.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class TD extends qi{static get className(){return"Adagrad"}constructor(t,e=.1){super(),this.learningRate=t,this.initialAccumulatorValue=e,this.accumulatedGrads=[]}applyGradients(t){(Array.isArray(t)?t.map(s=>s.name):Object.keys(t)).forEach((s,r)=>{const a=K.registeredVariables[s];this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${s}/accumulator`,variable:at(()=>Ru(a.shape,this.initialAccumulatorValue).variable(!1))});const i=Array.isArray(t)?t[r].tensor:t[s];if(i==null)return;const l=this.accumulatedGrads[r].variable;at(()=>{const u=St(l,Ae(i));l.assign(u);const h=St(X(_t(i,Wn(St(u,K.backend.epsilon()))),-this.learningRate),a);a.assign(h)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&se(this.accumulatedGrads.map(t=>t.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){t=await this.extractIterations(t);const e=!1;this.accumulatedGrads=t.map(s=>({originalName:s.name,variable:s.tensor.variable(e)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(t,e){return new t(e.learningRate,e.initialAccumulatorValue)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $D extends qi{static get className(){return"Adam"}constructor(t,e,s,r=null){super(),this.learningRate=t,this.beta1=e,this.beta2=s,this.epsilon=r,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],at(()=>{this.accBeta1=Vt(e).variable(),this.accBeta2=Vt(s).variable()}),r==null&&(this.epsilon=K.backend.epsilon())}applyGradients(t){const e=Array.isArray(t)?t.map(s=>s.name):Object.keys(t);at(()=>{const s=Rt(1,this.accBeta1),r=Rt(1,this.accBeta2);e.forEach((a,i)=>{const l=K.registeredVariables[a],u=!1;this.accumulatedFirstMoment[i]==null&&(this.accumulatedFirstMoment[i]={originalName:`${a}/m`,variable:at(()=>pe(l).variable(u))}),this.accumulatedSecondMoment[i]==null&&(this.accumulatedSecondMoment[i]={originalName:`${a}/v`,variable:at(()=>pe(l).variable(u))});const h=Array.isArray(t)?t[i].tensor:t[a];if(h==null)return;const d=this.accumulatedFirstMoment[i].variable,p=this.accumulatedSecondMoment[i].variable,m=St(X(d,this.beta1),X(h,1-this.beta1)),y=St(X(p,this.beta2),X(Ae(h),1-this.beta2)),b=_t(m,s),x=_t(y,r);d.assign(m),p.assign(y);const v=St(X(_t(b,St(Wn(x),this.epsilon)),-this.learningRate),l);l.assign(v)}),this.accBeta1.assign(X(this.accBeta1,this.beta1)),this.accBeta2.assign(X(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&se(this.accumulatedFirstMoment.map(t=>t.variable)),this.accumulatedSecondMoment!=null&&se(this.accumulatedSecondMoment.map(t=>t.variable))}async getWeights(){const t=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(t.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(t){t=await this.extractIterations(t),at(()=>{this.accBeta1.assign(La(this.beta1,this.iterations_+1)),this.accBeta2.assign(La(this.beta2,this.iterations_+1))});const e=t.length/2,s=!1;this.accumulatedFirstMoment=t.slice(0,e).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedSecondMoment=t.slice(e,e*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kD extends qi{static get className(){return"Adamax"}constructor(t,e,s,r=null,a=0){super(),this.learningRate=t,this.beta1=e,this.beta2=s,this.epsilon=r,this.decay=a,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],at(()=>{this.iteration=Vt(0).variable(),this.accBeta1=Vt(e).variable()}),r==null&&(this.epsilon=K.backend.epsilon())}applyGradients(t){const e=Array.isArray(t)?t.map(s=>s.name):Object.keys(t);at(()=>{const s=Rt(1,this.accBeta1),r=_t(-this.learningRate,St(X(this.iteration,this.decay),1));e.forEach((a,i)=>{const l=K.registeredVariables[a],u=!1;this.accumulatedFirstMoment[i]==null&&(this.accumulatedFirstMoment[i]={originalName:`${a}/m`,variable:pe(l).variable(u)}),this.accumulatedWeightedInfNorm[i]==null&&(this.accumulatedWeightedInfNorm[i]={originalName:`${a}/v`,variable:pe(l).variable(u)});const h=Array.isArray(t)?t[i].tensor:t[a];if(h==null)return;const d=this.accumulatedFirstMoment[i].variable,p=this.accumulatedWeightedInfNorm[i].variable,m=St(X(d,this.beta1),X(h,1-this.beta1)),y=X(p,this.beta2),b=bn(h),x=Wa(y,b);d.assign(m),p.assign(x);const v=St(X(_t(r,s),_t(m,St(x,this.epsilon))),l);l.assign(v)}),this.iteration.assign(St(this.iteration,1)),this.accBeta1.assign(X(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&se(this.accumulatedFirstMoment.map(t=>t.variable)),this.accumulatedWeightedInfNorm!=null&&se(this.accumulatedWeightedInfNorm.map(t=>t.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(t){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon,e.decay)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $w extends qi{static get className(){return"SGD"}constructor(t){super(),this.learningRate=t,this.setLearningRate(t)}applyGradients(t){(Array.isArray(t)?t.map(s=>s.name):Object.keys(t)).forEach((s,r)=>{const a=Array.isArray(t)?t[r].tensor:t[s];if(a==null)return;const i=K.registeredVariables[s];at(()=>{const l=St(X(this.c,a),i);i.assign(l)})}),this.incrementIterations()}setLearningRate(t){this.learningRate=t,this.c!=null&&this.c.dispose(),this.c=An(Vt(-t))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(t){if(t=await this.extractIterations(t),t.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(t,e){return new t(e.learningRate)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ID extends $w{static get className(){return"Momentum"}constructor(t,e,s=!1){super(t),this.learningRate=t,this.momentum=e,this.useNesterov=s,this.accumulations=[],this.m=Vt(this.momentum)}applyGradients(t){(Array.isArray(t)?t.map(s=>s.name):Object.keys(t)).forEach((s,r)=>{const a=K.registeredVariables[s];this.accumulations[r]==null&&(this.accumulations[r]={originalName:`${s}/momentum`,variable:at(()=>pe(a).variable(!1))});const i=this.accumulations[r].variable,l=Array.isArray(t)?t[r].tensor:t[s];l!=null&&at(()=>{let u;const h=St(X(this.m,i),l);this.useNesterov?u=St(X(this.c,St(l,X(h,this.m))),a):u=St(X(this.c,h),a),i.assign(h),a.assign(u)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&se(this.accumulations.map(t=>t.variable))}setMomentum(t){this.momentum=t}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){t=await this.extractIterations(t);const e=!1;this.accumulations=t.map(s=>({originalName:s.name,variable:s.tensor.variable(e)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(t,e){return new t(e.learningRate,e.momentum,e.useNesterov)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ED extends qi{static get className(){return"RMSProp"}constructor(t,e=.9,s=0,r=null,a=!1){if(super(),this.learningRate=t,this.decay=e,this.momentum=s,this.epsilon=r,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=a,r==null&&(this.epsilon=K.backend.epsilon()),t==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(t){(Array.isArray(t)?t.map(s=>s.name):Object.keys(t)).forEach((s,r)=>{const a=K.registeredVariables[s],i=!1;this.accumulatedMeanSquares[r]==null&&(this.accumulatedMeanSquares[r]={originalName:`${s}/rms`,variable:at(()=>pe(a).variable(i))}),this.accumulatedMoments[r]==null&&(this.accumulatedMoments[r]={originalName:`${s}/momentum`,variable:at(()=>pe(a).variable(i))}),this.accumulatedMeanGrads[r]==null&&this.centered&&(this.accumulatedMeanGrads[r]={originalName:`${s}/mg`,variable:at(()=>pe(a).variable(i))});const l=Array.isArray(t)?t[r].tensor:t[s];if(l==null)return;const u=this.accumulatedMeanSquares[r].variable,h=this.accumulatedMoments[r].variable;at(()=>{const d=St(X(u,this.decay),X(Ae(l),1-this.decay));if(this.centered){const p=this.accumulatedMeanGrads[r].variable,m=St(X(p,this.decay),X(l,1-this.decay)),y=_t(X(l,this.learningRate),Wn(Rt(d,St(Ae(m),this.epsilon)))),b=St(X(h,this.momentum),y);u.assign(d),p.assign(m),h.assign(b);const x=Rt(a,b);a.assign(x)}else{const p=St(X(u,this.decay),X(Ae(l),1-this.decay)),m=St(X(h,this.momentum),_t(X(l,this.learningRate),Wn(St(p,this.epsilon))));u.assign(p),h.assign(m);const y=Rt(a,m);a.assign(y)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&se(this.accumulatedMeanSquares.map(t=>t.variable)),this.accumulatedMeanGrads!=null&&this.centered&&se(this.accumulatedMeanGrads.map(t=>t.variable)),this.accumulatedMoments!=null&&se(this.accumulatedMoments.map(t=>t.variable))}async getWeights(){const t=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&t.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(t.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(t){t=await this.extractIterations(t);const e=this.centered?t.length/3:t.length/2,s=!1;this.accumulatedMeanSquares=t.slice(0,e).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedMoments=t.slice(e,e*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.centered&&(this.accumulatedMeanGrads=t.slice(e*2,e*3).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(t,e){return new t(e.learningRate,e.decay,e.momentum,e.epsilon,e.centered)}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NH=[ND,TD,$D,kD,ID,ED,$w];function TH(){for(const n of NH)Tt(n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $H="model",kH=".json",IH=".weights.bin";function N2(n){return new Promise(t=>setTimeout(t)).then(n)}class Go{constructor(t){if(!ut().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(Go.URL_SCHEME)&&(t=t.slice(Go.URL_SCHEME.length)),(t==null||t.length===0)&&(t=$H),this.modelJsonFileName=t+kH,this.weightDataFileName=t+IH}async save(t){if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");const e=Ur.join(t.weightData),s=window.URL.createObjectURL(new Blob([e],{type:"application/octet-stream"}));if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const r=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],a=lE(t,r),i=window.URL.createObjectURL(new Blob([JSON.stringify(a)],{type:"application/json"})),l=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor;if(l.download=this.modelJsonFileName,l.href=i,await N2(()=>l.dispatchEvent(new MouseEvent("click"))),t.weightData!=null){const u=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;u.download=this.weightDataFileName,u.href=s,await N2(()=>u.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:xd(t)}}}}Go.URL_SCHEME="downloads://";class EH{constructor(t){if(t==null||t.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${t}`);this.jsonFile=t[0],this.weightsFiles=t.slice(1)}async load(){return new Promise((t,e)=>{const s=new FileReader;s.onload=r=>{const a=JSON.parse(r.target.result),i=a.modelTopology;if(i==null){e(new Error(`modelTopology field is missing from file ${this.jsonFile.name}`));return}if(a.weightsManifest==null){e(new Error(`weightManifest field is missing from file ${this.jsonFile.name}`));return}if(this.weightsFiles.length===0){t({modelTopology:i});return}const u=Vv(a,h=>this.loadWeights(h));t(u)},s.onerror=r=>e(`Failed to read model topology and weights manifest JSON from file '${this.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),s.readAsText(this.jsonFile)})}loadWeights(t){const e=[],s=[];for(const i of t)e.push(...i.weights),s.push(...i.paths);const r=this.checkManifestAndWeightFiles(t),a=s.map(i=>this.loadWeightsFile(i,r[i]));return Promise.all(a).then(i=>[e,i])}loadWeightsFile(t,e){return new Promise((s,r)=>{const a=new FileReader;a.onload=i=>{const l=i.target.result;s(l)},a.onerror=i=>r(`Failed to weights data from file of path '${t}'.`),a.readAsArrayBuffer(e)})}checkManifestAndWeightFiles(t){const e=[],s=this.weightsFiles.map(a=>f2(a.name)),r={};for(const a of t)a.paths.forEach(i=>{const l=f2(i);if(e.indexOf(l)!==-1)throw new Error(`Duplicate file basename found in weights manifest: '${l}'`);if(e.push(l),s.indexOf(l)===-1)throw new Error(`Weight file with basename '${l}' is not provided.`);r[i]=this.weightsFiles[s.indexOf(l)]});if(e.length!==this.weightsFiles.length)throw new Error(`Mismatch in the number of files in weights manifest (${e.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return r}}const DH=n=>ut().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(Go.URL_SCHEME)?AH(n.slice(Go.URL_SCHEME.length)):null;He.registerSaveRouter(DH);function AH(n="model"){return new Go(n)}function RH(n){return new EH(n)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T2(n,t,e,s){i(n),e=e??0,s=s??1,l(e,s);let r=0;const a=u=>(u.then(h=>{const d=e+ ++r/n.length*(s-e);return t(d),h}),u);function i(u){F(u!=null&&Array.isArray(u)&&u.length>0,()=>"promises must be a none empty array")}function l(u,h){F(u>=0&&u<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${u}`),F(h>=0&&h<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${h}`),F(h>=u,()=>`startFraction must be no more than endFraction, but got startFraction ${u} and endFraction ${h}`)}return Promise.all(n.map(a))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function DD(n,t){t==null&&(t={});const e=t.fetchFunc==null?ut().platform.fetch:t.fetchFunc,s=n.map(p=>e(p,t.requestInit,{isBinary:!0})),l=(t.onProgress==null?await Promise.all(s):await T2(s,t.onProgress,0,.5)).map(p=>p.arrayBuffer());return t.onProgress==null?await Promise.all(l):await T2(l,t.onProgress,.5,1)}function OH(n,t){var e;const s=t.fetchFunc==null?ut().platform.fetch:t.fetchFunc;let r=0,a;return(e=t.onProgress)===null||e===void 0||e.call(t,0),new ReadableStream({pull:async i=>{for(var l;r<n.length;){a||(a=(await s(n[r],t.requestInit,{isBinary:!0})).body.getReader());const{done:u,value:h}=await a.read();if(u){r++,a=void 0,(l=t.onProgress)===null||l===void 0||l.call(t,r/n.length);continue}i.enqueue(h);return}i.close()}})}async function _H(n,t="",e,s){return AD(i=>DD(i,{requestInit:s}))(n,t,e)}function AD(n){return async(t,e="",s)=>{const r=t.map(()=>!1),a={},i=s!=null?s.map(()=>!1):[],l=[];if(t.forEach((y,b)=>{let x=0;y.weights.forEach(v=>{const S="quantization"in v?v.quantization.dtype:v.dtype,C=zo[S]*mt(v.shape),$=()=>{r[b]=!0,a[b]==null&&(a[b]=[]),a[b].push({manifestEntry:v,groupOffset:x,sizeBytes:C})};s!=null?s.forEach((T,I)=>{T===v.name&&($(),i[I]=!0)}):$(),l.push(v.name),x+=C})}),!i.every(y=>y)){const y=s.filter((b,x)=>!i[x]);throw new Error(`Could not find weights in manifest with names: ${y.join(", ")}. 
Manifest JSON has weights with names: ${l.join(", ")}.`)}const u=r.reduce((y,b,x)=>(b&&y.push(x),y),[]),h=[];u.forEach(y=>{t[y].paths.forEach(b=>{const x=e+(e.endsWith("/")?"":"/")+b;h.push(x)})});const d=await n(h),p={};let m=0;return u.forEach(y=>{const b=t[y].paths.length,x=new Ur(d.slice(m,m+b));a[y].forEach(S=>{const C=x.slice(S.groupOffset,S.groupOffset+S.sizeBytes),$=rE(C,[S.manifestEntry]);for(const T in $)p[T]=$[T]}),m+=b}),p}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FH="application/octet-stream",LH="application/json";class kw{constructor(t,e){if(this.DEFAULT_METHOD="POST",e==null&&(e={}),this.weightPathPrefix=e.weightPathPrefix,this.weightUrlConverter=e.weightUrlConverter,e.fetchFunc!=null?(F(typeof e.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=e.fetchFunc):this.fetch=ut().platform.fetch,F(t!=null&&t.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(t)&&F(t.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${t.length}).`),this.path=t,e.requestInit!=null&&e.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=e.requestInit||{},this.loadOptions=e}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const e=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);e.body=new FormData;const s=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],r=lE(t,s);if(e.body.append("model.json",new Blob([JSON.stringify(r)],{type:LH}),"model.json"),t.weightData!=null){const i=Ur.join(t.weightData);e.body.append("model.weights.bin",new Blob([i],{type:FH}),"model.weights.bin")}const a=await this.fetch(this.path,e);if(a.ok)return{modelArtifactsInfo:xd(t),responses:[a]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${a.status}.`)}async loadModelJSON(){const t=await this.fetch(this.path,this.requestInit);if(!t.ok)throw new Error(`Request to ${this.path} failed with status code ${t.status}. Please verify this URL points to the model JSON of the model to load.`);let e;try{e=await t.json()}catch{let i=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?i+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":i+=" Please make sure the server is serving valid JSON for this request.",new Error(i)}const s=e.modelTopology,r=e.weightsManifest;if(s==null&&r==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return e}async load(){if(this.loadOptions.streamWeights)return this.loadStream();const t=await this.loadModelJSON();return Vv(t,e=>this.loadWeights(e))}async loadStream(){const t=await this.loadModelJSON(),e=await this.getWeightUrls(t.weightsManifest),s=Mx(t.weightsManifest),r=()=>OH(e,this.loadOptions);return Object.assign(Object.assign({},t),{weightSpecs:s,getWeightStream:r})}async getWeightUrls(t){const e=Array.isArray(this.path)?this.path[1]:this.path,[s,r]=zH(e),a=this.weightPathPrefix||s,i=[],l=[];for(const u of t)for(const h of u.paths)this.weightUrlConverter!=null?l.push(this.weightUrlConverter(h)):i.push(a+h+r);return this.weightUrlConverter&&i.push(...await Promise.all(l)),i}async loadWeights(t){const e=await this.getWeightUrls(t),s=Mx(t),r=await DD(e,this.loadOptions);return[s,r]}}kw.URL_SCHEME_REGEX=/^https?:\/\//;function zH(n){const t=n.lastIndexOf("/"),e=n.lastIndexOf("?"),s=n.substring(0,t),r=e>t?n.substring(e):"";return[s+"/",r]}function Hx(n){return n.match(kw.URL_SCHEME_REGEX)!=null}const RD=(n,t)=>{if(typeof fetch>"u"&&(t==null||t.fetchFunc==null))return null;{let e=!0;if(Array.isArray(n)?e=n.every(s=>Hx(s)):e=Hx(n),e)return Iw(n,t)}return null};He.registerSaveRouter(RD);He.registerLoadRouter(RD);function Iw(n,t){return new kw(n,t)}function MH(n,t){return Iw(n,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Kb{constructor(t){this.modelArtifacts=t}load(){return this.modelArtifacts}}class OD{constructor(t){this.saveHandler=t}save(t){return this.saveHandler(t)}}class BH{constructor(t){t.load&&(this.load=()=>Promise.resolve(t.load())),t.save&&(this.save=e=>Promise.resolve(t.save(e)))}}function PH(n,t,e,s){const r=arguments;return new BH(_D(...r))}function _D(n,t,e,s){return arguments.length===1?n.modelTopology!=null||n.weightSpecs!=null?new Kb(n):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Kb({modelTopology:n})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Kb({modelTopology:n,weightSpecs:t,weightData:e,trainingConfig:s}))}function VH(n){return new OD(n)}function UH(n){return new OD(n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FD=Object.freeze(Object.defineProperty({__proto__:null,CompositeArrayBuffer:Ur,browserFiles:RH,browserHTTPRequest:MH,concatenateArrayBuffers:oE,copyModel:UB,decodeWeights:rE,decodeWeightsStream:iE,encodeWeights:zx,fromMemory:PH,fromMemorySync:_D,getLoadHandlers:IB,getModelArtifactsForJSON:Vv,getModelArtifactsForJSONSync:uE,getModelArtifactsInfoForJSON:xd,getSaveHandlers:cE,getWeightSpecs:Mx,http:Iw,isHTTPScheme:Hx,listModels:PB,loadWeights:_H,moveModel:GB,registerLoadRouter:kB,registerSaveRouter:$B,removeModel:VB,weightsLoaderFactory:AD,withSaveHandler:VH,withSaveHandlerSync:UH},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let mo;function GH(n,t=3){if(t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(n==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let e=!1,s=!1,r=!1,a=!1,i=!1,l=!1;if(n.data instanceof Uint8Array)e=!0;else if(typeof ImageData<"u"&&n instanceof ImageData)s=!0;else if(typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement)r=!0;else if(typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement)a=!0;else if(n.getContext!=null)i=!0;else if(typeof ImageBitmap<"u"&&n instanceof ImageBitmap)l=!0;else throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${n.constructor.name}`);if(Ax(Ex,K.backendName)!=null){const b={pixels:n},x={numChannels:t};return K.runKernel(Ex,b,x)}const[h,d]=r?[n.videoWidth,n.videoHeight]:[n.width,n.height];let p;if(i)p=n.getContext("2d").getImageData(0,0,h,d).data;else if(s||e)p=n.data;else if(a||r||l){if(mo==null)if(typeof document>"u")if(typeof OffscreenCanvas<"u"&&typeof OffscreenCanvasRenderingContext2D<"u")mo=new OffscreenCanvas(1,1).getContext("2d");else throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");else mo=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});mo.canvas.width=h,mo.canvas.height=d,mo.drawImage(n,0,0,h,d),p=mo.getImageData(0,0,h,d).data}let m;if(t===4)m=new Int32Array(p);else{const b=h*d;m=new Int32Array(b*t);for(let x=0;x<b;x++)for(let v=0;v<t;++v)m[x*t+v]=p[x*4+v]}return lD(m,[d,h,t],"int32")}const WH=q({fromPixels_:GH});function Ew(n,t){const e=n.shape.length,s=t.shape.length;if(e<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${e}.`);if(s<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${s}.`);if(t.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.shape[s-1]>e)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${t.shape[s-1]} vs. ${e}`);if(mt(n.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${n.shape}.`);const r=t.shape,a=r[r.length-1];let i=1;for(let p=0;p<r.length-1;++p)i*=r[p];const l=n.shape,u=r.slice();u.pop();let h=1;for(let p=a;p<e;++p)h*=l[p],u.push(l[p]);const d=[...Bt(n.shape).map(p=>p/h),1].slice(0,a);return[u,i,h,d]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jx=-2,HH=-1;function Dw(n,t,e){const s=n.shape.length;F(s===t.length,()=>`Error in slice${s}D: Length of begin ${t} must match the rank of the array (${s}).`),F(s===e.length,()=>`Error in slice${s}D: Length of size ${e} must match the rank of the array (${s}).`);for(let r=0;r<s;++r)F(t[r]+e[r]<=n.shape[r],()=>`Error in slice${s}D: begin[${r}] + size[${r}] (${t[r]+e[r]}) would overflow input.shape[${r}] (${n.shape[r]})`)}function jH(n){const t=[];let e=0;for(;n>0;)n&1&&t.push(e),n/=2,e++;return t}function Aw(n,t,e){const s=[];for(let r=0;r<n.length;r++)s[r]=Math.ceil((t[r]-n[r])/e[r]);return s}function LD(n,t,e,s){const r=[...n];for(let a=r.length;a<s.length;a++)r.push(1);for(let a=0;a<e;a++)a===0?r[t]=1:(r.splice(t,0,1),r.pop());return r}function zD(n,t,e){return e<=n?e:e-(t-1)}function MD(n,t){const e=[];for(let s=0;s<n;s++)e.push(t+s);return e}function qH(n,t,e,s,r,a,i,l,u){const h=n.length;let d=new Array(h),p=new Array(h),m=new Array(h);if(t.length&&e>0){const y=t[0],b=e+1;d=BD(i,y,b,s,n),p=PD(l,y,b,r,n),m=LD(a,y,b,n)}else for(let y=0;y<h;y++)d[y]=UD(i,s,a,n,y,u),p[y]=GD(l,r,a,n,y,u),m[y]=VD(a,y,u);return{begin:d,end:p,strides:m}}function BD(n,t,e,s,r){const a=[...r],i=MD(e,t);for(let l=0;l<a.length;l++)if(i.indexOf(l)>-1)a[l]=0;else{const u=zD(t,e,l);let h=s[u];n&1<<u&&(h=0),a[l]=h}return a}function PD(n,t,e,s,r){const a=[...r],i=MD(e,t);for(let l=0;l<a.length;l++)if(i.indexOf(l)>-1)a[l]=Number.MAX_SAFE_INTEGER;else{const u=zD(t,e,l);let h=s[u];n&1<<u&&(h=Number.MAX_SAFE_INTEGER),a[l]=h}for(let l=0;l<a.length;l++){const u=r[l];a[l]<0&&(a[l]+=u),a[l]=_o(0,a[l],r[l])}return a}function VD(n,t,e){let s=n[t];return(e&1<<t||s==null)&&(s=1),s}function UD(n,t,e,s,r,a){let i=t[r];const l=e[r]||1;(n&1<<r||a&1<<r||i==null)&&(l>0?i=Number.MIN_SAFE_INTEGER:i=Number.MAX_SAFE_INTEGER);const u=s[r];return i<0&&(i+=u),i=_o(0,i,u-1),i}function GD(n,t,e,s,r,a){let i=t[r];const l=e[r]||1;(n&1<<r||a&1<<r||i==null)&&(l>0?i=Number.MAX_SAFE_INTEGER:i=Number.MIN_SAFE_INTEGER);const u=s[r];return i<0&&(i+=u),l>0?i=_o(0,i,u):i=_o(-1,i,u-1),i}function Rw(n,t,e){let s=e.length;for(let r=0;r<e.length;r++)if(e[r]>1){s=r;break}for(let r=s+1;r<e.length;r++)if(t[r]>0||e[r]!==n[r])return!1;return!0}function Ow(n,t){let e=n.length>0?n[n.length-1]:1;for(let s=0;s<n.length-1;s++)e+=n[s]*t[s];return e}function Jg(n,t,e){let s;const r=n.shape.length;typeof t=="number"?s=[t,...new Array(r-1).fill(0)]:t.length<r?s=t.concat(new Array(r-t.length).fill(0)):s=t.slice(),s.forEach(i=>{F(i!==-1,()=>"slice() does not support negative begin indexing.")});let a;return e==null?a=new Array(r).fill(-1):typeof e=="number"?a=[e,...new Array(r-1).fill(-1)]:e.length<r?a=e.concat(new Array(r-e.length).fill(-1)):a=e,a=a.map((i,l)=>i>=0?i:(F(i===-1,()=>`Negative size values should be exactly -1 but got ${i} for the slice() size at index ${l}.`),n.shape[l]-s[l])),[s,a]}function _w(n,t,e,s,r,a,i,l,u){let h;if(s==null?(h=new Array(t.length),h.fill(1)):h=s,i!=null&&(i&i-1)!==0)throw new Error("Multiple ellipses in slice is not allowed.");let d=!1;const p={dims:h.length,numAddAxisAfterEllipsis:0,begin:t.slice(),end:e.slice(),strides:h.slice(),beginMask:r,endMask:a,ellipsisMask:i,newAxisMask:l,shrinkAxisMask:u};for(let $=0;$<p.dims;$++)d&&(1<<$&l)!==0&&p.numAddAxisAfterEllipsis++,1<<$&i&&(d=!0);d||(p.ellipsisMask|=1<<p.dims,p.dims++);const m={dims:n.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};XH(p,m);let y=!0,b=!0,x=!0;const v=[],S=[];for(let $=0;$<n.length;++$){if(m.strides[$]===0)throw Error(`strides[${$}] must be non-zero`);const T=!!(m.shrinkAxisMask&1<<$),I=n[$];if(I===-1){v.push(T?1:-1);continue}const A=[m.beginMask&1<<$,m.endMask&1<<$],R=[m.strides[$]>0?0:-1,m.strides[$]>0?I:I-1];if(T&&m.strides[$]<=0)throw Error("only stride 1 allowed on non-range indexing.");x=x&&m.strides[$]===1;const L=!!(m.beginMask&1<<$&&m.endMask&1<<$);if(m.beginValid&&m.endValid){if(T){const W=m.begin[$]<0?I+m.begin[$]:m.begin[$];if(m.begin[$]=W,m.end[$]=m.begin[$]+1,W<0||W>=I)throw Error(`slice index ${m.begin[$]} of dimension ${$} out of bounds.`)}else m.begin[$]=$2(m.begin[$],0,m.strides[$],I,A,R),m.end[$]=$2(m.end[$],1,m.strides[$],I,A,R);const D=m.strides[$]===1&&m.begin[$]===0&&m.end[$]===I;y=y&&D,b=b&&($===0&&m.strides[$]===1||D)}else y=y&&m.strides[$]===1&&L,b=b&&($===0&&m.strides[$]===1||L);let _,M=!1;if(m.beginValid&&m.endValid?(_=m.end[$]-m.begin[$],M=!0):T?(_=1,M=!0):L&&I>=0&&(m.strides[$]<0?_=-I:_=I,M=!0),M){let D;_===0||_<0!=m.strides[$]<0?D=0:D=Math.trunc(_/m.strides[$])+(_%m.strides[$]!==0?1:0),v.push(D)}else v.push(-1)}for(let $=0;$<m.finalShapeGatherIndices.length;++$){const T=m.finalShapeGatherIndices[$];T>=0?S.push(v[T]):T===jx&&S.push(1)}return{finalShapeSparse:S.filter(($,T)=>m.finalShapeGatherIndices[T]!==jx),finalShape:S,isIdentity:y,sliceDim0:b,isSimpleSlice:x,begin:m.begin,end:m.end,strides:m.strides}}function XH(n,t){t.beginMask=0,t.endMask=0,t.shrinkAxisMask=0;let e=0;t.beginValid=n.begin!=null,t.endValid=n.end!=null,t.begin=new Array(t.dims),t.end=new Array(t.dims),t.strides=new Array(t.dims),t.finalShapeGatherIndices=[],t.finalShapeGatherIndicesSparse=[],t.inputShapeGatherIndicesSparse=new Array(t.dims);for(let s=0;s<n.dims;s++)if(1<<s&n.ellipsisMask){const r=Math.min(t.dims-(n.dims-s)+1+n.numAddAxisAfterEllipsis,t.dims);for(;e<r;e++)t.begin[e]=0,t.end[e]=0,t.strides[e]=1,t.beginMask|=1<<e,t.endMask|=1<<e,t.finalShapeGatherIndices.push(e),t.finalShapeGatherIndicesSparse.push(-1),t.inputShapeGatherIndicesSparse[e]=s}else if(1<<s&n.newAxisMask)t.finalShapeGatherIndices.push(jx),t.finalShapeGatherIndicesSparse.push(-1);else{if(e===t.begin.length)throw Error(`Index out of range using input dim ${e}; input has only ${t.dims} dims, ${t.begin.length}.`);n.begin!=null&&(t.begin[e]=n.begin[s]),n.end!=null&&(t.end[e]=n.end[s]),t.strides[e]=n.strides[s],n.beginMask&1<<s&&(t.beginMask|=1<<e),n.endMask&1<<s&&(t.endMask|=1<<e),n.shrinkAxisMask&1<<s?(t.finalShapeGatherIndices.push(HH),t.finalShapeGatherIndicesSparse.push(-1),t.shrinkAxisMask|=1<<e):(t.finalShapeGatherIndices.push(e),t.finalShapeGatherIndicesSparse.push(s)),t.inputShapeGatherIndicesSparse[e]=s,e++}}function $2(n,t,e,s,r,a){if(r[t])return e>0?a[t]:a[t+1&1];{const i=n<0?s+n:n;return i<a[0]?a[0]:i>a[1]?a[1]:i}}const KH=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:Dw,computeFlatOffset:Ow,computeOutShape:Aw,getNormalizedAxes:qH,isSliceContinous:Rw,maskToAxes:jH,parseSliceParams:Jg,sliceInfo:_w,startForAxis:UD,startIndicesWithElidedDims:BD,stopForAxis:GD,stopIndicesWithElidedDims:PD,stridesForAxis:VD,stridesWithElidedDims:LD},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class YH{static sgd(t){return new $w(t)}static momentum(t,e,s=!1){return new ID(t,e,s)}static rmsprop(t,e=.9,s=0,r=null,a=!1){return new ED(t,e,s,r,a)}static adam(t=.001,e=.9,s=.999,r=null){return new $D(t,e,s,r)}static adadelta(t=.001,e=.95,s=null){return new ND(t,e,s)}static adamax(t=.002,e=.9,s=.999,r=null,a=0){return new kD(t,e,s,r,a)}static adagrad(t,e=.1){return new TD(t,e)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wl=YH;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZH=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:n=>n();function WD(){return new Promise(n=>ZH(()=>n()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fw(n,t){const e=n[0].length;n.forEach((r,a)=>{F(r.length===e,()=>`Error in concat${e}D: rank of tensors[${a}] must be the same as the rank of the rest (${e})`)}),F(t>=0&&t<e,()=>`Error in concat${e}D: axis must be between 0 and ${e-1}.`);const s=n[0];n.forEach((r,a)=>{for(let i=0;i<e;i++)F(i===t||r[i]===s[i],()=>`Error in concat${e}D: Shape of tensors[${a}] (${r}) does not match the shape of the rest (${s}) along the non-concatenated axis ${a}.`)})}function ra(n,t){const e=n[0].slice();for(let s=1;s<n.length;s++)e[t]+=n[s][t];return e}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Or;(function(n){n[n.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",n[n.VALUE_ROWIDS=1]="VALUE_ROWIDS",n[n.ROW_LENGTHS=2]="ROW_LENGTHS",n[n.ROW_SPLITS=3]="ROW_SPLITS",n[n.ROW_LIMITS=4]="ROW_LIMITS",n[n.ROW_STARTS=5]="ROW_STARTS"})(Or||(Or={}));function HD(n,t,e){let s=new Array;if(e==null&&t==null)return s;if(t==null)for(;s.length<n+e.length;)s.push(-1);else s=t.slice();if(e==null)return s;if(n+e.length!==s.length)throw new Error(`rt input.shape and shape=${t} are incompatible: rt input.rank = ${n+e.length}, but shape.rank = ${s.length}`);for(let r=1;r<e.length;++r){const a=e[r],i=s[s.length-e.length+r],l=s[i];if(a>=0)if(l>=0){if(l!==a)throw new Error(`rt input.shape and shape=${t} are incompatible: rt input.shape[${r+n}] = ${a} but shape[${r+n}] = ${l}`)}else s[i]=a}return s}function jD(n){const t={FIRST_DIM_SIZE:Or.FIRST_DIM_SIZE,VALUE_ROWIDS:Or.VALUE_ROWIDS,ROW_LENGTHS:Or.ROW_LENGTHS,ROW_SPLITS:Or.ROW_SPLITS,ROW_LIMITS:Or.ROW_LIMITS,ROW_STARTS:Or.ROW_STARTS},e=[];for(const s of n)if(s in t)e.push(t[s]);else break;return e}function qD(n){return n.length===0?0:n[0]===Or.FIRST_DIM_SIZE?n.length-1:n.length}function XD(n,t){if(n==null||t==null)return;const e=n.length,s=t.length;if(e>=s)throw new Error(`defaultValue.shape=${n} and ragged tensor flatValues.shape=${t}, are incompatible: defaultValue.rank = ${e} must be less than ragged tensor input flatValues.rank = ${s})`);for(let r=0;r<Math.min(e,s-1);++r){const a=n[r],i=t[r+1];if(a>=0&&i>=0&&a!==1&&a!==i)throw new Error(`defaultValue.shape=${n}, and ragged tensor input flatValues.shape=${t} are incompatible: defaultValue.shape[${r-n.length}] = ${a} but ragged tensor input.flatValues.shape[${r-n.length}] = ${i}`)}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lw=30;function ty(n){return n<=Lw?n:$x(n,Math.floor(Math.sqrt(n)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zw(n,t,e){const s=e*(typeof n=="number"?n:n[0]),r=t*(typeof n=="number"?n:n[1]);return[s,r]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kd(n,t,e,s=!0){let r=[];if(s)r=r.concat(t.slice(0)),r.push(n[0]/e),r=r.concat(n.slice(1));else{r=r.concat(n[0]);const a=t.length;for(let i=0;i<a;++i)r=r.concat([n[i+1]/t[i],t[i]]);r=r.concat(n.slice(a+1))}return r}function Id(n,t,e=!0){const s=[];if(e){s.push(t);for(let r=t+1;r<n;++r)r<=2*t?(s.push(r),s.push(r-(t+1))):s.push(r)}else{const r=[],a=[];for(let i=1;i<n;++i)i>=t*2+1||i%2===1?a.push(i):r.push(i);s.push(...r),s.push(0),s.push(...a)}return s}function Ed(n,t,e,s=!0){const r=[];s?r.push(n[0]/e):r.push(n[0]*e);for(let a=1;a<n.length;++a)a<=t.length?s?r.push(t[a-1]*n[a]):r.push(n[a]/t[a-1]):r.push(n[a]);return r}function Mw(n,t){const e=[0];for(let s=0;s<t;++s)e.push(n[s][0]);return e}function Bw(n,t,e){const s=n.slice(0,1);for(let r=0;r<e;++r)s.push(n[r+1]-t[r][0]-t[r][1]);return s}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ey=1.7580993408473768,ny=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pw=.3275911,Vw=.254829592,Uw=-.284496736,Gw=1.421413741,Ww=-1.453152027,Hw=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ba(n,t){if(n.length!==t.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${n.length}, imag: ${t.length}.`);const e=new Float32Array(n.length*2);for(let s=0;s<e.length;s+=2)e[s]=n[s/2],e[s+1]=t[s/2];return e}function KD(n){const t=new Float32Array(n.length/2),e=new Float32Array(n.length/2);for(let s=0;s<n.length;s+=2)t[s/2]=n[s],e[s/2]=n[s+1];return{real:t,imag:e}}function YD(n){const t=Math.ceil(n.length/4),e=new Float32Array(t),s=new Float32Array(t);for(let r=0;r<n.length;r+=4)e[Math.floor(r/4)]=n[r],s[Math.floor(r/4)]=n[r+1];return{real:e,imag:s}}function ZD(n){const t=Math.floor(n.length/4),e=new Float32Array(t),s=new Float32Array(t);for(let r=2;r<n.length;r+=4)e[Math.floor(r/4)]=n[r],s[Math.floor(r/4)]=n[r+1];return{real:e,imag:s}}function jw(n,t){const e=n[t*2],s=n[t*2+1];return{real:e,imag:s}}function QD(n,t,e,s){n[s*2]=t,n[s*2+1]=e}function JD(n,t){const e=new Float32Array(n/2),s=new Float32Array(n/2);for(let r=0;r<Math.ceil(n/2);r++){const a=(t?2:-2)*Math.PI*(r/n);e[r]=Math.cos(a),s[r]=Math.sin(a)}return{real:e,imag:s}}function tA(n,t,e){const s=(e?2:-2)*Math.PI*(n/t),r=Math.cos(s),a=Math.sin(s);return{real:r,imag:a}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yb="->",QH=/->/g,k2=",",I2="...";function qw(n,t){n=n.replace(/\s/g,"");const e=(n.length-n.replace(QH,"").length)/Yb.length;if(e<1)throw new Error("Equations without an arrow are not supported.");if(e>1)throw new Error(`Equation must contain exactly one arrow ("${Yb}").`);const[s,r]=n.split(Yb);F(s.indexOf(I2)===-1,()=>`The ellipsis notation ("${I2}") is not supported yet.`);const a=s.split(k2),i=a.length;if(t!==i)throw new Error(`Expected ${i} input tensors, received ${t}`);if(i>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const l=[];for(let m=0;m<r.length;++m){const y=r[m];if(!a.some(b=>b.indexOf(y)!==-1))throw new Error(`Output subscripts contain the label ${y} not present in the input subscripts.`);l.indexOf(y)===-1&&l.push(y)}for(let m=0;m<s.length;++m){const y=s[m];l.indexOf(y)===-1&&y!==k2&&l.push(y)}const u=new Array(a.length);for(let m=0;m<i;++m){if(new Set(a[m].split("")).size!==a[m].length)throw new Error(`Found duplicate axes in input component ${a[m]}. Support for duplicate axes in input is not implemented yet.`);u[m]=[];for(let y=0;y<a[m].length;++y)u[m].push(l.indexOf(a[m][y]))}const h=l.length,d=r.length,p=[];for(let m=d;m<h;++m)p.push(m);return{allDims:l,summedDims:p,idDims:u}}function Xw(n,t){let e=new Array(n);e.fill(-1);for(let r=0;r<t.length;++r)e[t[r]]=r;const s=[];for(let r=0;r<n;++r)e[r]===-1&&s.push(r);return e=e.filter(r=>r!==-1),{permutationIndices:e,expandDims:s}}function Kw(n,t,e){const s=new Array(n);for(let r=0;r<e.length;++r){const a=e[r].shape;for(let i=0;i<t[r].length;++i)s[t[r][i]]===void 0?s[t[r][i]]=a[i]:F(s[t[r][i]]===a[i],()=>`Expected dimension ${s[t[r][i]]} at axis ${i} of input shaped ${JSON.stringify(a)}, but got dimension ${a[i]}`)}}function Yw(n,t){const e=n,s=[];let r=0;n.length===0&&e.push(-1),r=n.length+1;for(let i=0;i<r;++i)s.push([]);const a=[];for(let i=0;i<e.length;++i){const l=e[i],u=JH(t,l);for(const h of u)a.indexOf(h)===-1&&(s[i].push(h),a.push(h))}return{path:e,steps:s}}function Zw(n){return n.every((t,e)=>t===e)}function JH(n,t){const e=[];for(let s=0;s<n.length;++s)(n[s].length===0||n[s].indexOf(t)!==-1||t===-1)&&e.push(s);return e}function Qw(n,t,e=0){let s=[];if(typeof t=="number")F(n.shape[e]%t===0,()=>"Number of splits must evenly divide the axis."),s=new Array(t).fill(n.shape[e]/t);else{const r=t.reduce((i,l)=>(l===-1&&(i+=1),i),0);F(r<=1,()=>"There should be only one negative value in split array.");const a=t.indexOf(-1);if(a!==-1){const i=t.reduce((l,u)=>u>0?l+u:l);t[a]=n.shape[e]-i}F(n.shape[e]===t.reduce((i,l)=>i+l),()=>"The sum of sizes must match the size of the axis dimension."),s=t}return s}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eA(n){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${n}`}function nA(n,t){return`indices(${n}, 0) is invalid: ${t} < 0`}function sA(n,t,e){return`indices(${n}, 0) is invalid: ${t} >= ${e}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rA(n,t){return`only one output dimension may be -1, not both ${n} and ${t}`}function aA(n,t){return`size ${n} must be non-negative, not ${t}`}function iA(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function oA(n,t){const e=mt(n),s=mt(t);return`Input to reshape is a SparseTensor with ${e}
  dense values, but the requested shape requires a multiple of ${s}. inputShape=${n} outputShape= ${t}`}function lA(n,t){const e=mt(n),s=mt(t);return`Input to reshape is a tensor with ${e} dense values, but the requested shape has ${s}. inputShape=${n} outputShape=${t}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qx(){return"segment ids must be >= 0"}function uA(){return"segment ids are not increasing"}function cA(n,t){return`Segment id ${n} out of range [0, ${t}), possibly because segmentIds input is not sorted.`}function hA(n,t,e){return`Bad: indices[${n}] == ${t} out of range [0, ${e})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dA(n,t){let e=!1,s;for(n<=Lw?(s=n,e=!0):s=$x(n,Math.floor(Math.sqrt(n)));!e;)s>t||s===n?e=!0:s=$x(n,s+1);return s}function fA(n,t,e){const s=[],r=n.length;for(let a=0;a<r;a++)a!==t?s.push(n[a]):s.push(e);return s}function Jw(n,t,e,s){const r=t.shape.length,a=n.shape.length;if(s!==0&&(s<-r||s>r))throw new Error(`Expect batchDims in the range of [-${r}, ${r}], but got ${s}`);if(s<0&&(s+=r),s>a)throw new Error(`batchDims (${s}) must be less than rank(x) (
    ${a}).`);if(e<s)throw new Error(`batchDims (${s}) must be less than or equal to axis (${e}).`);for(let p=0;p<s;++p)if(n.shape[p]!==t.shape[p])throw new Error(`x.shape[${p}]: ${n.shape[p]} should be equal to indices.shape[${p}]: ${t.shape[p]}.`);const i=n.shape[e],l=[];let u=1,h=1,d=1;for(let p=0;p<s;++p)l.push(n.shape[p]),u*=n.shape[p];for(let p=s;p<e;p++)l.push(n.shape[p]),h*=n.shape[p];for(let p=s;p<r;p++)l.push(t.shape[p]);for(let p=e+1;p<a;p++)l.push(n.shape[p]),d*=n.shape[p];return{batchSize:u,sliceSize:d,outerSize:h,dimSize:i,outputShape:l}}const t6=Object.freeze(Object.defineProperty({__proto__:null,collectGatherOpShapeInfo:Jw,computeOutShape:fA,segOpComputeOptimalWindowSize:dA},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pa(n){try{return n.map(t=>ki(t))}catch(t){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${t}`)}}function pA(n){return n.map(t=>Ni(t))}const e6=Object.freeze(Object.defineProperty({__proto__:null,ERF_A1:Vw,ERF_A2:Uw,ERF_A3:Gw,ERF_A4:Ww,ERF_A5:Hw,ERF_P:Pw,PARALLELIZE_THRESHOLD:Lw,get RowPartitionType(){return Or},SELU_SCALE:ny,SELU_SCALEALPHA:ey,applyActivation:Zg,assertAndGetBroadcastShape:Yt,assertAxesAreInnerMostDims:jn,assertParamsConsistent:Fw,assignToTypedArray:QD,axesAreInnerMostDims:Qv,calculateShapes:Qo,checkEinsumDimSizes:Kw,checkPadOnDimRoundingMode:hs,combineLocations:GE,combineRaggedTensorToTensorShapes:HD,complexWithEvenIndex:YD,complexWithOddIndex:ZD,computeConv2DInfo:On,computeConv3DInfo:Gi,computeDefaultPad:Wv,computeDilation2DInfo:vd,computeOptimalWindowSize:ty,computeOutAndReduceShapes:_n,computeOutShape:ra,computePool2DInfo:Tr,computePool3DInfo:Ua,convertConv2DDataFormat:Ga,decodeEinsumEquation:qw,eitherStridesOrDilationsAreOne:Hn,expandShapeToKeepDim:on,exponent:tA,exponents:JD,fromStringArrayToUint8:pA,fromUint8ToStringArray:Pa,getAxesPermutation:qe,getBroadcastDims:du,getComplexWithIndex:jw,getEinsumComputePath:Yw,getEinsumPermutation:Xw,getFusedBiasGradient:Yg,getFusedDyActivation:Kg,getImageCenter:zw,getInnerMostAxes:ln,getPermuted:Id,getRaggedRank:qD,getReductionAxes:$n,getReshaped:kd,getReshapedPermuted:Ed,getRowPartitionTypesHelper:jD,getSliceBeginCoords:Mw,getSliceSize:Bw,getSparseFillEmptyRowsIndicesDenseShapeMismatch:eA,getSparseFillEmptyRowsNegativeIndexErrorMessage:nA,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:sA,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:iA,getSparseReshapeInputOutputMismatchErrorMessage:lA,getSparseReshapeInputOutputMultipleErrorMessage:oA,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:rA,getSparseReshapeNegativeOutputDimErrorMessage:aA,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:hA,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:qx,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:uA,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:cA,getUndoAxesPermutation:Wi,isIdentityPermutation:Zw,log:UM,mergeRealAndImagArrays:Ba,prepareAndValidate:Ew,prepareSplitSize:Qw,segment_util:t6,shouldFuse:Qg,slice_util:KH,splitRealAndImagArrays:KD,stridesOrDilationsArePositive:Po,tupleValuesAreOne:Di,upcastType:Os,validateDefaultValueShape:XD,validateInput:gw,validateUpdateShape:uD,warn:Ys},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */TH();/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mA={kernelName:km,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>X(n,_u(kt(e,"float32"),-1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n6={kernelName:Nh,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>{const s=Ae(kt(e,"float32")),r=Wn(Rt(Vt(1),s));return Be(_t(n,r))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s6={kernelName:Th,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>{const s=Wn(Rt(Ae(kt(e,"float32")),1));return _t(n,s)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r6={kernelName:Au,inputsToSave:["a","b"],gradFunc:(n,t)=>{const[e,s]=t,r=Yt(e.shape,s.shape);return{a:()=>{let l=n;const u=$n(e.shape,r);return u.length>0&&(l=Ft(l,u)),J(l,e.shape)},b:()=>{let l=n;const u=$n(s.shape,r);return u.length>0&&(l=Ft(l,u)),J(l,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a6={kernelName:Im,saveAllInputs:!0,gradFunc:(n,t)=>{const e={};return t.forEach((s,r)=>{e[r]=()=>n.clone()}),e}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i6={kernelName:Em,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>pe(e)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o6={kernelName:Dm,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>pe(e)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l6={kernelName:$h,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>_t(n,Wn(Rt(Vt(1),Ae(kt(e,"float32")))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const u6={kernelName:kh,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>{const s=Wn(St(Vt(1),Ae(kt(e,"float32"))));return _t(n,s)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c6={kernelName:Dh,inputsToSave:["a","b"],gradFunc:(n,t)=>{const[e,s]=t,r=Yt(e.shape,s.shape);return{a:()=>{const l=St(Ae(e),Ae(s));let u=X(n,_t(s,l));const h=$n(e.shape,r);return h.length>0&&(u=Ft(u,h)),J(u,e.shape)},b:()=>{const l=St(Ae(e),Ae(s));let u=Be(X(n,_t(e,l)));const h=$n(s.shape,r);return h.length>0&&(u=Ft(u,h)),J(u,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h6={kernelName:Ih,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>_t(n,St(Ae(kt(e,"float32")),1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const d6={kernelName:Eh,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>_t(n,Rt(Vt(1),Ae(kt(e,"float32"))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f6(n,t,e,s,r,a){const i=B(n,"dy","avgPool3dGrad"),l=B(t,"input","avgPool3dGrad");let u=i,h=l,d=!1;l.rank===4&&(d=!0,u=J(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]]),h=J(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]])),F(u.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${u.rank}.`),F(h.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${h.rank}.`),hs("avgPool3dGrad",r,a);const p={dy:u,input:h},m={filterSize:e,strides:s,pad:r,dimRoundingMode:a},y=K.runKernel(z1,p,m);return d?J(y,[y.shape[1],y.shape[2],y.shape[3],y.shape[4]]):y}const p6=q({avgPool3dGrad_:f6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const m6={kernelName:Rm,inputsToSave:["x"],gradFunc:(n,t,e)=>{const[s]=t,{filterSize:r,strides:a,pad:i,dimRoundingMode:l}=e;return{x:()=>p6(n,s,r,a,i,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g6(n,t,e,s,r){const a=B(n,"dy","avgPoolGrad"),i=B(t,"input","avgPoolGrad");F(i.rank===a.rank,()=>`Rank of input (${i.rank}) does not match rank of dy (${a.rank})`);let l=i,u=a,h=!1;i.rank===3&&(h=!0,l=J(i,[1,i.shape[0],i.shape[1],i.shape[2]]),u=J(a,[1,a.shape[0],a.shape[1],a.shape[2]])),F(u.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${u.rank}.`),F(l.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${l.rank}.`);const d={dy:u,input:l},p={filterSize:e,strides:s,pad:r},m=K.runKernel(L1,d,p);return h?J(m,[m.shape[1],m.shape[2],m.shape[3]]):m}const y6=q({avgPoolGrad_:g6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const b6={kernelName:Am,inputsToSave:["x"],gradFunc:(n,t,e)=>{const[s]=t,{filterSize:r,strides:a,pad:i}=e;return{x:()=>y6(n,s,r,a,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x6={kernelName:Om,inputsToSave:["a","b"],gradFunc:(n,t,e)=>{const[s,r]=t,{transposeA:a,transposeB:i}=e;return!a&&!i?{a:()=>le(n,r,!1,!0),b:()=>le(s,n,!0,!1)}:!a&&i?{a:()=>le(n,r,!1,!1),b:()=>le(n,s,!0,!1)}:a&&!i?{a:()=>le(r,n,!1,!0),b:()=>le(s,n,!1,!1)}:{a:()=>le(r,n,!0,!0),b:()=>le(n,s,!0,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const v6={kernelName:_m,gradFunc:(n,t,e)=>{const{blockShape:s,crops:r}=e;return{x:()=>Vg(n,s,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w6={kernelName:BM,gradFunc:(n,t,e)=>{const s=e,r=s.inputShape,a=s.shape,i=Array.from(a);for(let u=r.length-1;u>=0;u--)if(r[u]===a[u])i[u]=1;else if(r[u]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${a}].`);const l=[];for(let u=0;u<i.length;u++)i[u]>1&&l.push(u);return{x:()=>Ft(n,l,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const S6={kernelName:Ah,gradFunc:n=>({x:()=>n.clone()})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C6={kernelName:Rh,gradFunc:n=>({x:()=>pe(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N6={kernelName:Oh,inputsToSave:["x"],gradFunc:(n,t,e)=>{const[s]=t,{clipValueMin:r,clipValueMax:a}=e;return{x:()=>Jn(oa(Hi(s,r),Yo(s,a)),n,pe(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T6={kernelName:Lm,inputsToSave:["x"],gradFunc:mA.gradFunc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $6={kernelName:zm,saveAllInputs:!0,gradFunc:(n,t,e)=>{const s=t.map(u=>u.shape),{axis:r}=e,a=re(r,t[0].shape)[0],i=s.map(u=>u[a]);return As(n,i,a).map(u=>()=>u)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k6={kernelName:Mm,inputsToSave:["x","filter"],gradFunc:(n,t,e)=>{const[s,r]=t,{dilations:a,strides:i,pad:l,dataFormat:u}=e;return F(Di(a),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${a}'`),{x:()=>qv(s.shape,n,r,i,l,u),filter:()=>ww(s,n,r.shape,i,l,u)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I6={kernelName:Bm,inputsToSave:["dy","filter"],gradFunc:(n,t,e)=>{const[s,r]=t,{strides:a,pad:i,dataFormat:l,dimRoundingMode:u}=e;return{dy:()=>Ai(n,r,a,i,l,1,u),filter:()=>ww(n,s,r.shape,a,i,l,u)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E6(n,t,e,s,r){let a=n;n.rank===4&&(a=J(n,[1,n.shape[0],n.shape[1],n.shape[2],n.shape[3]]));let i=t;i.rank===4&&(i=J(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]])),F(a.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${a.shape}.`),F(i.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${i.shape}.`),F(e.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${e}.`),F(a.shape[4]===e[3],()=>`Error in conv3dDerFilter: depth of input ${a.shape[4]}) must match input depth in filter (${e[3]}.`),F(i.shape[4]===e[4],()=>`Error in conv3dDerFilter: depth of dy (${i.shape[4]}) must match output depth for filter (${e[4]}).`);const l={x:a,dy:i},u={strides:s,pad:r,filterShape:e};return K.runKernel(U1,l,u)}const D6=q({conv3DBackpropFilter_:E6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A6={kernelName:Pm,inputsToSave:["x","filter"],gradFunc:(n,t,e)=>{const{dilations:s,strides:r,pad:a}=e;F(Di(s),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`);const[i,l]=t;return{x:()=>zE(i.shape,n,l,r,a),filter:()=>D6(i,n,l.shape,r,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const R6={kernelName:_h,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>X(Be(hw(kt(e,"float32"))),n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O6={kernelName:Fh,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>X(dw(kt(e,"float32")),n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _6={kernelName:Vm,inputsToSave:["x"],gradFunc:(n,t,e)=>{const[s]=t,{axis:r,exclusive:a,reverse:i}=e;return{x:()=>{const l=qe([r],s.rank);let u=Yv(n,r,a,!i);return l!=null&&(u=fe(u,l)),u}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F6={kernelName:Um,inputsToSave:["x","filter"],gradFunc:(n,t,e)=>{const{dilations:s,strides:r,pad:a,dimRoundingMode:i}=e,l=s??[1,1];F(Di(l),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${l}'`);const[u,h]=t;return F(u.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${u.rank}.`),F(h.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${h.rank}.`),F(u.shape[3]===h.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${u.shape[3]}) must match the inChannels dimension in filter ${h.shape[2]}.`),F(Hn(r,l),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${r} and dilations '${l}'.`),hs("depthwiseConv2d",a,i),{x:()=>bD(u.shape,n,h,r,a,l,i),filter:()=>yD(u,n,h.shape,r,a,l,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L6={kernelName:Gm,inputsToSave:["x","filter"],gradFunc:(n,t,e)=>{const[s,r]=t,a={x:s,filter:r,dy:n},i={x:s,filter:r,dy:n};return{x:()=>K.runKernel(kx,a,e),filter:()=>K.runKernel(Ix,i,e)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const z6={kernelName:zh,outputsToSave:[!0],gradFunc:(n,t)=>{const[e]=t,s={dy:n,y:e};return{x:()=>K.runKernel(Q1,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M6={kernelName:Mh,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t,s=X(Fs(Be(Ae(e))),2/Math.sqrt(Math.PI));return{x:()=>X(n,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const B6={kernelName:Bh,outputsToSave:[!0],gradFunc:(n,t)=>{const[e]=t;return{x:()=>X(n,e)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const P6={kernelName:Hm,inputsToSave:["input"],gradFunc:(n,t)=>{const[e]=t;return{input:()=>J(n,e.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const V6={kernelName:Ph,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>X(n,Fs(e))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const U6={kernelName:Vh,gradFunc:n=>({x:()=>pe(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G6={kernelName:Uh,inputsToSave:["a","b"],gradFunc:(n,t)=>{const[e,s]=t,r=Yt(e.shape,s.shape);return{a:()=>{const l=_t(n,kt(s,"float32")),u=$n(e.shape,r);return u.length>0?J(Ft(l,u),e.shape):l},b:()=>{let l=X(n,kt(e,"float32"));const u=$n(s.shape,r);u.length>0&&(l=J(Ft(l,u),s.shape));const h=Ae(s);return Be(_t(l,kt(h,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const W6={kernelName:jm,inputsToSave:["x","mean","variance","scale"],gradFunc:(n,t,e)=>{const{varianceEpsilon:s}=e,[r,a,i,l]=t,u=l??Vt(1),h=$n(a.shape,r.shape),d=[];if(a.rank===1){for(let T=0;T<r.shape.length-1;++T)d.push(r.shape[T]);d.push(1)}const p=Rt(r,a),m=X(n,u),y=lw(St(i,Vt(s))),b=X(X(X(y,y),y),Vt(-.5));return{x:()=>a.rank===1?J(X(X(n,gr(J(y,[1,1,1,a.shape[0]]),d)),u),r.shape):J(X(X(n,y),u),r.shape),mean:()=>{let T=X(X(y,Vt(-1)),m);return a.rank===1&&(T=Ft(T,h)),J(T,a.shape)},variance:()=>{let T=X(X(b,p),m);return a.rank===1&&(T=Ft(T,h)),J(T,a.shape)},scale:()=>{const T=X(p,y);let I=X(n,T);return a.rank===1&&(I=Ft(I,h)),J(I,a.shape)},offset:()=>{let T=n;return a.rank===1&&(T=Ft(T,h)),J(T,a.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const H6={kernelName:qm,inputsToSave:["x","indices"],gradFunc:(n,t,e)=>{const[s,r]=t,{axis:a,batchDims:i}=e,l=re(a,s.shape)[0],u=(h,d,p)=>()=>{const m=h.shape,y=d.size,b=m.slice(0,l),x=b.length,v=m.slice(a,m.length).slice(1),S=v.length,C=E2(0,x),$=E2(x+1,x+1+S),T=D2([b,[y],v]),I=J(p,T),A=J(d,[y]),R=D2([[x],C,$]),L=fe(I,R);let _=bw(L,A,h.shape[l]);const M=Wi(R);return _=fe(_,M),_};if(i===1){const h=s.shape[0],d=s.split(h,0);return{x:()=>Ls(d.map((y,b)=>u(y,r.slice(b,1),n.slice(b,1))())).reshape(s.shape),indices:()=>r}}else return{x:u(s,r,n),indices:()=>r}}};function E2(n,t){const e=[];for(let s=n;s<t;++s)e.push(s);return e}function D2(n){const t=[];for(let e=0;e<n.length;++e)for(let s=0;s<n[e].length;++s)t.push(n[e][s]);return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j6={kernelName:Gh,inputsToSave:["a","b"],gradFunc:(n,t)=>{const[e,s]=t;return{a:()=>pe(e),b:()=>pe(s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q6={kernelName:Wh,gradFunc:n=>({x:()=>kt(n,"float32")})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const X6={kernelName:Hh,gradFunc:n=>({x:()=>pe(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const K6={kernelName:jh,gradFunc:n=>({x:()=>pe(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Y6={kernelName:qh,gradFunc:n=>({x:()=>pe(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Z6={kernelName:Km,inputsToSave:["x"],gradFunc:(n,t,e)=>{const[s]=t,{alpha:r}=e,a=Ps(s,0);return{x:()=>Jn(a,n,X(n,r))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q6={kernelName:Kh,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>_t(n,St(e,1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const J6={kernelName:Xh,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>_t(n,kt(e,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tj={kernelName:VM,inputsToSave:[],outputsToSave:[!0],gradFunc:(n,t,e)=>{const[s]=t,{axis:r}=e;return{logits:()=>{const i=Fs(s);return Rt(n,X(Ft(n,r,!0),i))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ej(n,t,e,s=5,r=1,a=1,i=.5){const l={x:n,y:t,dy:e},u={depthRadius:s,bias:r,alpha:a,beta:i};return K.runKernel(iv,l,u)}const nj=q({localResponseNormalizationBackprop_:ej});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sj={kernelName:eg,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,t,e)=>{const[s,r]=t,{depthRadius:a,bias:i,alpha:l,beta:u}=e;return{x:()=>nj(s,r,n,a,i,l,u)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gA(n,t,e,s){return t.rank<e.rank&&(t=J(t,on(t.shape,s))),n.rank<e.rank&&(n=J(n,on(n.shape,s))),{x:()=>X(n,kt(Mr(e,t),n.dtype))}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A2={kernelName:ng,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,t,e)=>{const s=e,{reductionIndices:r}=s,a=t[0],i=t[1],l=re(r,a.shape),u=gA(n,i,a,l);return{x:()=>u.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rj={kernelName:Yh,inputsToSave:["a","b"],gradFunc:(n,t)=>{const[e,s]=t;return{a:()=>X(n,kt(Hi(e,s),"float32")),b:()=>X(n,kt(ch(e,s),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aj(n,t,e,s,r,a,i){const l=B(n,"dy","maxPool3dGrad"),u=B(t,"input","maxPool3dGrad"),h=B(e,"output","maxPool3dGrad");let d=l,p=u,m=h,y=!1;u.rank===4&&(y=!0,d=J(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),p=J(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]]),m=J(h,[1,h.shape[0],h.shape[1],h.shape[2],h.shape[3]])),F(d.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${d.rank}.`),F(p.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${p.rank}.`),F(m.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${m.rank}.`),hs("maxPool3dGrad",a,i);const b={dy:d,input:p,output:m},x={filterSize:s,strides:r,pad:a,dimRoundingMode:i},v=K.runKernel(lv,b,x);return y?J(v,[v.shape[1],v.shape[2],v.shape[3],v.shape[4]]):v}const ij=q({maxPool3dGrad_:aj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oj={kernelName:rg,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,t,e)=>{const[s,r]=t,{filterSize:a,strides:i,pad:l,dimRoundingMode:u}=e;return{x:()=>ij(n,s,r,a,i,l,u)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lj(n,t,e,s,r,a,i){const l=B(n,"dy","maxPoolGrad"),u=B(t,"input","maxPoolGrad"),h=B(e,"output","maxPoolGrad");F(u.rank===l.rank,()=>`Rank of input (${u.rank}) does not match rank of dy (${l.rank})`),F(l.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${l.rank}.`),F(u.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${u.rank}.`),hs("maxPoolGrad",a,i);const d={dy:l,input:u,output:h},p={filterSize:s,strides:r,pad:a,dimRoundingMode:i};return K.runKernel(ov,d,p)}const uj=q({maxPoolGrad_:lj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cj={kernelName:sg,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,t,e)=>{const[s,r]=t,{filterSize:a,strides:i,pad:l}=e;return{x:()=>uj(n,s,r,a,i,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hj={kernelName:ag,inputsToSave:["x"],gradFunc:(n,t,e)=>{const[s]=t,{axis:r}=e,a=re(r,s.shape),l=_n(s.shape,a)[1],u=mt(l);return{x:()=>{const d=s.shape.slice();a.forEach(y=>{d[y]=1});const p=J(n,d);return _t(X(p,Is(s.shape,"float32")),u)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dj={kernelName:ig,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,t,e)=>{const s=e,{axis:r}=s,[a,i]=t,l=re(r,a.shape),u=gA(n,i,a,l);return{x:()=>u.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fj={kernelName:Zh,inputsToSave:["a","b"],gradFunc:(n,t)=>{const[e,s]=t;return{a:()=>X(n,kt(Yo(e,s),"float32")),b:()=>X(n,kt(Ps(e,s),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pj={kernelName:og,inputsToSave:["x"],gradFunc:(n,t,e)=>{const s=t[0],{paddings:r}=e,a=r.map(i=>i[0]);return{x:()=>Qt(n,a,s.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mj={kernelName:Qh,inputsToSave:["a","b"],gradFunc:(n,t)=>{const[e,s]=t,r=Yt(e.shape,s.shape);return{a:()=>{const l=$n(e.shape,r);return l.length>0?J(Ft(n,l),e.shape):n},b:()=>{const l=X(n,Be(Td(_t(e,s)))),u=$n(s.shape,r);return u.length>0?J(Ft(l,u),s.shape):l}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gj={kernelName:Jh,inputsToSave:["a","b"],gradFunc:(n,t)=>{const[e,s]=t,r=Yt(e.shape,s.shape);return{a:()=>{const l=X(n,kt(s,"float32")),u=$n(e.shape,r);return u.length>0?J(Ft(l,u),e.shape):l},b:()=>{const l=X(n,kt(e,"float32")),u=$n(s.shape,r);return u.length>0?J(Ft(l,u),s.shape):l}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yj={kernelName:lg,gradFunc:n=>({x:()=>Be(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bj={kernelName:hg,inputsToSave:["indices"],gradFunc:(n,t)=>{const e=t[0];return{indices:()=>vn(e.shape,"float32")}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xj={kernelName:cg,gradFunc:n=>({x:()=>pe(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vj={kernelName:dg,saveAllInputs:!0,gradFunc:(n,t,e)=>{const{axis:s}=e;return Cr(n,s).map(a=>()=>a)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const R2={kernelName:fg,inputsToSave:["x"],gradFunc:(n,t,e)=>{const s=t[0],{paddings:r}=e,a=r.map(i=>i[0]);return{x:()=>Qt(n,a,s.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wj={kernelName:td,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(n,t)=>{const[e,s,r]=t,a=e,i=s,l=Yt(a.shape,i.shape);return{a:()=>{const d=kt(i,"float32");let p=X(n,X(d,La(a,Rt(d,Vt(1)))));const m=$n(a.shape,l);return m.length>0&&(p=Ft(p,m)),J(p,a.shape)},b:()=>{const d=Ps(a,0),p=Jn(d,Qs(a),pe(a));let m=X(n,X(r,p));const y=$n(i.shape,l);return y.length>0&&(m=Ft(m,y)),J(m,i.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sj={kernelName:pg,inputsToSave:["x","alpha"],gradFunc:(n,t)=>{const[e,s]=t,r=Ps(e,0);return{x:()=>Jn(r,n,X(n,s)),alpha:()=>{let a=Jn(r,pe(n),X(n,e));const i=$n(s.shape,n.shape);return i.length>0&&(a=Ft(a,i)),J(a,s.shape)}}}};/**
 * @license
 * Copyright 2022 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cj(n,t,e){const s=n.shape.slice();s[e]=1;const r=J(t,s),a=Yp(n,e,!0,!1),i=Yp(n,e,!0,!0),l=X(a,i);return X(r,l)}function Nj(n,t,e){const s=n.shape.length,r=s-e.length,a=qe(e,s);let i=n;a!=null&&(i=fe(n,a));const l=i.shape.slice(),h=l.splice(s-e.length,e.length).reduce((m,y)=>m*y,1);l.push(h);const d=i.reshape(l);let p=Cj(d,t,r);if(p=p.reshape(i.shape),a!=null){const m=Wi(a);p=fe(p,m)}return p}const Tj={kernelName:mg,inputsToSave:["x"],gradFunc:(n,t,e)=>{const[s]=t,{axis:r}=e;let a=[];return r==null?a=s.shape.map((i,l)=>l):typeof r=="number"?a=[r]:a=r,{x:()=>Nj(s,n,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $j={kernelName:Lh,inputsToSave:["a","b"],gradFunc:(n,t)=>{const[e,s]=t,r=Yt(e.shape,s.shape);return{a:()=>{const l=_t(n,kt(s,"float32")),u=$n(e.shape,r);return u.length>0?J(Ft(l,u),e.shape):l},b:()=>{let l=X(n,kt(e,"float32"));const u=$n(s.shape,r);u.length>0&&(l=J(Ft(l,u),s.shape));const h=Ae(s);return Be(_t(l,kt(h,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kj={kernelName:ed,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>_t(n,Be(Ae(e)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ij={kernelName:sd,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t,s=X(Yo(e,6),_u(e));return{x:()=>X(n,kt(s,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ej={kernelName:nd,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>X(n,kt(_u(e),"float32"))}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dj={kernelName:gg,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>J(n,e.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Aj={kernelName:bg,inputsToSave:["images"],gradFunc:(n,t,e)=>{const[s]=t,r={dy:n,images:s};return{images:()=>K.runKernel(vv,r,e)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rj={kernelName:yg,inputsToSave:["images"],gradFunc:(n,t,e)=>{const[s]=t,r={dy:n,images:s};return{images:()=>K.runKernel(xv,r,e)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oj={kernelName:xg,gradFunc:(n,t,e)=>{const{dims:s}=e,r=re(s,n.shape);return{x:()=>Sr(n,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _j={kernelName:rd,gradFunc:n=>({x:()=>pe(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fj={kernelName:ad,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>Be(_t(n,X(La(e,1.5),2)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lj={kernelName:vg,inputsToSave:["condition"],gradFunc:(n,t)=>{const[e]=t;return{condition:()=>kt(pe(e),"float32"),t:()=>X(n,kt(e,n.dtype)),e:()=>X(n,kt(Mg(e),n.dtype))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zj={kernelName:id,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>{const s=Ps(e,Vt(0)),r=Vt(ey),a=Vt(ny),i=X(n,a),l=X(X(n,r),Fs(kt(e,"float32")));return Jn(s,i,l)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mj={kernelName:cd,outputsToSave:[!0],gradFunc:(n,t)=>{const[e]=t;return{x:()=>X(n,X(e,Rt(Vt(1),e)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bj={kernelName:ud,gradFunc:n=>({x:()=>pe(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pj={kernelName:od,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>X(Og(kt(e,"float32")),n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vj={kernelName:ld,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>X(Kv(kt(e,"float32")),n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uj={kernelName:wg,inputsToSave:["x"],gradFunc:(n,t,e)=>{const[s]=t,{begin:r,size:a}=e,i=s.shape,[l,u]=Jg(s,r,a),h=[];for(let d=0;d<n.rank;d++)h.push([l[d],i[d]-l[d]-u[d]]);return{x:()=>ji(n,h)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gj={kernelName:Tg,outputsToSave:[!0],gradFunc:(n,t,e)=>{const[s]=t,{dim:r}=e,a=!0,i=X(n,s);return{logits:()=>Rt(i,X(Ft(i,[r],a),s))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wj={kernelName:hd,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>X(n,Fr(e))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O2={kernelName:Cg,gradFunc:(n,t,e)=>{const{blockShape:s,paddings:r}=e;return{x:()=>Rg(n,s,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _2={kernelName:Ng,gradFunc:(n,t,e)=>{const{axis:s}=e;return{x:()=>pn(n,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hj={kernelName:dd,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>_t(n,X(Wn(kt(e,"float32")),2))}}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jj={kernelName:Ev,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>X(n,X(kt(e,"float32"),2))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qj={kernelName:fd,inputsToSave:["a","b"],gradFunc:(n,t)=>{const[e,s]=t,r=Vt(2);return{a:()=>X(n,X(r,Rt(e,s))),b:()=>X(n,X(r,Rt(s,e)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xj={kernelName:bd,gradFunc:n=>({x:()=>pe(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kj={kernelName:pd,inputsToSave:["a","b"],gradFunc:(n,t)=>{const[e,s]=t,r=Yt(e.shape,s.shape);return{a:()=>{let l=n;const u=$n(e.shape,r);return u.length>0&&(l=Ft(l,u)),J(l,e.shape)},b:()=>{let l=n;const u=$n(s.shape,r);return u.length>0&&(l=Ft(l,u)),J(Be(l),s.shape)}}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yj={kernelName:Sg,inputsToSave:["x"],gradFunc:(n,t,e)=>{const[s]=t,r=s.shape.slice(),{axis:a}=e;re(a,s.shape).forEach(h=>{r[h]=1});const l=J(n,r),u=X(l,Is(s.shape,"float32"));return{x:()=>u}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zj={kernelName:md,inputsToSave:["x"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>_t(n,Ae(Og(e)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qj={kernelName:gd,outputsToSave:[!0],gradFunc:(n,t)=>{const[e]=t;return{x:()=>X(Rt(Vt(1),Ae(e)),n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jj={kernelName:yd,inputsToSave:["x"],gradFunc:(n,t,e)=>{const[s]=t,{reps:r}=e;return{x:()=>{let i=pe(s);if(s.rank===1)for(let l=0;l<r[0];++l)i=St(i,Qt(n,[l*s.shape[0]],[s.shape[0]]));else if(s.rank===2)for(let l=0;l<r[0];++l)for(let u=0;u<r[1];++u)i=St(i,Qt(n,[l*s.shape[0],u*s.shape[1]],[s.shape[0],s.shape[1]]));else if(s.rank===3)for(let l=0;l<r[0];++l)for(let u=0;u<r[1];++u)for(let h=0;h<r[2];++h)i=St(i,Qt(n,[l*s.shape[0],u*s.shape[1],h*s.shape[2]],[s.shape[0],s.shape[1],s.shape[2]]));else if(s.rank===4)for(let l=0;l<r[0];++l)for(let u=0;u<r[1];++u)for(let h=0;h<r[2];++h)for(let d=0;d<r[3];++d)i=St(i,Qt(n,[l*s.shape[0],u*s.shape[1],h*s.shape[2],d*s.shape[3]],[s.shape[0],s.shape[1],s.shape[2],s.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${s.rank} tensors yet.`);return i}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t5={kernelName:nu,gradFunc:(n,t,e)=>{const s=e,{perm:r}=s,a=Wi(r);return{x:()=>fe(n,a)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e5={kernelName:kg,gradFunc:(n,t,e)=>{const s=e,{axis:r}=s;return{value:()=>Ls(n,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n5={kernelName:Ig,inputsToSave:["segmentIds"],gradFunc:(n,t)=>{const[e]=t;return{x:()=>s5(n,e)}}};function s5(n,t){const e=Wa(t,pe(t)),s=$d(n,e);let r=Hi(t,Vt(0,"int32"));const a=s.rank-r.rank;for(let l=0;l<a;++l)r=Qn(r,l+1);r=oa(r,Is(s.shape,"bool"));const i=pe(s);return Jn(r,s,i)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r5={kernelName:Eg,gradFunc:n=>({x:()=>pe(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a5=[mA,n6,s6,r6,a6,i6,o6,l6,u6,c6,h6,d6,m6,b6,x6,v6,w6,S6,C6,N6,T6,$6,I6,k6,A6,R6,O6,_6,F6,L6,$j,z6,M6,B6,P6,V6,G6,U6,W6,H6,j6,q6,X6,K6,Y6,Z6,Q6,J6,tj,sj,A2,A2,rj,oj,cj,hj,dj,fj,pj,mj,gj,yj,bj,xj,vj,R2,R2,wj,Sj,Tj,kj,Ij,Ej,Dj,Aj,Rj,Oj,_j,Fj,Lj,zj,Mj,Bj,Pj,Vj,Uj,Gj,Wj,O2,O2,_2,_2,Hj,qj,jj,Xj,Kj,Yj,Zj,Qj,Jj,t5,e5,n5,r5];for(const n of a5)GM(n);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.abs=function(){return this.throwIfDisposed(),bn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.acos=function(){return this.throwIfDisposed(),xE(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.acosh=function(){return this.throwIfDisposed(),vE(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.add=function(n){return this.throwIfDisposed(),St(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.all=function(n,t){return this.throwIfDisposed(),Gv(this,n,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.any=function(n,t){return this.throwIfDisposed(),Kp(this,n,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.argMax=function(n){return this.throwIfDisposed(),hu(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.argMin=function(n){return this.throwIfDisposed(),wE(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.asScalar=function(){return this.throwIfDisposed(),F(this.size===1,()=>"The array must have only 1 element."),J(this,[])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.asType=function(n){return this.throwIfDisposed(),kt(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.as1D=function(){return this.throwIfDisposed(),J(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.as2D=function(n,t){return this.throwIfDisposed(),J(this,[n,t])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.as3D=function(n,t,e){return this.throwIfDisposed(),J(this,[n,t,e])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.as4D=function(n,t,e,s){return this.throwIfDisposed(),J(this,[n,t,e,s])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.as5D=function(n,t,e,s,r){return this.throwIfDisposed(),J(this,[n,t,e,s,r])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.asin=function(){return this.throwIfDisposed(),SE(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.asinh=function(){return this.throwIfDisposed(),CE(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.atan=function(){return this.throwIfDisposed(),NE(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.atan2=function(n){return this.throwIfDisposed(),TE(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.atanh=function(){return this.throwIfDisposed(),$E(this)};gt().prototype.avgPool=function(n,t,e,s){return this.throwIfDisposed(),Ag(this,n,t,e,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.batchToSpaceND=function(n,t){return this.throwIfDisposed(),Rg(this,n,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.batchNorm=function(n,t,e,s,r){return this.throwIfDisposed(),wd(this,n,t,e,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.broadcastTo=function(n){return this.throwIfDisposed(),au(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.cast=function(n){return this.throwIfDisposed(),kt(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.ceil=function(){return this.throwIfDisposed(),RE(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.clipByValue=function(n,t){return this.throwIfDisposed(),_s(this,n,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.concat=function(n,t){return this.throwIfDisposed(),n instanceof Me&&(n=[n]),pn([this,...n],t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.conv1d=function(n,t,e,s,r,a){return this.throwIfDisposed(),jv(this,n,t,e,s,r,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.conv2dTranspose=function(n,t,e,s,r){return this.throwIfDisposed(),Xv(this,n,t,e,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.conv2d=function(n,t,e,s,r,a){return this.throwIfDisposed(),Ai(this,n,t,e,s,r,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.cos=function(){return this.throwIfDisposed(),Og(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.cosh=function(){return this.throwIfDisposed(),Kv(this)};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.cumprod=function(n,t,e){return this.throwIfDisposed(),Yp(this,n,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.cumsum=function(n,t,e){return this.throwIfDisposed(),Yv(this,n,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.depthToSpace=function(n,t){return this.throwIfDisposed(),BE(this,n,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.depthwiseConv2d=function(n,t,e,s,r,a){return this.throwIfDisposed(),Sd(this,n,t,e,s,r,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.dilation2d=function(n,t,e,s,r){return this.throwIfDisposed(),PE(this,n,t,e,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.divNoNan=function(n){return this.throwIfDisposed(),VE(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.div=function(n){return this.throwIfDisposed(),_t(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.dot=function(n){return this.throwIfDisposed(),UE(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.elu=function(){return this.throwIfDisposed(),Cd(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.equal=function(n){return this.throwIfDisposed(),Mr(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.erf=function(){return this.throwIfDisposed(),Zv(this)};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.euclideanNorm=function(n,t){return this.throwIfDisposed(),HE(this,n,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.exp=function(){return this.throwIfDisposed(),Fs(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.expandDims=function(n){return this.throwIfDisposed(),Qn(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.expm1=function(){return this.throwIfDisposed(),jE(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.fft=function(){return this.throwIfDisposed(),qg(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.flatten=function(){return this.throwIfDisposed(),J(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.floor=function(){return this.throwIfDisposed(),Td(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.floorDiv=function(n){return this.throwIfDisposed(),Uv(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.gather=function(n,t,e){return this.throwIfDisposed(),$d(this,n,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.greaterEqual=function(n){return this.throwIfDisposed(),Hi(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.greater=function(n){return this.throwIfDisposed(),Ps(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.ifft=function(){return this.throwIfDisposed(),fh(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.irfft=function(){return this.throwIfDisposed(),pw(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.isFinite=function(){return this.throwIfDisposed(),qE(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.isInf=function(){return this.throwIfDisposed(),XE(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.isNaN=function(){return this.throwIfDisposed(),KE(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.leakyRelu=function(n){return this.throwIfDisposed(),Fg(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.lessEqual=function(n){return this.throwIfDisposed(),Yo(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.less=function(n){return this.throwIfDisposed(),ch(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.localResponseNormalization=function(n,t,e,s){return this.throwIfDisposed(),YE(this,n,t,e,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.logSigmoid=function(){return this.throwIfDisposed(),ZE(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.logSoftmax=function(n){return this.throwIfDisposed(),tw(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.logSumExp=function(n,t){return this.throwIfDisposed(),zg(this,n,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.log=function(){return this.throwIfDisposed(),Qs(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.log1p=function(){return this.throwIfDisposed(),Lg(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.logicalAnd=function(n){return this.throwIfDisposed(),oa(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.logicalNot=function(){return this.throwIfDisposed(),Mg(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.logicalOr=function(n){return this.throwIfDisposed(),ew(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.logicalXor=function(n){return this.throwIfDisposed(),QE(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.matMul=function(n,t,e){return this.throwIfDisposed(),le(this,n,t,e)};gt().prototype.maxPool=function(n,t,e,s){return this.throwIfDisposed(),Bg(this,n,t,e,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.max=function(n,t){return this.throwIfDisposed(),vr(this,n,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.maximum=function(n){return this.throwIfDisposed(),Wa(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.mean=function(n,t){return this.throwIfDisposed(),Ze(this,n,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.min=function(n,t){return this.throwIfDisposed(),uh(this,n,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.minimum=function(n){return this.throwIfDisposed(),Uo(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.mirrorPad=function(n,t){return this.throwIfDisposed(),tD(this,n,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.mod=function(n){return this.throwIfDisposed(),eD(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.mul=function(n){return this.throwIfDisposed(),X(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.neg=function(){return this.throwIfDisposed(),Be(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.norm=function(n,t,e){return this.throwIfDisposed(),Nd(this,n,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.notEqual=function(n){return this.throwIfDisposed(),fu(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.oneHot=function(n,t=1,e=0){return this.throwIfDisposed(),sw(this,n,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.onesLike=function(){return this.throwIfDisposed(),Js(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.pad=function(n,t){return this.throwIfDisposed(),ji(this,n,t)};gt().prototype.pool=function(n,t,e,s,r,a){return this.throwIfDisposed(),nD(this,n,t,e,s,r,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.pow=function(n){return this.throwIfDisposed(),La(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.prelu=function(n){return this.throwIfDisposed(),Ug(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.prod=function(n,t){return this.throwIfDisposed(),sD(this,n,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.reciprocal=function(){return this.throwIfDisposed(),rD(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.relu=function(){return this.throwIfDisposed(),ca(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.relu6=function(){return this.throwIfDisposed(),iw(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.reshapeAs=function(n){return this.throwIfDisposed(),J(this,n.shape)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.reshape=function(n){return this.throwIfDisposed(),J(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.resizeBilinear=function(n,t,e){return this.throwIfDisposed(),wD(this,n,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.resizeNearestNeighbor=function(n,t,e){return this.throwIfDisposed(),SD(this,n,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.reverse=function(n){return this.throwIfDisposed(),Sr(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.rfft=function(){return this.throwIfDisposed(),Xg(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.round=function(){return this.throwIfDisposed(),ow(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.rsqrt=function(){return this.throwIfDisposed(),lw(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.selu=function(){return this.throwIfDisposed(),uw(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.separableConv2d=function(n,t,e,s,r,a){return this.throwIfDisposed(),cw(this,n,t,e,s,r,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.sigmoid=function(){return this.throwIfDisposed(),Fr(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.sign=function(){return this.throwIfDisposed(),aD(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.sin=function(){return this.throwIfDisposed(),hw(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.sinh=function(){return this.throwIfDisposed(),dw(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.slice=function(n,t){return this.throwIfDisposed(),Qt(this,n,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.softmax=function(n){return this.throwIfDisposed(),jg(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.softplus=function(){return this.throwIfDisposed(),Ou(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.spaceToBatchND=function(n,t){return this.throwIfDisposed(),Vg(this,n,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.split=function(n,t){return this.throwIfDisposed(),As(this,n,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.sqrt=function(){return this.throwIfDisposed(),Wn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.square=function(){return this.throwIfDisposed(),Ae(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.squaredDifference=function(n){return this.throwIfDisposed(),mw(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.squeeze=function(n){return this.throwIfDisposed(),Ma(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.stack=function(n,t){this.throwIfDisposed();const e=n instanceof Me?[this,n]:[this,...n];return Ls(e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.step=function(n){return this.throwIfDisposed(),_u(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.stridedSlice=function(n,t,e,s,r,a,i,l){return this.throwIfDisposed(),iD(this,n,t,e,s,r,a,i,l)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.sub=function(n){return this.throwIfDisposed(),Rt(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.sum=function(n,t){return this.throwIfDisposed(),Ft(this,n,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.tan=function(){return this.throwIfDisposed(),oD(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.tanh=function(){return this.throwIfDisposed(),Vo(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.tile=function(n){return this.throwIfDisposed(),gr(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.toBool=function(){return this.throwIfDisposed(),kt(this,"bool")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.toFloat=function(){return this.throwIfDisposed(),kt(this,"float32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.toInt=function(){return this.throwIfDisposed(),kt(this,"int32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.topk=function(n,t){return this.throwIfDisposed(),cD(this,n,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.transpose=function(n){return this.throwIfDisposed(),fe(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.unique=function(n){return this.throwIfDisposed(),hD(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.unsortedSegmentSum=function(n,t){return this.throwIfDisposed(),bw(this,n,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.unstack=function(n){return this.throwIfDisposed(),Cr(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.where=function(n,t){return this.throwIfDisposed(),Jn(n,this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gt().prototype.zerosLike=function(){return this.throwIfDisposed(),pe(this)};/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Qr extends Error{constructor(t){super(t),Object.setPrototypeOf(this,Qr.prototype)}}class yr extends Error{constructor(t){super(t),Object.setPrototypeOf(this,yr.prototype)}}class st extends Error{constructor(t){super(t),Object.setPrototypeOf(this,st.prototype)}}class Jt extends Error{constructor(t){super(t),Object.setPrototypeOf(this,Jt.prototype)}}class tS extends Error{constructor(t){super(t),Object.setPrototypeOf(this,tS.prototype)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class yA{constructor(t){this.maxEntries=t||100,this.cache=new Map}get(t){let e;return this.cache.has(t)&&(e=this.cache.get(t),this.cache.delete(t),this.cache.set(t,e)),e}put(t,e){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxEntries){const s=this.cache.keys().next().value;this.cache.delete(s)}this.cache.set(t,e)}getMaxEntries(){return this.maxEntries}setMaxEntries(t){if(t<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${t}.`);if(this.maxEntries>t)for(let e=0;e<this.maxEntries-t;e++){const s=this.cache.keys().next().value;this.cache.delete(s)}this.maxEntries=t}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Wo(n,t){if(Array.isArray(n)){let e=[];for(let s=0;s<t;s++)e=e.concat(n);return e}else{const e=new Array(t);return e.fill(n),e}}function Jr(n,t){if(!n)throw new tS(t)}function F2(n,t){let e=0;for(const s of n)s===t&&e++;return e}function ms(n){return n.length===1?n[0]:n}function Se(n){return Array.isArray(n)?n:[n]}function Da(n){const e=n.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return e[0]!=="_"?e:"private"+e}function wo(n){return n.length<=1||n.indexOf("_")===-1?n:n.replace(/[_]+(\w|$)/g,(t,e)=>e.toUpperCase())}let hr={};function eS(n){if(n==null)return null;const t={};return t.className=n.getClassName(),t.config=n.getConfig(),t}function Xx(n){if(!(n==null||typeof n!="object"))if(Array.isArray(n))n.forEach(t=>Xx(t));else{const t=Object.keys(n);for(const e of t){const s=n[e];s!=null&&typeof s=="object"&&(!Array.isArray(s)&&s.type==="ndarray"&&typeof s.value=="number"?n[e]=s.value:Xx(s))}}}function Dd(n,t={},e={},s="object",r=!1){if(typeof n=="string"){const a=n;let i;if(a in e)i=e[a];else if(a in hr)i=hr[a];else if(i=t[a],i==null)throw new st(`Unknown ${s}: ${n}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return i}else{const a=n;if(a.className==null||a.config==null)throw new st(`${s}: Improper config format: ${JSON.stringify(a)}.
'className' and 'config' must set.`);const i=a.className;let l,u;if(i in e?[l,u]=e[i]:i in hr?[l,u]=hr.className:i in t&&([l,u]=t[i]),l==null)throw new st(`Unknown ${s}: ${i}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(u!=null){const h={};for(const y of Object.keys(hr))h[y]=hr[y];for(const y of Object.keys(e))h[y]=e[y];const d=a.config;d.customObjects=h;const p=Object.assign({},hr);for(const y of Object.keys(e))hr[y]=e[y];Xx(a.config);const m=u(l,a.config,e,r);return hr=Object.assign({},p),m}else{const h=Object.assign({},hr);for(const p of Object.keys(e))hr[p]=e[p];const d=new l(a.config);return hr=Object.assign({},h),d}}}function i5(n,t){return n<t?-1:n>t?1:0}function ip(n,t){return-1*i5(n,t)}function Ti(n){if(n==null)return n;const t=[];for(const e of n)t.indexOf(e)===-1&&t.push(e);return t}function o5(n){if(n==null)throw new st(`Invalid value in obj: ${JSON.stringify(n)}`);for(const t in n)if(n.hasOwnProperty(t))return!1;return!0}function Jo(n,t,e){if(e!=null&&n.indexOf(e)<0)throw new st(`${e} is not a valid ${t}.  Valid values are ${n} or null/undefined.`)}function nS(n,t,e=0,s=1/0){return Jr(e>=0),Jr(s>=e),Array.isArray(n)&&n.length>=e&&n.length<=s&&n.every(r=>typeof r===t)}function Rn(n,t){Array.isArray(n)?(F(n.length>0,()=>`${t} is unexpectedly an empty array.`),n.forEach((e,s)=>Rn(e,`element ${s+1} of ${t}`))):F(Number.isInteger(n)&&n>0,()=>`Expected ${t} to be a positive integer, but got ${bA(n)}.`)}function bA(n){return n===null?"null":Array.isArray(n)?"["+n.map(t=>bA(t)).join(",")+"]":typeof n=="string"?`"${n}"`:`${n}`}function l5(n,t,e){let s=e!=null?e():ps(),r;return(...i)=>{const l=e!=null?e():ps();return l-s<t||(s=l,r=n(...i)),r}}function xA(n){return n==="relu"?"relu":n==="linear"?"linear":n==="elu"?"elu":null}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let u5=0;function vA(){return u5++}const op={};function sy(n=""){return n in op||(op[n]=0),op[n]+=1,n+op[n].toString()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const c5=["channelsFirst","channelsLast"],h5=["nearest","bilinear"],d5=["valid","same","causal"],f5=["max","avg"],p5=["sum","mul","concat","ave"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Hl=new Map;function un(n){Jo(c5,"DataFormat",n)}function m5(n){Jo(h5,"InterpolationFormat",n)}function er(n){Jo(d5,"PaddingMode",n)}function wA(n){Jo(f5,"PoolMode",n)}const ah=[],L2="/";function Io(n,t){ah.push(n);try{const e=t();return ah.pop(),e}catch(e){throw ah.pop(),e}}function g5(){return ah.length===0?"":ah.join(L2)+L2}function SA(n){if(!NA(n))throw new Error("Not a valid tensor name: '"+n+"'");return g5()+n}function CA(n){if(!NA(n))throw new Error("Not a valid tensor name: '"+n+"'");Hl.has(n)||Hl.set(n,0);const t=Hl.get(n);if(Hl.set(n,Hl.get(n)+1),t>0){const e=`${n}_${t}`;return Hl.set(e,1),e}else return n}const y5=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function NA(n){return!!n.match(y5)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function b5(n){return n===parseInt(n.toString(),10)}function $i(n,t,e){t==null&&(t=0),e==null&&(e=n.length);let s=1;for(let r=t;r<e;++r)s*=n[r];return s}function mu(n){if(n.length===0)return Number.NaN;let t=Number.POSITIVE_INFINITY;for(let e=0;e<n.length;e++){const s=n[e];s<t&&(t=s)}return t}function Ri(n){if(n.length===0)return Number.NaN;let t=Number.NEGATIVE_INFINITY;for(let e=0;e<n.length;e++){const s=n[e];s>t&&(t=s)}return t}function Br(n,t){if(t<n)throw new st(`end (${t}) < begin (${n}) is forbidden.`);const e=[];for(let s=n;s<t;++s)e.push(s);return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let Zb;function wn(){return Zb==null&&(Zb=sE().epsilon()),Zb}function Pr(){return"channelsLast"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function aa(n,t){return kt(n,t)}function Ad(n,t=-1){const e=n.shape.slice();return t<0&&(t=e.length+t+1),e.splice(t,0,1),J(n,e)}function x5(n,t){return at(()=>{if(n.shape.length!==2)throw new st(`repeat() expects a rank-2 tensor, but received a rank-${n.shape.length} tensor.`);const e=Ad(n,1);return Kx(e,[1,t,1])})}function v5(n){const t=[$i(n.shape)];return J(n,t)}function w5(n){if(n.rank<=1)throw new st(`batchFlatten requires a minimum rank of 2. Got rank: ${n.rank}.`);const t=[n.shape[0],$i(n.shape,1)];return J(n,t)}function Eo(n,t,e){return at(()=>{switch(n.rank){case 1:return Wg(n,t,e);case 2:return fw(n,[t,0],[e,n.shape[1]]);case 3:return Hg(n,[t,0,0],[e,n.shape[1],n.shape[2]]);case 4:return dh(n,[t,0,0,0],[e,n.shape[1],n.shape[2],n.shape[3]]);case 5:return Qt(n,[t,0,0,0,0],[e,n.shape[1],n.shape[2],n.shape[3],n.shape[4]]);case 6:return Qt(n,[t,0,0,0,0,0],[e,n.shape[1],n.shape[2],n.shape[3],n.shape[4],n.shape[5]]);default:throw new st(`sliceAlongFirstAxis() received an unsupported tensor rank: ${n.rank}`)}})}function Qb(n,t,e){return at(()=>{switch(n.rank){case 1:return Wg(n,t,e);case 2:return fw(n,[0,t],[n.shape[0],e]);case 3:return Hg(n,[0,0,t],[n.shape[0],n.shape[1],e]);case 4:return dh(n,[0,0,0,t],[n.shape[0],n.shape[1],n.shape[2],e]);default:throw new st(`sliceAlongLastAxis() received an unsupported tensor rank: ${n.rank}`)}})}function lp(n,t,e,s){return at(()=>{switch(n.rank){case 1:return Wg(n,t,e);case 2:switch(s){case 1:return Eo(n,t,e);case 2:return Qb(n,t,e);default:throw new st(`The axis is not within the rank of the tensor ${s}`)}case 3:switch(s){case 1:return Eo(n,t,e);case 2:return Hg(n,[0,t,0],[n.shape[0],e,n.shape[2]]);case 3:return Qb(n,t,e);default:throw new st(`The axis is not within the rank of the tensor ${s}`)}case 4:switch(s){case 1:return Eo(n,t,e);case 2:return dh(n,[0,t,0,0],[n.shape[0],e,n.shape[2],n.shape[3]]);case 3:return dh(n,[0,0,t,0],[n.shape[0],n.shape[1],e,n.shape[3]]);case 4:return Qb(n,t,e);default:throw new st(`The axis is not within the rank of the tensor ${s}`)}default:throw new st(`sliceAlongLastAxis() received an unsupported tensor rank: ${n.rank}`)}})}function sS(n,t=-1){let e;return t<0&&(e=n[0].rank,e!==0?t=e:t=0),t===n[0].rank&&(t=-1),pn(n,t)}function z2(n,t){switch(n.rank){case 1:return OE([n,t]);case 2:return Hv([n,t],0);case 3:return _E([n,t],0);case 4:return FE([n,t],0);default:throw new st(`concatAlongFirstAxis() received an unsupported tensor rank: ${n.rank}`)}}function Kx(n,t){if(Array.isArray(t)||(t=[t]),n.rank!==t.length)throw new st(`The length of input n (${t.length}) does not match the number of dimensions in input x (${n.rank})`);return gr(n,t)}function ry(n,t=0,e=1,s,r){return aw(n,t,e,s,r)}function ia(n,t,e,s){if(n.rank<2||t.rank<2)throw new Jt(`dot requires both inputs to be rank >= 2 but got x shape = ${n.shape} and y shape = ${t.shape}`);if(t.rank>=3){const r=n.shape.slice(-1)[0],a=t.shape.slice(-2)[0];if(r!==a)throw new Jt(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${n.shape} and  y shape = ${t.shape}`)}if(n.rank===2&&t.rank===2)return Wx({a:n,b:t,transposeA:!1,transposeB:!1,bias:s?Yx(n.rank,s,Pr()):null,activation:e});{const r=n.shape.slice(),a=r.pop();n=J(n,[-1,a]);const i=t.shape.slice(),l=i.pop(),u=i.pop(),h=[...i,l],d=Array.from({length:t.rank},(b,x)=>x===0?t.rank-2:x<=t.rank-2?x-1:x);t=J(fe(t,d),[u,-1]);const p=[...r,...h];return J(Wx({a:n,b:t,transposeA:!1,transposeB:!1,bias:s?Yx(n.rank,s,Pr()):null,activation:e}),p)}}function TA(n,t,e){return at(()=>(Array.isArray(t)?t=Un(t,"int32"):t=kt(t,"int32"),$d(n,t,e)))}function Rd(n){return X(n,n)}function Yx(n,t,e){const s=t.shape;if(t.rank!==1&&t.rank!==n)throw new st(`Unexpected bias dimensions: ${t.rank}; expected it to be 1 or ${n}`);if(n===5){if(e==="channelsFirst")return s.length===1?J(t,[1,s[0],1,1,1]):J(t,[1,s[3],s[0],s[1],s[2]]);if(e==="channelsLast")return s.length===1?J(t,[1,1,1,1,s[0]]):J(t,[1].concat(s))}else if(n===4){if(e==="channelsFirst")return s.length===1?J(t,[1,s[0],1,1]):J(t,[1,s[2],s[0],s[1]]);if(e==="channelsLast")return s.length===1?J(t,[1,1,1,s[0]]):J(t,[1].concat(s))}else if(n===3){if(e==="channelsFirst")return s.length===1?J(t,[1,s[0],1]):J(t,[1,s[1],s[0]]);if(e==="channelsLast")return s.length===1?J(t,[1,1,s[0]]):J(t,[1].concat(s))}else if(n<3)return t;throw new st(`Unsupported input rank by biasAdd: ${t.rank}`)}function Gr(n,t,e){return at(()=>(e==null&&(e=Pr()),un(e),St(n,Yx(n.rank,t,e))))}function S5(n,t=1){if(t!==1)throw new Jt(`Support for alpha values other than 1 (${t}) is not implemented yet.`);return Cd(n)}function C5(n){return at(()=>_t(n,St(bn(n),1)))}function $A(n,t,e,s){return at(()=>pD(n,t,e,s))}function N5(n){return at(()=>{const t=St(.5,X(.2,n));return _s(t,0,1)})}function Od(n,t,e=!1){return e?n():t()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const T5=["fanIn","fanOut","fanAvg"],$5=["normal","uniform","truncatedNormal"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function k5(n){Jo(T5,"FanMode",n)}function I5(n){Jo($5,"Distribution",n)}class $r extends Lu{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class kA extends $r{apply(t,e){return vn(t,e)}}kA.className="Zeros";Tt(kA);class rS extends $r{apply(t,e){return Is(t,e)}}rS.className="Ones";Tt(rS);class IA extends $r{constructor(t){if(super(),typeof t!="object")throw new st(`Expected argument of type ConstantConfig but got ${t}`);if(t.value===void 0)throw new st(`config must have value set but got ${t}`);this.value=t.value}apply(t,e){return at(()=>X(Vt(this.value),Is(t,e)))}getConfig(){return{value:this.value}}}IA.className="Constant";Tt(IA);class EA extends $r{constructor(t){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=t.minval||this.DEFAULT_MINVAL,this.maxval=t.maxval||this.DEFAULT_MAXVAL,this.seed=t.seed}apply(t,e){return Zo(t,this.minval,this.maxval,e,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}EA.className="RandomUniform";Tt(EA);class DA extends $r{constructor(t){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=t.mean||this.DEFAULT_MEAN,this.stddev=t.stddev||this.DEFAULT_STDDEV,this.seed=t.seed}apply(t,e){if(e=e||"float32",e!=="float32"&&e!=="int32")throw new Jt(`randomNormal does not support dType ${e}.`);return ry(t,this.mean,this.stddev,e,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}DA.className="RandomNormal";Tt(DA);class AA extends $r{constructor(t){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=t.mean||this.DEFAULT_MEAN,this.stddev=t.stddev||this.DEFAULT_STDDEV,this.seed=t.seed}apply(t,e){if(e=e||"float32",e!=="float32"&&e!=="int32")throw new Jt(`truncatedNormal does not support dType ${e}.`);return yw(t,this.mean,this.stddev,e,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}AA.className="TruncatedNormal";Tt(AA);class RA extends $r{constructor(t){super(),this.gain=t.gain!=null?t.gain:1}apply(t,e){return at(()=>{if(t.length!==2||t[0]!==t[1])throw new st("Identity matrix initializer can only be used for 2D square matrices.");return X(this.gain,Jv(t[0]))})}getConfig(){return{gain:this.gain}}}RA.className="Identity";Tt(RA);function E5(n,t="channelsLast"){let e,s;if(un(t),n.length===2)e=n[0],s=n[1];else if([3,4,5].indexOf(n.length)!==-1){if(t==="channelsFirst"){const r=$i(n,2);e=n[1]*r,s=n[0]*r}else if(t==="channelsLast"){const r=$i(n,0,n.length-2);e=n[n.length-2]*r,s=n[n.length-1]*r}}else{const r=$i(n);e=Math.sqrt(r),s=Math.sqrt(r)}return[e,s]}class zs extends $r{constructor(t){if(super(),t.scale<0)throw new st(`scale must be a positive float. Got: ${t.scale}`);this.scale=t.scale==null?1:t.scale,this.mode=t.mode==null?"fanIn":t.mode,k5(this.mode),this.distribution=t.distribution==null?"normal":t.distribution,I5(this.distribution),this.seed=t.seed}apply(t,e){const s=E5(t),r=s[0],a=s[1];let i=this.scale;if(this.mode==="fanIn"?i/=Math.max(1,r):this.mode==="fanOut"?i/=Math.max(1,a):i/=Math.max(1,(r+a)/2),this.distribution==="normal"){const l=Math.sqrt(i);if(e=e||"float32",e!=="float32"&&e!=="int32")throw new Jt(`${this.getClassName()} does not support dType ${e}.`);return yw(t,0,l,e,this.seed)}else{const l=Math.sqrt(3*i);return Zo(t,-l,l,e,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}zs.className="VarianceScaling";Tt(zs);class aS extends zs{constructor(t){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:t==null?null:t.seed})}getClassName(){return zs.className}}aS.className="GlorotUniform";Tt(aS);class iS extends zs{constructor(t){super({scale:1,mode:"fanAvg",distribution:"normal",seed:t==null?null:t.seed})}getClassName(){return zs.className}}iS.className="GlorotNormal";Tt(iS);class oS extends zs{constructor(t){super({scale:2,mode:"fanIn",distribution:"normal",seed:t==null?null:t.seed})}getClassName(){return zs.className}}oS.className="HeNormal";Tt(oS);class lS extends zs{constructor(t){super({scale:2,mode:"fanIn",distribution:"uniform",seed:t==null?null:t.seed})}getClassName(){return zs.className}}lS.className="HeUniform";Tt(lS);class uS extends zs{constructor(t){super({scale:1,mode:"fanIn",distribution:"normal",seed:t==null?null:t.seed})}getClassName(){return zs.className}}uS.className="LeCunNormal";Tt(uS);class cS extends zs{constructor(t){super({scale:1,mode:"fanIn",distribution:"uniform",seed:t==null?null:t.seed})}getClassName(){return zs.className}}cS.className="LeCunUniform";Tt(cS);class OA extends $r{constructor(t){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=t.gain==null?this.DEFAULT_GAIN:t.gain,this.seed=t.seed}apply(t,e){return at(()=>{if(t.length<2)throw new Jt("Shape must be at least 2D.");if(e!=="int32"&&e!=="float32"&&e!==void 0)throw new TypeError(`Unsupported data type ${e}.`);e=e;const s=mt(t.slice(0,-1)),r=t[t.length-1],a=s*r;a>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${a}) elements: Slowness may result.`);const i=[Math.max(r,s),Math.min(r,s)],l=ry(i,0,1,e,this.seed),u=CD.qr(l,!1);let h=u[0];const p=u[1].flatten().stridedSlice([0],[Math.min(r,s)*Math.min(r,s)],[Math.min(r,s)+1]);return h=X(h,p.sign()),s<r&&(h=h.transpose()),X(Vt(this.gain),h.reshape(t))})}getConfig(){return{gain:this.gain,seed:this.seed}}}OA.className="Orthogonal";Tt(OA);const M2={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function B2(n,t={}){return Dd(n,mr.getMap().classNameMap,t,"initializer")}function je(n){return eS(n)}function Ue(n){if(typeof n=="string"){const t=n in M2?M2[n]:n;if(t==="GlorotNormal")return new iS;if(t==="GlorotUniform")return new aS;if(t==="HeNormal")return new oS;if(t==="HeUniform")return new lS;if(t==="LeCunNormal")return new uS;if(t==="LeCunUniform")return new cS;{const e={};return e.className=t,e.config={},B2(e)}}else return n instanceof $r?n:B2(n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Zx(n){return Array.isArray(n)&&Array.isArray(n[0])}function Zp(n){return n.length===0?[]:Array.isArray(n[0])?n:[n]}function Wt(n){let t;if(Array.isArray(n)){if(n.length!==1)throw new st(`Expected Tensor length to be 1; got ${n.length}`);t=n[0]}else t=n;return t}function ye(n){if(Array.isArray(n)&&Array.isArray(n[0])){if(n.length===1)return n=n,n[0];throw new st(`Expected exactly 1 Shape; got ${n.length}`)}else return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Qp(n){let t=0;for(const e of n)e.shape.length===0?t+=1:t+=e.shape.reduce((s,r)=>s*r);return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const P2="Variable";class D5{constructor(t,e="float32",s=P2,r=!0,a=null){this.dtype=e??"float32",this.shape=t.shape,this.id=vA(),s=s??P2,this.originalName=SA(s),this.name=CA(this.originalName),this.trainable_=r,this.constraint=a,this.val=dD(t,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(t){return this.assertNotDisposed(),A5(this.val,t),this.val.id!==t.id&&(this.val.assign(t),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(t){this.trainable_=t,this.val.trainable=t}}function A5(n,t){if(n.shape.toString()!==t.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(n.shape)+" vs. "+JSON.stringify(t.shape))}function Qx(n){return n.map(t=>t.read())}function hS(n){n.forEach(t=>{t[0].write(t[1])})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Sn{constructor(t){this.dtype=t.dtype,this.shape=t.shape,t.shape!=null?this.ndim=t.shape.length:this.ndim=t.ndim,this.maxNDim=t.maxNDim,this.minNDim=t.minNDim,this.axes=t.axes||{}}}class la{constructor(t,e,s,r,a,i,l){this.dtype=t,this.shape=e,this.sourceLayer=s,this.inputs=r,this.callArgs=a,this.outputTensorIndex=l,this.id=vA(),i!=null&&(this.originalName=SA(i),this.name=CA(this.originalName)),this.rank=e.length}}let R5=0;class ay{constructor(t,e){this.callArgs=e,this.id=R5++,this.outboundLayer=t.outboundLayer,this.inboundLayers=t.inboundLayers,this.nodeIndices=t.nodeIndices,this.tensorIndices=t.tensorIndices,this.inputTensors=t.inputTensors,this.outputTensors=t.outputTensors,this.inputMasks=t.inputMasks,this.outputMasks=t.outputMasks,this.inputShapes=t.inputShapes,this.outputShapes=t.outputShapes;for(const s of t.inboundLayers)s!=null&&s.outboundNodes.push(this);t.outboundLayer.inboundNodes.push(this)}getConfig(){const t=[];for(const e of this.inboundLayers)e!=null?t.push(e.name):t.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:t,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let O5=0;class ae extends Lu{constructor(t={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=O5++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let e=t.name;if(!e){const s=this.getClassName();e=Da(s)+"_"+sy(s)}if(this.name=e,this.trainable_=t.trainable==null?!0:t.trainable,t.inputShape!=null||t.batchInputShape!=null){let s;if(t.batchInputShape!=null)s=t.batchInputShape;else if(t.inputShape!=null){let a=null;t.batchSize!=null&&(a=t.batchSize),s=[a].concat(t.inputShape)}this.batchInputShape=s;let r=t.dtype;r==null&&(r=t.inputDType),r==null&&(r="float32"),this.dtype=r}t.weights!=null?this.initialWeights=t.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(t,e){return t.name+"_ib-"+e.toString()}getNodeAtIndex(t,e){if(this.inboundNodes.length===0)throw new yr(`The layer has never been called and thus has no defined ${e}.`);if(this.inboundNodes.length<=t)throw new st(`Asked to get ${e} at node ${t}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[t]}getInputAt(t){return ms(this.getNodeAtIndex(t,"input").inputTensors)}getOutputAt(t){return ms(this.getNodeAtIndex(t,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new Qr(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new Qr(`Layer ${this.name} is not connected, no input to return.`);return ms(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new Qr(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new Qr(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return ms(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(t=>t())}get updates(){return this._updates}get built(){return this._built}set built(t){this._built=t}get trainable(){return this.trainable_}set trainable(t){this._trainableWeights.forEach(e=>e.trainable=t),this.trainable_=t}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(t=>t.trainable):[]}set trainableWeights(t){this._trainableWeights=t}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(t=>!t.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(t){this._nonTrainableWeights=t}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(t){const e=Se(t);if(this.inputSpec==null||this.inputSpec.length===0)return;const s=Se(this.inputSpec);if(e.length!==s.length)throw new st(`Layer ${this.name} expects ${s.length} inputs, but it received ${e.length} input tensors. Input received: ${t}`);for(let r=0;r<e.length;r++){const a=e[r],i=s[r];if(i==null)continue;const l=a.rank;if(i.ndim!=null&&l!==i.ndim)throw new st(`Input ${r} is incompatible with layer ${this.name}: expected ndim=${i.ndim}, found ndim=${l}`);if(i.maxNDim!=null&&l>i.maxNDim)throw new st(`Input ${r} is incompatible with layer ${this.name}: expected max_ndim=${i.maxNDim}, found ndim=${l}`);if(i.minNDim!=null&&l<i.minNDim)throw new st(`Input ${r} is incompatible with layer ${this.name}: expected min_ndim=${i.minNDim}, found ndim=${l}.`);if(i.dtype!=null&&a.dtype!==i.dtype)throw new st(`Input ${r} is incompatible with layer ${this.name} : expected dtype=${i.dtype}, found dtype=${a.dtype}.`);if(i.axes){const u=a.shape;for(const h in i.axes){const d=Number(h),p=i.axes[h],m=d>=0?u[d]:u[u.length+d];if(p!=null&&[p,null].indexOf(m)===-1)throw new st(`Input ${r} is incompatible with layer ${this.name}: expected axis ${d} of input shape to have value ${p} but got shape ${u}.`)}}if(i.shape!=null)for(let u=0;u<i.shape.length;++u){const h=i.shape[u],d=a.shape[u];if(h!=null&&d!=null&&h!==d)throw new st(`Input ${r} is incompatible with layer ${this.name}: expected shape=${i.shape}, found shape=${a.shape}.`)}}}call(t,e){return t}invokeCallHook(t,e){this._callHook!=null&&this._callHook(t,e)}setCallHook(t){this._callHook=t}clearCallHook(){this._callHook=null}apply(t,e){e=e||{},this.assertNotDisposed();const s=Se(t),r=L5(t),a=z5(t);if(r===a)throw new st("Arguments to apply() must be all SymbolicTensors or all Tensors");return Io(this.name,()=>{if(!this.built){this.assertInputCompatibility(t);const i=[];for(const l of Se(t))i.push(l.shape);this.build(ms(i)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&a&&(this._refCount=1)}if(this.assertInputCompatibility(t),a){let i=this.call(t,e);this.supportsMasking&&this.setMaskMetadata(t,i);const l=Se(i),u=[];for(let h of l)s.indexOf(h)!==-1&&(h=h.clone()),u.push(h);if(i=ms(u),this.activityRegularizer!=null)throw new Jt("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return i}else{const i=_5(t),l=this.computeOutputShape(i);let u;const h=F5(t);if(this.warnOnIncompatibleInputShape(Array.isArray(t)?i[0]:i),l!=null&&l.length>0&&Array.isArray(l[0])?u=l.map((d,p)=>new la(h,d,this,Se(t),e,this.name,p)):u=new la(h,l,this,Se(t),e,this.name),this.addInboundNode(t,u,null,null,i,l,e),this._refCount++,this.activityRegularizer!=null)throw new Jt("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return u}})}warnOnIncompatibleInputShape(t){if(this.batchInputShape!=null)if(t.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(t)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let e=!1;this.batchInputShape.forEach((s,r)=>{s!=null&&t[r]!=null&&t[r]!==s&&(e=!0)}),e&&console.warn(`The shape of the input tensor (${JSON.stringify(t)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new Qr(`The layer ${this.name} has never been called and thus has no defined output shape.`);const t=[];for(const e of this.inboundNodes){const s=JSON.stringify(e.outputShapes);t.indexOf(s)===-1&&t.push(s)}if(t.length===1){const e=this.inboundNodes[0].outputShapes;return Array.isArray(e)&&Array.isArray(e[0])&&e.length===1?e[0]:e}else throw new Qr(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new yr(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return Qp(this.weights)}build(t){this.built=!0}getWeights(t=!1){return Qx(t?this.trainableWeights:this.weights)}setWeights(t){at(()=>{const e=this.weights;if(e.length!==t.length)throw new st(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${t.length}, but the layer was expecting ${e.length} weights. Provided weights: ${t}...`);if(e.length===0)return;const s=[],r=Qx(e);for(let a=0;a<r.length;++a){const i=r[a],l=e[a],u=t[a];if(!de(i.shape,u.shape))throw new st(`Layer weight shape ${i.shape} not compatible with provided weight shape ${u.shape}`);s.push([l,u])}hS(s)})}addWeight(t,e,s,r,a,i,l,u){if(this._addedWeightNames.indexOf(t)!==-1)throw new st(`Duplicate weight name ${t} for layer ${this.name}`);this._addedWeightNames.push(t),s==null&&(s="float32"),this.fastWeightInitDuringBuild&&(r=u!=null?u():Ue("zeros"));const h=r.apply(e,s),d=new D5(h,s,t,i,l);return h.dispose(),a!=null&&this.addLoss(()=>a.apply(d.read())),i==null&&(i=!0),i?this._trainableWeights.push(d):this._nonTrainableWeights.push(d),d}setFastWeightInitDuringBuild(t){this.fastWeightInitDuringBuild=t}addLoss(t){t==null||Array.isArray(t)&&t.length===0||(t=Se(t),this._losses!==void 0&&this._losses!==null&&this.losses.push(...t))}computeOutputShape(t){return t}computeMask(t,e){if(!this.supportsMasking){if(e!=null)if(Array.isArray(e))e.forEach(s=>{if(s!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return e}setMaskMetadata(t,e,s){if(!this.supportsMasking)return;const r=this.computeMask(t,s),a=Se(e),i=Se(r);if(a.length!==i.length)throw new Error(`${this.name} outputs ${a.length} tensors but ${a.length} masks for those tensors`);for(let l=0;l<a.length;l++)a[l].kerasMask=i[l]}addInboundNode(t,e,s,r,a,i,l=null){const u=Se(t);e=Se(e),s=Se(s),r=Se(r),a=Zp(a),i=Zp(i);const h=[],d=[],p=[];for(const m of u)h.push(m.sourceLayer),d.push(m.nodeIndex),p.push(m.tensorIndex);new ay({outboundLayer:this,inboundLayers:h,nodeIndices:d,tensorIndices:p,inputTensors:u,outputTensors:e,inputMasks:s,outputMasks:r,inputShapes:a,outputShapes:i},l);for(let m=0;m<e.length;m++)e[m].sourceLayer=this,e[m].nodeIndex=this.inboundNodes.length-1,e[m].tensorIndex=m}getConfig(){const t={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(t.batchInputShape=this.batchInputShape),this.dtype!=null&&(t.dtype=this.dtype),t}disposeWeights(){return this.weights.forEach(t=>t.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let t=0;return--this._refCount===0&&(t=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:t}}}function _5(n){n=Se(n);const t=[];for(const e of n)t.push(e.shape);return ms(t)}function F5(n){return"float32"}function _A(n,t,e){if((t==null||e!=null&&e>0)&&(t=n.sourceLayer,e=n.nodeIndex),t.inboundNodes.length===0)return[n];{const s=t.inboundNodes[e];if(s.inboundLayers.length===0)return s.inputTensors;{const r=[];for(let a=0;a<s.inboundLayers.length;a++){const i=s.inputTensors[a],l=s.inboundLayers[a],u=s.nodeIndices[a],h=_A(i,l,u);for(const d of h)r.indexOf(d)===-1&&r.push(d)}return r}}}function L5(n){let t=!0;for(const e of Se(n))if(!(e instanceof la)){t=!1;break}return t}function z5(n){let t=!0;for(const e of Se(n))if(e instanceof la){t=!1;break}return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class _d extends ae{constructor(t){if(super({dtype:t.dtype,name:t.name!=null?t.name:sy("input").toString()}),t.batchSize==null&&(t.batchSize=null),t.sparse==null&&(t.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=t.sparse,t.inputShape!=null&&t.batchInputShape!=null)throw new st("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let e=t.batchInputShape;if(e==null){if(t.inputShape==null)throw new st("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");e=[t.batchSize].concat(t.inputShape)}else if(t.batchSize!=null)throw new st("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const s=t.dtype||"float32";this.batchInputShape=e,this.dtype=s,this.inputSpec=[{shape:e}];const r=new la(this.dtype,this.batchInputShape,this,[],{},this.name);r.nodeIndex=0,r.tensorIndex=0,new ay({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[r],outputTensors:[r],inputMasks:[null],outputMasks:[null],inputShapes:[e],outputShapes:[e]})}apply(t,e){throw new st(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}_d.className="InputLayer";Tt(_d);function M5(n){if(n.batchShape==null&&n.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(n.batchShape!=null&&n.shape!=null)throw new st("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let t=n.batchShape;n.shape!=null&&t==null&&(t=[null].concat(n.shape));let e=n.dtype;return e==null&&(e="float32"),new _d({batchInputShape:t,name:n.name,dtype:e,sparse:n.sparse}).inboundNodes[0].outputTensors[0]}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function B5(n,t){if(n.dtype==null||n.dtype===t.dtype)return t;try{return kt(t,n.dtype)}catch{throw new st(`The dtype of the feed (${t.dtype}) can not be cast to the dtype of the key '${n.name}' (${n.dtype}).`)}}class wi{constructor(t){if(this.id2Value={},this.id2Mask={},this.name2Id={},t instanceof wi)for(const e in t.id2Value)this.id2Value[e]=t.id2Value[e],e in t.id2Mask&&(this.id2Mask[e]=t.id2Mask[e]);else{if(t==null)return;for(const e of t)this.add(e.key,e.value)}}add(t,e,s){if(this.id2Value[t.id]==null)this.id2Value[t.id]=B5(t,e),this.name2Id[t.name]=t.id,s!=null&&(this.id2Mask[t.id]=s);else throw new st(`Duplicate key: name=${t.name}, id=${t.id}`);return this}addFeed(t){this.add(t.key,t.value)}hasKey(t){return this.id2Value[t.id]!=null}names(){return Object.keys(this.name2Id)}getValue(t){if(t instanceof la){if(this.id2Value[t.id]==null)throw new st(`Nonexistent key: ${t.name}`);return this.id2Value[t.id]}else{const e=this.name2Id[t];if(e==null)throw new st(`Feed dict has no SymbolicTensor name: ${t}`);return this.id2Value[e]}}getMask(t){if(t instanceof la){if(this.id2Value[t.id]==null)throw new st(`Nonexistent key: ${t.name}`);return this.id2Mask[t.id]}else{const e=this.name2Id[t];if(e==null)throw new st(`Feed dict has no SymbolicTensor name: ${t}`);return this.id2Mask[e]}}disposeMasks(){this.id2Mask!=null&&se(this.id2Mask)}}const Jp=new yA,tm=new yA;function P5(n){Jp!=null&&Jp.setMaxEntries(n),tm!=null&&tm.setMaxEntries(n)}function th(n,t,e,s){const r=e==null?!1:e.training,a=Array.isArray(n),i=a?n:[n],l=i.map(b=>b.name),u=[],h=t.names();for(const b of l)h.indexOf(b)!==-1?u.push(t.getValue(b)):u.push(null);const d=l.join(",")+"|"+t.names().sort().join(",");let p=Jp.get(d),m;if(p==null){const b=V5(i,t);p=b.sorted,m=b.recipientCounts,Jp.put(d,p),tm.put(d,m)}m={},r||Object.assign(m,tm.get(d));const y=new wi(t);for(let b=0;b<p.length;++b){const x=p[b],v=x.sourceLayer;if(v instanceof _d)continue;const S=[],C=[],$=[];let T=!1;for(const _ of x.inputs){const M=y.getValue(_),D=y.getMask(_);S.push(M),C.push(D),D!=null&&(T=!0),r||(m[_.name]--,m[_.name]===0&&!t.hasKey(_)&&l.indexOf(_.name)===-1&&!M.isDisposed&&_.sourceLayer.stateful!==!0&&$.push(M))}T&&(e=e||{},e.mask=C[0]);const I=Se(v.apply(S,e));let A=null;v.supportsMasking&&(A=v.computeMask(S,C));const R=G5(x),L=Array.isArray(R)?R:[R];for(let _=0;_<L.length;++_){y.hasKey(L[_])||y.add(L[_],I[_],Array.isArray(A)?A[0]:A);const M=l.indexOf(L[_].name);M!==-1&&(u[M]=I[_])}r||se($)}return y.disposeMasks(),a?u:u[0]}function V5(n,t){F(n!=null&&n.length>0,()=>"Expected at least one fetch, got none");let e=[],s={};if(n.length===1){const r=V2(n[0],t);e=r.sorted,s=r.recipientMap}else{const r=new Set;for(const a of n){const{sorted:i,recipientMap:l}=V2(a,t);for(const u of i)r.has(u.name)||(e.push(u),r.add(u.name));for(const u in l)s[u]==null&&(s[u]=new Set),l[u].forEach(h=>s[u].add(h))}}return{sorted:e,recipientCounts:U5(s)}}function U5(n){const t={};for(const e in n)t[e]=n[e].size;return t}function V2(n,t){const e=new Set,s=[],r={};for(const l of t.names())e.add(l);const a=[],i=[];for(a.push(n);a.length>0;){const l=a[a.length-1];if(e.has(l.name)){a.pop();continue}const u=i[i.length-1]===a.length-1;if(l.inputs.length===0||u)a.pop(),s.push(l),e.add(l.name),u&&i.pop();else{i.push(a.length-1);for(const h of l.inputs)r[h.name]==null&&(r[h.name]=new Set),r[h.name].add(l.name),!e.has(h.name)&&a.push(h)}}return{sorted:s,recipientMap:r}}function G5(n){let t;if(n.sourceLayer.inboundNodes.length===1)t=n.sourceLayer.output;else{let e=null;for(let s=0;s<n.sourceLayer.inboundNodes.length;++s)for(const r of n.sourceLayer.inboundNodes[s].outputTensors)if(r.id===n.id){e=s;break}t=n.sourceLayer.getOutputAt(e)}return t}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const W5=ut();W5.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,P5);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function dS(n,t){return at(()=>Wn(Ft(X(n,n),t,!0)))}class Fd extends Lu{getConfig(){return{}}}class FA extends Fd{constructor(t){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=t.maxValue!=null?t.maxValue:this.defaultMaxValue,this.axis=t.axis!=null?t.axis:this.defaultAxis}apply(t){return at(()=>{const e=dS(t,this.axis),s=_s(e,0,this.maxValue);return X(t,_t(s,St(wn(),e)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}FA.className="MaxNorm";Tt(FA);class LA extends Fd{constructor(t){super(),this.defaultAxis=0,this.axis=t.axis!=null?t.axis:this.defaultAxis}apply(t){return at(()=>_t(t,St(wn(),dS(t,this.axis))))}getConfig(){return{axis:this.axis}}}LA.className="UnitNorm";Tt(LA);class zA extends Fd{apply(t){return ca(t)}}zA.className="NonNeg";Tt(zA);class MA extends Fd{constructor(t){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=t.minValue!=null?t.minValue:this.defaultMinValue,this.maxValue=t.maxValue!=null?t.maxValue:this.defaultMaxValue,this.rate=t.rate!=null?t.rate:this.defaultRate,this.axis=t.axis!=null?t.axis:this.defaultAxis}apply(t){return at(()=>{const e=dS(t,this.axis),s=St(X(this.rate,_s(e,this.minValue,this.maxValue)),X(1-this.rate,e));return X(t,_t(s,St(wn(),e)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}MA.className="MinMaxNorm";Tt(MA);const U2={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function Nn(n){return eS(n)}function G2(n,t={}){return Dd(n,mr.getMap().classNameMap,t,"constraint")}function Tn(n){if(n==null)return null;if(typeof n=="string"){const e={className:n in U2?U2[n]:n,config:{}};return G2(e)}else return n instanceof Fd?n:G2(n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function go(n){if(n==null)return;const t=[],e=[],s=[];for(const r in n){const a=n[r];if(typeof a!="number"){const i=a;t.push(i.data()),e.push(r),s.push(i)}}if(t.length>0){const r=await Promise.all(t);for(let a=0;a<r.length;++a)n[e[a]]=r[a][0];se(s)}}function BA(n){if(n!=null)for(const t in n){const e=n[t];typeof e!="number"&&e.dispose()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var W2;(function(n){n[n.SILENT=0]="SILENT",n[n.VERBOSE=1]="VERBOSE"})(W2||(W2={}));const H5=125;class ph{constructor(){this.validationData=null}setParams(t){this.params=t}async onEpochBegin(t,e){}async onEpochEnd(t,e){}async onBatchBegin(t,e){}async onBatchEnd(t,e){}async onTrainBegin(t){}async onTrainEnd(t){}setModel(t){}}class j5{constructor(t,e=10){t==null&&(t=[]),this.callbacks=t,this.queueLength=e}append(t){this.callbacks.push(t)}setParams(t){for(const e of this.callbacks)e.setParams(t)}setModel(t){for(const e of this.callbacks)e.setModel(t)}async onEpochBegin(t,e){e==null&&(e={});for(const s of this.callbacks)await s.onEpochBegin(t,e)}async onEpochEnd(t,e){e==null&&(e={});for(const s of this.callbacks)await s.onEpochEnd(t,e)}async onBatchBegin(t,e){e==null&&(e={});for(const s of this.callbacks)await s.onBatchBegin(t,e)}async onBatchEnd(t,e){e==null&&(e={});for(const s of this.callbacks)await s.onBatchEnd(t,e)}async onTrainBegin(t){t==null&&(t={});for(const e of this.callbacks)await e.onTrainBegin(t)}async onTrainEnd(t){t==null&&(t={});for(const e of this.callbacks)await e.onTrainEnd(t)}}class q5 extends ph{constructor(){super()}async onEpochBegin(t){this.seen=0,this.totals={}}async onBatchEnd(t,e){e==null&&(e={});const s=e.size==null?0:e.size;this.seen+=s;for(const r in e){const a=e[r];if(typeof a=="number")this.totals.hasOwnProperty(r)||(this.totals[r]=0),this.totals[r]=this.totals[r]+a*s;else{let i;r in this.totals?i=this.totals[r]:this.totals[r]=0;const l=at(()=>St(this.totals[r],X(a,s)));this.totals[r]=l,i!=null&&i.dispose()}}}async onEpochEnd(t,e){if(e!=null)for(const s of this.params.metrics)this.totals[s]!=null&&(typeof this.totals[s]=="number"?e[s]=this.totals[s]/this.seen:at(()=>{const r=X(_t(1,this.seen),this.totals[s]);e[s]=r,this.totals[s].dispose(),An(e[s])}))}}class X5 extends ph{async onTrainBegin(t){this.epoch=[],this.history={}}async onEpochEnd(t,e){e==null&&(e={}),this.epoch.push(t);for(const s in e)this.history[s]==null&&(this.history[s]=[]),this.history[s].push(e[s])}async syncData(){const t=[],e=[],s=[];for(const a in this.history){const i=this.history[a];for(let l=0;l<i.length;++l)if(typeof i[l]!="number"){const u=i[l];t.push(u.data()),e.push(a),s.push(l)}}const r=await Promise.all(t);for(let a=0;a<r.length;++a)this.history[e[a]][s[a]].dispose(),this.history[e[a]][s[a]]=r[a][0]}}class K5 extends ph{constructor(t,e){if(super(),this.currentEpoch=0,this.nowFunc=t.nowFunc,this.nextFrameFunc=t.nextFrameFunc||WD,this.yieldEvery=e||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=H5),this.yieldEvery==="never"&&t.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");Nx(this.yieldEvery)&&(this.maybeWait=l5(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=t.onTrainBegin,this.trainEnd=t.onTrainEnd,this.epochBegin=t.onEpochBegin,this.epochEnd=t.onEpochEnd,this.batchBegin=t.onBatchBegin,this.batchEnd=t.onBatchEnd,this.yield=t.onYield}async maybeWait(t,e,s){const r=[];this.yield!=null&&(await go(s),r.push(this.yield(t,e,s))),r.push(this.nextFrameFunc()),await Promise.all(r)}async onEpochBegin(t,e){this.currentEpoch=t,this.epochBegin!=null&&(await go(e),await this.epochBegin(t,e))}async onEpochEnd(t,e){const s=[];this.epochEnd!=null&&(await go(e),s.push(this.epochEnd(t,e))),this.yieldEvery==="epoch"&&s.push(this.nextFrameFunc()),await Promise.all(s)}async onBatchBegin(t,e){this.batchBegin!=null&&(await go(e),await this.batchBegin(t,e))}async onBatchEnd(t,e){const s=[];this.batchEnd!=null&&(await go(e),s.push(this.batchEnd(t,e))),this.yieldEvery==="batch"?s.push(this.nextFrameFunc()):Nx(this.yieldEvery)&&s.push(this.maybeWait(this.currentEpoch,t,e)),await Promise.all(s)}async onTrainBegin(t){this.trainBegin!=null&&(await go(t),await this.trainBegin(t))}async onTrainEnd(t){this.trainEnd!=null&&(await go(t),await this.trainEnd(t))}}function PA(n,t){return n==null&&(n={}),n instanceof ph?[n]:Array.isArray(n)&&n[0]instanceof ph?n:Se(n).map(s=>new K5(s,t))}class fr{constructor(){}static registerCallbackConstructor(t,e){F(t>=0&&Number.isInteger(t),()=>`Verbosity level is expected to be an integer >= 0, but got ${t}`),fr.checkForDuplicate(e),fr.constructors[t]==null&&(fr.constructors[t]=[]),fr.constructors[t].push(e)}static checkForDuplicate(t){for(const e in fr.constructors)fr.constructors[+e].forEach(r=>{if(r===t)throw new st("Duplicate callback constructor.")})}static clear(){fr.constructors={}}static createCallbacks(t){const e=[];for(const s in fr.constructors){const r=+s;t>=r&&e.push(...fr.constructors[r])}return e.map(s=>new s)}}fr.constructors={};function VA(n,t,e,s,r,a,i,l,u){const h=new X5,d=[new q5,...fr.createCallbacks(t)];n!=null&&d.push(...n),d.push(h);const p=new j5(d);return p.setParams({epochs:e,initialEpoch:s,samples:r,steps:a,batchSize:i,verbose:t,doValidation:l,metrics:u}),{callbackList:p,history:h}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Fa(n,t={},e=!1){return Dd(n,mr.getMap().classNameMap,t,"layer",e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function em(n,t){return at(()=>{n.dtype!=="float32"&&(n=kt(n,"float32"));const e=Ft(Rd(n),t,!0),s=Ru(e.shape,wn()),r=Wn(Wa(e,s));return _t(n,r)})}function iy(n,t){return at(()=>Ze(Rd(Rt(t,n)),-1))}function fS(n,t){return at(()=>Ze(bn(Rt(t,n)),-1))}function pS(n,t){return at(()=>{const e=Rt(n,t),s=_s(bn(n),wn(),Number.MAX_VALUE),r=bn(_t(e,s));return X(100,Ze(r,-1))})}function Y5(n,t){return at(()=>{const e=_s(t,wn(),Number.MAX_VALUE),s=Qs(St(1,e)),r=_s(n,wn(),Number.MAX_VALUE),a=Qs(St(1,r));return Ze(Rd(Rt(s,a)),-1)})}function Z5(n,t){return at(()=>{const e=Wa(0,Rt(1,X(n,t)));return Ze(Rd(e),-1)})}function Q5(n,t){return at(()=>{const e=Wa(0,Rt(1,X(n,t)));return Ze(e,-1)})}function J5(n,t){return at(()=>{const e=Ft(X(n,t),-1),s=vr(X(Rt(1,n),t),-1);return Wa(0,St(1,Rt(s,e)))})}function tq(n,t){return at(()=>{const e=Math.log(2),s=Rt(t,n),r=Rt(St(s,Ou(X(-2,s))),e);return Ze(r,-1)})}function mh(n,t,e=!1){return at(()=>{if(e)t=jg(t);else{const s=Ft(t,t.shape.length-1,!0);t=_t(t,s)}return t=_s(t,wn(),1-wn()),Be(Ft(X(kt(n,"float32"),Qs(t)),t.shape.length-1))})}function nm(n,t,e=!1){return at(()=>{const s=kt(Td(v5(n)),"int32");t=_s(t,wn(),1-wn());const r=t.shape,a=J(sw(s,r[r.length-1]),r);return mh(a,t,e)})}function eq(n,t){if(!de(n.shape,t.shape))throw new st(`logits and labels must have the same shape, but got shapes ${JSON.stringify(n.shape)} and ${JSON.stringify(t.shape)}`);return at(()=>{const e=ca(t),s=Be(bn(t));return St(Rt(e,X(t,n)),Lg(Fs(s)))})}function oy(n,t){return at(()=>{let e;return e=_s(t,wn(),1-wn()),e=Qs(_t(e,Rt(1,e))),Ze(eq(n,e),-1)})}function nq(n,t){return at(()=>{const e=_s(n,wn(),1),s=_s(t,wn(),1);return Ft(X(n,Qs(_t(e,s))),-1)})}function sq(n,t){return at(()=>{const e=Qs(St(wn(),t));return Ze(Rt(t,X(n,e)),-1)})}function UA(n,t){return at(()=>{const e=em(n,-1),s=em(t,-1),r=X(e,s);return Be(Ft(r,-1))})}const sm={meanSquaredError:iy,meanAbsoluteError:fS,meanAbsolutePercentageError:pS,meanSquaredLogarithmicError:Y5,squaredHinge:Z5,hinge:Q5,categoricalHinge:J5,logcosh:tq,categoricalCrossentropy:mh,sparseCategoricalCrossentropy:nm,binaryCrossentropy:oy,kullbackLeiblerDivergence:nq,poisson:sq,cosineProximity:UA};function Jb(n){if(typeof n=="string"){if(n in sm)return sm[n];let t=`Unknown loss ${n}`;throw n.toLowerCase().includes("softmaxcrossentropy")&&(t=`Unknown loss ${n}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new st(t)}else return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function GA(n,t){return at(()=>{const e=X(.5,Js(t)),s=aa(Ps(t,e),n.dtype);return Ze(Mr(n,s),-1)})}function WA(n,t){return at(()=>aa(Mr(hu(n,-1),hu(t,-1)),"float32"))}function rq(n,t){return at(()=>kt(Ft(oa(Mr(n,1),Mr(t,1))),"float32"))}function aq(n,t){return at(()=>kt(Ft(oa(Mr(n,0),Mr(t,1))),"float32"))}function iq(n,t){return at(()=>{const e=rq(n,t),s=aq(n,t),r=St(e,s);return kt(Jn(Ps(r,0),_t(e,r),0),"float32")})}function oq(n,t){return oy(n,t)}function lq(n,t){return n.rank===t.rank&&(n=Ma(n,[n.rank-1])),t=hu(t,-1),t.dtype!==n.dtype&&(t=kt(t,n.dtype)),kt(Mr(n,t),"float32")}const uq=iy,cq=iy,hq=fS,dq=fS,fq=pS,pq=pS,HA=mh,mq=UA,jA=nm,rm={binaryAccuracy:GA,categoricalAccuracy:WA,precision:iq,categoricalCrossentropy:HA,sparseCategoricalCrossentropy:jA,mse:uq,MSE:cq,mae:hq,MAE:dq,mape:fq,MAPE:pq,cosine:mq};function gq(n){if(typeof n=="string"&&n in rm)return rm[n];if(typeof n!="string"&&n!=null)return n;throw new st(`Unknown metric ${n}`)}function up(n){if(Jr(n!==null,`Unknown LossOrMetricFn ${n}`),typeof n=="string")return n;{let t;for(const e of Object.keys(sm))if(sm[e]===n){t=e;break}if(t!==void 0)return t;for(const e of Object.keys(rm))if(rm[e]===n){t=e;break}return t!==void 0?t:n.name}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function yq(n){const t={Adagrad:()=>Wl.adagrad(.01),Adadelta:()=>Wl.adadelta(1,.95,wn()),Adam:()=>Wl.adam(.001,.9,.999,wn()),Adamax:()=>Wl.adamax(.002,.9,.999,wn(),0),RMSProp:()=>Wl.rmsprop(.001,.9,0,wn()),SGD:()=>Wl.sgd(.01)};if(t.adagrad=t.Adagrad,t.adadelta=t.Adadelta,t.adam=t.Adam,t.adamax=t.Adamax,t.rmsprop=t.RMSProp,t.sgd=t.SGD,n in t)return t[n]();throw new st(`Unknown Optimizer ${n}`)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const H2=1*1024*1024;function j2(n,t,e=!1){if(n==null||typeof n!="object"||Object.getPrototypeOf(n)!==Object.prototype||!Jx(n))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(e){const s=JSON.stringify(n);s.length>H2&&console.warn(`User-defined metadata of model "${t}" is too large in size (length=${s.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= ${H2}.`)}}function Jx(n){if(n===null)return!0;if(typeof n=="object")if(Object.getPrototypeOf(n)===Object.prototype){const t=Object.keys(n);for(const e of t)if(typeof e!="string"||!Jx(n[e]))return!1;return!0}else if(Array.isArray(n)){for(const t of n)if(!Jx(t))return!1;return!0}else return!1;else{const t=typeof n;return t==="string"||t==="number"||t==="boolean"}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function bq(n,t,e,s=console.log){const r=vq(n),a=["Layer (type)","Input Shape","Output shape","Param #"];r?(t=t||90,e=e||[.32,.61,.89,1]):(t=t||115,e=e||[.24,.48,.7,.8,1]),e[e.length-1]<=1&&(e=e.map(d=>Math.floor(t*d)));let i;if(!r){a.push("Receives inputs"),i=[];for(const d in n.nodesByDepth)i.push(...n.nodesByDepth[d])}s("_".repeat(t)),am(a,e,s),s("=".repeat(t));const l=n.layers;for(let d=0;d<l.length;++d)r?wq(l[d],e,s):Sq(l[d],e,i,s),s((d===l.length-1?"=":"_").repeat(t));n.checkTrainableWeightsConsistency();const u=xq(n),h=Qp(n.nonTrainableWeights);s(`Total params: ${u+h}`),s(`Trainable params: ${u}`),s(`Non-trainable params: ${h}`),s("_".repeat(t))}function xq(n){let t;return n.collectedTrainableWeights!=null?t=Qp(n.collectedTrainableWeights):t=Qp(n.trainableWeights),t}function vq(n){let t=!0;const e=[],s=[];for(const r in n.nodesByDepth)e.push(n.nodesByDepth[r]);for(const r of e){if(r.length>1||r.length===1&&r[0].inboundLayers.length>1){t=!1;break}s.push(...r)}if(t)for(const r of n.layers){let a=!1;for(const i of r.inboundNodes)if(s.indexOf(i)!==-1)if(a){t=!1;break}else a=!0;if(!t)break}return t}function am(n,t,e=console.log){let s="";for(let r=0;r<n.length;++r)r>0&&(s=s.slice(0,s.length-1)+" "),s+=n[r],s=s.slice(0,t[r]),s+=" ".repeat(t[r]-s.length);e(s)}function wq(n,t,e){let s,r;try{r=n.inboundNodes.map(u=>JSON.stringify(u.inputShapes)).join(",")}catch{r="multiple"}try{s=JSON.stringify(n.outputShape)}catch{s="multiple"}const a=n.name,i=n.getClassName(),l=[`${a} (${i})`,r,s,n.countParams().toString()];am(l,t,e)}function Sq(n,t,e,s){let r,a;try{a=n.inboundNodes.map(p=>JSON.stringify(p.inputShapes)).join(",")}catch{a="multiple"}try{r=JSON.stringify(n.outputShape)}catch{r="multiple"}const i=[];for(const p of n.inboundNodes)if(!(e!=null&&e.length>0&&e.indexOf(p)===-1))for(let m=0;m<p.inboundLayers.length;++m){const y=p.inboundLayers[m].name,b=p.nodeIndices[m],x=p.tensorIndices[m];i.push(`${y}[${b}][${x}]`)}const l=n.name,u=n.getClassName(),h=i.length===0?"":i[0],d=[`${l} (${u})`,a,r,n.countParams().toString(),h];am(d,t,s);for(let p=1;p<i.length;++p)am(["","","","",i[p]],t,s)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function qA(n,t,e){return(n==="inboundNodes"||n==="outputLayers"||n==="inputLayers")&&t===0&&typeof e=="string"}function t1(n,t){if(n===null)return null;if(typeof n=="string")return wo(n);if(typeof n=="number"||typeof n=="boolean")return n;if(n instanceof Array){const e=[],s=n.length;for(let r=0;r<s;++r){const a=n[r];qA(t,r,a)?e.push(a):e.push(t1(a,t))}return e}else{const e={};for(const s of Object.keys(n)){const r=n[s];if(s==="name"&&typeof r=="string")e[s]=r;else{const a=wo(s);e[a]=t1(r,a)}}return e}}function e1(n,t){if(n==null)return null;if(typeof n=="string")return Da(n);if(typeof n=="number"||typeof n=="boolean")return n;if(n instanceof Array){const e=[],s=n.length;for(let r=0;r<s;++r){const a=n[r];qA(t,r,a)?e.push(a):e.push(e1(a,t))}return e}else{const e={};for(const s of Object.keys(n)){const r=n[s],a=Da(s);(s==="name"||s==="className")&&typeof r=="string"?e[a]=r:e[a]=e1(r,s)}return e}}/** @license See the LICENSE file. */const XA="4.22.0";/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Cq=n=>{const t=Object.keys(n);if(t.length===0)return!1;const e=t[0].split("/");return!isNaN(parseInt(e[e.length-1],10))};let Nq=class Yr extends ae{constructor(t){if(super({}),this.containerNodes=new Set,this.name=t.name,this.name==null){const C=this.getClassName().toLowerCase();this.name=sy(C)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(t.inputs)?this.inputs=t.inputs.slice():this.inputs=[t.inputs],Array.isArray(t.outputs)?this.outputs=t.outputs.slice():this.outputs=[t.outputs],Ti(this.inputs).length!==this.inputs.length)throw new st(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(C=>C.name)}`);Ti(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(C=>C.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const C of this.outputs){const $=C.sourceLayer,T=C.nodeIndex,I=C.tensorIndex;this.outputLayers.push($),this.outputLayersNodeIndices.push(T),this.outputLayersTensorIndices.push(I)}for(const C of this.inputs){const $=C.sourceLayer,T=C.nodeIndex,I=C.tensorIndex;Jr(T===0,"input layer has >1 nodes"),Jr(I===0,"input layer has >1 tensors"),this.inputLayers.push($),this.inputLayersNodeIndices.push(T),this.inputLayersTensorIndices.push(I)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let C=0;C<this.inputLayers.length;C++){const $=this.inputLayers[C];if(!($ instanceof _d))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${t.inputs}. Input ${C} (0-based) originates from layer type ${$.getClassName()}.`);this.inputNames.push($.name),this.feedInputShapes.push($.batchInputShape),this.feedInputNames.push($.name)}for(const C of this.outputLayers)this.outputNames.push(C.name);this.internalInputShapes=this.inputs.map(C=>C.shape),this.internalOutputShapes=this.outputs.map(C=>C.shape);const e={},s={},r={},a={},i={},l=[],u=(C,$,T,I,A,R)=>{(I==null||A==null||R==null)&&(I=C.sourceLayer,A=C.nodeIndex,R=C.tensorIndex);const L=I.inboundNodes[A];if(T.indexOf(L)!==-1)throw new yr(`The tensor ${C.name} at layer "${I.name}" is part of a cycle.`);if($.indexOf(L)!==-1)return;this.containerNodes.add(Yr.nodeKey(I,A)),I.id in i||(i[I.id]=Object.keys(i).length),T.indexOf(L)===-1&&T.push(L);const _=L.inboundLayers.length;for(let M=0;M<_;M++){const D=L.inputTensors[M],W=L.inboundLayers[M],et=L.nodeIndices[M],nt=L.tensorIndices[M];u(D,$,T,W,et,nt)}for($.push(L);T.indexOf(L)>=0;)T.splice(T.indexOf(L),1);l.push(L)},h=[],d=[];for(const C of this.outputs)u(C,h,d);const p=l.slice().reverse();for(const C of p){s[C.id]=C,C.id in e||(e[C.id]=0);let $=e[C.id];const T=r[C.outboundLayer.id]==null?0:r[C.outboundLayer.id];$=Math.max($,T),r[C.outboundLayer.id]=$,a[C.outboundLayer.id]=C.outboundLayer,e[C.id]=$;for(let I=0;I<C.inboundLayers.length;I++){const A=C.inboundLayers[I],R=C.nodeIndices[I],L=A.inboundNodes[R],_=e[L.id]==null?0:e[L.id];e[L.id]=Math.max($+1,_),s[L.id]=L}}const m={};for(const C in e){const $=e[C];$ in m||(m[$]=[]),m[$].push(s[C])}const y={};for(const C in r){const $=r[C];$ in y||(y[$]=[]),y[$].push(a[C])}let b=Object.keys(y).map(C=>parseInt(C,10)).sort(ip);this.layers=[];for(const C of b){const $=y[C];$.sort((T,I)=>{const A=i[T.id],R=i[I.id];return A<R?-1:A>R?1:0});for(const T of $)T instanceof Yr&&this.internalContainerRefs.push(T),this.layers.push(T)}this.layersByDepth=y,b=Object.keys(m).map(C=>parseInt(C,10)).sort(ip);const x=this.inputs.slice(),v=[];for(const C of b)for(const $ of m[C]){const T=$.outboundLayer;if(T!=null){for(const I of $.inputTensors)if(x.indexOf(I)===-1)throw new yr(`Graph disconnected: cannot obtain value for tensor ${I} at layer "${T.name}". The following previous layers were accessed without issue: ${v}`);for(const I of $.outputTensors)x.push(I);v.push(T.name)}}this.nodesByDepth=m;const S=this.layers.map(C=>C.name);for(const C of S){const $=S.filter(T=>T===C).length;if($!==1)throw new yr(`The name "${C}" is used ${$} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(S))}this.outboundNodes=[],this.inboundNodes=[],new ay({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(C=>null),outputMasks:this.outputs.map(C=>null),inputShapes:this.inputs.map(C=>C.shape),outputShapes:this.outputs.map(C=>C.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const t={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(const e of this.layers)t.numDisposedVariables+=e.dispose().numDisposedVariables;for(const e of this.internalContainerRefs)t.numDisposedVariables+=e.dispose().numDisposedVariables}return t.refCountAfterDispose=this._refCount,t}get trainable(){return this.trainable_}set trainable(t){this.layers.forEach(e=>{e._trainableWeights.forEach(s=>s.trainable=t)}),this.trainable_=t}get trainableWeights(){if(this._trainableWeights.length>0)throw new st("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let t=[];for(const e of this.layers)t=t.concat(e.trainableWeights);return t}get nonTrainableWeights(){const t=[];for(const e of this.layers)t.push(...e.nonTrainableWeights);if(!this.trainable){const e=[];for(const s of this.layers)e.push(...s.trainableWeights);return e.concat(t)}return t}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(t,e=!0){const s={};let r=0;const a=Cq(t);a&&this.parseWeights(t);for(const l of this.layers)for(const[u,h]of l.weights.entries()){const d=a?`${h.name.split("/").slice(0,-1).join("/")+"/"}${u}`:h.originalName;if(s[d]!=null)throw new st(`Duplicate weight name: ${d}`);s[d]=h,r++}const i=[];for(const l in t){let u=l;if(s[l]==null){const h=l.split("/");u=h.slice(0,-2).concat([h[h.length-1]]).join("/")}if(s[u]!=null)i.push([s[u],t[l]]);else if(e)throw new st(`Provided weight data has no target variable: ${l}`);delete s[u]}if(e){const l=[];for(const u in s)l.push(u);if(l.length>0)throw new st(`${l.length} of ${r} weights are not set: ${l}`)}hS(i)}parseWeights(t){for(const e in Object.keys(t)){const s=e.split("/"),r=["vars","layer_checkpoint_dependencies"],a=s.map(i=>i.startsWith("_")?i.slice(1):i).filter(i=>!r.includes(i)).join("/");a!==e&&(t[a]=t[e],delete t[e])}}updatedConfig(){const t=this.getConfig(),e={};return e.className=this.getClassName(),e.config=t,e.kerasVersion=`tfjs-layers ${XA}`,e.backend="TensorFlow.js",e}toJSON(t,e=!0){const s=e1(this.updatedConfig());return e?JSON.stringify(s):s}call(t,e){return at(()=>{t=Se(t);const s=new wi;for(let r=0;r<this.inputs.length;++r)s.add(this.inputs[r],t[r]);return th(this.outputs,s,e)})}computeMask(t,e){return at(()=>{t=Se(t);let s;return e==null?s=Wo(null,t.length):s=Se(e),this.runInternalGraph(t,s)[1]})}computeOutputShape(t){const e=Zp(t);if(e.length!==this.inputLayers.length)throw new st(`Invalid inputShape argument ${t}: model has ${this.inputLayers.length} tensor inputs.`);const s={};for(let l=0;l<e.length;l++){const u=this.inputLayers[l],h=e[l],d=u.name+"_0_0";s[d]=h}const r=Object.keys(this.nodesByDepth).map(l=>parseInt(l,10)).sort(ip);if(r.length>1)for(const l of r){const u=this.nodesByDepth[l];for(const h of u){const d=h.outboundLayer;if(this.inputLayers.map(x=>x.id).indexOf(d.id)!==-1)continue;const p=[];for(let x=0;x<h.inboundLayers.length;x++){const v=h.inboundLayers[x],S=h.nodeIndices[x],C=h.tensorIndices[x],$=`${v.name}_${S}_${C}`,T=s[$];p.push(T)}const m=d.computeOutputShape(ms(p)),y=Zp(m),b=d.inboundNodes.indexOf(h);for(let x=0;x<y.length;x++){const v=`${d.name}_${b}_${x}`;s[v]=y[x]}}}const a=[],i=[];for(let l=0;l<this.outputLayers.length;l++){const u=this.outputLayers[l],h=this.outputLayersNodeIndices[l],d=this.outputLayersTensorIndices[l],p=`${u.name}_${h}_${d}`;i.push(p)}for(let l=0;l<i.length;l++){const u=i[l];Jr(u in s),a.push(s[u])}return ms(a)}runInternalGraph(t,e){e==null&&(e=Wo(null,t.length));const s={};for(let u=0;u<this.inputs.length;++u){const h=this.inputs[u],d=t[u],p=e[u];s[h.id]=[d,p]}const r=Object.keys(this.nodesByDepth).map(u=>parseInt(u,10)).sort(ip);for(const u of r){const h=this.nodesByDepth[u];for(const d of h){const p=d.outboundLayer,m=d.inputTensors,y=d.outputTensors,b=new Array;for(const x of m)x.id in s&&b.push(s[x.id]);if(b.length===m.length){let x={},v,S,C,$;if(d.callArgs!=null&&(x=d.callArgs),b.length===1){const[T,I]=b[0];x.mask==null&&(x.mask=I),C=Se(p.call(T,x)),$=Se(p.computeMask(T,I)),v=[T],S=[I]}else v=b.map(T=>T[0]),S=b.map(T=>T[1]),x.mask==null&&(x.mask=S),C=Se(p.call(v,x)),$=Se(p.computeMask(v,S));if(p.activityRegularizer)throw new Jt("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let T=0;T<y.length;++T){const I=y[T],A=C[T],R=$[T];s[I.id]=[A,R]}}}}const a=[],i=[],l=[];for(const u of this.outputs){Jr(u.id in s,`Could not compute output ${u.name} : ${u.id}`);const[h,d]=s[u.id];l.push(h.shape),a.push(h),i.push(d)}return[a,i,l]}buildNodeConversionMap(t){const e={};let s;for(const r of this.layers){s=r instanceof Yr?1:0;for(let a=0;a<r.inboundNodes.length;a++){const i=Yr.nodeKey(r,a);this.containerNodes.has(i)&&(e[i]=s,s+=1)}}return e}getLayer(t,e){if(e!=null)return this.findLayer(e);if(t==null)throw new st("Provide either a layer name or layer index");if(typeof t=="number")return this.findLayer(t);for(const s of this.layers)if(s.name===t)return s;throw new st(`No such layer: ${t}`)}findLayer(t){if(this.layers.length<=t)throw new st(`Was asked to retrieve layer at index ${t}, but model only has ${this.layers.length} layer(s).`);return this.layers[t]}calculateLosses(){return at(()=>{const t=[];for(const e of this.layers)for(let s=0;s<e.inboundNodes.length;++s){const r=Yr.nodeKey(e,s);this.containerNodes.has(r)&&t.push(...e.calculateLosses())}return t})}getConfig(){const t={name:this.name},e=this.buildNodeConversionMap(this.layers),s=[];for(const i of this.layers){const l=i.getClassName(),u=i.getConfig(),h=[];for(let p=0;p<i.inboundNodes.length;p++){const m=i.inboundNodes[p],y=Yr.nodeKey(i,p);let b={};if(this.containerNodes.has(y)){if(m.callArgs)try{JSON.stringify(m.callArgs),b=m.callArgs}catch{console.warn(`Layer ${i.name} was passed non-serializable keyword arguments: ${m.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),b={}}if(m.inboundLayers.length>0){const x=[];for(let v=0;v<m.inboundLayers.length;v++){const S=m.inboundLayers[v],C=m.nodeIndices[v],$=m.tensorIndices[v],T=Yr.nodeKey(S,C);let I=e[T];I==null&&(I=0),x.push([S.name,I,$,b])}h.push(x)}}}const d={};d.name=i.name,d.className=l,d.config=u,d.inboundNodes=h,s.push(d)}t.layers=s;const r=[];for(let i=0;i<this.inputLayers.length;i++){const l=this.inputLayers[i],u=this.inputLayersNodeIndices[i],h=Yr.nodeKey(l,u);if(!this.containerNodes.has(h))continue;let d=e[h];d==null&&(d=0);const p=this.inputLayersTensorIndices[i];r.push([l.name,d,p])}t.inputLayers=r;const a=[];for(let i=0;i<this.outputLayers.length;i++){const l=this.outputLayers[i],u=this.outputLayersNodeIndices[i],h=Yr.nodeKey(l,u);if(!this.containerNodes.has(h))continue;let d=e[h];d==null&&(d=0);const p=this.outputLayersTensorIndices[i];a.push([l.name,d,p])}return t.outputLayers=a,t}static fromConfig(t,e,s={},r=!1){const a={},i={};function l(v,S){v.name in i?i[v.name].push(S):i[v.name]=[S]}function u(v,S){const C=[];let $;for(const T of S){const I=T[0],A=T[1],R=T[2];if($=T[3]==null?{}:T[3],!(I in a)){l(v,S);return}const L=a[I];if(L.inboundNodes.length<=A){l(v,S);return}const _=L.inboundNodes[A];C.push(_.outputTensors[R])}C.length>0&&v.apply(ms(C),$)}function h(v){const S=v.name,C=Fa(v,e.customObjects!=null?e.customObjects:{});C.setFastWeightInitDuringBuild(r),a[S]=C,v.inboundNodes.forEach(T=>{if(!(T instanceof Array))throw new st(`Corrupted configuration, expected array for nodeData: ${T}`);l(C,T)})}const d=e.name,p=e.layers;for(const v of p)h(v);for(;!o5(i);)for(const v of p){const S=a[v.name];if(S.name in i){const C=i[S.name];delete i[S.name];for(const $ of C)u(S,$)}}const m=[],y=[],b=e.inputLayers;for(const v of b){const S=v[0],C=v[1],$=v[2];Jr(S in a);const I=a[S].inboundNodes[C].outputTensors;m.push(I[$])}const x=e.outputLayers;for(const v of x){const S=v[0],C=v[1],$=v[2];Jr(S in a);const I=a[S].inboundNodes[C].outputTensors;y.push(I[$])}return new t({inputs:m,outputs:y,name:d})}get stateful(){if(this._stateful)throw new st("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const t of this.layers)if(t.stateful)return!0;return!1}resetStates(){at(()=>{this.layers.forEach(t=>{t.stateful&&t.resetStates()})})}};/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Tq(n,t,e){const s=t.length;if(n==null||Array.isArray(n)&&n.length===0)return t.map(r=>null);if(s===1)return Array.isArray(n)&&n.length===1?n:typeof n=="object"&&t[0]in n?[n[t[0]]]:[n];if(Array.isArray(n)){if(n.length!==s)throw new Error(`Provided ${e} is an array of ${n.length} element(s), but the model has ${s} outputs. Make sure a set of weights is provided for each model output.`);return n}else if(typeof n=="object"&&Object.keys(n).length>0&&typeof n[Object.keys(n)[0]]=="object"){const r=[];return t.forEach(a=>{a in n?r.push(n[a]):r.push(null)}),r}else throw new Error(`The model has multiple (${s}) outputs, so ${e} must be either an array with ${s} elements or an object with ${t} keys. Provided ${e} not understood: ${JSON.stringify(n)}`)}function KA(n,t){return Tq(n,t,"classWeight")}async function YA(n,t,e,s){if(e!=null){const r=at(()=>{if(n.shape.length===1)return _a(n);if(n.shape.length===2){if(n.shape[1]>1)return hu(n,1);if(n.shape[1]===1)return J(n,[n.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${n.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw new Error(`Unexpected rank of target (y) tensor (${n.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),a=Array.from(await r.data());se(r);const i=[];return a.forEach(l=>{if(e[l]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${l} exists in the data but not in classWeight`);i.push(e[l])}),Un(i,"float32")}else return null}function $q(n,t){return X(n,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const kq=32;function ZA(n,t){let e,s;const r=t;e=r.xs,s=r.ys,F(e!=null&&s!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${t}`);const a=q2("input",n.inputNames,e),i=q2("output",n.outputNames,s),l=a[0].shape[0];F(a.length===n.inputs.length,()=>`LayersModel has ${n.inputs.length} inputs, but the dataset provides ${a.length} inputs.  (Expected input keys: ${JSON.stringify(n.inputNames)})`),F(i.length===n.outputs.length,()=>`LayersModel has ${n.outputs.length} outputs, but the dataset provides ${i.length} outputs.  (Expected output keys: ${JSON.stringify(n.outputNames)})`);for(let u=0;u<a.length;u++)F(a[u].shape[0]===l,()=>`Batch size mismatch: input ${n.inputNames[u]} has ${a[u].shape[0]}; expected  ${l} based on input ${n.inputNames[0]}.`);for(let u=0;u<i.length;u++)F(i[u].shape[0]===l,()=>`Batch size mismatch: output ${n.outputNames[u]} has ${i[u].shape[0]}; expected  ${l} based on input ${n.inputNames[0]}.`);return{xs:a,ys:i}}function q2(n,t,e){if(e instanceof Me)return[e];if(Array.isArray(e))return F(e.length===t.length,()=>`Received an array of ${e.length} Tensors, but expected ${t.length} to match the ${n} keys ${t}.`),e;{const s=[];for(const r of t){if(e[r]==null)throw new st(`The feature data generated by the dataset lacks the required ${n} key '${r}'.`);s.push(e[r])}return s}}function Iq(n){if(n.length===3)throw new Jt("Validation with sample weights is not implemented yet.");return{xs:n[0],ys:n[1]}}async function Eq(n,t,e){const s=e.batchesPerEpoch!=null;if(F(n.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),F(e!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),F(e.epochs!=null&&e.epochs>0&&Number.isInteger(e.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${e.epochs}`),F(!s||e.batchesPerEpoch>0&&Number.isInteger(e.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${e.batchesPerEpoch}`),F(e.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),n.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");n.isTraining=!0;try{const r=e.validationData!=null;let a,i;if(r)if(X2(e.validationData))F(e.validationBatches==null||e.validationBatches>0&&Number.isInteger(e.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${e.validationBatches}`);else{const v=Iq(e.validationData);a=v.xs,i=v.ys}const l=n.makeTrainFunction(),u=n.getDedupedMetricsNames();let h;r?h=u.slice().concat(u.map(v=>"val_"+v)):h=u.slice();const d=PA(e.callbacks,e.yieldEvery),p=e.verbose==null?1:e.verbose,{callbackList:m,history:y}=VA(d,p,e.epochs,null,null,Dq(t,e),null,r,h);m.setModel(n),n.history=y,await m.onTrainBegin(),n.stopTraining_=!1;let b=e.initialEpoch==null?0:e.initialEpoch,x=await t.iterator();for(;b<e.epochs;){const v={};await m.onEpochBegin(b);let S=0,C=0;for(s||(x=await t.iterator());!s||S<e.batchesPerEpoch;){const $=await x.next();if(s&&$.done){console.warn(`You provided \`batchesPerEpoch\` as ${e.batchesPerEpoch}, but your dataset iterator ran out of data after ${S} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${e.batchesPerEpoch*e.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if($.value!=null){const{xs:T,ys:I}=ZA(n,$.value),A={};A.batch=C,A.size=T[0].shape[0],await m.onBatchBegin(C,A);const R=[];if(e.classWeight!=null){const M=KA(e.classWeight,n.outputNames);for(let D=0;D<M.length;++D)R.push(await YA(I[D],null,M[D]))}const L=T.concat(I).concat(R),_=l(L);se(L);for(let M=0;M<u.length;++M){const D=u[M],W=_[M];A[D]=W,An(W)}await m.onBatchEnd(C,A),BA(A),C++,S++}if(s?S>=e.batchesPerEpoch:$.done){if(r){let T;X2(e.validationData)?T=Se(await n.evaluateDataset(e.validationData,{batches:e.validationBatches})):T=Se(n.evaluate(a,i,{batchSize:e.validationBatchSize==null?kq:e.validationBatchSize,verbose:0}));for(let I=0;I<n.metricsNames.length;++I)v[`val_${n.metricsNames[I]}`]=T[I]}break}if(n.stopTraining_)break}if(await m.onEpochEnd(b,v),b++,n.stopTraining_)break}return await m.onTrainEnd(),await n.history.syncData(),n.history}finally{n.isTraining=!1}}function Dq(n,t){let e=null;return t.batchesPerEpoch!=null?e=t.batchesPerEpoch:Number.isFinite(n.size)&&(e=n.size),e}function X2(n){return typeof n.iterator=="function"}function Aq(n){return typeof n.next=="function"}async function Rq(n,t,e){e=e||{};const s=e.batches!=null,r=n.testFunction;let a=[];if(e.verbose>0)throw new Jt("Verbose mode is not implemented yet.");F(!s||e.batches>0&&Number.isInteger(e.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(e.batches)}`);const i=Aq(t)?t:await t.iterator();let l=0,u=0;for(;!s||u<e.batches;){const h=await i.next();if(a=at(()=>{if(h.value){const{xs:d,ys:p}=ZA(n,h.value),m=d.concat(p),y=at(()=>r(m));if(se(m),u===0)for(let x=0;x<y.length;++x)a.push(Vt(0));const b=m[0].shape[0];for(let x=0;x<y.length;++x){const v=y[x],S=a[x];a[x]=at(()=>St(a[x],X(b,v))),u>0&&se(S)}se(y),l+=b,++u}return a}),h.done){s&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${e.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let h=0;h<a.length;++h){const d=a[h];a[h]=_t(a[h],l),se(d)}return ms(a)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function tx(n){F(n>0&&Number.isInteger(n),()=>`batchSize is required to be a positive integer, but got ${n}`)}function Kc(n,t,e){return n==null?[null]:Array.isArray(n)?n.map(s=>Eo(s,t,e-t)):Eo(n,t,e-t)}function n1(n,t){return at(()=>n==null?null:Array.isArray(n)?n.map(e=>n1(e,t)):TA(n,t.dtype==="int32"?t:kt(t,"int32")))}function ex(n,t){const e=[];let s=0,r=null;for(;s<n;)r=s+t,r>=n&&(r=n),e.push([s,r]),s=r;return e}function QA(n){const t=[];n instanceof Me&&(n=[n]);for(let e=0;e<n.length;++e){const s=n[e];if(s.rank===1)t.push(Ad(s,1));else{if(s.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");t.push(s)}}return t}function Ar(n,t){if(n==null)return;const e=[];if(t instanceof Me)e.push(t.id);else if(Array.isArray(t))t.forEach(r=>e.push(r.id));else if(t!=null)for(const r in t){const a=t[r];e.push(a.id)}const s=[];if(n instanceof Me)e.indexOf(n.id)===-1&&s.push(n);else if(Array.isArray(n))n.forEach(r=>{e.indexOf(r.id)===-1&&s.push(r)});else if(n!=null)for(const r in n){const a=n[r];e.indexOf(a.id)===-1&&s.push(a)}s.forEach(r=>{r.isDisposed||r.dispose()})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Oq(n){return n instanceof Me}function s1(n){return Array.isArray(n)}function K2(n){return!Oq(n)&&!s1(n)}function Y2(n,t,e,s=!0,r=""){if(t==null||t.length===0){if(n!=null){let i=!1;if(s1(n)&&n.length>0)i=!0;else if(K2(n)){for(const l in n)if(n.hasOwnProperty(l)){i=!0;break}}else i=!0;if(i)throw new st(`Error when checking model ${r} expected no data, but got ${n}`)}return[]}if(n==null)return t.map(i=>null);let a;if(K2(n)){n=n,a=[];for(const i of t){if(n[i]==null)throw new st(`No data provided for "${i}". Need data for each key in: ${t}`);a.push(n[i])}}else if(s1(n)){if(n=n,n.length!==t.length)throw new st(`Error when checking model ${r}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${t.length} Tensor(s), but instead got the following list of Tensor(s): ${n}`);a=n}else{if(n=n,t.length>1)throw new st(`The model ${r} expects ${t.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${n.shape}`);a=[n]}if(a=QA(a),e!=null)for(let i=0;i<t.length;++i){if(e[i]==null)continue;const l=a[i];if(l.shape.length!==e[i].length)throw new st(`Error when checking ${r}: expected ${t[i]} to have ${e[i].length} dimension(s). but got array with shape ${l.shape}`);for(let u=0;u<e[i].length;++u){if(u===0&&!s)continue;const h=l.shape[u],d=e[i][u];if(d!=null&&d>=0&&h!==d)throw new st(`${r} expected a batch of elements where each example has shape [${e[i].slice(1,e[i].length)}] (i.e.,tensor shape [*,${e[i].slice(1,e[i].length)}]) but the ${r} received an input with ${l.shape[0]} examples, each with shape [${l.shape.slice(1,l.shape.length)}] (tensor shape [${l.shape}])`)}}return a}function _q(n,t,e){const s=Ti(n.map(a=>a.shape[0]));s.sort();const r=Ti(t.map(a=>a.shape[0]));if(r.sort(),s.length>1)throw new st(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(n.map(a=>a.shape))}`);if(r.length>1)throw new st(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(t.map(a=>a.shape))}`);if(s.length>0&&r.length>0&&!de(s,r))throw new st(`Input Tensors should have the same number of samples as target Tensors. Found ${s[0]} input sample(s) and ${r[0]} target sample(s).`)}function Fq(n,t,e){const s=[iy,oy,mh];for(let r=0;r<n.length;++r){const a=n[r],i=t[r],l=e[r];if(i!=null){if(i===mh&&a.shape[a.shape.length-1]===1)throw new st(`You are passing a target array of shape ${a.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(s.indexOf(i)!==-1){const u=a.shape.slice(1),h=l.slice(1);for(let d=0;d<u.length;++d){const p=u[d],m=h[d];if(m!=null&&p!==m)throw new st(`A target Tensor with shape ${a.shape} was passed for an output of shape ${l}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function Z2(n,t,e,s=!0,r=""){let a;if(Array.isArray(n)){if(n.length!==t.length)throw new st(`Error when checking model ${r}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${t.length} Tensor(s), but instead got ${n.length} Tensors(s).`);a=n}else{if(t.length>1)throw new st(`The model expects ${t.length} ${r} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(n.shape)}.`);a=[n]}if(e!=null)for(let i=0;i<t.length;++i){if(e[i]==null)continue;const l=a[i];if(l.shape.length!==e[i].length)throw new st(`Error when checking ${r}: expected ${t[i]} to have ${e[i].length} dimension(s), but got array with shape ${JSON.stringify(l.shape)}`);for(let u=0;u<e[i].length;++u){if(u===0&&!s)continue;const h=l.shape[u],d=e[i][u];if(d!=null&&d!==h)throw new st(`Error when checking ${r}: expected ${t[i]} to have shape ${JSON.stringify(e[i])} but got array with shape ${JSON.stringify(l.shape)}.`)}}}function Lq(n,t){if(n==null||Array.isArray(n)&&n.length===0)return t.map(s=>[]);let e;if(typeof n=="string"||typeof n=="function")e=[n];else if(Array.isArray(n)||typeof n=="object")e=n;else throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${n}`);if(Array.isArray(e))return t.map(s=>e);{const s=[];for(const r of t){let a=e.hasOwnProperty(r)?e[r]:[];Array.isArray(a)||(a=[a]),s.push(a)}return s}}const zq="layers-model";class ou extends Nq{constructor(t){super(t),this.isTraining=!1}summary(t,e,s=console.log){if(!this.built)throw new st("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");bq(this,t,e,s)}compile(t){if(t.loss==null&&(t.loss=[]),this.loss=t.loss,typeof t.optimizer=="string")this.optimizer_=yq(t.optimizer),this.isOptimizerOwned=!0;else{if(!(t.optimizer instanceof qi))throw new st("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=t.optimizer,this.isOptimizerOwned=!1}let e=[];if(!Array.isArray(t.loss)&&typeof t.loss!="string"&&typeof t.loss!="function"){t.loss=t.loss;for(const i in t.loss)if(this.outputNames.indexOf(i)===-1)throw new st(`Unknown entry in loss dictionary: "${i}". Only expected the following keys: ${this.outputNames}`);for(const i of this.outputNames)t.loss[i]==null&&console.warn(`Output "${i}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${i} during training`),e.push(Jb(t.loss[i]))}else if(Array.isArray(t.loss)){if(t.loss.length!==this.outputs.length)throw new st(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${t.loss}.`);e=t.loss.map(l=>Jb(l))}else{const i=Jb(t.loss);this.outputs.forEach(l=>{e.push(i)})}this.lossFunctions=e,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let i=0;i<this.outputs.length;++i){const l=this.internalOutputShapes[i],u=this.outputNames[i];this.feedOutputNames.push(u),this.feedOutputShapes.push(l),this.feedLossFns.push(this.lossFunctions[i])}const s=[];this.metrics=t.metrics,this.metricsNames=["loss"],this.metricsTensors=[],Io("loss",()=>{for(let i=0;i<this.outputs.length;++i){if(s.indexOf(i)!==-1)continue;const l=this.lossFunctions[i];this.outputs.length>1&&(this.metricsTensors.push([l,i]),this.metricsNames.push(this.outputNames[i]+"_loss"))}});const r=Lq(t.metrics,this.outputNames),a=(i,l,u)=>{this.outputNames.length>1&&(l=this.outputNames[i]+"_"+l),this.metricsNames.push(l),this.metricsTensors.push([u,i])};Io("metric",()=>{for(let i=0;i<this.outputs.length;++i){if(s.indexOf(i)!==-1)continue;const l=r[i];(h=>{const d="";let p,m,y;for(const b of h){if(typeof b=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(b)!==-1){const v=this.internalOutputShapes[i];v[v.length-1]===1||this.lossFunctions[i]===oy?["accuracy","acc"].indexOf(b)!==-1?m=GA:["crossentropy","ce"].indexOf(b)!==-1&&(m=oq):this.lossFunctions[i]===nm?["accuracy","acc"].indexOf(b)!==-1?m=lq:["crossentropy","ce"].indexOf(b)!==-1&&(m=jA):["accuracy","acc"].indexOf(b)!==-1?m=WA:["crossentropy","ce"].indexOf(b)!==-1&&(m=HA);let S;["accuracy","acc"].indexOf(b)!==-1?S="acc":["crossentropy","ce"].indexOf(b)!==-1&&(S="ce"),y=m,p=d+S}else y=gq(b),p=d+up(b);let x;Io(p,()=>{x=y}),a(i,p,x)}})(l)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(t,e,s={}){const r=s.batchSize==null?32:s.batchSize;tx(r);const i=this.standardizeUserDataXY(t,e,!0,r);try{const l=i[0].concat(i[1]);this.makeTestFunction();const u=this.testFunction,h=this.testLoop(u,l,r,s.verbose,s.steps);return ms(h)}finally{Ar(i[0],t),Ar(i[1],e)}}async evaluateDataset(t,e){return this.makeTestFunction(),Rq(this,t,e)}checkNumSamples(t,e,s,r="steps"){let a;if(s!=null){if(a=null,e!=null)throw new st(`If ${r} is set, batchSize must be null or undefined.Got batchSize = ${e}`)}else if(t!=null)Array.isArray(t)?a=t[0].shape[0]:a=t.shape[0];else throw new st(`Either the input data should have a defined shape, or ${r} shoud be specified.`);return a}execute(t,e){if(Array.isArray(e)&&e.length===0)throw new st("`outputs` is an empty Array, which is not allowed.");const s=Array.isArray(e),r=s?e:[e],a=this.retrieveSymbolicTensors(r),i=new wi;if(t instanceof Me&&(t=[t]),Array.isArray(t)){if(t.length!==this.inputs.length)throw new st(`The number of inputs provided (${t.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let u=0;u<this.inputs.length;++u)i.add(this.inputs[u],t[u])}else for(const u of this.inputs){const h=t[u.name];if(h==null)throw new st(`No value is provided for the model's input ${u.name}`);i.add(u,h)}const l=th(a,i);return s?l:l[0]}retrieveSymbolicTensors(t){const e=Wo(null,t.length);let s=t.length;for(const r of this.layers){const a=Array.isArray(r.output)?r.output:[r.output],i=a.map(l=>l.name);for(let l=0;l<t.length;++l){const u=i.indexOf(t[l]);if(u!==-1&&(e[l]=a[u],s--),s===0)break}if(s===0)break}if(s>0){const r=[];throw e.forEach((a,i)=>{a==null&&r.push(t[i])}),new st(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(r)}`)}return e}predictLoop(t,e=32,s=!1){return at(()=>{const r=this.checkNumSamples(t);if(s)throw new Jt("Verbose predictLoop() is not implemented yet.");const a=ex(r,e),i=this.outputs.map(l=>[]);for(let l=0;l<a.length;++l)at(()=>{const h=a[l][0],d=a[l][1],p=Kc(t,h,d),m=[];if(Array.isArray(p))for(let b=0;b<p.length;++b)m.push({key:this.inputs[b],value:p[b]});else m.push({key:this.inputs[0],value:p});const y=new wi(m);return th(this.outputs,y)}).forEach((h,d)=>i[d].push(h));return ms(i.map(l=>pn(l,0)))})}predict(t,e={}){const s=QA(t);Z2(s,this.inputNames,this.feedInputShapes,!1);try{const r=e.batchSize==null?32:e.batchSize;return tx(r),this.predictLoop(s,r)}finally{Ar(s,t)}}predictOnBatch(t){Z2(t,this.inputNames,this.feedInputShapes,!0);const e=(Array.isArray(t)?t[0]:t).shape[0];return this.predictLoop(t,e)}standardizeUserDataXY(t,e,s=!0,r){if(this.optimizer_==null)throw new yr("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const a=[];for(let i=0;i<this.feedOutputShapes.length;++i){const l=this.feedOutputShapes[i];this.feedLossFns[i]===nm?a.push(l.slice(0,l.length-1).concat([1])):a.push(l)}if(t=Y2(t,this.feedInputNames,this.feedInputShapes,!1,"input"),e=Y2(e,this.feedOutputNames,a,!1,"target"),_q(t,e),Fq(e,this.feedLossFns,this.feedOutputShapes),this.stateful&&r!=null&&r>0&&t[0].shape[0]%r!==0)throw new st(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${r}. Found: ${t[0].shape[0]} sample(s).`);return[t,e]}async standardizeUserData(t,e,s,r,a=!0,i){const[l,u]=this.standardizeUserDataXY(t,e,a,i);if(s!=null)throw new Error("sample weight is not supported yet.");let h=null;if(r!=null){const d=KA(r,this.outputNames);h=[];for(let p=0;p<d.length;++p)h.push(await YA(u[p],null,d[p]))}return[l,u,h]}testLoop(t,e,s,r=0,a){return at(()=>{const i=this.checkNumSamples(e,s,a,"steps"),l=[];if(r>0)throw new Jt("Verbose mode is not implemented yet.");if(a!=null)throw new Jt("steps mode in testLoop() is not implemented yet");{const u=ex(i,s),h=Un(Br(0,i));for(let d=0;d<u.length;++d){const p=u[d][0],m=u[d][1],y=Eo(h,p,m-p),b=n1(e,y),x=t(b);if(d===0)for(let v=0;v<x.length;++v)l.push(Vt(0));for(let v=0;v<x.length;++v){const S=x[v];l[v]=St(l[v],X(m-p,S))}}for(let d=0;d<l.length;++d)l[d]=_t(l[d],i)}return l})}getDedupedMetricsNames(){const t=this.metricsNames,e=[];for(let s=0;s<t.length;++s){const r=t[s];let a=r;if(F2(t,r)>1){const i=F2(t.slice(0,s),r);a+=`_${i}`}e.push(a)}return e}makeTrainFunction(){return t=>{const e=[],s=t.slice(0,this.inputs.length),r=t.slice(this.inputs.length,this.inputs.length+this.outputs.length),a=t.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),i=[],l=()=>{const p=[];for(let x=0;x<this.inputs.length;++x)p.push({key:this.inputs[x],value:s[x]});const m=new wi(p),y=th(this.outputs,m,{training:!0});let b;for(let x=0;x<this.lossFunctions.length;++x){const v=this.lossFunctions[x];let S=v(r[x],y[x]);a[x]!=null&&(S=$q(S,a[x]));const C=Ze(S);e.push(C),x===0?b=S:b=St(b,S)}for(let x=0;x<this.metricsTensors.length;++x){let v;if(this.outputs.length>1&&x<this.outputs.length)v=e[x];else{const S=this.metricsTensors[x][0],C=this.metricsTensors[x][1];v=Ze(S(r[C],y[C]))}An(v),i.push(v)}return b=Ze(b),this.calculateLosses().forEach(x=>{b=St(b,x)}),b},u=this.collectedTrainableWeights.map(p=>p.read());return[this.optimizer_.minimize(l,!0,u)].concat(i)}}makeTestFunction(){this.testFunction=t=>at(()=>{const e=[];let s;const r=t.slice(0,this.inputs.length),a=t.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=[];for(let h=0;h<this.inputs.length;++h)i.push({key:this.inputs[h],value:r[h]});const l=new wi(i),u=th(this.outputs,l);for(let h=0;h<this.lossFunctions.length;++h){const d=this.lossFunctions[h],p=Ze(d(a[h],u[h]));h===0?s=p:s=St(s,p),e.push(s)}for(let h=0;h<this.metricsTensors.length;++h){const d=this.metricsTensors[h][0],p=this.metricsTensors[h][1],m=Ze(d(a[p],u[p]));e.push(m)}return e})}async fit(t,e,s={}){if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;let r,a,i,l,u,h,d,p,m;try{const y=s.batchSize==null?32:s.batchSize;tx(y);const x=await this.standardizeUserData(t,e,s.sampleWeight,s.classWeight,!1,y);r=x[0],a=x[1],m=x[2];let v=!1,S;if(s.validationData!=null&&s.validationData.length>0){if(v=!0,s.validationData.length===2)u=s.validationData[0],h=s.validationData[1];else throw s.validationData.length===3?new Jt("validationData including sample weights is not supported yet."):new st(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${s.validationData} is invalid.`);const M=await this.standardizeUserData(u,h,null,null,!0,y);d=M[0],p=M[1],S=d.concat(p)}else if(s.validationSplit!=null&&s.validationSplit>0&&s.validationSplit<1){v=!0;const _=Math.floor(r[0].shape[0]*(1-s.validationSplit)),M=r[0].shape[0];d=Kc(r,_,M),i=r,r=Kc(r,0,_),p=Kc(a,_,M),l=a,a=Kc(a,0,_),S=d.concat(p)}else s.validationSteps!=null&&(v=!0);const C=r.concat(a).concat(m);this.checkTrainableWeightsConsistency();const $=this.makeTrainFunction(),T=this.getDedupedMetricsNames();let I,A;v?(this.makeTestFunction(),I=this.testFunction,A=T.slice().concat(T.map(_=>"val_"+_))):(I=null,S=[],A=T.slice());const R=PA(s.callbacks,s.yieldEvery);return await this.fitLoop($,C,T,y,s.epochs,s.verbose,R,I,S,s.shuffle,A,s.initialEpoch,null,null)}finally{this.isTraining=!1,Ar(r,t),Ar(a,e),Ar(i,t),Ar(l,e),Ar(d,u),Ar(p,h),m!=null&&se(m)}}async fitLoop(t,e,s,r,a,i,l,u,h,d,p,m,y,b){r==null&&(r=32),a==null&&(a=1),d==null&&(d=!0),m==null&&(m=0);let x=!1;if(u!=null&&h!=null&&(x=!0),b!=null&&(x=!0,y==null))throw new st("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const v=this.checkNumSamples(e,r,y,"steps_per_epoch");let S;v!=null&&(S=Br(0,v)),i==null&&(i=1);const{callbackList:C,history:$}=VA(l,i,a,m,v,y,r,x,p);C.setModel(this),this.history=$,await C.onTrainBegin(),this.stopTraining_=!1;for(let T=m;T<a;++T){await C.onEpochBegin(T);const I={};if(y!=null)throw new Jt("stepsPerEpoch mode is not implemented yet.");{if(d==="batch")throw new Jt("batch shuffling is not implemneted yet");d&&TM(S);const A=Un(S),R=ex(v,r);for(let L=0;L<R.length;++L){const _={};if(await C.onBatchBegin(L,_),at(()=>{const M=R[L][0],D=R[L][1],W=Eo(A,M,D-M);_.batch=L,_.size=D-M;const et=n1(e,W),nt=t(et);for(let tt=0;tt<s.length;++tt){const U=s[tt],Y=nt[tt];_[U]=Y,An(Y)}if(L===R.length-1&&x){const tt=this.testLoop(u,h,r);for(let U=0;U<s.length;++U){const Y=s[U],Z=tt[U];An(Z),I["val_"+Y]=Z}}}),await C.onBatchEnd(L,_),BA(_),this.stopTraining_)break}A.dispose()}if(await C.onEpochEnd(T,I),this.stopTraining_)break}return await C.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(t,e){return Eq(this,t,e)}async trainOnBatch(t,e){const s=await this.standardizeUserData(t,e),r=s[0],a=s[1],l=this.makeTrainFunction()(r.concat(a)),u=[];for(const h of l){const d=await h.data();u.push(d[0])}return se(l),Ar(s[0],t),Ar(s[1],e),ms(u)}getNamedWeights(t){const e=[],s=t!=null&&t.trainableOnly,r=s?this.trainableWeights:this.weights,a=this.getWeights(s);for(let i=0;i<r.length;++i)s&&!r[i].trainable||e.push({name:r[i].originalName,tensor:a[i]});return e}set stopTraining(t){this.stopTraining_=t}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(t){this.optimizer_!==t&&(this.optimizer_=t,this.isOptimizerOwned=!1)}dispose(){const t=super.dispose();if(t.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){const e=c2().numTensors;this.optimizer_.dispose(),t.numDisposedVariables+=e-c2().numTensors}return t}getLossIdentifiers(){let t;if(typeof this.loss=="string")t=Da(this.loss);else if(Array.isArray(this.loss)){for(const e of this.loss)if(typeof e!="string")throw new Error("Serialization of non-string loss is not supported.");t=this.loss.map(e=>Da(e))}else{const e=Object.keys(this.loss);t={};const s=this.loss;for(const r of e)if(typeof s[r]=="string")t[r]=Da(s[r]);else throw new Error("Serialization of non-string loss is not supported.")}return t}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[Da(up(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(t=>Da(up(t)));{const t={};for(const e in this.metrics)t[e]=Da(up(this.metrics[e]));return t}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(t){if(t.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(t.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(t.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");const e=t1(t.optimizer_config),s=Fa(e);let r;if(typeof t.loss=="string")r=wo(t.loss);else if(Array.isArray(t.loss))r=t.loss.map(i=>wo(i));else if(t.loss!=null){r={};for(const i in t.loss)r[i]=wo(t.loss[i])}let a;if(Array.isArray(t.metrics))a=t.metrics.map(i=>wo(i));else if(t.metrics!=null){a={};for(const i in t.metrics)a[i]=wo(t.metrics[i])}this.compile({loss:r,metrics:a,optimizer:s})}async save(t,e){if(typeof t=="string"){const h=cE(t);if(h.length===0)throw new st(`Cannot find any save handlers for URL '${t}'`);if(h.length>1)throw new st(`Found more than one (${h.length}) save handlers for URL '${t}'`);t=h[0]}if(t.save==null)throw new st("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const s=await zx(this.getNamedWeights(e)),l={modelTopology:this.toJSON(null,!1),format:zq,generatedBy:`TensorFlow.js tfjs-layers v${XA}`,convertedBy:null};if((e==null?!1:e.includeOptimizer)&&this.optimizer!=null){l.trainingConfig=this.getTrainingConfig();const h="optimizer",{data:d,specs:p}=await zx(await this.optimizer.getWeights(),h);s.specs.push(...p),s.data=oE([s.data,d])}return this.userDefinedMetadata!=null&&(j2(this.userDefinedMetadata,this.name,!0),l.userDefinedMetadata=this.userDefinedMetadata),l.weightData=s.data,l.weightSpecs=s.specs,t.save(l)}setUserDefinedMetadata(t){j2(t,this.name),this.userDefinedMetadata=t}getUserDefinedMetadata(){return this.userDefinedMetadata}}ou.className="Model";Tt(ou);class JA extends ou{}JA.className="Functional";Tt(JA);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class gh extends ou{constructor(t){if(super({inputs:[],outputs:[]}),t=t||{},this.trainable=!0,this.built=!1,this.name=t.name!=null?t.name:sy("sequential_"),t.layers!=null)for(const e of t.layers)this.add(e)}checkShape(t){if(t.inboundNodes[0].outputTensors[0].shape.some(s=>s<0))throw new st(`Negative dimension size caused by adding layer ${t.name} with input shape [${t.inboundNodes[0].inputTensors[0].shape}]`)}add(t){const e=t instanceof gh||t instanceof ou;let s;if(e){if(s=t,s.outputs.length!==1)throw new st("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(s.inputs.length!==1)throw new st("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(t.inboundNodes.length===0){if(t.batchInputShape==null)throw new st("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const r=M5({batchShape:t.batchInputShape,dtype:t.dtype,name:t.name+"_input"});t.apply(r)}if(e)this.outputs=s.outputs,this.inputs=s.inputs;else{if(t.inboundNodes.length!==1)throw new st(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${t.name} which has ${t.inboundNodes.length} pre-existing inbound connections.`);if(t.inboundNodes[0].outputTensors.length!==1)throw new st("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[t.inboundNodes[0].outputTensors[0]],this.inputs=_A(this.outputs[0])}this.inboundNodes=[],new ay({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:Wo(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(r=>r.shape),outputShapes:this.outputs[0].shape})}else{const r=t.apply(this.outputs[0]);if(Array.isArray(r))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[r],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(t),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const t=this.layers.length-1;this.layers[t].outboundNodes=[],this.outputs=[this.layers[t].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(t,e){return this.model==null&&this.build(),this.model.call(t,e)}build(t){if(ye(t),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new ou({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(t,e,s=console.log){this.built||this.build(),super.summary(t,e,s)}setWeights(t){this.model==null&&this.build(),this.model.setWeights(t)}evaluate(t,e,s={}){if(!this.built)throw new yr("The model needs to be compiled before being used.");return this.model.evaluate(t,e,s)}async evaluateDataset(t,e){if(!this.built)throw new yr("The model needs to be compiled before being used.");return this.model.evaluateDataset(t,e)}predict(t,e={}){return this.model==null&&this.build(),this.model.predict(t,e)}predictOnBatch(t){return this.model==null&&this.build(),this.model.predictOnBatch(t)}compile(t){this.build(),this.model.compile(t),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(t){this.model.optimizer=t}async fit(t,e,s={}){if(!this.built)throw new yr("The model needs to be compiled before being used.");return this.model.fit(t,e,s)}async fitDataset(t,e){if(!this.built)throw new yr("The model needs to be compiled before being used.");return this.model.fitDataset(t,e)}async trainOnBatch(t,e){return this.model.trainOnBatch(t,e)}static fromConfig(t,e,s={},r=!1){let a,i={};if(e instanceof Array){if(e[0].className==null||e[0].className==="Merge")throw new st("Legacy serialization format not supported yet.");a=e}else F(e.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),a=e.layers,delete e.layers,i=e;const l=new t(i);if(!(l instanceof gh))throw new Jt(`Sequential.fromConfig called on non-Sequential input: ${l}`);for(const u of a){const d=Fa(u,void 0,r);r&&d.setFastWeightInitDuringBuild(!0),l.add(d)}return l}set stopTraining(t){if(this.model==null)throw new st("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=t}get stopTraining(){if(this.model==null)throw new st("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const t=[];for(const e of this.layers){const s={};s.className=e.getClassName(),s.config=e.getConfig(),t.push(s)}return{name:this.name,layers:t}}}gh.className="Sequential";Tt(gh);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let es=class extends Lu{getConfig(){return{}}};class tR extends es{apply(t,e=1){return S5(t,e)}}tR.className="elu";Tt(tR);class eR extends es{apply(t){return uw(t)}}eR.className="selu";Tt(eR);class nR extends es{apply(t){return ca(t)}}nR.className="relu";Tt(nR);class sR extends es{apply(t){return at(()=>Uo(6,ca(t)))}}sR.className="relu6";Tt(sR);class rR extends es{apply(t){return t}}rR.className="linear";Tt(rR);class aR extends es{apply(t){return Fr(t)}}aR.className="sigmoid";Tt(aR);class iR extends es{apply(t){return N5(t)}}iR.className="hardSigmoid";Tt(iR);class oR extends es{apply(t){return Ou(t)}}oR.className="softplus";Tt(oR);class lR extends es{apply(t){return C5(t)}}lR.className="softsign";Tt(lR);class uR extends es{apply(t){return Vo(t)}}uR.className="tanh";Tt(uR);let mS=class extends es{apply(t,e=-1){return jg(t,e)}};mS.className="softmax";Tt(mS);class cR extends es{apply(t,e=-1){return tw(t,e)}}cR.className="logSoftmax";Tt(cR);class hR extends es{apply(t){return at(()=>at(()=>{const e=Math.sqrt(2),s=X(.5,St(1,Zv(_t(t,e))));return X(t,s)}))}}hR.className="gelu";Tt(hR);class dR extends es{apply(t){return at(()=>X(.5,X(t,St(1,Vo(X(Wn(_t(2,Math.PI)),St(t,X(.044715,La(t,3)))))))))}}dR.className="gelu_new";Tt(dR);class fR extends es{apply(t){return at(()=>X(t,Vo(Ou(t))))}}fR.className="mish";Tt(fR);class pR extends es{apply(t,e=1){return at(()=>X(Fr(X(t,e)),t))}}pR.className="swish";Tt(pR);function Oi(n){return n.getClassName()}function nx(n,t={}){return Dd(n,mr.getMap().classNameMap,t,"activation")}function _i(n){if(n==null){const t={};return t.className="linear",t.config={},nx(t)}if(typeof n=="string"){const t={};return t.className=n,t.config={},nx(t)}else return n instanceof es?n:nx(n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Mq(n){if(n!=null&&typeof n!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${n}`)}class mR extends Lu{}class gR extends mR{constructor(t){super(),Mq(t),this.l1=t==null||t.l1==null?.01:t.l1,this.l2=t==null||t.l2==null?.01:t.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(t){return at(()=>{let e=vn([1]);return this.hasL1&&(e=St(e,Ft(X(this.l1,bn(t))))),this.hasL2&&(e=St(e,Ft(X(this.l2,Rd(t))))),J(e,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(t,e){return new t({l1:e.l1,l2:e.l2})}}gR.className="L1L2";Tt(gR);const Q2={l1l2:"L1L2"};function Re(n){return eS(n)}function J2(n,t={}){return Dd(n,mr.getMap().classNameMap,t,"regularizer")}function Ge(n){if(n==null)return null;if(typeof n=="string"){const e={className:n in Q2?Q2[n]:n,config:{}};return J2(e)}else return n instanceof mR?n:J2(n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class yR extends ae{constructor(t){super(t??{}),this.supportsMasking=!0,t!=null&&(this.maxValue=t.maxValue)}call(t,e){t=Wt(t);let s=ca(t);return this.maxValue!=null&&(s=_s(s,0,this.maxValue)),s}computeOutputShape(t){return t}getConfig(){const t={maxValue:this.maxValue},e=super.getConfig();return Object.assign(t,e),t}}yR.className="ReLU";Tt(yR);class bR extends ae{constructor(t){super(t??{}),this.DEFAULT_ALPHA=.3,t==null&&(t={}),this.alpha=t.alpha==null?this.DEFAULT_ALPHA:t.alpha}call(t,e){const s=Wt(t);return Fg(s,this.alpha)}computeOutputShape(t){return t}getConfig(){const t={alpha:this.alpha},e=super.getConfig();return Object.assign(t,e),t}}bR.className="LeakyReLU";Tt(bR);class xR extends ae{constructor(t){if(super(t??{}),this.DEFAULT_ALPHA_INITIALIZER="zeros",t==null&&(t={}),this.supportsMasking=!0,this.alphaInitializer=Ue(t.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=Ge(t.alphaRegularizer),this.alphaConstraint=Tn(t.alphaConstraint),t.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(t.sharedAxes))this.sharedAxes=t.sharedAxes;else if(typeof t.sharedAxes=="number")this.sharedAxes=[t.sharedAxes];else throw new st(`Expected sharedAxes to be a number or an array of numbers, but got ${t.sharedAxes}`)}build(t){t=ye(t);const e=t.slice(1);if(this.sharedAxes!=null)for(const r of this.sharedAxes)e[r-1]=1;this.alpha=this.addWeight("alpha",e,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const s={};if(this.sharedAxes!=null)for(let r=1;r<t.length;++r)s[r]=t[r];this.inputSpec=[new Sn({ndim:t.length,axes:s})],this.built=!0}call(t,e){return t=Wt(t),Ug(t,this.alpha.read())}getConfig(){const t={alphaInitializer:je(this.alphaInitializer),alphaRegularizer:Re(this.alphaRegularizer),alphaConstraint:Nn(this.alphaConstraint),sharedAxes:this.sharedAxes},e=super.getConfig();return Object.assign(t,e),t}}xR.className="PReLU";Tt(xR);let vR=class extends ae{constructor(t){if(super(t??{}),this.DEFAULT_ALPHA=1,t==null&&(t={}),t.alpha!=null&&t.alpha!==this.DEFAULT_ALPHA)throw new Jt(`Non-default alpha value (${t.alpha}) is not supported by the ELU layer yet.`);this.alpha=t.alpha==null?this.DEFAULT_ALPHA:t.alpha}call(t,e){const s=Wt(t);return Cd(s)}computeOutputShape(t){return t}getConfig(){const t={alpha:this.alpha},e=super.getConfig();return Object.assign(t,e),t}};vR.className="ELU";Tt(vR);class wR extends ae{constructor(t){super(t??{}),this.DEFAULT_THETA=1,t==null&&(t={}),this.theta=t.theta==null?this.DEFAULT_THETA:t.theta}call(t,e){const s=Wt(t);return X(s,kt(Ps(s,this.theta),"float32"))}computeOutputShape(t){return t}getConfig(){const t={theta:this.theta},e=super.getConfig();return Object.assign(t,e),t}}wR.className="ThresholdedReLU";Tt(wR);class SR extends ae{constructor(t){super(t??{}),this.DEFAULT_AXIS=1,t==null&&(t={}),this.softmax=new mS().apply,this.axis=t.axis==null?this.DEFAULT_AXIS:t.axis}call(t,e){return at(()=>{let s=Wt(t);const r=e.mask;if(r!=null){const a=X(Rt(Is(s.shape),kt(r,s.dtype)),Vt(-1e9));s=St(s,a)}return this.axis instanceof Array?this.axis.length>1?Fs(Rt(s,zg(s,this.axis,!0))):this.softmax(s,this.axis[0]):this.softmax(s,this.axis)})}computeOutputShape(t){return t}getConfig(){const t={axis:this.axis},e=super.getConfig();return Object.assign(t,e),t}}SR.className="Softmax";Tt(SR);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function lu(n,t,e){if(typeof n=="number")return Wo(n,t);if(n.length!==t)throw new st(`The ${e} argument must be an integer or tuple of ${t} integers. Received: ${n.length} elements.`);for(let s=0;s<t;++s){const r=n[s];if(!b5(r))throw new st(`The ${e} argument must be an integer or tuple of ${t} integers. Received: ${JSON.stringify(n)} including a non-integer number ${r}`)}return n}function Lr(n,t,e,s,r=1){if(n==null)return n;const a=t+(t-1)*(r-1);let i;return e==="same"?i=n:i=n-a+1,Math.floor((i+s-1)/s)}function ta(n,t,e,s){if(n==null)return null;if(s==="valid")n=n*t+Ri([e-t,0]);else if(s==="same")n=n*t;else throw new st(`Unsupport padding mode: ${s}.`);return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function gS(n,t){return at(()=>(un(t),t==="channelsFirst"?fe(n,[0,2,3,1]):n))}function CR(n,t){return at(()=>(un(t),t==="channelsFirst"?fe(n,[0,2,3,4,1]):n))}function Bq(n,t,e,s=1,r="valid",a,i=1){return at(()=>{if(a==null&&(a=Pr()),un(a),n.shape.length!==3)throw new st(`The input of a conv1dWithBias operation should be 3, but is ${n.shape.length} instead.`);if(t.shape.length!==3)throw new st(`The kernel for a conv1dWithBias operation should be 3, but is ${t.shape.length} instead`);if(e!=null&&e.shape.length!==1)throw new st(`The bias for a conv1dWithBias operation should be 1, but is ${e.shape.length} instead`);if(a==="channelsFirst"&&(n=fe(n,[0,2,1])),r==="causal")throw new Jt("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let l=jv(n,t,s,r==="same"?"same":"valid","NWC",i);return e!=null&&(l=Gr(l,e)),l})}function tk(n,t,e,s=[1,1],r="valid",a,i,l=null){return at(()=>{if(a==null&&(a=Pr()),un(a),n.rank!==3&&n.rank!==4)throw new st(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${n.rank}.`);if(t.rank!==3&&t.rank!==4)throw new st(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${n.rank}.`);let u=gS(n,a);if(r==="causal")throw new Jt("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return u=gD({x:u,filter:t,strides:s,pad:r==="same"?"same":"valid",dilations:i,dataFormat:"NHWC",bias:e,activation:l}),a==="channelsFirst"&&(u=fe(u,[0,3,1,2])),u})}function Pq(n,t,e,s=[1,1,1],r="valid",a,i){return at(()=>{if(a==null&&(a=Pr()),un(a),n.rank!==4&&n.rank!==5)throw new st(`conv3dWithBias expects input to be of rank 4 or 5, but received ${n.rank}.`);if(t.rank!==4&&t.rank!==5)throw new st(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${n.rank}.`);let l=CR(n,a);if(r==="causal")throw new Jt("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return l=LE(l,t,s,r==="same"?"same":"valid","NDHWC",i),e!=null&&(l=Gr(l,e)),a==="channelsFirst"&&(l=fe(l,[0,4,1,2,3])),l})}class ly extends ae{constructor(t,e){if(super(e),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",ly.verifyArgs(e),this.rank=t,Rn(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new Jt(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=lu(e.kernelSize,t,"kernelSize"),this.strides=lu(e.strides==null?1:e.strides,t,"strides"),this.padding=e.padding==null?"valid":e.padding,er(this.padding),this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,un(this.dataFormat),this.activation=_i(e.activation),this.useBias=e.useBias==null?!0:e.useBias,this.biasInitializer=Ue(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=Tn(e.biasConstraint),this.biasRegularizer=Ge(e.biasRegularizer),this.activityRegularizer=Ge(e.activityRegularizer),this.dilationRate=lu(e.dilationRate==null?1:e.dilationRate,t,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new st(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new st(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new st(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(t){if(Jr("kernelSize"in t,"required key 'kernelSize' not in config"),typeof t.kernelSize!="number"&&!nS(t.kernelSize,"number",1,3))throw new st(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(t.kernelSize)}.`)}getConfig(){const t={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:Oi(this.activation),useBias:this.useBias,biasInitializer:je(this.biasInitializer),biasRegularizer:Re(this.biasRegularizer),activityRegularizer:Re(this.activityRegularizer),biasConstraint:Nn(this.biasConstraint)},e=super.getConfig();return Object.assign(t,e),t}}class zu extends ly{constructor(t,e){super(t,e),this.kernel=null,zu.verifyArgs(e),this.filters=e.filters,Rn(this.filters,"filters"),this.kernelInitializer=Ue(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=Tn(e.kernelConstraint),this.kernelRegularizer=Ge(e.kernelRegularizer)}build(t){t=ye(t);const e=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[e]==null)throw new st(`The channel dimension of the input should be defined. Found ${t[e]}`);const s=t[e],r=this.kernelSize.concat([s,this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[e]:s}}],this.built=!0}call(t,e){return at(()=>{t=Wt(t);let s;const r=this.bias==null?null:this.bias.read(),a=xA(this.activation.getClassName());if(a!=null&&this.rank===2)s=tk(t,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate,a);else{if(this.rank===1)s=Bq(t,this.kernel.read(),r,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)s=tk(t,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)s=Pq(t,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new Jt("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(s=this.activation.apply(s))}return s})}computeOutputShape(t){t=ye(t);const e=[],s=this.dataFormat==="channelsLast"?t.slice(1,t.length-1):t.slice(2);for(let a=0;a<s.length;++a){const i=Lr(s[a],this.kernelSize[a],this.padding,this.strides[a],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[a]);e.push(i)}let r=[t[0]];return this.dataFormat==="channelsLast"?(r=r.concat(e),r.push(this.filters)):(r.push(this.filters),r=r.concat(e)),r}getConfig(){const t={filters:this.filters,kernelInitializer:je(this.kernelInitializer),kernelRegularizer:Re(this.kernelRegularizer),kernelConstraint:Nn(this.kernelConstraint)},e=super.getConfig();return Object.assign(t,e),t}static verifyArgs(t){if(!("filters"in t)||typeof t.filters!="number"||t.filters<1)throw new st(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(t.filters)}`)}}class Ld extends zu{constructor(t){super(2,t),Ld.verifyArgs(t)}getConfig(){const t=super.getConfig();return delete t.rank,t}static verifyArgs(t){if(typeof t.kernelSize!="number"&&!nS(t.kernelSize,"number",1,2))throw new st(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(t.kernelSize)}.`)}}Ld.className="Conv2D";Tt(Ld);class zd extends zu{constructor(t){super(3,t),zd.verifyArgs(t)}getConfig(){const t=super.getConfig();return delete t.rank,t}static verifyArgs(t){if(typeof t.kernelSize!="number"&&!(Array.isArray(t.kernelSize)&&(t.kernelSize.length===1||t.kernelSize.length===3)))throw new st(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(t.kernelSize)}.`)}}zd.className="Conv3D";Tt(zd);class NR extends Ld{constructor(t){if(super(t),this.inputSpec=[new Sn({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new st(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(t){if(t=ye(t),t.length!==4)throw new st("Input should have rank 4; Received input shape: "+JSON.stringify(t));const e=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[e]==null)throw new st("The channel dimension of the inputs should be defined. Found `None`.");const s=t[e],r=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Sn({ndim:4,axes:{[e]:s}})],this.built=!0}call(t,e){return at(()=>{let s=Wt(t);if(s.shape.length!==4)throw new st(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const r=s.shape,a=r[0];let i,l;this.dataFormat==="channelsFirst"?(i=2,l=3):(i=1,l=2);const u=r[i],h=r[l],d=this.kernelSize[0],p=this.kernelSize[1],m=this.strides[0],y=this.strides[1],b=ta(u,m,d,this.padding),x=ta(h,y,p,this.padding),v=[a,b,x,this.filters];this.dataFormat!=="channelsLast"&&(s=fe(s,[0,2,3,1]));let S=Xv(s,this.kernel.read(),v,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(S=fe(S,[0,3,1,2])),this.bias!=null&&(S=Gr(S,this.bias.read(),this.dataFormat)),this.activation!=null&&(S=this.activation.apply(S)),S})}computeOutputShape(t){t=ye(t);const e=t.slice();let s,r,a;this.dataFormat==="channelsFirst"?(s=1,r=2,a=3):(s=3,r=1,a=2);const i=this.kernelSize[0],l=this.kernelSize[1],u=this.strides[0],h=this.strides[1];return e[s]=this.filters,e[r]=ta(e[r],u,i,this.padding),e[a]=ta(e[a],h,l,this.padding),e}getConfig(){const t=super.getConfig();return delete t.dilationRate,t}}NR.className="Conv2DTranspose";Tt(NR);class TR extends zd{constructor(t){if(super(t),this.inputSpec=[new Sn({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new st(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(t){if(t=ye(t),t.length!==5)throw new st("Input should have rank 5; Received input shape: "+JSON.stringify(t));const e=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[e]==null)throw new st("The channel dimension of the inputs should be defined. Found `None`.");const s=t[e],r=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Sn({ndim:5,axes:{[e]:s}})],this.built=!0}call(t,e){return at(()=>{let s=Wt(t);if(s.shape.length!==5)throw new st(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const r=s.shape,a=r[0];let i,l,u;this.dataFormat==="channelsFirst"?(u=2,i=3,l=4):(u=1,i=2,l=3);const h=r[u],d=r[i],p=r[l],m=this.kernelSize[0],y=this.kernelSize[1],b=this.kernelSize[2],x=this.strides[0],v=this.strides[1],S=this.strides[2],C=ta(h,x,m,this.padding),$=ta(d,v,y,this.padding),T=ta(p,S,b,this.padding),I=[a,C,$,T,this.filters];this.dataFormat!=="channelsLast"&&(s=fe(s,[0,2,3,4,1]));let A=ME(s,this.kernel.read(),I,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(A=fe(A,[0,4,1,2,3])),this.bias!==null&&(A=Gr(A,this.bias.read(),this.dataFormat)),this.activation!==null&&(A=this.activation.apply(A)),A})}computeOutputShape(t){t=ye(t);const e=t.slice();let s,r,a,i;this.dataFormat==="channelsFirst"?(s=1,r=2,a=3,i=4):(s=4,r=1,a=2,i=3);const l=this.kernelSize[0],u=this.kernelSize[1],h=this.kernelSize[2],d=this.strides[0],p=this.strides[1],m=this.strides[2];return e[s]=this.filters,e[r]=ta(e[r],d,l,this.padding),e[a]=ta(e[a],p,u,this.padding),e[i]=ta(e[i],m,h,this.padding),e}getConfig(){const t=super.getConfig();return delete t.dilationRate,t}}TR.className="Conv3DTranspose";Tt(TR);class $R extends zu{constructor(t,e){if(super(t,e),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,e.filters==null)throw new st("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(e.kernelInitializer!=null||e.kernelRegularizer!=null||e.kernelConstraint!=null)throw new st("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(e.padding!=null&&e.padding!=="same"&&e.padding!=="valid")throw new st(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(e.padding)}`);this.depthMultiplier=e.depthMultiplier==null?1:e.depthMultiplier,this.depthwiseInitializer=Ue(e.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=Ge(e.depthwiseRegularizer),this.depthwiseConstraint=Tn(e.depthwiseConstraint),this.pointwiseInitializer=Ue(e.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=Ge(e.pointwiseRegularizer),this.pointwiseConstraint=Tn(e.pointwiseConstraint)}build(t){if(t=ye(t),t.length<this.rank+2)throw new st(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(t)}`);const e=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[e]==null||t[e]<0)throw new st(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(t[e])}`);const s=t[e],r=this.kernelSize.concat([s,this.depthMultiplier]),a=[];for(let l=0;l<this.rank;++l)a.push(1);a.push(s*this.depthMultiplier,this.filters);const i=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",r,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,i,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",a,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,i,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,i,this.biasConstraint):this.bias=null,this.inputSpec=[new Sn({ndim:this.rank+2,axes:{[e]:s}})],this.built=!0}call(t,e){return at(()=>{t=Wt(t);let s;if(this.rank===1)throw new Jt("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(t=fe(t,[0,2,3,1])),s=cw(t,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(s=Gr(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),this.dataFormat==="channelsFirst"&&(s=fe(s,[0,3,1,2])),s})}getConfig(){const t=super.getConfig();return delete t.rank,delete t.kernelInitializer,delete t.kernelRegularizer,delete t.kernelConstraint,t.depthwiseInitializer=je(this.depthwiseInitializer),t.pointwiseInitializer=je(this.pointwiseInitializer),t.depthwiseRegularizer=Re(this.depthwiseRegularizer),t.pointwiseRegularizer=Re(this.pointwiseRegularizer),t.depthwiseConstraint=Nn(this.depthwiseConstraint),t.pointwiseConstraint=Nn(this.pointwiseConstraint),t}}$R.className="SeparableConv";class kR extends $R{constructor(t){super(2,t)}}kR.className="SeparableConv2D";Tt(kR);class uy extends zu{constructor(t){super(1,t),uy.verifyArgs(t),this.inputSpec=[{ndim:3}]}getConfig(){const t=super.getConfig();return delete t.rank,delete t.dataFormat,t}static verifyArgs(t){if(typeof t.kernelSize!="number"&&!nS(t.kernelSize,"number",1,1))throw new st(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(t.kernelSize)}.`)}}uy.className="Conv1D";Tt(uy);class IR extends ae{constructor(t){super(t),typeof t.cropping=="number"?this.cropping=[[t.cropping,t.cropping],[t.cropping,t.cropping]]:typeof t.cropping[0]=="number"?this.cropping=[[t.cropping[0],t.cropping[0]],[t.cropping[1],t.cropping[1]]]:this.cropping=t.cropping,this.dataFormat=t.dataFormat===void 0?"channelsLast":t.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(t){return this.dataFormat==="channelsFirst"?[t[0],t[1],t[2]-this.cropping[0][0]-this.cropping[0][1],t[3]-this.cropping[1][0]-this.cropping[1][1]]:[t[0],t[1]-this.cropping[0][0]-this.cropping[0][1],t[2]-this.cropping[1][0]-this.cropping[1][1],t[3]]}call(t,e){return at(()=>{if(t=Wt(t),this.dataFormat==="channelsLast"){const s=lp(t,this.cropping[0][0],t.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return lp(s,this.cropping[1][0],t.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{const s=lp(t,this.cropping[0][0],t.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return lp(s,this.cropping[1][0],t.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const t={cropping:this.cropping,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}IR.className="Cropping2D";Tt(IR);class ER extends ae{constructor(t){super(t),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=t.size==null?this.DEFAULT_SIZE:t.size,this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,un(this.dataFormat),this.interpolation=t.interpolation==null?"nearest":t.interpolation,m5(this.interpolation)}computeOutputShape(t){if(this.dataFormat==="channelsFirst"){const e=t[2]==null?null:this.size[0]*t[2],s=t[3]==null?null:this.size[1]*t[3];return[t[0],t[1],e,s]}else{const e=t[1]==null?null:this.size[0]*t[1],s=t[2]==null?null:this.size[1]*t[2];return[t[0],e,s,t[3]]}}call(t,e){return at(()=>{let s=Wt(t);const r=s.shape;if(this.dataFormat==="channelsFirst"){s=fe(s,[0,2,3,1]);const a=this.size[0]*r[2],i=this.size[1]*r[3],l=this.interpolation==="nearest"?Es.resizeNearestNeighbor(s,[a,i]):Es.resizeBilinear(s,[a,i]);return fe(l,[0,3,1,2])}else{const a=this.size[0]*r[1],i=this.size[1]*r[2];return this.interpolation==="nearest"?Es.resizeNearestNeighbor(s,[a,i]):Es.resizeBilinear(s,[a,i])}})}getConfig(){const t={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},e=super.getConfig();return Object.assign(t,e),t}}ER.className="UpSampling2D";Tt(ER);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Vq(n,t,e=[1,1],s="valid",r,a){return at(()=>{r==null&&(r=Pr()),un(r);let i=gS(n,r);if(n.rank!==4)throw new st(`Input for depthwiseConv2d is required to be 4-D, but is instead ${n.rank}-D`);if(t.rank!==4)throw new st(`depthwiseKernel is required to be 4-D, but is instead ${t.rank}-D`);return i=Sd(i,t,e,s==="same"?"same":"valid","NHWC",a),r==="channelsFirst"&&(i=fe(i,[0,3,1,2])),i})}class DR extends ly{constructor(t){super(2,t),this.depthwiseKernel=null,this.depthMultiplier=t.depthMultiplier==null?1:t.depthMultiplier,this.depthwiseInitializer=Ue(t.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=Tn(t.depthwiseConstraint),this.depthwiseRegularizer=Ge(t.depthwiseRegularizer)}build(t){if(t=ye(t),t.length<4)throw new st(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(t)}.`);const e=this.dataFormat==="channelsFirst"?1:3;if(t[e]==null||t[e]<0)throw new st(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${t[e]}).`);const s=t[e],r=[this.kernelSize[0],this.kernelSize[1],s,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",r,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[s*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,e){return at(()=>{t=Wt(t);let s=Vq(t,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(s=Gr(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),s})}computeOutputShape(t){t=ye(t);const e=this.dataFormat==="channelsFirst"?t[2]:t[1],s=this.dataFormat==="channelsFirst"?t[3]:t[2],r=this.dataFormat==="channelsFirst"?t[1]*this.depthMultiplier:t[3]*this.depthMultiplier,a=Lr(e,this.kernelSize[0],this.padding,this.strides[0]),i=Lr(s,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[t[0],r,a,i]:[t[0],a,i,r]}getConfig(){const t=super.getConfig();return t.depthMultiplier=this.depthMultiplier,t.depthwiseInitializer=je(this.depthwiseInitializer),t.depthwiseRegularizer=Re(this.depthwiseRegularizer),t.depthwiseConstraint=Nn(this.depthwiseRegularizer),t}}DR.className="DepthwiseConv2D";Tt(DR);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function AR(n,t,e,s){if(Array.isArray(n)){if(t!=null||e!=null)throw new st("When inputs is an array, neither initialState or constants should be provided");s!=null&&(e=n.slice(n.length-s,n.length),n=n.slice(0,n.length-s)),n.length>1&&(t=n.slice(1,n.length)),n=n[0]}function r(a){return a==null||Array.isArray(a)?a:[a]}return t=r(t),e=r(e),{inputs:n,initialState:t,constants:e}}function RR(n,t,e,s=!1,r,a,i=!1,l=!1){return at(()=>{const u=t.shape.length;if(u<3)throw new st(`Input should be at least 3D, but is ${u}D.`);const h=[1,0].concat(Br(2,u));t=fe(t,h),i&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),r!=null&&(r=kt(kt(r,"bool"),"float32"),r.rank===u-1&&(r=Qn(r,-1)),r=fe(r,h)),s&&(t=Sr(t,0),r!=null&&(r=Sr(r,0)));const d=[];let p,m=e;const y=t.shape[0],b=Cr(t);let x;r!=null&&(x=Cr(r));for(let S=0;S<y;++S){const C=b[S],$=at(()=>n(C,m));if(r==null)p=$[0],m=$[1];else{const T=at(()=>{const I=x[S],A=Rt(Js(I),I),R=St(X($[0],I),X(m[0],A)),L=m.map((_,M)=>St(X($[1][M],I),X(_,A)));return{output:R,newStates:L}});p=T.output,m=T.newStates}l&&d.push(p)}let v;return l&&(v=Ls(d,1)),[p,v,m]})}class Xi extends ae{constructor(t){super(t);let e;if(t.cell==null)throw new st("cell property is missing for the constructor of RNN.");if(Array.isArray(t.cell)?e=new xS({cells:t.cell}):e=t.cell,e.stateSize==null)throw new st("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=e,this.returnSequences=t.returnSequences==null?!1:t.returnSequences,this.returnState=t.returnState==null?!1:t.returnState,this.goBackwards=t.goBackwards==null?!1:t.goBackwards,this._stateful=t.stateful==null?!1:t.stateful,this.unroll=t.unroll==null?!1:t.unroll,this.supportsMasking=!0,this.inputSpec=[new Sn({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){const t=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return Br(0,t).map(e=>null)}else return this.states_}setStates(t){this.states_=t}computeOutputShape(t){Zx(t)&&(t=t[0]),t=t;let e=this.cell.stateSize;Array.isArray(e)||(e=[e]);const s=e[0];let r;if(this.returnSequences?r=[t[0],t[1],s]:r=[t[0],s],this.returnState){const a=[];for(const i of e)a.push([t[0],i]);return[r].concat(a)}else return r}computeMask(t,e){return at(()=>{Array.isArray(e)&&(e=e[0]);const s=this.returnSequences?e:null;if(this.returnState){const r=this.states.map(a=>null);return[s].concat(r)}else return s})}get states(){if(this.states_==null){const t=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,e=[];for(let s=0;s<t;++s)e.push(null);return e}else return this.states_}set states(t){this.states_=t}build(t){if(this.numConstants!=null)throw new Jt("Constants support is not implemented in RNN yet.");Zx(t)&&(t=t[0]),t=t;const e=this.stateful?t[0]:null,s=t.slice(2);this.inputSpec[0]=new Sn({shape:[e,null,...s]});const r=[t[0]].concat(t.slice(2));this.cell.build(r);let a;if(Array.isArray(this.cell.stateSize)?a=this.cell.stateSize:a=[this.cell.stateSize],this.stateSpec!=null){if(!de(this.stateSpec.map(i=>i.shape[i.shape.length-1]),a))throw new st(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=a.map(i=>new Sn({shape:[null,i]}));this.stateful&&this.resetStates()}resetStates(t,e=!1){at(()=>{if(!this.stateful)throw new Qr("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape[0];if(s==null)throw new st("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(r=>vn([s,r])):this.states_=[vn([s,this.cell.stateSize])];else if(t==null)se(this.states_),this.keptStates!=null&&(se(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(r=>vn([s,r])):this.states_[0]=vn([s,this.cell.stateSize]);else{if(Array.isArray(t)||(t=[t]),t.length!==this.states_.length)throw new st(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${t.length} state value(s). Input received: ${t}`);e===!0?this.keptStates.push(this.states_.slice()):se(this.states_);for(let r=0;r<this.states_.length;++r){const a=t[r],i=Array.isArray(this.cell.stateSize)?this.cell.stateSize[r]:this.cell.stateSize,l=[s,i];if(!de(a.shape,l))throw new st(`State ${r} is incompatible with layer ${this.name}: expected shape=${l}, received shape=${a.shape}`);this.states_[r]=a}}this.states_=this.states_.map(r=>An(r.clone()))})}apply(t,e){let s=e==null?null:e.initialState,r=e==null?null:e.constants;e==null&&(e={});const a=AR(t,s,r,this.numConstants);t=a.inputs,s=a.initialState,r=a.constants;let i=[],l=[];if(s!=null){e.initialState=s,i=i.concat(s),this.stateSpec=[];for(const h of s)this.stateSpec.push(new Sn({shape:h.shape}));l=l.concat(this.stateSpec)}if(r!=null&&(e.constants=r,i=i.concat(r),this.numConstants=r.length),i[0]instanceof la){const h=[t].concat(i),d=this.inputSpec.concat(l),p=this.inputSpec;this.inputSpec=d;const m=super.apply(h,e);return this.inputSpec=p,m}else return super.apply(t,e)}call(t,e){return at(()=>{const s=e==null?null:e.mask,r=e==null?null:e.training;let a=e==null?null:e.initialState;t=Wt(t),a==null&&(this.stateful?a=this.states_:a=this.getInitialState(t));const i=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(a.length!==i)throw new st(`RNN Layer has ${i} state(s) but was passed ${a.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const l={training:r},h=RR((b,x)=>{const v=this.cell.call([b].concat(x),l);return[v[0],v.slice(1)]},t,a,this.goBackwards,s,null,this.unroll,this.returnSequences),d=h[0],p=h[1],m=h[2];this.stateful&&this.resetStates(m,r);const y=this.returnSequences?p:d;return this.returnState?[y].concat(m):y})}getInitialState(t){return at(()=>{let e=vn(t.shape);return e=Ft(e,[1,2]),e=Ad(e),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(s=>s>1?Kx(e,[1,s]):e):this.cell.stateSize>1?[Kx(e,[1,this.cell.stateSize])]:[e]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(t)}getConfig(){const t=super.getConfig(),e={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(e.numConstants=this.numConstants);const s=this.cell.getConfig();return this.getClassName()===Xi.className&&(e.cell={className:this.cell.getClassName(),config:s}),Object.assign(Object.assign(Object.assign({},s),t),e)}static fromConfig(t,e,s={}){const r=e.cell,a=Fa(r,s);return new t(Object.assign(e,{cell:a}))}}Xi.className="RNN";Tt(Xi);class cy extends ae{}class yS extends cy{constructor(t){super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=t.units,Rn(this.units,"units"),this.activation=_i(t.activation==null?this.DEFAULT_ACTIVATION:t.activation),this.useBias=t.useBias==null?!0:t.useBias,this.kernelInitializer=Ue(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Ue(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Ue(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Ge(t.kernelRegularizer),this.recurrentRegularizer=Ge(t.recurrentRegularizer),this.biasRegularizer=Ge(t.biasRegularizer),this.kernelConstraint=Tn(t.kernelConstraint),this.recurrentConstraint=Tn(t.recurrentConstraint),this.biasConstraint=Tn(t.biasConstraint),this.dropout=mu([1,Ri([0,t.dropout==null?0:t.dropout])]),this.recurrentDropout=mu([1,Ri([0,t.recurrentDropout==null?0:t.recurrentDropout])]),this.dropoutFunc=t.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){t=ye(t),this.kernel=this.addWeight("kernel",[t[t.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,e){return at(()=>{if(t=t,t.length!==2)throw new st(`SimpleRNNCell expects 2 input Tensors, got ${t.length}.`);let s=t[1];t=t[0];const r=e.training==null?!1:e.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Fi({ones:()=>Js(t),rate:this.dropout,training:r,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Fi({ones:()=>Js(s),rate:this.recurrentDropout,training:r,dropoutFunc:this.dropoutFunc}));let a;const i=this.dropoutMask,l=this.recurrentDropoutMask;i!=null?a=ia(X(t,i),this.kernel.read()):a=ia(t,this.kernel.read()),this.bias!=null&&(a=Gr(a,this.bias.read())),l!=null&&(s=X(s,l));let u=St(a,ia(s,this.recurrentKernel.read()));return this.activation!=null&&(u=this.activation.apply(u)),[u,u]})}getConfig(){const t=super.getConfig(),e={units:this.units,activation:Oi(this.activation),useBias:this.useBias,kernelInitializer:je(this.kernelInitializer),recurrentInitializer:je(this.recurrentInitializer),biasInitializer:je(this.biasInitializer),kernelRegularizer:Re(this.kernelRegularizer),recurrentRegularizer:Re(this.recurrentRegularizer),biasRegularizer:Re(this.biasRegularizer),activityRegularizer:Re(this.activityRegularizer),kernelConstraint:Nn(this.kernelConstraint),recurrentConstraint:Nn(this.recurrentConstraint),biasConstraint:Nn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},t),e)}}yS.className="SimpleRNNCell";Tt(yS);class OR extends Xi{constructor(t){t.cell=new yS(t),super(t)}call(t,e){return at(()=>{this.cell.dropoutMask!=null&&(se(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(se(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=e==null?null:e.mask,r=e==null?null:e.training,a=e==null?null:e.initialState;return super.call(t,{mask:s,training:r,initialState:a})})}static fromConfig(t,e){return new t(e)}}OR.className="SimpleRNN";Tt(OR);class bS extends cy{constructor(t){if(super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",t.resetAfter)throw new st("GRUCell does not support reset_after parameter set to true.");this.units=t.units,Rn(this.units,"units"),this.activation=_i(t.activation===void 0?this.DEFAULT_ACTIVATION:t.activation),this.recurrentActivation=_i(t.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:t.recurrentActivation),this.useBias=t.useBias==null?!0:t.useBias,this.kernelInitializer=Ue(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Ue(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Ue(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Ge(t.kernelRegularizer),this.recurrentRegularizer=Ge(t.recurrentRegularizer),this.biasRegularizer=Ge(t.biasRegularizer),this.kernelConstraint=Tn(t.kernelConstraint),this.recurrentConstraint=Tn(t.recurrentConstraint),this.biasConstraint=Tn(t.biasConstraint),this.dropout=mu([1,Ri([0,t.dropout==null?0:t.dropout])]),this.recurrentDropout=mu([1,Ri([0,t.recurrentDropout==null?0:t.recurrentDropout])]),this.dropoutFunc=t.dropoutFunc,this.implementation=t.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){t=ye(t);const e=t[t.length-1];this.kernel=this.addWeight("kernel",[e,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,e){return at(()=>{if(t=t,t.length!==2)throw new st(`GRUCell expects 2 input Tensors (inputs, h, c), got ${t.length}.`);const s=e.training==null?!1:e.training;let r=t[1];t=t[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Fi({ones:()=>Js(t),rate:this.dropout,training:s,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Fi({ones:()=>Js(r),rate:this.recurrentDropout,training:s,count:3,dropoutFunc:this.dropoutFunc}));const a=this.dropoutMask,i=this.recurrentDropoutMask;let l,u,h;0<this.dropout&&this.dropout<1&&(t=X(t,a[0]));let d=ia(t,this.kernel.read());this.useBias&&(d=Gr(d,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(r=X(r,i[0]));const p=this.recurrentKernel.read(),[m,y]=As(p,[2*this.units,this.units],p.rank-1),b=ia(r,m),[x,v,S]=As(d,3,d.rank-1),[C,$]=As(b,2,b.rank-1);l=this.recurrentActivation.apply(St(x,C)),u=this.recurrentActivation.apply(St(v,$));const T=ia(X(u,r),y);h=this.activation.apply(St(S,T));const I=St(X(l,r),X(St(1,Be(l)),h));return[I,I]})}getConfig(){const t=super.getConfig(),e={units:this.units,activation:Oi(this.activation),recurrentActivation:Oi(this.recurrentActivation),useBias:this.useBias,kernelInitializer:je(this.kernelInitializer),recurrentInitializer:je(this.recurrentInitializer),biasInitializer:je(this.biasInitializer),kernelRegularizer:Re(this.kernelRegularizer),recurrentRegularizer:Re(this.recurrentRegularizer),biasRegularizer:Re(this.biasRegularizer),activityRegularizer:Re(this.activityRegularizer),kernelConstraint:Nn(this.kernelConstraint),recurrentConstraint:Nn(this.recurrentConstraint),biasConstraint:Nn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},t),e)}}bS.className="GRUCell";Tt(bS);class _R extends Xi{constructor(t){t.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),t.cell=new bS(t),super(t)}call(t,e){return at(()=>{this.cell.dropoutMask!=null&&(se(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(se(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=e==null?null:e.mask,r=e==null?null:e.training,a=e==null?null:e.initialState;return super.call(t,{mask:s,training:r,initialState:a})})}static fromConfig(t,e){return e.implmentation===0&&(e.implementation=1),new t(e)}}_R.className="GRU";Tt(_R);class hy extends cy{constructor(t){super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=t.units,Rn(this.units,"units"),this.activation=_i(t.activation===void 0?this.DEFAULT_ACTIVATION:t.activation),this.recurrentActivation=_i(t.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:t.recurrentActivation),this.useBias=t.useBias==null?!0:t.useBias,this.kernelInitializer=Ue(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Ue(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Ue(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=t.unitForgetBias,this.kernelRegularizer=Ge(t.kernelRegularizer),this.recurrentRegularizer=Ge(t.recurrentRegularizer),this.biasRegularizer=Ge(t.biasRegularizer),this.kernelConstraint=Tn(t.kernelConstraint),this.recurrentConstraint=Tn(t.recurrentConstraint),this.biasConstraint=Tn(t.biasConstraint),this.dropout=mu([1,Ri([0,t.dropout==null?0:t.dropout])]),this.recurrentDropout=mu([1,Ri([0,t.recurrentDropout==null?0:t.recurrentDropout])]),this.dropoutFunc=t.dropoutFunc,this.implementation=t.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){var e;t=ye(t);const s=t[t.length-1];this.kernel=this.addWeight("kernel",[s,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let r;if(this.useBias){if(this.unitForgetBias){const a=this.biasInitializer,i=this.units;r=new(e=class extends $r{apply(u,h){const d=a.apply([i]),p=new rS().apply([i]),m=a.apply([i*2]);return z2(z2(d,p),m)}},e.className="CustomInit",e)}else r=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,r,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(t,e){return at(()=>{const s=e.training==null?!1:e.training;if(t=t,t.length!==3)throw new st(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${t.length}.`);let r=t[1];const a=t[2];t=t[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Fi({ones:()=>Js(t),rate:this.dropout,training:s,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Fi({ones:()=>Js(r),rate:this.recurrentDropout,training:s,count:4,dropoutFunc:this.dropoutFunc}));const i=this.dropoutMask,l=this.recurrentDropoutMask;let u,h,d,p;0<this.dropout&&this.dropout<1&&(t=X(t,i[0]));let m=ia(t,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(r=X(r,l[0])),m=St(m,ia(r,this.recurrentKernel.read())),this.useBias&&(m=Gr(m,this.bias.read()));const[y,b,x,v]=As(m,4,m.rank-1);u=this.recurrentActivation.apply(y),h=this.recurrentActivation.apply(b),d=St(X(h,a),X(u,this.activation.apply(x))),p=this.recurrentActivation.apply(v);const S=X(p,this.activation.apply(d));return[S,S,d]})}getConfig(){const t=super.getConfig(),e={units:this.units,activation:Oi(this.activation),recurrentActivation:Oi(this.recurrentActivation),useBias:this.useBias,kernelInitializer:je(this.kernelInitializer),recurrentInitializer:je(this.recurrentInitializer),biasInitializer:je(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:Re(this.kernelRegularizer),recurrentRegularizer:Re(this.recurrentRegularizer),biasRegularizer:Re(this.biasRegularizer),activityRegularizer:Re(this.activityRegularizer),kernelConstraint:Nn(this.kernelConstraint),recurrentConstraint:Nn(this.recurrentConstraint),biasConstraint:Nn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},t),e)}}hy.className="LSTMCell";Tt(hy);class FR extends Xi{constructor(t){t.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),t.cell=new hy(t),super(t)}call(t,e){return at(()=>{this.cell.dropoutMask!=null&&(se(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(se(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=e==null?null:e.mask,r=e==null?null:e.training,a=e==null?null:e.initialState;return super.call(t,{mask:s,training:r,initialState:a})})}static fromConfig(t,e){return e.implmentation===0&&(e.implementation=1),new t(e)}}FR.className="LSTM";Tt(FR);class xS extends cy{constructor(t){super(t),this.cells=t.cells}get stateSize(){const t=[];for(const e of this.cells.slice().reverse())Array.isArray(e.stateSize)?t.push(...e.stateSize):t.push(e.stateSize);return t}call(t,e){return at(()=>{t=t;let s=t.slice(1);const r=[];for(const l of this.cells.slice().reverse())Array.isArray(l.stateSize)?r.push(s.splice(0,l.stateSize.length)):r.push(s.splice(0,1));r.reverse();const a=[];let i;for(let l=0;l<this.cells.length;++l){const u=this.cells[l];s=r[l],l===0?i=[t[0]].concat(s):i=[i[0]].concat(s),i=u.call(i,e),a.push(i.slice(1))}s=[];for(const l of a.slice().reverse())s.push(...l);return[i[0]].concat(s)})}build(t){Zx(t)&&(t=t[0]),t=t;let e;this.cells.forEach((s,r)=>{Io(`RNNCell_${r}`,()=>{s.build(t),Array.isArray(s.stateSize)?e=s.stateSize[0]:e=s.stateSize,t=[t[0],e]})}),this.built=!0}getConfig(){const t=super.getConfig(),e=a=>({className:a.getClassName(),config:a.getConfig()}),r={cells:this.cells.map(e)};return Object.assign(Object.assign({},t),r)}static fromConfig(t,e,s={}){const r=[];for(const a of e.cells)r.push(Fa(a,s));return new t({cells:r})}get trainableWeights(){if(!this.trainable)return[];const t=[];for(const e of this.cells)t.push(...e.trainableWeights);return t}get nonTrainableWeights(){const t=[];for(const e of this.cells)t.push(...e.nonTrainableWeights);if(!this.trainable){const e=[];for(const s of this.cells)e.push(...s.trainableWeights);return e.concat(t)}return t}getWeights(){const t=[];for(const e of this.cells)t.push(...e.weights);return Qx(t)}setWeights(t){const e=[];for(const s of this.cells){const r=s.weights.length,a=t.splice(r);for(let i=0;i<s.weights.length;++i)e.push([s.weights[i],a[i]])}hS(e)}}xS.className="StackedRNNCells";Tt(xS);function Fi(n){const{ones:t,rate:e,training:s=!1,count:r=1,dropoutFunc:a}=n,i=()=>a!=null?a(t(),e):$A(t(),e),l=()=>Od(i,t,s);return!r||r<=1?An(l().clone()):Array(r).fill(void 0).map(l).map(h=>An(h.clone()))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var Uq=function(n,t){var e={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&t.indexOf(s)<0&&(e[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(n);r<s.length;r++)t.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(n,s[r])&&(e[s[r]]=n[s[r]]);return e};class LR extends Xi{constructor(t){if(t.unroll)throw new Jt("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(t.cell))throw new Jt("It is not possible at the moment to stack convolutional cells.");super(t),this.inputSpec=[new Sn({ndim:5})]}call(t,e){return at(()=>{if(this.cell.dropoutMask!=null&&(se(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(se(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),e&&e.constants)throw new st("ConvRNN2D cell does not support constants");const s=e==null?null:e.mask,r=e==null?null:e.training,a=e==null?null:e.initialState;return super.call(t,{mask:s,training:r,initialState:a})})}computeOutputShape(t){let e=this.computeSingleOutputShape(t);return this.returnSequences||(e=[e[0],...e.slice(2)]),this.returnState&&(e=[e,...Array(2).fill([t[0],...e.slice(-3)])]),e}getInitialState(t){return at(()=>{const{stateSize:e}=this.cell,s=t.shape,r=this.computeSingleOutputShape(s),a=[r[0],...r.slice(2)],i=vn(a);return Array.isArray(e)?Array(e.length).fill(i):[i]})}resetStates(t,e=!1){at(()=>{if(!this.stateful)throw new Qr("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape,r=this.computeSingleOutputShape(s),a=[r[0],...r.slice(2)];if(s[0]==null)throw new st("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>vn(a)):this.states_=[vn(a)];else if(t==null)se(this.states_),this.keptStates!=null&&(se(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>vn(a)):this.states_[0]=vn(a);else{if(Array.isArray(t)||(t=[t]),t.length!==this.states_.length)throw new st(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${t.length} state value(s). Input received: ${t}`);e?this.keptStates.push(this.states_.slice()):se(this.states_);for(let l=0;l<this.states_.length;++l){const u=t[l],h=a;if(!de(u.shape,h))throw new st(`State ${l} is incompatible with layer ${this.name}: expected shape=${h}, received shape=${u.shape}`);this.states_[l]=u}}this.states_=this.states_.map(l=>An(l.clone()))})}computeSingleOutputShape(t){const{dataFormat:e,filters:s,kernelSize:r,padding:a,strides:i,dilationRate:l}=this.cell,u=e==="channelsFirst",h=t[u?3:2],d=t[u?4:3],p=Lr(h,r[0],a,i[0],l[0]),m=Lr(d,r[1],a,i[1],l[1]);return[...t.slice(0,2),...u?[s,p,m]:[p,m,s]]}}LR.className="ConvRNN2D";class vS extends hy{constructor(t){const{filters:e,kernelSize:s,strides:r,padding:a,dataFormat:i,dilationRate:l}=t;super(Object.assign(Object.assign({},t),{units:e})),this.filters=e,Rn(this.filters,"filters"),this.kernelSize=lu(s,2,"kernelSize"),this.kernelSize.forEach(u=>Rn(u,"kernelSize")),this.strides=lu(r||1,2,"strides"),this.strides.forEach(u=>Rn(u,"strides")),this.padding=a||"valid",er(this.padding),this.dataFormat=i||"channelsLast",un(this.dataFormat),this.dilationRate=lu(l||1,2,"dilationRate"),this.dilationRate.forEach(u=>Rn(u,"dilationRate"))}build(t){var e;t=ye(t);const s=this.dataFormat==="channelsFirst"?1:t.length-1;if(t[s]==null)throw new st(`The channel dimension of the input should be defined. Found ${t[s]}`);const r=t[s],a=4,i=this.kernelSize.concat([r,this.filters*a]);this.kernel=this.addWeight("kernel",i,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const l=this.kernelSize.concat([this.filters,this.filters*a]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",l,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let u;if(this.unitForgetBias){const h=this.biasInitializer,d=this.filters;u=new(e=class extends $r{apply(m,y){const b=h.apply([d]),x=Is([d]),v=h.apply([d*2]);return sS([b,x,v])}},e.className="CustomInit",e)}else u=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*a],null,u,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(t,e){return at(()=>{if(t.length!==3)throw new st(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${t.length}.`);const s=e.training||!1,r=t[0],a=t[1],i=t[2],l=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Fi({ones:()=>Js(r),rate:this.dropout,training:s,count:l,dropoutFunc:this.dropoutFunc}));const u=this.dropoutMask,h=(O,V,P)=>!V||!V[P]?O:X(V[P],O);let d=h(r,u,0),p=h(r,u,1),m=h(r,u,2),y=h(r,u,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Fi({ones:()=>Js(a),rate:this.recurrentDropout,training:s,count:l,dropoutFunc:this.dropoutFunc}));const b=this.recurrentDropoutMask;let x=h(a,b,0),v=h(a,b,1),S=h(a,b,2),C=h(a,b,3);const $=3,[T,I,A,R]=As(this.kernel.read(),l,$),[L,_,M,D]=this.useBias?As(this.bias.read(),l):[null,null,null,null];d=this.inputConv(d,T,L,this.padding),p=this.inputConv(p,I,_,this.padding),m=this.inputConv(m,A,M,this.padding),y=this.inputConv(y,R,D,this.padding);const[W,et,nt,tt]=As(this.recurrentKernel.read(),l,$);x=this.recurrentConv(x,W),v=this.recurrentConv(v,et),S=this.recurrentConv(S,nt),C=this.recurrentConv(C,tt);const U=this.recurrentActivation.apply(St(d,x)),Y=this.recurrentActivation.apply(St(p,v)),Z=St(X(Y,i),X(U,this.activation.apply(St(m,S)))),G=X(this.recurrentActivation.apply(St(y,C)),this.activation.apply(Z));return[G,G,Z]})}getConfig(){const t=super.getConfig(),{units:e}=t,s=Uq(t,["units"]),r={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},s),r)}inputConv(t,e,s,r){const a=Ai(t,e,this.strides,r||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return s?Gr(a,s,this.dataFormat):a}recurrentConv(t,e){return Ai(t,e,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}}vS.className="ConvLSTM2DCell";Tt(vS);class zR extends LR{constructor(t){const e=new vS(t);super(Object.assign(Object.assign({},t),{cell:e}))}static fromConfig(t,e){return new t(e)}}zR.className="ConvLSTM2D";Tt(zR);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class wS extends ae{constructor(t){super(t),this.rate=Math.max(Math.min(t.rate,1),0),this.noiseShape=t.noiseShape,this.seed=t.seed,this.supportsMasking=!0}getNoiseShape(t){if(this.noiseShape==null)return this.noiseShape;const e=t.shape,s=[];for(let r=0;r<this.noiseShape.length;++r)s.push(this.noiseShape[r]==null?e[r]:this.noiseShape[r]);return s}call(t,e){return at(()=>{this.invokeCallHook(t,e);const s=Wt(t);if(0<this.rate&&this.rate<1){const r=e.training==null?!1:e.training,a=this.getNoiseShape(s);return Od(()=>$A(s,this.rate,a,this.seed),()=>s,r)}return t})}getConfig(){const t={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},e=super.getConfig();return Object.assign(t,e),t}dispose(){return super.dispose()}}wS.className="Dropout";Tt(wS);class MR extends wS{constructor(t){super(t),this.inputSpec=[{ndim:3}]}getNoiseShape(t){const e=t.shape;return[e[0],1,e[2]]}}MR.className="SpatialDropout1D";Tt(MR);class BR extends ae{constructor(t){if(super(t),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",t.batchInputShape==null&&t.inputShape==null&&t.inputDim!=null){let e=null;t.batchSize!=null&&(e=t.batchSize),this.batchInputShape=[e,t.inputDim]}this.units=t.units,Rn(this.units,"units"),this.activation=_i(t.activation),t.useBias!=null&&(this.useBias=t.useBias),this.kernelInitializer=Ue(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=Ue(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=Tn(t.kernelConstraint),this.biasConstraint=Tn(t.biasConstraint),this.kernelRegularizer=Ge(t.kernelRegularizer),this.biasRegularizer=Ge(t.biasRegularizer),this.activityRegularizer=Ge(t.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(t){t=ye(t);const e=t[t.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[e,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:e}}],this.built=!0}computeOutputShape(t){t=ye(t);const e=t.slice();return e[e.length-1]=this.units,e}call(t,e){return at(()=>{this.invokeCallHook(t,e);const s=Wt(t),r=xA(this.activation.getClassName());let a;return r!=null?a=ia(s,this.kernel.read(),r,this.bias?this.bias.read():null):(a=ia(s,this.kernel.read()),this.bias!=null&&(a=Gr(a,this.bias.read())),this.activation!=null&&(a=this.activation.apply(a))),a})}getConfig(){const t={units:this.units,activation:Oi(this.activation),useBias:this.useBias,kernelInitializer:je(this.kernelInitializer),biasInitializer:je(this.biasInitializer),kernelRegularizer:Re(this.kernelRegularizer),biasRegularizer:Re(this.biasRegularizer),activityRegularizer:Re(this.activityRegularizer),kernelConstraint:Nn(this.kernelConstraint),biasConstraint:Nn(this.biasConstraint)},e=super.getConfig();return Object.assign(t,e),t}}BR.className="Dense";Tt(BR);class PR extends ae{constructor(t){t=t||{},super(t),this.inputSpec=[{minNDim:3}],this.dataFormat=t.dataFormat}computeOutputShape(t){t=ye(t);for(const e of t.slice(1))if(e==null)throw new st(`The shape of the input to "Flatten" is not fully defined (got ${t.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[t[0],$i(t,1)]}call(t,e){return at(()=>{this.invokeCallHook(t,e);let s=Wt(t);if(this.dataFormat==="channelsFirst"&&s.rank>1){const r=[0];for(let a=2;a<s.rank;++a)r.push(a);r.push(1),s=fe(s,r)}return w5(s)})}getConfig(){const t={};this.dataFormat!=null&&(t.dataFormat=this.dataFormat);const e=super.getConfig();return Object.assign(t,e),t}}PR.className="Flatten";Tt(PR);class VR extends ae{constructor(t){super(t),this.supportsMasking=!0,this.activation=_i(t.activation)}call(t,e){return at(()=>{this.invokeCallHook(t,e);const s=Wt(t);return this.activation.apply(s)})}getConfig(){const t={activation:Oi(this.activation)},e=super.getConfig();return Object.assign(t,e),t}}VR.className="Activation";Tt(VR);class UR extends ae{constructor(t){super(t),this.n=t.n,this.inputSpec=[{ndim:2}]}computeOutputShape(t){return[t[0],this.n,t[1]]}call(t,e){return at(()=>(t=Wt(t),x5(t,this.n)))}getConfig(){const t={n:this.n},e=super.getConfig();return Object.assign(t,e),t}}UR.className="RepeatVector";Tt(UR);class GR extends ae{constructor(t){super(t),this.targetShape=t.targetShape;for(let e=0;e<this.targetShape.length;++e)this.isUnknown(this.targetShape[e])&&(this.targetShape[e]=null)}isUnknown(t){return t<0||t==null}fixUnknownDimension(t,e){const s="Total size of new array must be unchanged.",r=e.slice();let a=1,i=null;for(let u=0;u<r.length;++u){const h=r[u];if(this.isUnknown(h))if(i===null)i=u;else throw new st("Can only specifiy one unknown dimension.");else a*=h}const l=$i(t);if(i!==null){if(a===0||l%a!==0)throw new st(s);r[i]=l/a}else if(l!==a)throw new st(s);return r}computeOutputShape(t){let e=!1;for(let s=0;s<t.length;++s)if(this.isUnknown(t[s])){e=!0;break}return e?t.slice(0,1).concat(this.targetShape):t.slice(0,1).concat(this.fixUnknownDimension(t.slice(1),this.targetShape))}call(t,e){return at(()=>{this.invokeCallHook(t,e);const s=Wt(t),r=s.shape,a=r.slice(0,1).concat(this.fixUnknownDimension(r.slice(1),this.targetShape));return J(s,a)})}getConfig(){const t={targetShape:this.targetShape},e=super.getConfig();return Object.assign(t,e),t}}GR.className="Reshape";Tt(GR);class WR extends ae{constructor(t){if(super(t),t.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(t.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${t.dims} instead.`);const e=Br(1,t.dims.length+1);if(!de(t.dims.slice().sort(),e))throw new Error("Invalid permutation `dims`: "+JSON.stringify(t.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=t.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new Sn({ndim:this.dims.length+1})]}computeOutputShape(t){t=ye(t);const e=t.slice();return this.dims.forEach((s,r)=>{e[r+1]=t[s]}),e}call(t,e){return fe(Wt(t),this.dimsIncludingBatch)}getConfig(){const t={dims:this.dims},e=super.getConfig();return Object.assign(t,e),t}}WR.className="Permute";Tt(WR);class HR extends ae{constructor(t){super(t??{}),this.supportsMasking=!0,t!=null?this.maskValue=t.maskValue==null?0:t.maskValue:this.maskValue=0}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),e={maskValue:this.maskValue};return Object.assign(e,t),e}computeMask(t,e){const s=Wt(t);return Kp(fu(s,this.maskValue),-1)}call(t,e){return at(()=>{this.invokeCallHook(t,e);const s=Wt(t),i=Kp(fu(s,this.maskValue),-1,!0);return X(s,kt(i,s.dtype))})}}HR.className="Masking";Tt(HR);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class jR extends ae{constructor(t){if(super(t),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",t.batchInputShape==null&&t.inputShape==null){let e=null;t.batchSize!=null&&(e=t.batchSize),t.inputLength==null?this.batchInputShape=[e,null]:this.batchInputShape=[e].concat(Se(t.inputLength))}this.inputDim=t.inputDim,Rn(this.inputDim,"inputDim"),this.outputDim=t.outputDim,Rn(this.outputDim,"outputDim"),this.embeddingsInitializer=Ue(t.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=Ge(t.embeddingsRegularizer),this.activityRegularizer=Ge(t.activityRegularizer),this.embeddingsConstraint=Tn(t.embeddingsConstraint),this.maskZero=t.maskZero,this.supportsMasking=t.maskZero,this.inputLength=t.inputLength}build(t){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(t){}computeMask(t,e){return at(()=>this.maskZero?(t=Wt(t),fu(t,pe(t))):null)}computeOutputShape(t){if(t=ye(t),this.inputLength==null)return[...t,this.outputDim];const e=Se(this.inputLength);if(e.length!==t.length-1)throw new st(`"inputLength" is ${this.inputLength}, but received input shape has shape ${t}`);{let s=0;for(let r=0;r<e.length;++r){const a=e[r],i=t[r+1];if(a!=null&&i!=null&&a!==i)throw new st(`"inputLength" is ${this.inputLength}, but received input shape has shape ${t}`);a==null&&(e[s]=i),s++}}return[t[0],...e,this.outputDim]}call(t,e){return at(()=>{this.invokeCallHook(t,e);let s=Wt(t);s.dtype!=="int32"&&(s=aa(s,"int32"));const r=TA(this.embeddings.read(),J(s,[s.size]));return J(r,ye(this.computeOutputShape(s.shape)))})}getConfig(){const t={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:je(this.embeddingsInitializer),embeddingsRegularizer:Re(this.embeddingsRegularizer),activityRegularizer:Re(this.activityRegularizer),embeddingsConstraint:Nn(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},e=super.getConfig();return Object.assign(t,e),t}}jR.className="Embedding";Tt(jR);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class tl extends ae{constructor(t){super(t||{}),this.supportsMasking=!0}mergeFunction(t){throw new Jt}computeElementwiseOpOutputShape(t,e){if(t==null||e==null)return null;if(t.length<e.length)return this.computeElementwiseOpOutputShape(e,t);if(e.length===0)return t;const s=t.slice(0,t.length-e.length);for(let r=0;r<e.length;++r){const a=t[t.length-e.length+r],i=e[r];if(a==null||i==null||a<0||i<0)s.push(null);else if(a===1)s.push(i);else if(i===1)s.push(a);else{if(a!==i)throw new st("Operands could not be broadcast together with shapes "+JSON.stringify(t)+" "+JSON.stringify(e));s.push(a)}}return s}build(t){if(Array.isArray(t)&&!Array.isArray(t[0])&&(t=[ye(t)]),t=t,t.length<2)throw new st(`A merge layer should be called on an Array of at least 2 inputs. Got ${t.length} input(s).`);let e=[];for(const a of t)a!=null&&a[0]!==null&&e.push(a[0]);if(e=Ti(e),e.length>1)throw new st(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(t)}.`);let s=t[0]==null?null:t[0].slice(1);for(let a=1;a<t.length;++a){const i=t[a]==null?null:t[a].slice(1);s=this.computeElementwiseOpOutputShape(s,i)}const r=t.map(a=>a.length);t.indexOf(null)===-1&&Ti(r).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(t,e){return at(()=>{if(t=t,this.reshapeRequired){const s=[],r=t.map(a=>a.rank);if(r.indexOf(null)===-1){const a=Ri(r);for(let i of t){const l=i.rank;for(let u=0;u<a-l;++u)i=Ad(i,1);s.push(i)}return this.mergeFunction(s)}else{let a=!1;for(const u of t){const h=u.rank;if(h==null){const d=u.shape,p=d[0],m=d.slice(1).concat([p]);let y=J(u,[p].concat($i(d.slice(1))));y=fe(y,[1,0]),y=J(y,m),s.push(y),a=!0}else if(h>1){const d=Br(1,h).concat([0]);s.push(fe(u,d)),a=!0}else s.push(u)}let i=this.mergeFunction(s);const l=i.rank;if(a){if(l==null){const u=i.shape,h=u.length,d=u[h-1],p=[d].concat(u.slice(0,u.length-1));i=J(fe(J(i,[-1,d]),[1,0]),p)}else if(l>1){const u=[l-1].concat(Br(0,l-1));i=fe(i,u)}}return i}}else return this.mergeFunction(t)})}computeOutputShape(t){t=t;let e;t[0]==null?e=null:e=t[0].slice(1);for(let r=1;r<t.length;++r){const a=t[r]==null?null:t[r].slice(1);e=this.computeElementwiseOpOutputShape(e,a)}let s=[];for(const r of t)r!=null&&r[0]!==null&&s.push(r[0]);return s=Ti(s),s.length===1?e=s.concat(e):e=[null].concat(e),e}computeMask(t,e){return at(()=>{if(e==null)return null;if(!Array.isArray(e))throw new st("`mask` should be an Array");if(!Array.isArray(t))throw new st("`inputs` should be an Array");if(e.length!==t.length)throw new st(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${t.length} vs ${e.length})`);if(e.every(r=>r==null))return null;e=e.map(r=>r==null?r:Qn(r,0));let s=e[0];for(let r=1;r<e.length-1;++r)s=oa(s,e[r]);return s})}}class qR extends tl{constructor(t){super(t)}mergeFunction(t){return at(()=>{let e=t[0].clone();for(let s=1;s<t.length;++s)e=St(e,t[s]);return e})}}qR.className="Add";Tt(qR);class XR extends tl{constructor(t){super(t)}mergeFunction(t){return at(()=>{let e=t[0].clone();for(let s=1;s<t.length;++s)e=X(e,t[s]);return e})}}XR.className="Multiply";Tt(XR);class KR extends tl{constructor(t){super(t)}mergeFunction(t){return at(()=>{let e=t[0].clone();for(let s=1;s<t.length;++s)e=St(e,t[s]);return X(1/t.length,e)})}}KR.className="Average";Tt(KR);class YR extends tl{constructor(t){super(t)}mergeFunction(t){return at(()=>{let e=t[0];for(let s=1;s<t.length;++s)e=Wa(e,t[s]);return e})}}YR.className="Maximum";Tt(YR);class ZR extends tl{constructor(t){super(t)}mergeFunction(t){return at(()=>{let e=t[0];for(let s=1;s<t.length;++s)e=Uo(e,t[s]);return e})}}ZR.className="Minimum";Tt(ZR);class QR extends tl{constructor(t){super(t),this.DEFAULT_AXIS=-1,t==null&&(t={}),this.axis=t.axis==null?this.DEFAULT_AXIS:t.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(t){if(!(Array.isArray(t)&&Array.isArray(t[0]))||t.length===1)throw new st("A `Concatenate` layer should be called on a list of at least 2 inputs");t=t;let e=!0;for(const r of t)if(r!=null){e=!1;break}if(e)return;const s=[];for(let r=0;r<t.length;++r){const a=t[r].slice();a.splice(this.axis,1);let i=!1;for(const l of s)if(de(l,a)){i=!0;break}i||s.push(a)}if(s.length>1)throw new st("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(t))}mergeFunction(t){return at(()=>sS(t,this.axis))}computeOutputShape(t){if(!(Array.isArray(t)&&Array.isArray(t[0])))throw new st("A `Concatenate` layer should be called on a list of inputs.");const e=t,s=e[0].slice(),r=this.axis<0?s.length+this.axis:this.axis;for(const a of e.slice(1)){if(s[r]==null||a[r]==null){s[r]=null;break}s[r]+=a[r]}return s}computeMask(t,e){if(e==null)return null;if(!Array.isArray(e))throw new st("`mask` should be an array for Concatenate");if(!Array.isArray(t))throw new st("`inputs` should be an array for Concatenate");if(e.length!==t.length)throw new st(`Mismatch in the length of mask (${e.length}) and the legnth of inputs (${t.length})`);return at(()=>{let s=!0;if(e.forEach(i=>{if(i!=null){s=!1;return}}),s)return null;const r=[];for(let i=0;i<t.length;++i)e[i]==null?r.push(kt(Js(t[i]),"bool")):e[i].rank<t[i].rank?r.push(Qn(e[i],-1)):r.push(e[i]);const a=pn(r,this.axis);return Gv(a,-1,!1)})}getConfig(){const t={axis:this.axis},e=super.getConfig();return Object.assign(t,e),t}}QR.className="Concatenate";Tt(QR);function Yc(n,t){for(;n<0;)n+=t;return n}function Gq(n,t,e){if(n.shape.length>3||t.shape.length>3)throw new Jt("batchDot is not implemented for tensors of 4D or higher rank yet");if(F(n.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${n.shape.length}`),F(n.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${t.shape.length}`),typeof e=="number"&&(e=[e,e]),n.dtype==="complex64"||t.dtype==="complex64")throw new Jt("batchDot is not implemented for complex64-type Tensors yet.");const s=n.shape.length,r=t.shape.length;e==null&&(e=[s-1,r-2]);const a=e;return at(()=>{let i;if(s>r){i=s-r;const u=[];for(let h=0;h<i;++h)u.push(1);t=J(t,t.shape.concat(u))}else if(r>s){i=r-s;const u=[];for(let h=0;h<i;++h)u.push(1);n=J(n,n.shape.concat(u))}else i=0;let l;if(n.shape.length===2&&t.shape.length===2)a[0]===a[1]?l=Ft(X(n,t),a[0]):l=Ft(X(fe(n,[1,0]),t),a[1]);else{const u=a[0]!==n.shape.length-1,h=a[1]===t.shape.length-1;l=le(n,t,u,h)}if(i>0){let u;s>r?u=s+r-3:u=s-1;const h=[];for(let d=u;d<u+i;++d)h.push(d);l=Ma(l,h)}return l.shape.length===1&&(l=Qn(l,1)),l})}class JR extends tl{constructor(t){super(t),this.axes=t.axes,this.normalize=t.normalize==null?!1:t.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(t){F(Array.isArray(t)&&t.length===2&&Array.isArray(t[0])&&Array.isArray(t[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const e=t[0],s=t[1];if(e.length>3||s.length>3)throw new Jt("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(e,s);if(e[r[0]]!==s[r[1]])throw new st(`Dimension incompatibility: ${e[r[0]]} !== ${s[r[1]]}`)}mergeFunction(t){if(t.length!==2)throw new st(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${t.length} input(s).`);let e=t[0],s=t[1],r;return Array.isArray(this.axes)?r=this.axes.map((a,i)=>Yc(a,t[i].shape.length)):r=[Yc(this.axes,e.shape.length),Yc(this.axes,s.shape.length)],this.normalize&&(e=em(e,r[0]),s=em(s,r[1])),Gq(e,s,r)}interpretAxes(t,e){let s;return Array.isArray(this.axes)?s=this.axes:s=[Yc(this.axes,t.length),Yc(this.axes,e.length)],s}computeOutputShape(t){F(Array.isArray(t)&&t.length===2&&Array.isArray(t[0])&&Array.isArray(t[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const e=t[0].slice(),s=t[1].slice();if(e.length>3||s.length>3)throw new Jt("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(e,s);e.splice(r[0],1),s.splice(r[1],1),s.splice(0,1);const a=e.concat(s);return a.length===1&&a.push(1),a}computeMask(t,e){return null}getConfig(){const t={axes:this.axes,normalize:this.normalize},e=super.getConfig();return Object.assign(t,e),t}}JR.className="Dot";Tt(JR);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class tO extends ae{constructor(t){super(t),this.supportsMasking=!0,this.stddev=t.stddev}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),e={stddev:this.stddev};return Object.assign(e,t),e}call(t,e){return at(()=>{this.invokeCallHook(t,e);const s=Wt(t);return Od(()=>St(ry(s.shape,0,this.stddev),s),()=>s,e.training||!1)})}}tO.className="GaussianNoise";Tt(tO);class eO extends ae{constructor(t){super(t),this.supportsMasking=!0,this.rate=t.rate}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),e={rate:this.rate};return Object.assign(e,t),e}call(t,e){return at(()=>{this.invokeCallHook(t,e);const s=Wt(t);return this.rate>0&&this.rate<1?Od(()=>{const a=Math.sqrt(this.rate/(1-this.rate));return X(s,ry(s.shape,1,a))},()=>s,e.training||!1):s})}}eO.className="GaussianDropout";Tt(eO);class nO extends ae{constructor(t){super(t),this.supportsMasking=!0,this.rate=t.rate,this.noiseShape=t.noiseShape}_getNoiseShape(t){return this.noiseShape||Wt(t).shape}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),e={rate:this.rate};return Object.assign(e,t),e}call(t,e){return at(()=>{if(this.rate<1&&this.rate>0){const s=this._getNoiseShape(t);return Od(()=>{const a=Wt(t),l=-1.6732632423543772*1.0507009873554805;let u=Hi(Zo(s),this.rate);u=aa(u,"float32");const h=((1-this.rate)*(1+this.rate*l**2))**-.5,d=-h*l*this.rate,p=St(X(a,u),X(St(u,-1),l));return St(X(p,h),d)},()=>Wt(t),e.training||!1)}return t})}}nO.className="AlphaDropout";Tt(nO);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function yh(n,t,e,s,r,a=.001){let i;if(n.rank===2)i=IE(n,t,e,s,r,a);else if(n.rank===3)i=EE(n,t,e,s,r,a);else if(n.rank===4)i=DE(n,t,e,s,r,a);else throw new Jt(`batchNormalization is not implemented for array of rank ${n.rank} yet`);return i}function Wq(n,t,e,s,r=.001){return at(()=>{const a=Pg(n,s),i=a.mean,l=a.variance;return[yh(n,i,l,e,t,r),i,l]})}function Hq(n,t,e,s,r=.001){return at(()=>{const a=Pg(n,s),i=a.mean,l=a.variance,u=[];for(const b of Br(0,n.rank))s.indexOf(b)!==-1?u.push(1):u.push(n.shape[b]);const h=J(i,u),d=J(l,u),p=t==null?null:J(t,u),m=e==null?null:J(e,u);return[yh(n,h,d,m,p,r),i,l]})}function jq(n,t,e,s,r=.001){return de(s.slice().sort(),Br(0,n.rank-1))?Wq(n,t,e,s,r):Hq(n,t,e,s,r)}class sO extends ae{constructor(t){t==null&&(t={}),super(t),this.supportsMasking=!0,this.axis=t.axis==null?-1:t.axis,this.momentum=t.momentum==null?.99:t.momentum,this.epsilon=t.epsilon==null?.001:t.epsilon,this.center=t.center==null?!0:t.center,this.scale=t.scale==null?!0:t.scale,this.betaInitializer=Ue(t.betaInitializer||"zeros"),this.gammaInitializer=Ue(t.gammaInitializer||"ones"),this.movingMeanInitializer=Ue(t.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=Ue(t.movingVarianceInitializer||"ones"),this.betaConstraint=Tn(t.betaConstraint),this.gammaConstraint=Tn(t.gammaConstraint),this.betaRegularizer=Ge(t.betaRegularizer),this.gammaRegularizer=Ge(t.gammaRegularizer)}build(t){t=ye(t);const e=this.axis>=0?this.axis:this.axis+t.length,s=t[e];if(s==null)throw new st(`Axis ${e} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(t)}.`);this.inputSpec=[new Sn({ndim:t.length,axes:{[e]:s}})];const r=[s];this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(t,e){return at(()=>{const s=e.training==null?!1:e.training,r=Wt(t),a=r.shape,i=a.length,l=Br(0,i),u=this.axis>=0?this.axis:this.axis+i;l.splice(u,1);const h=Wo(1,i);h[u]=a[u];const d=l.slice();d.sort();const p=!de(d,Br(0,i).slice(0,i-1)),m=()=>{if(p){const C=J(this.movingMean.read(),h),$=J(this.movingVariance.read(),h),T=this.center?J(this.beta.read(),h):null,I=this.scale?J(this.gamma.read(),h):null;return yh(r,C,$,T,I,this.epsilon)}else return yh(r,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!s)return m();const[y,b,x]=jq(r,this.gamma.read(),this.beta.read(),l,this.epsilon),v=(C,$,T)=>{at(()=>{const I=1-T,A=C.read(),R=X(Rt(A,$),I);C.write(Rt(A,R))})};return(()=>{v(this.movingMean,b,this.momentum),v(this.movingVariance,x,this.momentum)})(),y})}getConfig(){const t={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:je(this.betaInitializer),gammaInitializer:je(this.gammaInitializer),movingMeanInitializer:je(this.movingMeanInitializer),movingVarianceInitializer:je(this.movingVarianceInitializer),betaRegularizer:Re(this.betaRegularizer),gammaRegularizer:Re(this.gammaRegularizer),betaConstraint:Nn(this.betaConstraint),gammaConstraint:Nn(this.gammaConstraint)},e=super.getConfig();return Object.assign(t,e),t}}sO.className="BatchNormalization";Tt(sO);class rO extends ae{constructor(t){if(t==null&&(t={}),super(t),this.axis=t.axis==null?-1:t.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(const e of this.axis)if(!Number.isInteger(e))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=t.epsilon==null?.001:t.epsilon,this.center=t.center==null?!0:t.center,this.scale=t.scale==null?!0:t.scale,this.betaInitializer=Ue(t.betaInitializer||"zeros"),this.gammaInitializer=Ue(t.gammaInitializer||"ones"),this.betaRegularizer=Ge(t.betaRegularizer),this.gammaRegularizer=Ge(t.gammaRegularizer),this.supportsMasking=!0}build(t){t=ye(t);const e=t.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let a=0;a<this.axis.length;++a)this.axis[a]<0&&(this.axis[a]+=e);for(const a of this.axis)if(a<0||a>=e)throw new Error(`Invalid axis: ${a}`);if(this.axis.length!==Ti(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const s=this.axis.map(a=>t[a]),r=!0;this.scale?this.gamma=this.addWeight("gamma",s,"float32",this.gammaInitializer,this.gammaRegularizer,r):this.gamma=null,this.center?this.beta=this.addWeight("beta",s,"float32",this.betaInitializer,this.betaRegularizer,r):this.beta=null,this.built=!0}call(t,e){const s=Wt(t),r=s.shape,a=r.length;return at(()=>{let{mean:l,variance:u}=Pg(s,this.axis,!0);const h=Wo(1,a);for(const x of this.axis)h[x]=r[x];const d=x=>x!=null&&x.shape.length!==a?J(x,h):x;let p=this.scale?d(this.gamma.read()):null,m=this.center?d(this.beta.read()):null;const y=[],b=[];for(let x=0;x<a;++x)this.axis.indexOf(x)!==-1?(y.push(r[x]),b.push(1)):(y.push(1),b.push(r[x]));return l=gr(l,y),u=gr(u,y),p!=null&&(p=gr(p,b)),m!=null&&(m=gr(m,b)),yh(s,l,u,m,p,this.epsilon)})}getConfig(){const t={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:je(this.betaInitializer),gammaInitializer:je(this.gammaInitializer),betaRegularizer:Re(this.betaRegularizer),gammaRegularizer:Re(this.gammaRegularizer)},e=super.getConfig();return Object.assign(t,e),t}}rO.className="LayerNormalization";Tt(rO);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function qq(n,t,e){return at(()=>{if(n.rank!==4)throw new st(`temporalPadding expects input tensor to be 4-D, but received a ${n.rank}-D tensor.`);if(t==null&&(t=[[1,1],[1,1]]),t.length!==2||t[0].length!==2||t[1].length!==2)throw new st("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(e==null&&(e=Pr()),e!=="channelsLast"&&e!=="channelsFirst")throw new st(`Unknown data format: ${e}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let s;return e==="channelsFirst"?s=[[0,0],[0,0],t[0],t[1]]:s=[[0,0],t[0],t[1],[0,0]],ji(n,s)})}class aO extends ae{constructor(t){if(t==null&&(t={}),super(t),this.dataFormat=t.dataFormat==null?Pr():t.dataFormat,t.padding==null)this.padding=[[1,1],[1,1]];else if(typeof t.padding=="number")this.padding=[[t.padding,t.padding],[t.padding,t.padding]];else{if(t.padding=t.padding,t.padding.length!==2)throw new st(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${t.padding.length} array.`);let e,s;if(typeof t.padding[0]=="number")e=[t.padding[0],t.padding[0]],s=[t.padding[1],t.padding[1]];else{if(t.padding=t.padding,t.padding[0].length!==2)throw new st(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${t.padding[0].length} array.`);if(e=t.padding[0],t.padding[1].length!==2)throw new st(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${t.padding[1].length} array.`);s=t.padding[1]}this.padding=[e,s]}this.inputSpec=[new Sn({ndim:4})]}computeOutputShape(t){t=ye(t);let e,s;return this.dataFormat==="channelsFirst"?(t[2]!=null&&t[2]>=0?e=t[2]+this.padding[0][0]+this.padding[0][1]:e=null,t[3]!=null&&t[3]>=0?s=t[3]+this.padding[1][0]+this.padding[1][1]:s=null,[t[0],t[1],e,s]):(t[1]!=null&&t[1]>=0?e=t[1]+this.padding[0][0]+this.padding[0][1]:e=null,t[2]!=null&&t[2]>=0?s=t[2]+this.padding[1][0]+this.padding[1][1]:s=null,[t[0],e,s,t[3]])}call(t,e){return at(()=>qq(Wt(t),this.padding,this.dataFormat))}getConfig(){const t={padding:this.padding,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}aO.className="ZeroPadding2D";Tt(aO);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function dy(n,t,e,s,r,a){return at(()=>{un(r),wA(a),er(s),e==null&&(e=[1,1]),s==null&&(s="valid"),r==null&&(r=Pr()),a==null&&(a="max"),n=gS(n,r);let i;const l=s==="same"?"same":"valid";return a==="max"?i=Bg(n,t,e,l):i=Ag(n,t,e,l),r==="channelsFirst"&&(i=fe(i,[0,3,1,2])),i})}function iO(n,t,e,s,r,a){return at(()=>{un(r),wA(a),er(s),e==null&&(e=[1,1,1]),s==null&&(s="valid"),r==null&&(r=Pr()),a==null&&(a="max"),n=CR(n,r);let i;const l=s==="same"?"same":"valid";return a==="max"?i=JE(n,t,e,l):i=kE(n,t,e,l),r==="channelsFirst"&&(i=fe(i,[0,4,1,2,3])),i})}class oO extends ae{constructor(t){if(t.poolSize==null&&(t.poolSize=2),super(t),typeof t.poolSize=="number")this.poolSize=[t.poolSize];else if(Array.isArray(t.poolSize)&&t.poolSize.length===1&&typeof t.poolSize[0]=="number")this.poolSize=t.poolSize;else throw new st(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(t.poolSize)}`);if(Rn(this.poolSize,"poolSize"),t.strides==null)this.strides=this.poolSize;else if(typeof t.strides=="number")this.strides=[t.strides];else if(Array.isArray(t.strides)&&t.strides.length===1&&typeof t.strides[0]=="number")this.strides=t.strides;else throw new st(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(t.strides)}`);Rn(this.strides,"strides"),this.padding=t.padding==null?"valid":t.padding,er(this.padding),this.inputSpec=[new Sn({ndim:3})]}computeOutputShape(t){t=ye(t);const e=Lr(t[1],this.poolSize[0],this.padding,this.strides[0]);return[t[0],e,t[2]]}call(t,e){return at(()=>{this.invokeCallHook(t,e),t=Ad(Wt(t),2);const s=this.poolingFunction(Wt(t),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return Ma(s,[2])})}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides},e=super.getConfig();return Object.assign(t,e),t}}class lO extends oO{constructor(t){super(t)}poolingFunction(t,e,s,r,a){return un(a),er(r),dy(t,e,s,r,a,"max")}}lO.className="MaxPooling1D";Tt(lO);class uO extends oO{constructor(t){super(t)}poolingFunction(t,e,s,r,a){return un(a),er(r),dy(t,e,s,r,a,"avg")}}uO.className="AveragePooling1D";Tt(uO);class cO extends ae{constructor(t){if(t.poolSize==null&&(t.poolSize=[2,2]),super(t),this.poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize],t.strides==null)this.strides=this.poolSize;else if(Array.isArray(t.strides)){if(t.strides.length!==2)throw new st(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${t.strides.length}.`);this.strides=t.strides}else this.strides=[t.strides,t.strides];Rn(this.poolSize,"poolSize"),Rn(this.strides,"strides"),this.padding=t.padding==null?"valid":t.padding,this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,un(this.dataFormat),er(this.padding),this.inputSpec=[new Sn({ndim:4})]}computeOutputShape(t){t=ye(t);let e=this.dataFormat==="channelsFirst"?t[2]:t[1],s=this.dataFormat==="channelsFirst"?t[3]:t[2];return e=Lr(e,this.poolSize[0],this.padding,this.strides[0]),s=Lr(s,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[t[0],t[1],e,s]:[t[0],e,s,t[3]]}call(t,e){return at(()=>(this.invokeCallHook(t,e),this.poolingFunction(Wt(t),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}class hO extends cO{constructor(t){super(t)}poolingFunction(t,e,s,r,a){return un(a),er(r),dy(t,e,s,r,a,"max")}}hO.className="MaxPooling2D";Tt(hO);class dO extends cO{constructor(t){super(t)}poolingFunction(t,e,s,r,a){return un(a),er(r),dy(t,e,s,r,a,"avg")}}dO.className="AveragePooling2D";Tt(dO);class fO extends ae{constructor(t){if(t.poolSize==null&&(t.poolSize=[2,2,2]),super(t),this.poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize,t.poolSize],t.strides==null)this.strides=this.poolSize;else if(Array.isArray(t.strides)){if(t.strides.length!==3)throw new st(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${t.strides.length}.`);this.strides=t.strides}else this.strides=[t.strides,t.strides,t.strides];Rn(this.poolSize,"poolSize"),Rn(this.strides,"strides"),this.padding=t.padding==null?"valid":t.padding,this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,un(this.dataFormat),er(this.padding),this.inputSpec=[new Sn({ndim:5})]}computeOutputShape(t){t=ye(t);let e=this.dataFormat==="channelsFirst"?t[2]:t[1],s=this.dataFormat==="channelsFirst"?t[3]:t[2],r=this.dataFormat==="channelsFirst"?t[4]:t[3];return e=Lr(e,this.poolSize[0],this.padding,this.strides[0]),s=Lr(s,this.poolSize[1],this.padding,this.strides[1]),r=Lr(r,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[t[0],t[1],e,s,r]:[t[0],e,s,r,t[4]]}call(t,e){return at(()=>(this.invokeCallHook(t,e),this.poolingFunction(Wt(t),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}class pO extends fO{constructor(t){super(t)}poolingFunction(t,e,s,r,a){return un(a),er(r),iO(t,e,s,r,a,"max")}}pO.className="MaxPooling3D";Tt(pO);class mO extends fO{constructor(t){super(t)}poolingFunction(t,e,s,r,a){return un(a),er(r),iO(t,e,s,r,a,"avg")}}mO.className="AveragePooling3D";Tt(mO);class gO extends ae{constructor(t){super(t),this.inputSpec=[new Sn({ndim:3})]}computeOutputShape(t){return[t[0],t[2]]}call(t,e){throw new Jt}}class yO extends gO{constructor(t){super(t||{})}call(t,e){return at(()=>{const s=Wt(t);return Ze(s,1)})}}yO.className="GlobalAveragePooling1D";Tt(yO);class bO extends gO{constructor(t){super(t||{})}call(t,e){return at(()=>{const s=Wt(t);return vr(s,1)})}}bO.className="GlobalMaxPooling1D";Tt(bO);class xO extends ae{constructor(t){super(t),this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,un(this.dataFormat),this.inputSpec=[new Sn({ndim:4})]}computeOutputShape(t){return t=t,this.dataFormat==="channelsLast"?[t[0],t[3]]:[t[0],t[1]]}call(t,e){throw new Jt}getConfig(){const t={dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}class vO extends xO{call(t,e){return at(()=>{const s=Wt(t);return this.dataFormat==="channelsLast"?Ze(s,[1,2]):Ze(s,[2,3])})}}vO.className="GlobalAveragePooling2D";Tt(vO);class wO extends xO{call(t,e){return at(()=>{const s=Wt(t);return this.dataFormat==="channelsLast"?vr(s,[1,2]):vr(s,[2,3])})}}wO.className="GlobalMaxPooling2D";Tt(wO);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class SO extends ae{constructor(t){super(t),this.layer=t.layer}build(t){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(t){this.layer!=null&&(this.layer.trainable=t)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(t){this.layer.setWeights(t)}getConfig(){const t={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},e=super.getConfig();return Object.assign(t,e),t}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(t)}static fromConfig(t,e,s={}){const r=e.layer,a=Fa(r,s);delete e.layer;const i={layer:a};return Object.assign(i,e),new t(i)}}class CO extends SO{constructor(t){super(t),this.supportsMasking=!0}build(t){if(t=ye(t),t.length<3)throw new st(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(t)}`);this.inputSpec=[{shape:t}];const e=[t[0]].concat(t.slice(2));this.layer.built||(this.layer.build(e),this.layer.built=!0),super.build(t)}computeOutputShape(t){t=ye(t);const e=[t[0]].concat(t.slice(2)),s=this.layer.computeOutputShape(e),r=t[1];return[s[0],r].concat(s.slice(1))}call(t,e){return at(()=>(t=Wt(t),RR((i,l)=>[Wt(this.layer.call(i,e)),[]],t,[],!1,null,null,!1,!0)[1]))}}CO.className="TimeDistributed";Tt(CO);function Xq(n){Jo(p5,"BidirectionalMergeMode",n)}const Kq="concat";class NO extends SO{constructor(t){super(t);const e=t.layer.getConfig(),s={};s.className=t.layer.getClassName(),s.config=e,this.forwardLayer=Fa(s),e.goBackwards=e.goBackwards!==!0;const r={};if(r.className=t.layer.getClassName(),r.config=e,this.backwardLayer=Fa(r),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=t.mergeMode===void 0?Kq:t.mergeMode,Xq(this.mergeMode),t.weights)throw new Jt("weights support is not implemented for Bidirectional layer yet.");this._stateful=t.layer.stateful,this.returnSequences=t.layer.returnSequences,this.returnState=t.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=t.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(t){this._trainable=t,this.forwardLayer!=null&&(this.forwardLayer.trainable=t),this.backwardLayer!=null&&(this.backwardLayer.trainable=t)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(t){const e=t.length,s=Math.floor(e/2);this.forwardLayer.setWeights(t.slice(0,s)),this.backwardLayer.setWeights(t.slice(s))}computeOutputShape(t){let e=this.forwardLayer.computeOutputShape(t);Array.isArray(e)&&Array.isArray(e[0])||(e=[e]),e=e;let s,r,a;return this.returnState&&(a=e.slice(1)),s=e[0],s=s,this.mergeMode==="concat"?(s[s.length-1]*=2,r=[s]):this.mergeMode==null?r=[s,s.slice()]:r=[s],this.returnState?this.mergeMode==null?r.concat(a).concat(a.slice()):[s].concat(a).concat(a.slice()):ms(r)}apply(t,e){let s=e==null?null:e.initialState,r=e==null?null:e.constants;e==null&&(e={});const a=AR(t,s,r,this.numConstants);if(t=a.inputs,s=a.initialState,r=a.constants,Array.isArray(t)&&(s=t.slice(1),t=t[0]),(s==null||s.length===0)&&r==null)return super.apply(t,e);const i=[],l=[];if(s!=null){const h=s.length;if(h%2>0)throw new st("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");e.initialState=s,i.push(...s);const d=s.map(p=>new Sn({shape:p.shape}));this.forwardLayer.stateSpec=d.slice(0,h/2),this.backwardLayer.stateSpec=d.slice(h/2),l.push(...d)}if(r!=null)throw new Jt("Support for constants in Bidirectional layers is not implemented yet.");const u=i[0]instanceof la;for(const h of i)if(h instanceof la!==u)throw new st("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(u){const h=[t].concat(i),d=this.inputSpec.concat(l),p=this.inputSpec;this.inputSpec=d;const m=super.apply(h,e);return this.inputSpec=p,m}else return super.apply(t,e)}call(t,e){return at(()=>{const s=e.initialState;let r,a;if(s==null)r=this.forwardLayer.call(t,e),a=this.backwardLayer.call(t,e);else{const u=s.slice(0,s.length/2),h=s.slice(s.length/2);r=this.forwardLayer.call(t,Object.assign(e,{initialState:u})),a=this.backwardLayer.call(t,Object.assign(e,{initialState:h}))}let i;this.returnState&&(Array.isArray(r)&&(i=r.slice(1).concat(a.slice(1))),r=r[0],a=a[0]),this.returnSequences&&(a=Sr(a,1));let l;return this.mergeMode==="concat"?l=sS([r,a]):this.mergeMode==="sum"?l=St(r,a):this.mergeMode==="ave"?l=X(.5,St(r,a)):this.mergeMode==="mul"?l=X(r,a):this.mergeMode==null&&(l=[r,a]),this.returnState?this.mergeMode==null?l.concat(i):[l].concat(i):l})}resetStates(t){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(t){Io(this.forwardLayer.name,()=>{this.forwardLayer.build(t)}),Io(this.backwardLayer.name,()=>{this.backwardLayer.build(t)}),this.built=!0}computeMask(t,e){Array.isArray(e)&&(e=e[0]);let s;if(this.returnSequences?this.mergeMode==null?s=[e,e]:s=e:this.mergeMode==null?s=[null,null]:s=null,this.returnState){const a=this.forwardLayer.states.map(i=>null);return Array.isArray(s)?s.concat(a).concat(a):[s].concat(a).concat(a)}else return s}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(t),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(t)}getConfig(){const t={mergeMode:this.mergeMode},e=super.getConfig();return Object.assign(t,e),t}static fromConfig(t,e){const s=Fa(e.layer);if(delete e.layer,e.numConstants!=null)throw new Jt("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const r=e;return r.layer=s,new t(r)}}NO.className="Bidirectional";Tt(NO);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class TO extends ae{constructor(t){super(t),this.scale=t.scale,t.offset?this.offset=t.offset:this.offset=0}getConfig(){const t={scale:this.scale,offset:this.offset},e=super.getConfig();return Object.assign(t,e),t}call(t,e){return at(()=>(t=Wt(t),t.dtype!=="float32"&&(t=aa(t,"float32")),St(X(t,this.scale),this.offset)))}}TO.className="Rescaling";Tt(TO);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const{resizeBilinear:Yq,cropAndResize:Zq}=Es;class $O extends ae{constructor(t){super(t),this.height=t.height,this.width=t.width}centerCrop(t,e,s,r,a,i,l,u){return at(()=>{let h,d=!1;const p=e/i,m=s/l,y=(r+e)/i,b=(a+s)/l,x=[p,m,y,b],v=[];t.rank===3?(d=!0,h=Ls([t])):h=t;for(let I=0;I<h.shape[0];I++)v.push(x);const S=_r(v,[v.length,4]),C=pu(0,v.length,1,"int32"),T=Zq(h,S,C,[r,a],"nearest");return aa(d?Wt(Cr(T)):T,u)})}upsize(t,e,s,r){return at(()=>{const a=Yq(t,[e,s]);return aa(a,r)})}call(t,e){return at(()=>{const s=Wt(t),r=s.dtype,a=s.shape,i=a[a.length-3],l=a[a.length-2];let u=0;i!==this.height&&(u=Math.floor((i-this.height)/2));let h=0;return l!==this.width&&(h=Math.floor((l-this.width)/2),h===0&&(h=1)),u>=0&&h>=0?this.centerCrop(s,u,h,this.height,this.width,i,l,r):this.upsize(t,this.height,this.width,r)})}getConfig(){const t={height:this.height,width:this.width},e=super.getConfig();return Object.assign(t,e),t}computeOutputShape(t){t=ye(t);const e=t.length-3,s=t.length-2;return t[e]=this.height,t[s]=this.width,t}}$O.className="CenterCrop";Tt($O);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Qq(n,t,e,s){let r=Wt(n);if(r.dtype!=="int32"&&(r=aa(r,"int32")),t==="int")return r;const a=r.shape;if(r.rank===0&&(r=Qn(r,-1)),t==="oneHot"&&r.shape[r.shape.length-1]!==1&&(r=Qn(r,-1)),r.rank>2)throw new st(`When outputMode is not int, maximum output rank is 2 Received outputMode ${t} and input shape ${a} which would result in output rank ${r.rank}.`);const i=["multiHot","oneHot"].includes(t),l=r;let u;if(typeof s<"u"&&t==="count"?u=Gx(l,s,e,i):u=Gx(l,[],e,i),t!=="tfIdf")return u;if(s)return X(u,s);throw new st("When outputMode is 'tfIdf', weights must be provided.")}/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class kO extends ae{constructor(t){super(t),this.numTokens=t.numTokens,t.outputMode?this.outputMode=t.outputMode:this.outputMode="multiHot"}getConfig(){const t={numTokens:this.numTokens,outputMode:this.outputMode},e=super.getConfig();return Object.assign(t,e),t}computeOutputShape(t){return t=ye(t),t==null?[this.numTokens]:this.outputMode==="oneHot"&&t[t.length-1]!==1?(t.push(this.numTokens),t):(t[t.length-1]=this.numTokens,t)}call(t,e){return at(()=>{t=Wt(t),t.dtype!=="int32"&&(t=aa(t,"int32"));let s;if(typeof e.countWeights<"u"){if(this.outputMode!=="count")throw new st(`countWeights is not used when outputMode !== count.
              Received countWeights=${e.countWeights}`);s=Wt(e.countWeights)}const r=vr(t),a=uh(t),i=Ps(this.numTokens,r).bufferSync().get(0),l=Hi(a,0).bufferSync().get(0);if(!(i&&l))throw new st(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return Qq(t,this.outputMode,this.numTokens,s)})}}kO.className="CategoryEncoding";Tt(kO);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Jq=["bilinear","nearest"],ek=new Set(Jq);class IO extends ae{constructor(t){if(super(t),this.height=t.height,this.width=t.width,t.interpolation)if(ek.has(t.interpolation))this.interpolation=t.interpolation;else throw new st(`Invalid interpolation parameter: ${t.interpolation} is not implemented`);else this.interpolation="bilinear";this.cropToAspectRatio=!!t.cropToAspectRatio}computeOutputShape(t){t=ye(t);const e=t[2];return[this.height,this.width,e]}getConfig(){const t={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},e=super.getConfig();return Object.assign(t,e),t}call(t,e){return at(()=>{const s=[this.height,this.width];if(this.interpolation==="bilinear")return Es.resizeBilinear(t,s,!this.cropToAspectRatio);if(this.interpolation==="nearest")return Es.resizeNearestNeighbor(t,s,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[...ek]} are supported`)})}}IO.className="Resizing";Tt(IO);/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class EO{constructor(t){this.seed=t}next(){if(this.seed!==void 0)return this.seed++}}EO.className="RandomSeed";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class DO extends ae{constructor(t){super(t),this.randomGenerator=new EO(t.seed)}getConfig(){const t={seed:this.randomGenerator.seed},e=super.getConfig();return Object.assign(t,e),t}}DO.className="BaseRandomLayer";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const t8=["bilinear","nearest"],nk=new Set(t8);class AO extends DO{constructor(t){super(t);const{factor:e,interpolation:s="bilinear"}=t;if(this.factor=e,Array.isArray(this.factor)&&this.factor.length===2)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else if(!Array.isArray(this.factor)&&this.factor>0)this.widthLower=-this.factor,this.widthUpper=this.factor;else throw new st(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);if(this.widthLower<-1||this.widthUpper<-1)throw new st(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new st(`factor cannot have upper bound less than lower bound.
        Got upper bound: ${this.widthUpper}.
        Got lower bound: ${this.widthLower}
      `);if(s)if(nk.has(s))this.interpolation=s;else throw new st(`Invalid interpolation parameter: ${s} is not implemented`)}getConfig(){const t={factor:this.factor,interpolation:this.interpolation},e=super.getConfig();return Object.assign(t,e),t}computeOutputShape(t){t=ye(t);const e=t[2];return[this.imgHeight,-1,e]}call(t,e){return at(()=>{const s=Wt(t);this.imgHeight=s.shape[s.shape.length-3];const r=s.shape[s.shape.length-2];this.widthFactor=Zo([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let a=this.widthFactor.dataSync()[0]*r;a=Math.round(a);const i=[this.imgHeight,a];switch(this.interpolation){case"bilinear":return Es.resizeBilinear(t,i);case"nearest":return Es.resizeNearestNeighbor(t,i);default:throw new Error(`Interpolation is ${this.interpolation}
          but only ${[...nk]} are supported`)}})}}AO.className="RandomWidth";Tt(AO);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e8=ut();e8.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,n=>{n&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var Ts;(function(n){n[n.DT_INVALID=0]="DT_INVALID",n[n.DT_FLOAT=1]="DT_FLOAT",n[n.DT_DOUBLE=2]="DT_DOUBLE",n[n.DT_INT32=3]="DT_INT32",n[n.DT_UINT8=4]="DT_UINT8",n[n.DT_INT16=5]="DT_INT16",n[n.DT_INT8=6]="DT_INT8",n[n.DT_STRING=7]="DT_STRING",n[n.DT_COMPLEX64=8]="DT_COMPLEX64",n[n.DT_INT64=9]="DT_INT64",n[n.DT_BOOL=10]="DT_BOOL",n[n.DT_QINT8=11]="DT_QINT8",n[n.DT_QUINT8=12]="DT_QUINT8",n[n.DT_QINT32=13]="DT_QINT32",n[n.DT_BFLOAT16=14]="DT_BFLOAT16",n[n.DT_QINT16=15]="DT_QINT16",n[n.DT_QUINT16=16]="DT_QUINT16",n[n.DT_UINT16=17]="DT_UINT16",n[n.DT_COMPLEX128=18]="DT_COMPLEX128",n[n.DT_HALF=19]="DT_HALF",n[n.DT_RESOURCE=20]="DT_RESOURCE",n[n.DT_VARIANT=21]="DT_VARIANT",n[n.DT_UINT32=22]="DT_UINT32",n[n.DT_UINT64=23]="DT_UINT64",n[n.DT_FLOAT_REF=101]="DT_FLOAT_REF",n[n.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",n[n.DT_INT32_REF=103]="DT_INT32_REF",n[n.DT_UINT8_REF=104]="DT_UINT8_REF",n[n.DT_INT16_REF=105]="DT_INT16_REF",n[n.DT_INT8_REF=106]="DT_INT8_REF",n[n.DT_STRING_REF=107]="DT_STRING_REF",n[n.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",n[n.DT_INT64_REF=109]="DT_INT64_REF",n[n.DT_BOOL_REF=110]="DT_BOOL_REF",n[n.DT_QINT8_REF=111]="DT_QINT8_REF",n[n.DT_QUINT8_REF=112]="DT_QUINT8_REF",n[n.DT_QINT32_REF=113]="DT_QINT32_REF",n[n.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",n[n.DT_QINT16_REF=115]="DT_QINT16_REF",n[n.DT_QUINT16_REF=116]="DT_QUINT16_REF",n[n.DT_UINT16_REF=117]="DT_UINT16_REF",n[n.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",n[n.DT_HALF_REF=119]="DT_HALF_REF",n[n.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",n[n.DT_VARIANT_REF=121]="DT_VARIANT_REF",n[n.DT_UINT32_REF=122]="DT_UINT32_REF",n[n.DT_UINT64_REF=123]="DT_UINT64_REF"})(Ts||(Ts={}));var sk;(function(n){(function(t){t[t.LEGACY=0]="LEGACY",t[t.V1=1]="V1",t[t.V2=2]="V2"})(n.CheckpointFormatVersion||(n.CheckpointFormatVersion={}))})(sk||(sk={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n8={};function RO(n){return n8[n]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k(n,t,e,s,r){const a=t.inputParams[n];if(a&&a.inputIndexStart!==void 0){const l=a.inputIndexStart,u=a.inputIndexEnd===0?void 0:a.inputIndexEnd===void 0?l+1:a.inputIndexEnd,h=l<0?t.inputNames.length+l:l;if(a.type==="tensor")return Pn(t.inputNames[h],e,s,r);if(a.type==="tensors"){const m=t.inputs.slice(l,u);return t.inputNames.slice(l,u).filter((b,x)=>{var v;return((v=m[x])===null||v===void 0?void 0:v.op)!=="NoOp"}).map(b=>Pn(b,e,s,r))}const d=Pn(t.inputNames[h],e,s,r),p=d.dataSync();return a.type==="number"?p[0]:xr(d.shape,p)}const i=t.attrParams[n];return i&&i.value}function Pn(n,t,e,s){const[r,a]=$s(n,e);if(s!=null){const l=s.getHashTableHandleByName(r);if(l!=null)return l}const i=e.currentContextIds.find(l=>!!t[im(r,l)]);return i!==void 0?t[im(r,i)][a]:void 0}function rk(n,t,e){return t[im(n,e.currentContextId)]}function Aa(n,t){const[e,s,r]=$s(n,t);return[im(e,t&&t.currentContextId),s,r]}function im(n,t){return t?`${n}-${t}`:n}function $s(n,t){if(n==="")return["",0,void 0];const e=t!=null&&t.parseNodeNameCache!=null;if(e){const a=t.parseNodeNameCache.get(n);if(a!=null)return a}const s=n.split(":");let r;if(s.length===1)r=[n,0,void 0];else{const a=s[0],i=s.length===3?s[1]:void 0,l=Number(s[s.length-1]);r=[a,l,i]}return e&&t.parseNodeNameCache.set(n,r),r}function Ap(n,t,e){let s=k("pad",n,t,e);if(s==="explicit"){s=k("explicitPaddings",n,t,e);const r=[[0,0],[0,0],[0,0],[0,0]];for(let a=0;a<4;a++)r[a][0]=s[a*2],r[a][1]=s[a*2+1];return r}return s}function Ra(n){return n.kept?n:_a(n)}/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s8=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],r8=Object.freeze(Object.defineProperty({__proto__:null,json:s8},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a8=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsFinite",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsInf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],i8=Object.freeze(Object.defineProperty({__proto__:null,json:a8},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o8=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],l8=Object.freeze(Object.defineProperty({__proto__:null,json:o8},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const u8=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],c8=Object.freeze(Object.defineProperty({__proto__:null,json:u8},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h8=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniformInt",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number"},{tfName:"maxval",name:"maxval",type:"number"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],d8=Object.freeze(Object.defineProperty({__proto__:null,json:h8},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const f8=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],p8=Object.freeze(Object.defineProperty({__proto__:null,json:f8},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const m8=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],g8=Object.freeze(Object.defineProperty({__proto__:null,json:m8},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y8=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],b8=Object.freeze(Object.defineProperty({__proto__:null,json:y8},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x8=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"InitializeTable",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]},{tfOpName:"InitializeTableV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],v8=Object.freeze(Object.defineProperty({__proto__:null,json:x8},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w8=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],S8=Object.freeze(Object.defineProperty({__proto__:null,json:w8},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C8=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BitwiseAnd",category:"logical",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}]}],N8=Object.freeze(Object.defineProperty({__proto__:null,json:C8},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T8=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"MatrixBandPart",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"numLower",type:"tensor"},{start:1,name:"numUpper",type:"tensor"}]}],$8=Object.freeze(Object.defineProperty({__proto__:null,json:T8},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k8=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]}],I8=Object.freeze(Object.defineProperty({__proto__:null,json:k8},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E8=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],D8=Object.freeze(Object.defineProperty({__proto__:null,json:E8},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A8=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]},{tfOpName:"TensorScatterUpdate",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],R8=Object.freeze(Object.defineProperty({__proto__:null,json:A8},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O8=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],_8=Object.freeze(Object.defineProperty({__proto__:null,json:O8},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F8=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],L8=Object.freeze(Object.defineProperty({__proto__:null,json:F8},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const z8=[{tfOpName:"StaticRegexReplace",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"pattern",name:"pattern",type:"string"},{tfName:"rewrite",name:"rewrite",type:"string"},{tfName:"replace_global",name:"replaceGlobal",type:"bool"}]},{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],M8=Object.freeze(Object.defineProperty({__proto__:null,json:z8},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const B8=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"EnsureShape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}],P8=Object.freeze(Object.defineProperty({__proto__:null,json:B8},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ak{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const t=[r8,i8,l8,c8,d8,p8,g8,b8,v8,S8,N8,$8,I8,D8,R8,_8,L8,M8,P8],e=[].concat(...t.map(s=>s.json));this.opMappers=e.reduce((s,r)=>(s[r.tfOpName]=r,s),{})}transformGraph(t,e={}){const s=t.node,r=[],a=[],i=[],l=s.reduce((x,v)=>(x[v.name]=this.mapNode(v),v.op.startsWith("Placeholder")?r.push(x[v.name]):v.op==="Const"?a.push(x[v.name]):(v.input==null||v.input.length===0)&&i.push(x[v.name]),x),{});let u=[];const h=[];let d={},p={};e!=null&&(d=this.mapSignatureEntries(e.inputs),p=this.mapSignatureEntries(e.outputs));const m=Object.keys(l);m.forEach(x=>{const v=l[x];v.inputNames.forEach((S,C)=>{const[$,,T]=Aa(S),I=l[$];if(I.outputs!=null){const A=I.outputs.indexOf(T);if(A!==-1){const R=`${$}:${A}`;v.inputNames[C]=R}}v.inputs.push(I),I.children.push(v)})}),Object.keys(p).length===0?m.forEach(x=>{const v=l[x];v.children.length===0&&h.push(v)}):Object.keys(p).forEach(x=>{const[v]=Aa(x),S=l[v];S!=null&&(S.signatureKey=p[x],h.push(S))}),Object.keys(d).length>0?Object.keys(d).forEach(x=>{const[v]=Aa(x),S=l[v];S&&(S.signatureKey=d[x],u.push(S))}):u=r;let y={};t.library!=null&&t.library.function!=null&&(y=t.library.function.reduce((x,v)=>(x[v.signature.name]=this.mapFunction(v),x),{}));const b={nodes:l,inputs:u,outputs:h,weights:a,placeholders:r,signature:e,functions:y};return i.length>0&&(b.initNodes=i),b}mapSignatureEntries(t){return Object.keys(t||{}).reduce((e,s)=>(e[t[s].name]=s,e),{})}mapNode(t){const e=RO(t.op)||this.opMappers[t.op]||{};t.attr==null&&(t.attr={});const s={name:t.name,op:t.op,category:e.category,inputNames:(t.input||[]).map(r=>r.startsWith("^")?r.slice(1):r),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:t.attr,outputs:e.outputs};return e.inputs!=null&&(s.inputParams=e.inputs.reduce((r,a)=>(r[a.name]={type:a.type,inputIndexStart:a.start,inputIndexEnd:a.end},r),{})),e.attrs!=null&&(s.attrParams=e.attrs.reduce((r,a)=>{const i=a.type;let l;switch(a.type){case"string":l=r1(t.attr,a.tfName,a.defaultValue),l===void 0&&a.tfDeprecatedName&&(l=r1(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"string[]":l=h1(t.attr,a.tfName,a.defaultValue),l===void 0&&a.tfDeprecatedName&&(l=h1(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"number":l=i1(t.attr,a.tfName,a.defaultValue||0),l===void 0&&a.tfDeprecatedName&&(l=i1(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"number[]":l=c1(t.attr,a.tfName,a.defaultValue),l===void 0&&a.tfDeprecatedName&&(l=c1(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"bool":l=a1(t.attr,a.tfName,a.defaultValue),l===void 0&&a.tfDeprecatedName&&(l=a1(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"bool[]":l=f1(t.attr,a.tfName,a.defaultValue),l===void 0&&a.tfDeprecatedName&&(l=f1(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"shape":l=u1(t.attr,a.tfName,a.defaultValue),l===void 0&&a.tfDeprecatedName&&(l=u1(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"shape[]":l=d1(t.attr,a.tfName,a.defaultValue),l===void 0&&a.tfDeprecatedName&&(l=d1(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"dtype":l=o1(t.attr,a.tfName,a.defaultValue),l===void 0&&a.tfDeprecatedName&&(l=o1(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"dtype[]":l=l1(t.attr,a.tfName,a.defaultValue),l===void 0&&a.tfDeprecatedName&&(l=l1(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"func":l=ik(t.attr,a.tfName,a.defaultValue),l===void 0&&a.tfDeprecatedName&&(l=ik(t.attr,a.tfDeprecatedName,a.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${a.type} for op: ${t.op}`)}return r[a.name]={value:l,type:i},r},{})),s}mapFunction(t){const e=t.nodeDef,s=[],r=[];let a={};e!=null&&(a=e.reduce((p,m)=>(p[m.name]=this.mapNode(m),m.op==="Const"&&r.push(p[m.name]),p),{}));const i=[],l=[];t.signature.inputArg.forEach(p=>{const[m]=Aa(p.name),y={name:m,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:SS(p.type),type:"dtype"}},children:[]};y.signatureKey=p.name,i.push(y),a[m]=y}),Object.keys(a).forEach(p=>{const m=a[p];m.inputNames.forEach((y,b)=>{const[x,,v]=Aa(y),S=a[x];if(S.outputs!=null){const C=S.outputs.indexOf(v);if(C!==-1){const $=`${x}:${C}`;m.inputNames[b]=$}}m.inputs.push(S),S.children.push(m)})});const h=t.ret;t.signature.outputArg.forEach(p=>{const[m,y]=Aa(h[p.name]),b=a[m];b!=null&&(b.defaultOutput=y,l.push(b))});const d=this.mapArgsToSignature(t);return{nodes:a,inputs:i,outputs:l,weights:r,placeholders:s,signature:d}}mapArgsToSignature(t){return{methodName:t.signature.name,inputs:t.signature.inputArg.reduce((e,s)=>(e[s.name]=this.mapArgToTensorInfo(s),e),{}),outputs:t.signature.outputArg.reduce((e,s)=>(e[s.name]=this.mapArgToTensorInfo(s,t.ret),e),{})}}mapArgToTensorInfo(t,e){let s=t.name;return e!=null&&(s=e[s]),{name:s,dtype:t.type}}}function V8(n){const t=ut().global;if(typeof t.atob<"u")return t.atob(n);if(typeof Buffer<"u")return new Buffer(n,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function OO(n,t){const e=Array.isArray(n)?String.fromCharCode.apply(null,n):V8(n);return t?e:e.toLowerCase()}function r1(n,t,e,s=!1){const r=n[t];return r!=null?OO(r.s,s):e}function a1(n,t,e){const s=n[t];return s?s.b:e}function i1(n,t,e){const s=n[t]||{},r=s.i!=null?s.i:s.f!=null?s.f:e;return typeof r=="number"?r:parseInt(r,10)}function SS(n){switch(typeof n=="string"&&(n=Ts[n]),n){case Ts.DT_FLOAT:case Ts.DT_HALF:return"float32";case Ts.DT_INT32:case Ts.DT_INT64:case Ts.DT_INT8:case Ts.DT_UINT8:return"int32";case Ts.DT_BOOL:return"bool";case Ts.DT_DOUBLE:return"float32";case Ts.DT_STRING:return"string";case Ts.DT_COMPLEX64:case Ts.DT_COMPLEX128:return"complex64";default:return null}}function ik(n,t,e){const s=n[t];return s&&s.func?s.func.name:e}function o1(n,t,e){const s=n[t];return s&&s.type?SS(s.type):e}function l1(n,t,e){const s=n[t];return s&&s.list&&s.list.type?s.list.type.map(r=>SS(r)):e}function _O(n){if(!n.unknownRank)return n.dim!=null?n.dim.map(t=>typeof t.size=="number"?t.size:parseInt(t.size,10)):[]}function u1(n,t,e){const s=n[t];return s&&s.shape?_O(s.shape):e}function c1(n,t,e){const s=n[t];return s?((s.list.f&&s.list.f.length?s.list.f:s.list.i)||[]).map(r=>typeof r=="number"?r:parseInt(r,10)):e}function h1(n,t,e,s=!1){const r=n[t];return r&&r.list&&r.list.s?r.list.s.map(a=>OO(a,s)):e}function d1(n,t,e){const s=n[t];return s&&s.list&&s.list.shape?s.list.shape.map(r=>_O(r)):e}function f1(n,t,e){const s=n[t];return s&&s.list&&s.list.b?s.list.b:e}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class U8{constructor(t,e,s){this.node=t,this.tensorMap=e,this.context=s,this.inputs=[],this.attrs={},this.inputs=t.inputNames.map(r=>this.getInput(r)),t.rawAttrs!=null&&(this.attrs=Object.keys(t.rawAttrs).reduce((r,a)=>(r[a]=this.getAttr(a),r),{}))}getInput(t){return Pn(t,this.tensorMap,this.context)}getAttr(t,e){const s=this.node.rawAttrs[t];if(s.tensor!=null)return Pn(t,this.tensorMap,this.context);if(s.i!=null||s.f!=null)return i1(this.node.rawAttrs,t,e);if(s.s!=null)return r1(this.node.rawAttrs,t,e);if(s.b!=null)return a1(this.node.rawAttrs,t,e);if(s.shape!=null)return u1(this.node.rawAttrs,t,e);if(s.type!=null)return o1(this.node.rawAttrs,t,e);if(s.list!=null){if(s.list.i!=null||s.list.f!=null)return c1(this.node.rawAttrs,t,e);if(s.list.s!=null)return h1(this.node.rawAttrs,t,e);if(s.list.shape!=null)return d1(this.node.rawAttrs,t,e);if(s.list.b!=null)return f1(this.node.rawAttrs,t,e);if(s.list.type!=null)return l1(this.node.rawAttrs,t,e)}return e}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qn=Object.freeze(Object.defineProperty({__proto__:null,OP_SCOPE_SUFFIX:eE,abs:bn,acos:xE,acosh:vE,add:St,addN:r4,all:Gv,any:Kp,argMax:hu,argMin:wE,asin:SE,asinh:CE,atan:NE,atan2:TE,atanh:$E,avgPool:Ag,avgPool3d:kE,basicLSTMCell:k4,batchNorm:wd,batchNorm2d:IE,batchNorm3d:EE,batchNorm4d:DE,batchToSpaceND:Rg,bincount:AE,bitwiseAnd:L4,booleanMaskAsync:vG,broadcastArgs:M4,broadcastTo:au,buffer:te,cast:kt,ceil:RE,clipByValue:_s,clone:_a,complex:Ii,concat:pn,concat1d:OE,concat2d:Hv,concat3d:_E,concat4d:FE,conv1d:jv,conv2d:Ai,conv2dTranspose:Xv,conv3d:LE,conv3dTranspose:ME,cos:Og,cosh:Kv,cosineWindow:vw,cumprod:Yp,cumsum:Yv,denseBincount:Gx,depthToSpace:BE,depthwiseConv2d:Sd,diag:oP,dilation2d:PE,div:_t,divNoNan:VE,dot:UE,dropout:pD,einsum:Ql,elu:Cd,enclosingPowerOfTwo:mD,ensureShape:yP,equal:Mr,erf:Zv,euclideanNorm:HE,exp:Fs,expandDims:Qn,expm1:jE,eye:Jv,fft:qg,fill:Ru,floor:Td,floorDiv:Uv,fused:UG,gather:$d,gatherND:DG,greater:Ps,greaterEqual:Hi,ifft:fh,imag:_g,image:Es,inTopKAsync:_G,irfft:pw,isFinite:qE,isInf:XE,isNaN:KE,leakyRelu:Fg,less:ch,lessEqual:Yo,linalg:CD,linspace:GP,localResponseNormalization:YE,log:Qs,log1p:Lg,logSigmoid:ZE,logSoftmax:tw,logSumExp:zg,logicalAnd:oa,logicalNot:Mg,logicalOr:ew,logicalXor:QE,losses:xH,lowerBound:aV,matMul:le,max:vr,maxPool:Bg,maxPool3d:JE,maxPoolWithArgmax:uV,maximum:Wa,mean:Ze,meshgrid:dV,min:uh,minimum:Uo,mirrorPad:tD,mod:eD,moments:Pg,movingAverage:CG,mul:X,multiRNNCell:bV,multinomial:vV,neg:Be,norm:Nd,notEqual:fu,oneHot:sw,ones:Is,onesLike:Js,op:q,outerProduct:TV,pad:ji,pad1d:IV,pad2d:DV,pad3d:RV,pad4d:_V,pool:nD,pow:La,prelu:Ug,print:bE,prod:sD,raggedGather:UV,raggedRange:WV,raggedTensorToTensor:jV,rand:XV,randomGamma:gU,randomNormal:aw,randomStandardNormal:xU,randomUniform:Zo,randomUniformInt:SU,range:pu,real:hh,reciprocal:rD,relu:ca,relu6:iw,reshape:J,reverse:Sr,reverse1d:EU,reverse2d:AU,reverse3d:OU,reverse4d:FU,rfft:Xg,round:ow,rsqrt:lw,scalar:Vt,scatterND:TG,searchSorted:nw,selu:uw,separableConv2d:cw,setdiff1dAsync:VU,sigmoid:Fr,sign:aD,signal:bH,sin:hw,sinh:dw,slice:Qt,slice1d:Wg,slice2d:fw,slice3d:Hg,slice4d:dh,softmax:jg,softplus:Ou,spaceToBatchND:Vg,sparse:vH,sparseToDense:IG,spectral:yH,split:As,sqrt:Wn,square:Ae,squaredDifference:mw,squeeze:Ma,stack:Ls,step:_u,stridedSlice:iD,string:wH,sub:Rt,sum:Ft,tan:oD,tanh:Vo,tensor:_r,tensor1d:Un,tensor2d:iu,tensor3d:lD,tensor4d:oG,tensor5d:lG,tensor6d:uG,tensorScatterUpdate:hG,tile:gr,topk:cD,transpose:fe,truncatedNormal:yw,unique:hD,unsortedSegmentSum:bw,unstack:Cr,upperBound:yG,variable:dD,where:Jn,whereAsync:fD,zeros:vn,zerosLike:pe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G8=(n,t,e,s=qn)=>{switch(n.op){case"BiasAdd":case"AddV2":case"Add":return[s.add(k("a",n,t,e),k("b",n,t,e))];case"AddN":return[s.addN(k("tensors",n,t,e))];case"FloorMod":case"Mod":return[s.mod(k("a",n,t,e),k("b",n,t,e))];case"Mul":return[s.mul(k("a",n,t,e),k("b",n,t,e))];case"RealDiv":case"Div":return[s.div(k("a",n,t,e),k("b",n,t,e))];case"DivNoNan":return[s.divNoNan(k("a",n,t,e),k("b",n,t,e))];case"FloorDiv":return[s.floorDiv(k("a",n,t,e),k("b",n,t,e))];case"Sub":return[s.sub(k("a",n,t,e),k("b",n,t,e))];case"Minimum":return[s.minimum(k("a",n,t,e),k("b",n,t,e))];case"Maximum":return[s.maximum(k("a",n,t,e),k("b",n,t,e))];case"Pow":return[s.pow(k("a",n,t,e),k("b",n,t,e))];case"SquaredDifference":return[s.squaredDifference(k("a",n,t,e),k("b",n,t,e))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const W8=(n,t,e,s=qn)=>{switch(n.op){case"Abs":case"ComplexAbs":return[s.abs(k("x",n,t,e))];case"Acos":return[s.acos(k("x",n,t,e))];case"Acosh":return[s.acosh(k("x",n,t,e))];case"Asin":return[s.asin(k("x",n,t,e))];case"Asinh":return[s.asinh(k("x",n,t,e))];case"Atan":return[s.atan(k("x",n,t,e))];case"Atan2":return[s.atan2(k("x",n,t,e),k("y",n,t,e))];case"Atanh":return[s.atanh(k("x",n,t,e))];case"Ceil":return[s.ceil(k("x",n,t,e))];case"Complex":return[s.complex(k("real",n,t,e),k("imag",n,t,e))];case"Cos":return[s.cos(k("x",n,t,e))];case"Cosh":return[s.cosh(k("x",n,t,e))];case"Elu":return[s.elu(k("x",n,t,e))];case"Erf":return[s.erf(k("x",n,t,e))];case"Exp":return[s.exp(k("x",n,t,e))];case"Expm1":return[s.expm1(k("x",n,t,e))];case"Floor":return[s.floor(k("x",n,t,e))];case"Log":return[s.log(k("x",n,t,e))];case"Log1p":return[s.log1p(k("x",n,t,e))];case"Imag":return[s.imag(k("x",n,t,e))];case"Neg":return[s.neg(k("x",n,t,e))];case"Reciprocal":return[s.reciprocal(k("x",n,t,e))];case"Real":return[s.real(k("x",n,t,e))];case"Relu":return[s.relu(k("x",n,t,e))];case"Round":return[s.round(k("x",n,t,e))];case"Selu":return[s.selu(k("x",n,t,e))];case"Sigmoid":return[s.sigmoid(k("x",n,t,e))];case"Sin":return[s.sin(k("x",n,t,e))];case"Sign":return[s.sign(k("x",n,t,e))];case"Sinh":return[s.sinh(k("x",n,t,e))];case"Softplus":return[s.softplus(k("x",n,t,e))];case"Sqrt":return[s.sqrt(k("x",n,t,e))];case"Square":return[s.square(k("x",n,t,e))];case"Tanh":return[s.tanh(k("x",n,t,e))];case"Tan":return[s.tan(k("x",n,t,e))];case"ClipByValue":return[s.clipByValue(k("x",n,t,e),k("clipValueMin",n,t,e),k("clipValueMax",n,t,e))];case"Relu6":return[s.relu6(k("x",n,t,e))];case"Rsqrt":return[s.rsqrt(Pn(n.inputNames[0],t,e))];case"LeakyRelu":return[s.leakyRelu(k("x",n,t,e),k("alpha",n,t,e))];case"Prelu":return[s.prelu(k("x",n,t,e),k("alpha",n,t,e))];case"IsNan":return[s.isNaN(Pn(n.inputNames[0],t,e))];case"IsInf":return[s.isInf(Pn(n.inputNames[0],t,e))];case"IsFinite":return[s.isFinite(Pn(n.inputNames[0],t,e))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pr(n,t,e=""){if(!(typeof n=="number"||typeof t=="number")){F(n.length===t.length,()=>e+` Shapes ${n} and ${t} must match`);for(let s=0;s<n.length;s++){const r=n[s],a=t[s];F(r<0||a<0||r===a,()=>e+` Shapes ${n} and ${t} must match`)}}}function ok(n){return!(typeof n=="number"||n.some(t=>t<0))}function Zc(n,t,e){let s=p1(n,e);const r=!ok(s);if(r&&t.length===0)throw new Error(`Tried to calculate elements of an empty list with non-fully-defined elementShape: ${s}`);if(r&&t.forEach(a=>{s=p1(a.shape,s)}),!ok(s))throw new Error(`Non-fully-defined elementShape: ${s}`);return s}function p1(n,t){if(typeof n=="number")return t;if(typeof t=="number")return n;if(n.length!==t.length)throw new Error(`Incompatible ranks during merge: ${n} vs. ${t}`);const e=[];for(let s=0;s<n.length;++s){const r=n[s],a=t[s];if(r>=0&&a>=0&&r!==a)throw new Error(`Incompatible shape during merge: ${n} vs. ${t}`);e[s]=r>=0?r:a}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class H8{constructor(t,e,s,r,a,i,l){this.name=t,this.dtype=e,this.maxSize=s,this.elementShape=r,this.identicalElementShapes=a,this.dynamicSize=i,this.clearAfterRead=l,this.tensors=[],this.closed_=!1,this.idTensor=Vt(0),An(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(t){this.tensors.forEach(e=>{(t==null||!t.has(e.tensor.id))&&e.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(t){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(t<0||t>=this.size())throw new Error(`Tried to read from index ${t}, but array size is: ${this.size()}`);const e=this.tensors[t];if(e.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${t} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(e.cleared=!0),e.read=!0,e.tensor}readMany(t){return t.map(e=>this.read(e))}write(t,e){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(t<0||!this.dynamicSize&&t>=this.maxSize)throw new Error(`Tried to write to index ${t}, but array is not resizeable and size is: ${this.maxSize}`);const s=this.tensors[t]||{};if(e.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${t},
          because the value dtype is ${e.dtype}, but TensorArray dtype is ${this.dtype}.`);if(this.size()===0&&(this.elementShape==null||this.elementShape.length===0)&&(this.elementShape=e.shape),pr(this.elementShape,e.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${t}.`),s.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${t}, because it has already been read.`);if(s.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${t}, because it has already been written.`);s.tensor=e,An(e),s.written=!0,this.tensors[t]=s}writeMany(t,e){if(t.length!==e.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${t.length} is not the same as tensors size: ${e.length}.`);t.forEach((s,r)=>this.write(s,e[r]))}gather(t,e){if(e&&e!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${e}`);if(t)t=t.slice(0,this.size());else{t=[];for(let r=0;r<this.size();r++)t.push(r)}if(t.length===0)return _r([],[0].concat(this.elementShape));const s=this.readMany(t);return pr(this.elementShape,s[0].shape,"TensorArray shape mismatch: "),Ls(s,0)}concat(t){if(t&&t!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${t}`);if(this.size()===0)return _r([],[0].concat(this.elementShape));const e=[];for(let r=0;r<this.size();r++)e.push(r);const s=this.readMany(e);return pr(this.elementShape,s[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${s[0].shape})`),pn(s,0)}scatter(t,e){if(e.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${e.dtype}`);if(t.length!==e.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${t.length} vs. ${e.shape[0]}`);const s=Math.max(...t);if(!this.dynamicSize&&s>=this.maxSize)throw new Error(`Max index must be < array size (${s}  vs. ${this.maxSize})`);this.writeMany(t,Cr(e,0))}split(t,e){if(e.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${e.dtype}`);let s=0;const r=t.map(u=>(s+=u,s));if(s!==e.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${s}, and tensor's shape is: ${e.shape}`);if(!this.dynamicSize&&t.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${t.length}), and the TensorArray is not marked as dynamically resizeable`);const a=s===0?0:e.size/s,i=[];at(()=>{e=J(e,[1,s,a]);for(let u=0;u<t.length;++u){const d=[0,u===0?0:r[u-1],0],p=[1,t[u],a];i[u]=J(Qt(e,d,p),this.elementShape)}return i});const l=[];for(let u=0;u<t.length;u++)l[u]=u;this.writeMany(l,i)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ho{get id(){return this.idTensor.id}constructor(t,e,s,r=-1){this.tensors=t,this.elementShape=e,this.elementDtype=s,t!=null&&t.forEach(a=>{if(s!==a.dtype)throw new Error(`Invalid data types; op elements ${s}, but list elements ${a.dtype}`);pr(e,a.shape,"TensorList shape mismatch: "),An(a)}),this.idTensor=Vt(0),this.maxNumElements=r,An(this.idTensor)}copy(){return new Ho([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(t){this.tensors.forEach(e=>{(t==null||!t.has(e.id))&&e.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(t,e,s=-1){if(e!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e}, but list elements ${this.elementDtype}`);if(s!==-1&&this.tensors.length!==s)throw new Error(`Operation expected a list with ${s} elements but got a list with ${this.tensors.length} elements.`);pr(t,this.elementShape,"TensorList shape mismatch: ");const r=Zc(this.elementShape,this.tensors,t);return at(()=>{const a=this.tensors.map(i=>J(i,r));return Ls(a,0)})}popBack(t,e){if(e!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e}, but list elements ${this.elementDtype}`);if(this.size()===0)throw new Error("Trying to pop from an empty list.");const s=Zc(this.elementShape,this.tensors,t),r=this.tensors.pop();return r.kept=!1,pr(r.shape,t,"TensorList shape mismatch: "),J(r,s)}pushBack(t){if(t.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${this.elementDtype}`);if(pr(t.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");An(t),this.tensors.push(t)}resize(t){if(t<0)throw new Error(`TensorListResize expects size to be non-negative. Got: ${t}`);if(this.maxNumElements!==-1&&t>this.maxNumElements)throw new Error(`TensorListResize input size ${t} is greater maxNumElement ${this.maxNumElements}.`);const e=new Ho([],this.elementShape,this.elementDtype,this.maxNumElements);e.tensors.length=t;for(let s=0;s<Math.min(this.tensors.length,t);++s)e.tensors[s]=this.tensors[s];return e}getItem(t,e,s){if(s!==this.elementDtype)throw new Error(`Invalid data types; op elements ${s}, but list elements ${this.elementDtype}`);if(t<0||t>this.tensors.length)throw new Error(`Trying to access element ${t} in a list with ${this.tensors.length} elements.`);if(this.tensors[t]==null)throw new Error(`element at index ${t} is null.`);pr(this.tensors[t].shape,e,"TensorList shape mismatch: ");const r=Zc(this.elementShape,this.tensors,e);return J(this.tensors[t],r)}setItem(t,e){if(e.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${this.elementDtype}`);if(t<0||this.maxNumElements!==-1&&t>=this.maxNumElements)throw new Error(`Trying to set element ${t} in a list with max ${this.maxNumElements} elements.`);pr(this.elementShape,e.shape,"TensorList shape mismatch: "),An(e),this.tensors[t]!=null&&(this.tensors[t].kept=!1),this.tensors[t]=e}gather(t,e,s){if(e!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e}, but list elements ${this.elementDtype}`);pr(this.elementShape,s,"TensorList shape mismatch: "),t=t.slice(0,this.size());const r=Zc(this.elementShape,this.tensors,s);return t.length===0?_r([],[0].concat(r)):at(()=>{const a=t.map(i=>J(this.tensors[i],r));return Ls(a,0)})}concat(t,e){if(t&&t!==this.elementDtype)throw new Error(`TensorList dtype is ${this.elementDtype} but concat requested dtype ${t}`);pr(this.elementShape,e,"TensorList shape mismatch: ");const s=Zc(this.elementShape,this.tensors,e);return this.size()===0?_r([],[0].concat(s)):at(()=>{const r=this.tensors.map(a=>J(a,s));return pn(r,0)})}}function j8(n,t,e){const s=n.dtype;if(n.shape.length<1)throw new Error(`Tensor must be at least a vector, but saw shape: ${n.shape}`);if(n.dtype!==e)throw new Error(`Invalid data types; op elements ${n.dtype}, but list elements ${e}`);const r=n.shape.slice(1);pr(r,t,"TensorList shape mismatch: ");const a=Cr(n);return new Ho(a,t,s)}function q8(n,t,e,s){return new Ho([],n,t,s)}function X8(n,t,e,s){if(t.length!==n.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${t.length} vs. ${n.shape[0]}`);const r=Math.max(...t);if(s!=null&&s!==-1&&r>=s)throw new Error(`Max index must be < array size (${r}  vs. ${s})`);const a=new Ho([],e,n.dtype,s),i=Cr(n,0);return t.forEach((l,u)=>{a.setItem(l,i[u])}),a}function K8(n,t,e){let s=0;const r=t.map(d=>(s+=d,s));if(s!==n.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${s}, and tensor's shape is: ${n.shape}`);const a=n.shape.slice(1),i=p1(a,e),l=s===0?0:n.size/s,u=at(()=>{const d=[];n=J(n,[1,s,l]);for(let p=0;p<t.length;++p){const y=[0,p===0?0:r[p-1],0],b=[1,t[p],l];d[p]=J(Qt(n,y,b),i)}return n.dispose(),d}),h=new Ho([],e,n.dtype,t.length);for(let d=0;d<u.length;d++)h.setItem(d,u[d]);return h}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Y8=async(n,t,e)=>{switch(n.op){case"If":case"StatelessIf":{const s=k("thenBranch",n,t,e),r=k("elseBranch",n,t,e),a=k("cond",n,t,e),i=k("args",n,t,e);return(await a.data())[0]?e.functionMap[s].executeFunctionAsync(i,e.tensorArrayMap,e.tensorListMap):e.functionMap[r].executeFunctionAsync(i,e.tensorArrayMap,e.tensorListMap)}case"While":case"StatelessWhile":{const s=k("body",n,t,e),r=k("cond",n,t,e),a=k("args",n,t,e),i=await e.functionMap[r].executeFunctionAsync(a,e.tensorArrayMap,e.tensorListMap),l=a.map(d=>d.id);let u=await i[0].data();i.forEach(d=>{!d.kept&&l.indexOf(d.id)===-1&&d.dispose()});let h=a;for(;u[0];){const d=h;h=await e.functionMap[s].executeFunctionAsync(h,e.tensorArrayMap,e.tensorListMap);const p=h.map(y=>y.id);d.forEach(y=>{!y.kept&&l.indexOf(y.id)===-1&&p.indexOf(y.id)===-1&&y.dispose()});const m=await e.functionMap[r].executeFunctionAsync(h,e.tensorArrayMap,e.tensorListMap);u=await m[0].data(),m.forEach(y=>{!y.kept&&l.indexOf(y.id)===-1&&p.indexOf(y.id)===-1&&y.dispose()})}return h}case"LoopCond":{const s=k("pred",n,t,e);return[Ra(s)]}case"Switch":{const s=k("pred",n,t,e);let r=k("data",n,t,e);return r.kept||(r=Ra(r)),(await s.data())[0]?[void 0,r]:[r,void 0]}case"Merge":{const s=n.inputNames.find(r=>Pn(r,t,e)!==void 0);if(s){const r=Pn(s,t,e);return[Ra(r)]}return}case"Enter":{const s=k("frameName",n,t,e),r=k("tensor",n,t,e);return e.enterFrame(s),[Ra(r)]}case"Exit":{const s=k("tensor",n,t,e);return e.exitFrame(),[Ra(s)]}case"NextIteration":{const s=k("tensor",n,t,e);return e.nextIteration(),[Ra(s)]}case"TensorArrayV3":{const s=k("size",n,t,e),r=k("dtype",n,t,e),a=k("elementShape",n,t,e),i=k("dynamicSize",n,t,e),l=k("clearAfterRead",n,t,e),u=k("identicalElementShapes",n,t,e),h=k("name",n,t,e),d=new H8(h,r,s,a,u,i,l);return e.addTensorArray(d),[d.idTensor,Vt(1)]}case"TensorArrayWriteV3":{const s=k("tensorArrayId",n,t,e),r=k("index",n,t,e),a=k("tensor",n,t,e),i=e.getTensorArray(s.id);return i.write(r,a),[i.idTensor]}case"TensorArrayReadV3":{const s=k("tensorArrayId",n,t,e),r=k("index",n,t,e);return[e.getTensorArray(s.id).read(r)]}case"TensorArrayGatherV3":{const s=k("tensorArrayId",n,t,e),r=k("indices",n,t,e),a=k("dtype",n,t,e);return[e.getTensorArray(s.id).gather(r,a)]}case"TensorArrayScatterV3":{const s=k("tensorArrayId",n,t,e),r=k("indices",n,t,e),a=k("tensor",n,t,e),i=e.getTensorArray(s.id);return i.scatter(r,a),[i.idTensor]}case"TensorArrayConcatV3":{const s=k("tensorArrayId",n,t,e),r=e.getTensorArray(s.id),a=k("dtype",n,t,e);return[r.concat(a)]}case"TensorArraySplitV3":{const s=k("tensorArrayId",n,t,e),r=k("tensor",n,t,e),a=k("lengths",n,t,e),i=e.getTensorArray(s.id);return i.split(a,r),[i.idTensor]}case"TensorArraySizeV3":{const s=k("tensorArrayId",n,t,e),r=e.getTensorArray(s.id);return[Vt(r.size(),"int32")]}case"TensorArrayCloseV3":{const s=k("tensorArrayId",n,t,e),r=e.getTensorArray(s.id);return r.clearAndClose(),[r.idTensor]}case"TensorListSetItem":{const s=k("tensorListId",n,t,e),r=k("index",n,t,e),a=k("tensor",n,t,e),i=e.getTensorList(s.id);return i.setItem(r,a),[i.idTensor]}case"TensorListGetItem":{const s=k("tensorListId",n,t,e),r=k("index",n,t,e),a=k("elementShape",n,t,e),i=k("elementDType",n,t,e);return[e.getTensorList(s.id).getItem(r,a,i)]}case"TensorListScatterV2":case"TensorListScatter":{const s=k("indices",n,t,e),r=k("tensor",n,t,e),a=k("elementShape",n,t,e),i=k("numElements",n,t,e),l=X8(r,s,a,i);return e.addTensorList(l),[l.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const s=k("elementShape",n,t,e),r=k("elementDType",n,t,e);let a;n.op==="TensorListReserve"?a="numElements":a="maxNumElements";const i=k(a,n,t,e),l=n.op==="TensorListReserve"?-1:i,u=q8(s,r,i,l);return e.addTensorList(u),[u.idTensor]}case"TensorListGather":{const s=k("tensorListId",n,t,e),r=k("indices",n,t,e),a=k("elementShape",n,t,e),i=k("elementDType",n,t,e);return[e.getTensorList(s.id).gather(r,i,a)]}case"TensorListStack":{const s=k("tensorListId",n,t,e),r=k("elementShape",n,t,e),a=k("elementDType",n,t,e),i=k("numElements",n,t,e);return[e.getTensorList(s.id).stack(r,a,i)]}case"TensorListFromTensor":{const s=k("tensor",n,t,e),r=k("elementShape",n,t,e),a=k("elementDType",n,t,e),i=j8(s,r,a);return e.addTensorList(i),[i.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{const s=k("tensorListId",n,t,e),r=e.getTensorList(s.id),a=k("dtype",n,t,e),i=k("elementShape",n,t,e);return[r.concat(a,i)]}case"TensorListPushBack":{const s=k("tensorListId",n,t,e),r=k("tensor",n,t,e),a=e.getTensorList(s.id);return a.pushBack(r),[a.idTensor]}case"TensorListPopBack":{const s=k("tensorListId",n,t,e),r=k("elementShape",n,t,e),a=k("elementDType",n,t,e);return[e.getTensorList(s.id).popBack(r,a)]}case"TensorListSplit":{const s=k("tensor",n,t,e),r=k("elementShape",n,t,e),a=k("lengths",n,t,e),i=K8(s,a,r);return e.addTensorList(i),[i.idTensor]}case"TensorListLength":{const s=k("tensorListId",n,t,e),r=e.getTensorList(s.id);return[Vt(r.size(),"int32")]}case"TensorListResize":{const s=k("tensorListId",n,t,e),r=k("size",n,t,e),i=e.getTensorList(s.id).resize(r);return e.addTensorList(i),[i.idTensor]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lk(n,t,e){const[s,r]=k("fusedOps",n,t,e),a=s==="biasadd",i=!a,l=r==="prelu",u=s==="fusedbatchnorm",h=k("numArgs",n,t,e);if(a){if(l&&h!==2)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!l&&a&&h!==1)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(u)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");const d=k("strides",n,t,e),p=Ap(n,t,e),m=k("dataFormat",n,t,e).toUpperCase(),y=k("dilations",n,t,e);let[b,x]=k("args",n,t,e);i&&(x=b,b=void 0);const v=k("leakyreluAlpha",n,t,e);return{stride:d,pad:p,dataFormat:m,dilations:y,biasArg:b,preluArg:x,activationFunc:r,leakyreluAlpha:v}}const Z8=(n,t,e,s=qn)=>{switch(n.op){case"Conv1D":{const r=k("stride",n,t,e),a=k("pad",n,t,e),i=k("dataFormat",n,t,e).toUpperCase(),l=k("dilation",n,t,e);return[s.conv1d(k("x",n,t,e),k("filter",n,t,e),r,a,i,l)]}case"Conv2D":{const r=k("strides",n,t,e),a=Ap(n,t,e),i=k("dataFormat",n,t,e).toUpperCase(),l=k("dilations",n,t,e);return[s.conv2d(k("x",n,t,e),k("filter",n,t,e),[r[1],r[2]],a,i,[l[1],l[2]])]}case"_FusedConv2D":{const{stride:r,pad:a,dataFormat:i,dilations:l,biasArg:u,preluArg:h,activationFunc:d,leakyreluAlpha:p}=lk(n,t,e);return[s.fused.conv2d({x:k("x",n,t,e),filter:k("filter",n,t,e),strides:[r[1],r[2]],pad:a,dataFormat:i,dilations:[l[1],l[2]],bias:u,activation:d,preluActivationWeights:h,leakyreluAlpha:p})]}case"FusedDepthwiseConv2dNative":{const{stride:r,pad:a,dataFormat:i,dilations:l,biasArg:u,preluArg:h,activationFunc:d,leakyreluAlpha:p}=lk(n,t,e);return[s.fused.depthwiseConv2d({x:k("x",n,t,e),filter:k("filter",n,t,e),strides:[r[1],r[2]],pad:a,dataFormat:i,dilations:[l[1],l[2]],bias:u,activation:d,preluActivationWeights:h,leakyreluAlpha:p})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const r=k("outputShape",n,t,e),a=k("strides",n,t,e),i=Ap(n,t,e);return[s.conv2dTranspose(k("x",n,t,e),k("filter",n,t,e),r,[a[1],a[2]],i)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const r=k("strides",n,t,e),a=Ap(n,t,e),i=k("dilations",n,t,e),l=k("dataFormat",n,t,e).toUpperCase();return[s.depthwiseConv2d(k("input",n,t,e),k("filter",n,t,e),[r[1],r[2]],a,l,[i[1],i[2]])]}case"Conv3D":{const r=k("strides",n,t,e),a=k("pad",n,t,e),i=k("dataFormat",n,t,e).toUpperCase(),l=k("dilations",n,t,e);return[s.conv3d(k("x",n,t,e),k("filter",n,t,e),[r[1],r[2],r[3]],a,i,[l[1],l[2],l[3]])]}case"AvgPool":{const r=k("strides",n,t,e),a=k("pad",n,t,e),i=k("kernelSize",n,t,e);return[s.avgPool(k("x",n,t,e),[i[1],i[2]],[r[1],r[2]],a)]}case"MaxPool":{const r=k("strides",n,t,e),a=k("pad",n,t,e),i=k("kernelSize",n,t,e);return[s.maxPool(k("x",n,t,e),[i[1],i[2]],[r[1],r[2]],a)]}case"MaxPoolWithArgmax":{const r=k("strides",n,t,e),a=k("pad",n,t,e),i=k("kernelSize",n,t,e),l=k("includeBatchInIndex",n,t,e),{result:u,indexes:h}=s.maxPoolWithArgmax(k("x",n,t,e),[i[1],i[2]],[r[1],r[2]],a,l);return[u,h]}case"AvgPool3D":{const r=k("strides",n,t,e),a=k("pad",n,t,e),i=k("kernelSize",n,t,e);return[s.avgPool3d(k("x",n,t,e),[i[1],i[2],i[3]],[r[1],r[2],r[3]],a)]}case"MaxPool3D":{const r=k("strides",n,t,e),a=k("pad",n,t,e),i=k("kernelSize",n,t,e);return[s.maxPool3d(k("x",n,t,e),[i[1],i[2],i[3]],[r[1],r[2],r[3]],a)]}case"Dilation2D":{const r=k("strides",n,t,e),a=k("pad",n,t,e),i=k("dilations",n,t,e),l=r[1],u=r[2],h=i[1],d=i[2];return[s.dilation2d(k("x",n,t,e),k("filter",n,t,e),[l,u],a,[h,d],"NHWC")]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q8=(n,t,e,s=qn)=>{switch(n.op){case"Fill":{const r=k("shape",n,t,e),a=k("dtype",n,t,e),i=k("value",n,t,e);return[s.fill(r,i,a)]}case"LinSpace":{const r=k("start",n,t,e),a=k("stop",n,t,e),i=k("num",n,t,e);return[s.linspace(r,a,i)]}case"Multinomial":{const r=k("logits",n,t,e),a=k("numSamples",n,t,e),i=k("seed",n,t,e);return[s.multinomial(r,a,i)]}case"OneHot":{const r=k("indices",n,t,e),a=k("depth",n,t,e),i=k("onValue",n,t,e),l=k("offValue",n,t,e),u=k("dtype",n,t,e);return[s.oneHot(r,a,i,l,u)]}case"Ones":return[s.ones(k("shape",n,t,e),k("dtype",n,t,e))];case"OnesLike":return[s.onesLike(k("x",n,t,e))];case"RandomStandardNormal":return[s.randomStandardNormal(k("shape",n,t,e),k("dtype",n,t,e),k("seed",n,t,e))];case"RandomUniform":return[s.randomUniform(k("shape",n,t,e),k("minval",n,t,e),k("maxval",n,t,e),k("dtype",n,t,e))];case"RandomUniformInt":return[s.randomUniformInt(k("shape",n,t,e),k("minval",n,t,e),k("maxval",n,t,e),k("seed",n,t,e))];case"Range":{const r=k("start",n,t,e),a=k("stop",n,t,e),i=k("step",n,t,e);return[s.range(r,a,i,k("dtype",n,t,e))]}case"TruncatedNormal":{const r=k("shape",n,t,e),a=k("mean",n,t,e),i=k("stdDev",n,t,e),l=k("seed",n,t,e);return[s.truncatedNormal(r,a,i,k("dtype",n,t,e),l)]}case"Zeros":return[s.zeros(k("shape",n,t,e),k("dtype",n,t,e))];case"ZerosLike":return[s.zerosLike(k("x",n,t,e))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sx(n,t,e){const s=k("boxes",n,t,e),r=k("scores",n,t,e),a=k("maxOutputSize",n,t,e),i=k("iouThreshold",n,t,e),l=k("scoreThreshold",n,t,e),u=k("softNmsSigma",n,t,e);return{boxes:s,scores:r,maxOutputSize:a,iouThreshold:i,scoreThreshold:l,softNmsSigma:u}}const J8=async(n,t,e,s,r=qn)=>{switch(n.op){case"NonMaxSuppressionV5":{const{boxes:a,scores:i,maxOutputSize:l,iouThreshold:u,scoreThreshold:h,softNmsSigma:d}=sx(n,t,e),p=await r.image.nonMaxSuppressionWithScoreAsync(a,i,l,u,h,d);return[p.selectedIndices,p.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:a,scores:i,maxOutputSize:l,iouThreshold:u,scoreThreshold:h}=sx(n,t,e),d=k("padToMaxOutputSize",n,t,e),p=await r.image.nonMaxSuppressionPaddedAsync(a,i,l,u,h,d);return[p.selectedIndices,p.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:a,scores:i,maxOutputSize:l,iouThreshold:u,scoreThreshold:h}=sx(n,t,e);return[await r.image.nonMaxSuppressionAsync(a,i,l,u,h)]}case"Where":{const a=r.cast(k("condition",n,t,e),"bool"),i=[await r.whereAsync(a)];return a.dispose(),i}case"ListDiff":return r.setdiff1dAsync(k("x",n,t,e),k("y",n,t,e));default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tX=(n,t,e,s=qn)=>{switch(n.op){case"LowerBound":{const r=k("sortedSequence",n,t,e),a=k("values",n,t,e);return[s.lowerBound(r,a)]}case"TopKV2":{const r=k("x",n,t,e),a=k("k",n,t,e),i=k("sorted",n,t,e),l=s.topk(r,a,i);return[l.values,l.indices]}case"UpperBound":{const r=k("sortedSequence",n,t,e),a=k("values",n,t,e);return[s.upperBound(r,a)]}case"Unique":{const r=k("x",n,t,e),a=s.unique(r);return[a.values,a.indices]}case"UniqueV2":{const r=k("x",n,t,e),a=k("axis",n,t,e),i=s.unique(r,a);return[i.values,i.indices]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eX=(n,t,e,s=qn)=>{switch(n.op){case"Const":return t[n.name];case"PlaceholderWithDefault":const r=k("default",n,t,e);return[Pn(n.name,t,e)||r];case"Placeholder":return[Pn(n.name,t,e)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":{const d=k("x",n,t,e);return[Ra(d)]}case"IdentityN":return k("x",n,t,e).map(d=>Ra(d));case"Snapshot":const a=k("x",n,t,e);return[Ra(a)];case"Shape":return[s.tensor1d(k("x",n,t,e).shape,"int32")];case"ShapeN":return k("x",n,t,e).map(d=>s.tensor1d(d.shape));case"Size":return[s.scalar(k("x",n,t,e).size,"int32")];case"Rank":return[s.scalar(k("x",n,t,e).rank,"int32")];case"NoOp":return[s.scalar(1)];case"Print":const i=k("x",n,t,e),l=k("data",n,t,e),u=k("message",n,t,e),h=k("summarize",n,t,e);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(u);for(let d=0;d<l.length;d++)console.log(Array.prototype.slice.call(l[d].dataSync()).slice(0,h));return[i];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nX{get id(){return this.handle.id}constructor(t,e){this.keyDType=t,this.valueDType=e,this.handle=Vt(0),this.tensorMap=new Map,An(this.handle)}clearAndClose(){this.tensorMap.forEach(t=>t.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return Vt(this.size(),"int32")}async import(t,e){this.checkKeyAndValueTensor(t,e);const s=await t.data();return this.tensorMap.forEach(r=>r.dispose()),this.tensorMap.clear(),at(()=>{const r=Cr(e),a=s.length,i=r.length;F(a===i,()=>`The number of elements doesn't match, keys has ${a} elements, the values has ${i} elements.`);for(let l=0;l<a;l++){const u=s[l],h=r[l];An(h),this.tensorMap.set(u,h)}return this.handle})}async find(t,e){this.checkKeyAndValueTensor(t,e);const s=await t.data();return at(()=>{const r=[];for(let a=0;a<s.length;a++){const i=s[a],l=this.findWithDefault(i,e);r.push(l)}return Ls(r)})}findWithDefault(t,e){const s=this.tensorMap.get(t);return s??e}checkKeyAndValueTensor(t,e){if(t.dtype!==this.keyDType)throw new Error(`Expect key dtype ${this.keyDType}, but got ${t.dtype}`);if(e.dtype!==this.valueDType)throw new Error(`Expect value dtype ${this.valueDType}, but got ${e.dtype}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sX=async(n,t,e,s)=>{switch(n.op){case"HashTable":case"HashTableV2":{const r=s.getHashTableHandleByName(n.name);if(r!=null)return[r];{const a=k("keyDType",n,t,e),i=k("valueDType",n,t,e),l=new nX(a,i);return s.addHashTable(n.name,l),[l.handle]}}case"InitializeTable":case"InitializeTableV2":case"LookupTableImport":case"LookupTableImportV2":{const r=k("tableHandle",n,t,e,s),a=k("keys",n,t,e),i=k("values",n,t,e);return[await s.getHashTableById(r.id).import(a,i)]}case"LookupTableFind":case"LookupTableFindV2":{const r=k("tableHandle",n,t,e,s),a=k("keys",n,t,e),i=k("defaultValue",n,t,e);return[await s.getHashTableById(r.id).find(a,i)]}case"LookupTableSize":case"LookupTableSizeV2":{const r=k("tableHandle",n,t,e,s);return[s.getHashTableById(r.id).tensorSize()]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rX=(n,t,e,s=qn)=>{switch(n.op){case"ResizeBilinear":{const r=k("images",n,t,e),a=k("size",n,t,e),i=k("alignCorners",n,t,e),l=k("halfPixelCenters",n,t,e);return[s.image.resizeBilinear(r,[a[0],a[1]],i,l)]}case"ResizeNearestNeighbor":{const r=k("images",n,t,e),a=k("size",n,t,e),i=k("alignCorners",n,t,e),l=k("halfPixelCenters",n,t,e);return[s.image.resizeNearestNeighbor(r,[a[0],a[1]],i,l)]}case"CropAndResize":{const r=k("image",n,t,e),a=k("boxes",n,t,e),i=k("boxInd",n,t,e),l=k("cropSize",n,t,e),u=k("method",n,t,e),h=k("extrapolationValue",n,t,e);return[s.image.cropAndResize(r,a,i,l,u,h)]}case"ImageProjectiveTransformV3":{const r=k("images",n,t,e),a=k("transforms",n,t,e),i=k("outputShape",n,t,e),l=k("fillValue",n,t,e),u=k("interpolation",n,t,e),h=k("fillMode",n,t,e);return[s.image.transform(r,a,u.toLowerCase(),h.toLowerCase(),l,i)]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aX=(n,t,e,s=qn)=>{switch(n.op){case"Equal":return[s.equal(k("a",n,t,e),k("b",n,t,e))];case"NotEqual":return[s.notEqual(k("a",n,t,e),k("b",n,t,e))];case"Greater":return[s.greater(k("a",n,t,e),k("b",n,t,e))];case"GreaterEqual":return[s.greaterEqual(k("a",n,t,e),k("b",n,t,e))];case"Less":return[s.less(k("a",n,t,e),k("b",n,t,e))];case"LessEqual":return[s.lessEqual(k("a",n,t,e),k("b",n,t,e))];case"LogicalAnd":return[s.logicalAnd(k("a",n,t,e),k("b",n,t,e))];case"LogicalNot":return[s.logicalNot(k("a",n,t,e))];case"LogicalOr":return[s.logicalOr(k("a",n,t,e),k("b",n,t,e))];case"Select":case"SelectV2":return[s.where(k("condition",n,t,e),k("a",n,t,e),k("b",n,t,e))];case"BitwiseAnd":return[s.bitwiseAnd(k("a",n,t,e),k("b",n,t,e))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iX=(n,t,e,s=qn)=>{switch(n.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[s.matMul(k("a",n,t,e),k("b",n,t,e),k("transposeA",n,t,e),k("transposeB",n,t,e))];case"Einsum":return[s.einsum(k("equation",n,t,e),...k("tensors",n,t,e))];case"Transpose":return[s.transpose(k("x",n,t,e),k("perm",n,t,e))];case"_FusedMatMul":const[r,a]=k("fusedOps",n,t,e),i=r==="biasadd",l=a==="prelu",u=k("numArgs",n,t,e),h=k("leakyreluAlpha",n,t,e);if(i){if(l&&u!==2)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!l&&u!==1)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[d,p]=k("args",n,t,e);return[s.fused.matMul({a:k("a",n,t,e),b:k("b",n,t,e),transposeA:k("transposeA",n,t,e),transposeB:k("transposeB",n,t,e),bias:d,activation:a,preluActivationWeights:p,leakyreluAlpha:h})];case"MatrixBandPart":return[s.linalg.bandPart(k("a",n,t,e),k("numLower",n,t,e),k("numUpper",n,t,e))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oX=(n,t,e,s=qn)=>{switch(n.op){case"EuclideanNorm":return[s.euclideanNorm(k("x",n,t,e),k("axis",n,t,e),k("keepDims",n,t,e))];case"FusedBatchNorm":case"FusedBatchNormV2":return[s.batchNorm(k("x",n,t,e),k("mean",n,t,e),k("variance",n,t,e),k("offset",n,t,e),k("scale",n,t,e),k("epsilon",n,t,e))];case"FusedBatchNormV3":return[s.batchNorm(k("x",n,t,e),k("mean",n,t,e),k("variance",n,t,e),k("offset",n,t,e),k("scale",n,t,e),k("epsilon",n,t,e))];case"LRN":return[s.localResponseNormalization(k("x",n,t,e),k("radius",n,t,e),k("bias",n,t,e),k("alpha",n,t,e),k("beta",n,t,e))];case"Softmax":return[s.softmax(k("x",n,t,e))];case"LogSoftmax":return[s.logSoftmax(k("x",n,t,e))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lX=(n,t,e,s=qn)=>{switch(n.op){case"RaggedGather":{const{outputNestedSplits:r,outputDenseValues:a}=s.raggedGather(k("paramsNestedSplits",n,t,e),k("paramsDenseValues",n,t,e),k("indices",n,t,e),k("outputRaggedRank",n,t,e));return r.concat(a)}case"RaggedRange":{const{rtNestedSplits:r,rtDenseValues:a}=s.raggedRange(k("starts",n,t,e),k("limits",n,t,e),k("splits",n,t,e));return[r,a]}case"RaggedTensorToTensor":return[s.raggedTensorToTensor(k("shape",n,t,e),k("values",n,t,e),k("defaultValue",n,t,e),k("rowPartitionTensors",n,t,e),k("rowPartitionTypes",n,t,e))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uX=(n,t,e,s=qn)=>{switch(n.op){case"Max":{const l=k("axis",n,t,e),u=k("keepDims",n,t,e);return[s.max(k("x",n,t,e),l,u)]}case"Mean":{const l=k("axis",n,t,e),u=k("keepDims",n,t,e);return[s.mean(k("x",n,t,e),l,u)]}case"Min":{const l=k("axis",n,t,e),u=k("keepDims",n,t,e);return[s.min(k("x",n,t,e),l,u)]}case"Sum":{const l=k("axis",n,t,e),u=k("keepDims",n,t,e);return[s.sum(k("x",n,t,e),l,u)]}case"All":{const l=k("axis",n,t,e),u=k("keepDims",n,t,e);return[s.all(k("x",n,t,e),l,u)]}case"Any":{const l=k("axis",n,t,e),u=k("keepDims",n,t,e);return[s.any(k("x",n,t,e),l,u)]}case"ArgMax":{const l=k("axis",n,t,e);return[s.argMax(k("x",n,t,e),l)]}case"ArgMin":{const l=k("axis",n,t,e);return[s.argMin(k("x",n,t,e),l)]}case"Prod":{const l=k("axis",n,t,e),u=k("keepDims",n,t,e);return[s.prod(k("x",n,t,e),l,u)]}case"Cumprod":{const l=k("axis",n,t,e),u=k("exclusive",n,t,e),h=k("reverse",n,t,e);return[s.cumprod(k("x",n,t,e),l,u,h)]}case"Cumsum":{const l=k("axis",n,t,e),u=k("exclusive",n,t,e),h=k("reverse",n,t,e);return[s.cumsum(k("x",n,t,e),l,u,h)]}case"Bincount":const r=k("x",n,t,e),a=k("weights",n,t,e),i=k("size",n,t,e);return[s.bincount(r,a,i)];case"DenseBincount":{const l=k("x",n,t,e),u=k("weights",n,t,e),h=k("size",n,t,e),d=k("binaryOutput",n,t,e);return[s.denseBincount(l,u,h,d)]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cX=(n,t,e,s=qn)=>{switch(n.op){case"ConcatV2":case"Concat":{const r=k("n",n,t,e),a=k("axis",n,t,e);let i=k("tensors",n,t,e);return i=i.slice(0,r),[s.concat(i,a)]}case"Gather":{const r=k("x",n,t,e),a=k("indices",n,t,e);return[s.gather(r,s.cast(a,"int32"),0)]}case"GatherV2":{const r=k("axis",n,t,e),a=k("batchDims",n,t,e),i=k("x",n,t,e),l=k("indices",n,t,e);return[s.gather(i,s.cast(l,"int32"),r,a)]}case"Reverse":{const r=k("dims",n,t,e),a=[];for(let l=0;l<r.length;l++)r[l]&&a.push(l);const i=k("x",n,t,e);return[s.reverse(i,a)]}case"ReverseV2":{const r=k("axis",n,t,e),a=k("x",n,t,e);return[s.reverse(a,r)]}case"Slice":{const r=k("begin",n,t,e),a=k("size",n,t,e);return[s.slice(k("x",n,t,e),r,a)]}case"StridedSlice":{const r=k("begin",n,t,e),a=k("end",n,t,e),i=k("strides",n,t,e),l=k("beginMask",n,t,e),u=k("endMask",n,t,e),h=k("ellipsisMask",n,t,e),d=k("newAxisMask",n,t,e),p=k("shrinkAxisMask",n,t,e),m=k("x",n,t,e);return[s.stridedSlice(m,r,a,i,l,u,h,d,p)]}case"Pack":return at(()=>{const r=k("axis",n,t,e),a=k("tensors",n,t,e),i=a[0].shape,l=s.squeeze(a[0]).shape,u=a.map(h=>{const d=de(h.shape,i);if(!d&&!de(s.squeeze(h).shape,l))throw new Error("the input tensors shape does not match");return d?h:s.reshape(h,i)});return[s.stack(u,r)]});case"Unpack":{const r=k("axis",n,t,e),a=k("tensor",n,t,e);return s.unstack(a,r)}case"Tile":{const r=k("reps",n,t,e);return[s.tile(k("x",n,t,e),r)]}case"Split":case"SplitV":{const r=k("axis",n,t,e),a=k("numOrSizeSplits",n,t,e),i=k("x",n,t,e);return s.split(i,a,r)}case"ScatterNd":{const r=k("indices",n,t,e),a=k("values",n,t,e),i=k("shape",n,t,e);return[s.scatterND(r,a,i)]}case"GatherNd":{const r=k("x",n,t,e),a=k("indices",n,t,e);return[s.gatherND(r,a)]}case"SparseToDense":{const r=k("sparseIndices",n,t,e),a=k("outputShape",n,t,e),i=k("sparseValues",n,t,e),l=k("defaultValue",n,t,e);return[s.sparseToDense(r,i,a,i.dtype===l.dtype?l:s.cast(l,i.dtype))]}case"TensorScatterUpdate":{const r=k("indices",n,t,e),a=k("values",n,t,e),i=k("tensor",n,t,e);return[s.tensorScatterUpdate(i,r,a)]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hX=(n,t,e,s=qn)=>{switch(n.op){case"SparseFillEmptyRows":{const{outputIndices:r,outputValues:a,emptyRowIndicator:i,reverseIndexMap:l}=s.sparse.sparseFillEmptyRows(k("indices",n,t,e),k("values",n,t,e),k("denseShape",n,t,e),k("defaultValue",n,t,e));return[r,a,i,l]}case"SparseReshape":{const{outputIndices:r,outputShape:a}=s.sparse.sparseReshape(k("inputIndices",n,t,e),k("inputShape",n,t,e),k("newShape",n,t,e));return[r,a]}case"SparseSegmentMean":return[s.sparse.sparseSegmentMean(k("data",n,t,e),k("indices",n,t,e),k("segmentIds",n,t,e))];case"SparseSegmentSum":return[s.sparse.sparseSegmentSum(k("data",n,t,e),k("indices",n,t,e),k("segmentIds",n,t,e))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dX=(n,t,e,s=qn)=>{switch(n.op){case"FFT":return[s.fft(k("x",n,t,e))];case"IFFT":return[s.ifft(k("x",n,t,e))];case"RFFT":return[s.rfft(k("x",n,t,e))];case"IRFFT":return[s.irfft(k("x",n,t,e))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fX=(n,t,e,s=qn)=>{switch(n.op){case"StaticRegexReplace":return[s.string.staticRegexReplace(k("input",n,t,e),k("pattern",n,t,e),k("rewrite",n,t,e),k("replaceGlobal",n,t,e))];case"StringNGrams":{const{nGrams:r,nGramsSplits:a}=s.string.stringNGrams(k("data",n,t,e),k("dataSplits",n,t,e),k("separator",n,t,e),k("nGramWidths",n,t,e),k("leftPad",n,t,e),k("rightPad",n,t,e),k("padWidth",n,t,e),k("preserveShortSequences",n,t,e));return[r,a]}case"StringSplit":{const{indices:r,values:a,shape:i}=s.string.stringSplit(k("input",n,t,e),k("delimiter",n,t,e),k("skipEmpty",n,t,e));return[r,a,i]}case"StringToHashBucketFast":return[s.string.stringToHashBucketFast(k("input",n,t,e),k("numBuckets",n,t,e))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pX=(n,t,e,s=qn)=>{switch(n.op){case"Cast":return[s.cast(k("x",n,t,e),k("dtype",n,t,e))];case"ExpandDims":{const r=k("axis",n,t,e);return[s.expandDims(k("x",n,t,e),r)]}case"Squeeze":{const r=k("axis",n,t,e);return[s.squeeze(k("x",n,t,e),r)]}case"Reshape":return[s.reshape(k("x",n,t,e),k("shape",n,t,e))];case"EnsureShape":return[s.ensureShape(k("x",n,t,e),k("shape",n,t,e))];case"MirrorPad":return[s.mirrorPad(k("x",n,t,e),k("padding",n,t,e),k("mode",n,t,e))];case"PadV2":case"Pad":return[s.pad(k("x",n,t,e),k("padding",n,t,e),k("constantValue",n,t,e))];case"SpaceToBatchND":{const r=k("blockShape",n,t,e),a=k("paddings",n,t,e);return[s.spaceToBatchND(k("x",n,t,e),r,a)]}case"BatchToSpaceND":{const r=k("blockShape",n,t,e),a=k("crops",n,t,e);return[s.batchToSpaceND(k("x",n,t,e),r,a)]}case"DepthToSpace":{const r=k("blockSize",n,t,e),a=k("dataFormat",n,t,e).toUpperCase();return[s.depthToSpace(k("x",n,t,e),r,a)]}case"BroadcastTo":return[s.broadcastTo(k("x",n,t,e),k("shape",n,t,e))];case"BroadcastArgs":return[s.broadcastArgs(k("s0",n,t,e),k("s1",n,t,e))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uk(n,t,e,s,r=at){const a=((i,l,u)=>{switch(i.category){case"arithmetic":return r(()=>G8(i,l,u));case"basic_math":return r(()=>W8(i,l,u));case"control":return Y8(i,l,u);case"convolution":return r(()=>Z8(i,l,u));case"creation":return r(()=>Q8(i,l,u));case"dynamic":return J8(i,l,u);case"evaluation":return r(()=>tX(i,l,u));case"image":return r(()=>rX(i,l,u));case"graph":return r(()=>eX(i,l,u));case"logical":return r(()=>aX(i,l,u));case"matrices":return r(()=>iX(i,l,u));case"normalization":return r(()=>oX(i,l,u));case"ragged":return r(()=>lX(i,l,u));case"reduction":return r(()=>uX(i,l,u));case"slice_join":return r(()=>cX(i,l,u));case"sparse":return r(()=>hX(i,l,u));case"spectral":return r(()=>dX(i,l,u));case"string":return r(()=>fX(i,l,u));case"transformation":return r(()=>pX(i,l,u));case"hash_table":return sX(i,l,u,s);case"custom":const h=RO(i.op);if(h&&h.customExecutor)return h.customExecutor(new U8(i,l,u));throw TypeError(`Custom op ${i.op} is not registered.`);default:throw TypeError(`Unknown op '${i.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(n,t,e);return Fo(a)?a.then(i=>[].concat(i)):[].concat(a)}class ck{constructor(t={},e={},s={},r={},a){this.weightMap=t,this.tensorArrayMap=e,this.tensorListMap=s,this.functionMap=r,this.parseNodeNameCache=a,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(t,e){return{id:t,frameName:e,iterationId:0}}set currentContext(t){this.contexts!==t&&(this.contexts=t,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const t=[];for(let e=0;e<this.contexts.length-1;e++){const s=this.contexts.slice(0,this.contexts.length-e);t.push(this.contextIdforContexts(s))}t.push(""),this._currentContextIds=t}contextIdforContexts(t){return t?t.map(e=>e.id===0&&e.iterationId===0?"":`${e.frameName}-${e.iterationId}`).join("/"):""}enterFrame(t){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,t)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(this.contexts&&this.contexts.length>1)this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift();else throw new Error("Cannot exit frame, the context is empty")}nextIteration(){if(this.contexts&&this.contexts.length>0){this.contexts=this.contexts.slice(),this.lastId++;const t=Object.assign({},this.contexts[this.contexts.length-1]);t.iterationId+=1,t.id=this.lastId,this.contexts.splice(-1,1,t),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}else throw new Error("Cannot increase frame iteration, the context is empty")}getWeight(t){return this.weightMap[t]}addTensorArray(t){this.tensorArrayMap[t.id]=t}getTensorArray(t){return this.tensorArrayMap[t]}addTensorList(t){this.tensorListMap[t.id]=t}getTensorList(t){return this.tensorListMap[t]}dispose(t){for(const e in this.tensorArrayMap)this.tensorArrayMap[e].clearAndClose(t);for(const e in this.tensorListMap)this.tensorListMap[e].clearAndClose(t)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hk(n,t,e,s){const r=new Set,a=[];let i=null,l=null;const u=new Set,h=new Set(Object.keys(n).map(m=>$s(m)[0]));s=s||[];const d=new Set(s.map(m=>$s(m.name)[0])),p=[...t];for(;p.length>0;){const m=p.pop();if((So(m)||SX(m)||CX(m))&&i==null&&(i=m,l=i.children.map(y=>y.name).filter(y=>r.has(y))),r.add(m.name),e[m.name]==null&&!h.has(m.name)&&!d.has(m.name)){if(m.inputs.length===0){a.push(m.name);continue}m.inputs.forEach(y=>{u.has(y.name)||(u.add(y.name),p.push(y))})}}return{inputs:n,outputs:t,usedNodes:r,missingInputs:a,dynamicNode:i,syncInputs:l}}function mX(n,t){const{usedNodes:e,inputs:s}=t,r=Object.keys(s).map(v=>$s(v)[0]).map(v=>n.nodes[v]),a=n.initNodes||[],i=v=>e.has(typeof v=="string"?v:v.name);function l(v){return[...new Map(v.map(S=>[S.name,S])).values()]}const u=l([...r,...n.weights,...a]).filter(i),h=l([...u,...Object.values(n.nodes)]).filter(i),d=new Map(h.map(v=>[v.name,v])),p={};for(const v of h){p[v.name]=p[v.name]||0;for(const S of v.children)i(S)||(p[S.name]=Number.POSITIVE_INFINITY),p[S.name]=(p[S.name]||0)+1}const m=Object.entries(p).filter(([,v])=>v===0).map(([v])=>v),y=[...m];for(;m.length>0;){const v=m.pop(),S=d.get(v);for(const C of S.children.filter(i))--p[C.name]===0&&(y.push(C.name),m.push(C.name))}const b=y.map(v=>d.get(v)),x=gX(b,u);return yX(x,u),x}function gX(n,t){const e=new Map(n.map(i=>[i.name,i])),s=t.map(i=>i.name),r=new Set(s);for(;s.length>0;){const i=s.pop(),l=e.get(i);for(const u of l.children)!e.has(u.name)||r.has(u.name)||(r.add(u.name),s.push(u.name))}return n.filter(i=>r.has(i.name))}class cp extends Error{constructor(t){super(`NodesExecutionOrderError: ${t}`)}}function yX(n,t){const e=new Map(n.map((l,u)=>[l.name,u])),s=new Set(t.map(l=>l.name)),r=l=>s.has(typeof l=="string"?l:l.name),a=new Set(n.map(l=>l.name)),i=l=>a.has(typeof l=="string"?l:l.name);for(const l of n){for(const u of l.children.filter(i)){if(!e.has(u.name))throw new cp(`Child ${u.name} of node ${l.name} is unreachable.`);if(e.get(l.name)>e.get(u.name))throw new cp(`Node ${l.name} is scheduled to run after its child ${u.name}.`)}if(!r(l))for(const u of l.inputs){if(!e.has(u.name))throw new cp(`Input ${u.name} of node ${l.name} is unreachable.`);if(e.get(u.name)>e.get(l.name))throw new cp(`Node ${l.name} is scheduled to run before its input ${u.name}.`)}}}function bX(n){const t=new Map(n.map((l,u)=>[l.name,u])),e=Number.MAX_SAFE_INTEGER,s=n.map((l,u)=>So(l)?e:u),r=l=>{const u=s[t.get(l.name)];return u??-1},a=n.map((l,u)=>l.children.map(r).reduce((h,d)=>Math.max(h,d),s[u])),i=new Map;for(let l=0;l<n.length;++l){const u=a[l];if(u===e)continue;const h=n[l],d=n[u];i.has(d.name)||i.set(d.name,[]),i.get(d.name).push(h)}return i}const xX=new Set(["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"]),vX=new Set(["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"]),wX=new Set(["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"]);function So(n){return xX.has(n.op)}function SX(n){return vX.has(n.op)}function CX(n){return wX.has(n.op)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class om{get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(t){const e=Object.keys(t).map(s=>t[s].map(r=>r.id));this._weightIds=[].concat(...e),this._weightMap=t}set resourceManager(t){this._resourceManager=t}get inputs(){return this._inputs.map(t=>({name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(t=>({name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(t=>t.signatureKey||t.name)}get outputNodes(){return this._outputs.map(t=>{const e=t.signatureKey||t.name;return t.defaultOutput?`${e}:${t.defaultOutput}`:e})}get functions(){return Object.keys(this._functions).reduce((t,e)=>(t[e]=this._functions[e].signature,t),{})}constructor(t,e){this.graph=t,this.parent=e,this.compiledMap=new Map,this.parseNodeNameCache=new Map,this._weightMap={},this.SEPARATOR=",",this._functions={},this._functionExecutorMap={},this.keepIntermediateTensors=!1,this._outputs=t.outputs,this._inputs=t.inputs,this._initNodes=t.initNodes,this._signature=t.signature,this._functions=t.functions,t.functions!=null&&Object.keys(t.functions).forEach(s=>{this._functionExecutorMap[s]=new om(t.functions[s],this)})}getCompilationKey(t,e){const s=t.map(a=>a.name).sort(),r=e.map(a=>a.name).sort();return s.join(this.SEPARATOR)+"--"+r.join(this.SEPARATOR)}compile(t,e){const s=hk(t,e,this.weightMap,this._initNodes),{missingInputs:r,dynamicNode:a,syncInputs:i}=s;if(a!=null)throw new Error(`This execution contains the node '${a.name}', which has the dynamic op '${a.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${i}]`);if(r.length>0){const h=e.map(p=>p.name),d=Object.keys(t);throw new Error(`Cannot compute the outputs [${h}] from the provided inputs [${d}]. Missing the following inputs: [${r}]`)}const l=mX(this.graph,s),u=bX(l);return{orderedNodes:l,nodeLiveUntilMap:u}}cloneAndKeepTensor(t){if(t==null)return null;const e=t.clone();return An(e),e}cloneTensorList(t){return t?t.map(s=>this.cloneAndKeepTensor(s)):null}cloneTensorMap(t){return Object.fromEntries(Object.entries(t).map(([e,s])=>[e,this.cloneTensorList(s)]))}execute(t,e){this.disposeIntermediateTensors(),t=this.mapInputs(t);const s=Object.keys(t).sort();this.checkInputs(t),this.checkInputShapeAndType(t),e=this.mapOutputs(e),this.checkOutputs(e);const r=s.map(m=>this.graph.nodes[$s(m)[0]]),a=e.map(m=>$s(m)[0]),i=new Set(a);let l=a.map(m=>this.graph.nodes[m]);l.length===0&&(l=this._outputs);const u=this.getCompilationKey(r,l);let h=this.compiledMap.get(u);h==null&&(h=this.compile(t,l),this.compiledMap.set(u,h));try{this.keepIntermediateTensors=ut().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(m){this.keepIntermediateTensors=!1,console.warn(m.message)}const d={},p={};return at(()=>{const m=new ck(this.weightMap,d,p,this.functionExecutorMap,this.parseNodeNameCache),y=Object.assign({},this.weightMap);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap)),Object.keys(t).forEach(S=>{const[C,$]=$s(S,m),T=[];T[$]=t[S],y[C]=T,this.keepIntermediateTensors&&(this.clonedTensorsMap[C]=this.cloneTensorList(T))});const b=this.getFrozenTensorIds(y),{orderedNodes:x,nodeLiveUntilMap:v}=h;for(const S of x){if(y[S.name])continue;const C=uk(S,y,m,this._resourceManager);if(Fo(C))throw new Error(`The execution of the op '${S.op}' returned a promise. Please use model.executeAsync() instead.`);y[S.name]=C,this.keepIntermediateTensors&&(this.clonedTensorsMap[S.name]=this.cloneTensorList(C)),this.checkTensorForDisposalWithNodeLiveUntilInfo(S,y,m,b,i,v.get(S.name))}return this.parent==null&&m.dispose(b),e.map(S=>Pn(S,y,m))})}getFrozenTensorIds(t){const e=[].concat.apply([],Object.keys(t).map(s=>t[s]).map(s=>s.map(r=>r.id)));return new Set(e)}checkTensorForDisposal(t,e,s,r,a,i,l){if(!(So(e)||i.has(t))){for(const u of s[t])u!=null&&(l[u.id]=(l[u.id]||0)+e.children.length);for(const u of e.inputs){if(So(u))continue;const h=rk(u.name,s,r);if(h!=null)for(const d of h){if(!d||d.kept||a.has(d.id))continue;const p=l[d.id];p===1?(d.dispose(),delete l[d.id]):p!=null&&l[d.id]--}}}}checkTensorForDisposalWithNodeLiveUntilInfo(t,e,s,r,a,i){function l(u){return So(u)||a.has(u.name)}if(!(So(t)||i==null))for(const u of i){if(l(u))continue;const h=rk(u.name,e,s);for(const d of h)!d||d.kept||r.has(d.id)||d.dispose()}}async executeAsync(t,e){return this._executeAsync(t,e)}disposeIntermediateTensors(){this.clonedTensorsMap&&(Object.values(this.clonedTensorsMap).forEach(t=>{for(const e of t)e&&!e.isDisposed&&e.dispose()}),this.clonedTensorsMap=null)}getIntermediateTensors(){return this.clonedTensorsMap}async _executeAsync(t,e,s=!1,r={},a={}){this.disposeIntermediateTensors(),s||(t=this.mapInputs(t),this.checkInputs(t),this.checkInputShapeAndType(t),e=this.mapOutputs(e),this.checkOutputs(e));try{this.keepIntermediateTensors=ut().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(m){this.keepIntermediateTensors=!1,console.warn(m.message)}const i=new ck(this.weightMap,r,a,this.functionExecutorMap,this.parseNodeNameCache);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap));const l=await this.executeWithControlFlow(t,i,e,s),u=e.map(m=>Pn(m,l,i)),h=u.map(m=>m.id),d=Object.keys(t).map(m=>t[m].id),p=new Set([...h,...d,...this.weightIds]);return Object.values(l).forEach(m=>{m.forEach(y=>{y&&!y.isDisposed&&!p.has(y.id)&&y.dispose()})}),this.parent==null&&i.dispose(p),u}async executeFunctionAsync(t,e,s){const r=t.reduce((a,i,l)=>(a[this.inputs[l].name]=i,a),{});return this._executeAsync(r,this.outputNodes,!0,e,s)}async executeWithControlFlow(t,e,s,r){const a=Object.keys(t),i=a.map(T=>this.graph.nodes[$s(T)[0]]),l=s.map(T=>$s(T)[0]),u=new Set(l);let h=l.map(T=>this.graph.nodes[T]);h.length===0&&(h=this._outputs);const{usedNodes:d,missingInputs:p,dynamicNode:m,syncInputs:y}=hk(t,h,this.weightMap,this._initNodes),b=[...i,...this.graph.weights,...this._initNodes||[]].map(T=>({node:T,contexts:e.currentContext})),x=Object.assign({},this.weightMap);Object.keys(t).forEach(T=>{const[I,A]=$s(T),R=[];R[A]=t[T],x[I]=R});const v={},S=this.getFrozenTensorIds(x),C={};for(;b.length>0;){const T=this.processStack(i,b,e,x,C,S,u,v,d);await Promise.all(T)}m==null&&!r&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const $=h.filter(T=>!So(T)&&!Pn(T.name,x,e)).map(T=>T.name);if($.length>0){let T="";throw m!=null&&(T=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${y}]`),new Error(`Cannot compute the outputs [${$}] from the provided inputs [${a}]. Consider providing the following inputs: [${p}]. ${T}`)}return x}processStack(t,e,s,r,a,i,l,u,h){const d=[];for(;e.length>0;){const p=e.pop();s.currentContext=p.contexts;let m="";if(p.node.op==="Enter"&&k("isConstant",p.node,r,s)&&([m]=Aa(p.node.name,s)),r[p.node.name]==null){const y=uk(p.node,r,s,this._resourceManager);m||([m]=Aa(p.node.name,s));const b=s.currentContext;Fo(y)?d.push(y.then(x=>(r[m]=x,this.keepIntermediateTensors&&(this.clonedTensorsMap[m]=this.cloneTensorList(x)),s.currentContext=b,this.checkTensorForDisposal(m,p.node,r,s,i,l,u),this.processChildNodes(p.node,e,s,r,a,h),x))):(r[m]=y,this.keepIntermediateTensors&&(this.clonedTensorsMap[m]=this.cloneTensorList(y)),this.checkTensorForDisposal(m,p.node,r,s,i,l,u),this.processChildNodes(p.node,e,s,r,a,h))}else this.processChildNodes(p.node,e,s,r,a,h)}return d}processChildNodes(t,e,s,r,a,i){t.children.forEach(l=>{const[u]=Aa(l.name,s);a[u]||!i.has(l.name)||(l.op==="Merge"?l.inputNames.some(h=>!!Pn(h,r,s))&&(a[u]=!0,e.push({contexts:s.currentContext,node:l})):l.inputNames.every(h=>!!Pn(h,r,s))&&(a[u]=!0,e.push({contexts:s.currentContext,node:l})))})}dispose(){Object.keys(this.weightMap).forEach(t=>this.weightMap[t].forEach(e=>e.dispose()))}checkInputShapeAndType(t){Object.keys(t).forEach(e=>{const s=t[e],[r]=$s(e),a=this.graph.nodes[r];if(a.attrParams.shape&&a.attrParams.shape.value){const i=a.attrParams.shape.value,l=i.length===s.shape.length&&s.shape.every((u,h)=>i[h]===-1||i[h]===u);F(l,()=>`The shape of dict['${a.name}'] provided in model.execute(dict) must be [${i}], but was [${s.shape}]`)}a.attrParams.dtype&&a.attrParams.dtype.value&&F(s.dtype===a.attrParams.dtype.value,()=>`The dtype of dict['${a.name}'] provided in model.execute(dict) must be ${a.attrParams.dtype.value}, but was ${s.dtype}`)})}mapInputs(t){var e,s;const r={};for(const a in t){const i=(s=(e=this._signature)===null||e===void 0?void 0:e.inputs)===null||s===void 0?void 0:s[a];i!=null?r[i.name]=t[a]:r[a]=t[a]}return r}checkInputs(t){const e=Object.keys(t).filter(s=>{const[r]=$s(s);return this.graph.nodes[r]==null});if(e.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${e}] that are not part of graph`)}mapOutputs(t){return t.map(e=>{var s,r;const a=(r=(s=this._signature)===null||s===void 0?void 0:s.outputs)===null||r===void 0?void 0:r[e];return a!=null?a.name:e},{})}checkOutputs(t){t.forEach(e=>{const[s]=$s(e);if(!this.graph.nodes[s])throw new Error(`The output '${e}' is not found in the graph`)})}}class NX{constructor(t={},e={}){this.hashTableNameToHandle=t,this.hashTableMap=e}addHashTable(t,e){this.hashTableNameToHandle[t]=e.handle,this.hashTableMap[e.id]=e}getHashTableHandleByName(t){return this.hashTableNameToHandle[t]}getHashTableById(t){return this.hashTableMap[t]}dispose(){for(const t in this.hashTableMap)this.hashTableMap[t].clearAndClose(),delete this.hashTableMap[t];for(const t in this.hashTableNameToHandle)this.hashTableNameToHandle[t].dispose(),delete this.hashTableNameToHandle[t]}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TX="?tfjs-format=file",$X="model.json";class kX{get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}constructor(t,e={},s=FD){this.modelUrl=t,this.loadOptions=e,this.version="n/a",this.io=s,e==null&&(this.loadOptions={}),this.resourceManager=new NX}findIOHandler(){const t=this.modelUrl;if(t.load!=null)this.handler=t;else if(this.loadOptions.requestInit!=null)this.handler=this.io.browserHTTPRequest(t,this.loadOptions);else{const e=this.io.getLoadHandlers(t,this.loadOptions);if(e.length===0)e.push(this.io.browserHTTPRequest(t,this.loadOptions));else if(e.length>1)throw new Error(`Found more than one (${e.length}) load handlers for URL '${[t]}'`);this.handler=e[0]}}load(){if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const t=this.handler.load();return Fo(t)?t.then(e=>e.getWeightStream==null?this.loadSync(e):this.loadStreaming(e)):this.loadSync(t)}loadSync(t){const e=this.io.decodeWeights(t.weightData,t.weightSpecs);return this.loadWithWeightMap(t,e)}async loadStreaming(t){if(t.getWeightStream==null)throw new Error("Model artifacts missing streamWeights function");const e=await iE(t.getWeightStream(),t.weightSpecs);return this.loadWithWeightMap(t,e)}loadWithWeightMap(t,e){this.artifacts=t;const s=this.artifacts.modelTopology;let r=this.artifacts.signature;if(this.artifacts.userDefinedMetadata!=null){const a=this.artifacts.userDefinedMetadata;a.signature!=null&&(r=a.signature),a.structuredOutputKeys!=null&&(this.structuredOutputKeys=a.structuredOutputKeys)}if(this.signature=r,this.version=`${s.versions.producer}.${s.versions.minConsumer}`,this.executor=new om(ak.Instance.transformGraph(s,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(e),this.executor.resourceManager=this.resourceManager,t.modelInitializer!=null&&t.modelInitializer.node!=null){const a=ak.Instance.transformGraph(t.modelInitializer);this.initializer=new om(a),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializerSignature=t.initializerSignature}return!0}async save(t,e){if(typeof t=="string"){const s=this.io.getSaveHandlers(t);if(s.length===0)throw new Error(`Cannot find any save handlers for URL '${t}'`);if(s.length>1)throw new Error(`Found more than one (${s.length}) save handlers for URL '${t}'`);t=s[0]}if(t.save==null)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return t.save(this.artifacts)}addStructuredOutputNames(t){if(this.structuredOutputKeys){const e=t instanceof Me?[t]:t,s={};return e.forEach((r,a)=>s[this.structuredOutputKeys[a]]=r),s}return t}predict(t,e){const s=this.execute(t,this.outputNodes);return this.addStructuredOutputNames(s)}async predictAsync(t,e){const s=await this.executeAsync(t,this.outputNodes);return this.addStructuredOutputNames(s)}normalizeInputs(t){var e;if(!(t instanceof Me)&&!Array.isArray(t)){const a=(e=this.signature)===null||e===void 0?void 0:e.inputs;if(a!=null)for(const i in a){const l=a[i];l.resourceId!=null&&(t[i]=this.resourceIdToCapturedInput[l.resourceId])}return t}t=Array.isArray(t)?t:[t];const s=Object.keys(this.resourceIdToCapturedInput).length;if(t.length+s!==this.inputNodes.length)throw new Error(`Input tensor count mismatch, the graph model has ${this.inputNodes.length-s} non-resource placeholders, while there are ${t.length} input tensors provided.`);let r=0;return this.inputNodes.reduce((a,i)=>{var l,u,h;const d=(h=(u=(l=this.signature)===null||l===void 0?void 0:l.inputs)===null||u===void 0?void 0:u[i])===null||h===void 0?void 0:h.resourceId;return d!=null?a[i]=this.resourceIdToCapturedInput[d]:a[i]=t[r++],a},{})}normalizeOutputs(t){return t=t||this.outputNodes,Array.isArray(t)?t:[t]}executeInitializerGraph(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.execute({},[]):this.initializer.execute({},Object.keys(this.initializerSignature.outputs))}async executeInitializerGraphAsync(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.executeAsync({},[]):this.initializer.executeAsync({},Object.keys(this.initializerSignature.outputs))}setResourceIdToCapturedInput(t){if(this.resourceIdToCapturedInput={},this.initializerSignature){const e=this.initializerSignature.outputs,s=Object.keys(e);for(let r=0;r<s.length;r++){const a=s[r],i=e[a];this.resourceIdToCapturedInput[i.resourceId]=t[r]}}}execute(t,e){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(this.executeInitializerGraph()),t=this.normalizeInputs(t),e=this.normalizeOutputs(e);const s=this.executor.execute(t,e);return s.length>1?s:s[0]}async executeAsync(t,e){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(await this.executeInitializerGraphAsync()),t=this.normalizeInputs(t),e=this.normalizeOutputs(e);const s=await this.executor.executeAsync(t,e);return s.length>1?s:s[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(t){return Object.keys(t).reduce((e,s)=>(e[s]=[t[s]],e),{})}dispose(){this.executor.dispose(),this.initializer&&(this.initializer.dispose(),this.resourceIdToCapturedInput&&se(this.resourceIdToCapturedInput)),this.resourceManager.dispose()}}async function FO(n,t={},e=FD){if(n==null)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");t==null&&(t={}),t.fromTFHub&&typeof n=="string"&&(n=IX(n));const s=new kX(n,t,e);return await s.load(),s}function IX(n){return n.endsWith("/")||(n=n+"/"),`${n}${$X}${TX}`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var dk;(function(n){n[n.FAIL=0]="FAIL",n[n.SHORTEST=1]="SHORTEST",n[n.LONGEST=2]="LONGEST"})(dk||(dk={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lt(n,t){Array.isArray(n)||(n=[n]),n.forEach(e=>{e!=null&&F(e.dtype!=="complex64",()=>`${t} does not support complex64 tensors in the CPU backend.`)})}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EX=xw;class fy extends D1{nextDataId(){return fy.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new RI(this,Zr())}write(t,e,s){this.firstUse&&(this.firstUse=!1,ut().get("IS_NODE")&&Ys(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));const r={id:this.nextDataId()};return this.data.set(r,{values:t,dtype:s,refCount:1}),r}makeTensorInfo(t,e,s){let r;if(e==="string"&&s!=null&&s.length>0&&Ch(s[0])){const a=s.map(i=>Ni(i));r=this.write(a,t,e)}else r=this.write(s,t,e);return{dataId:r,shape:t,dtype:e}}refCount(t){return this.data.has(t)?this.data.get(t).refCount:0}incRef(t){const e=this.data.get(t);e.refCount++}decRef(t){if(this.data.has(t)){const e=this.data.get(t);e.refCount--}}move(t,e,s,r,a){this.data.set(t,{values:e,dtype:r,refCount:a})}numDataIds(){return this.data.numDataIds()}async read(t){return this.readSync(t)}readSync(t){const{dtype:e,complexTensorInfos:s}=this.data.get(t);if(e==="complex64"){const r=this.readSync(s.real.dataId),a=this.readSync(s.imag.dataId);return Ba(r,a)}return RM(this.data.get(t).values,e)}bufferSync(t){const e=this.readSync(t.dataId);if(t.dtype==="string")try{const s=e.map(r=>ki(r));return te(t.shape,t.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return te(t.shape,t.dtype,e)}makeOutput(t,e,s){return Zr().makeTensorFromTensorInfo(this.makeTensorInfo(e,s,t),this)}disposeData(t,e=!1){if(this.data.has(t)){if(this.data.get(t).refCount--,!e&&this.data.get(t).refCount>0)return!1;const{complexTensorInfos:s}=this.data.get(t);s!=null&&(this.disposeData(s.real.dataId,!0),this.disposeData(s.imag.dataId,!0)),this.data.delete(t)}return!0}disposeIntermediateTensorInfo(t){this.disposeData(t.dataId)}async time(t){const e=ps();return t(),{kernelMs:ps()-e}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(t){Lt([t],"where");const e=this.readSync(t.dataId);return EX(t.shape,e)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}fy.nextDataId=0;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LO(n){const t=new Float32Array(n.length);for(let e=0;e<n.length;++e)t[e]=Math.abs(n[e]);return t}const DX=n=>{const{x:t}=n.inputs,e=n.backend;Lt(t,"abs");let s=new Float32Array(mt(t.shape));const r=e.data.get(t.dataId).values;return s=LO(r),e.makeOutput(s,t.shape,t.dtype)},AX={kernelName:km,backendName:"cpu",kernelFunc:DX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cn(n){return(t,e,s,r,a)=>{const i=Yt(t,e),l=i.length,u=Bt(i),h=mt(i),d=Gn(a,h),p=t.length,m=e.length,y=Bt(t),b=Bt(e),x=du(t,i),v=du(e,i);if(x.length+v.length===0)for(let S=0;S<d.length;++S)d[S]=n(s[S%s.length],r[S%r.length]);else for(let S=0;S<d.length;++S){const C=Du(S,l,u),$=C.slice(-p);x.forEach(R=>$[R]=0);const T=sa($,p,y),I=C.slice(-m);v.forEach(R=>I[R]=0);const A=sa(I,m,b);d[S]=n(s[T],r[A])}return[d,i]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ks(n){const{inputs:t,backend:e}=n,{real:s,imag:r}=t,a=e.data.get(s.dataId).values,i=e.data.get(r.dataId).values,l=e.makeTensorInfo(s.shape,"complex64"),u=e.data.get(l.dataId);return u.complexTensorInfos={real:e.makeTensorInfo(s.shape,"float32",a),imag:e.makeTensorInfo(r.shape,"float32",i)},l}const RX={kernelName:P1,backendName:"cpu",kernelFunc:ks};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lm(n,t,e="float32"){if(e==="complex64"){const r=lm(n,t,"float32"),a=lm(n,t,"float32");return ks({inputs:{real:r,imag:a},backend:n})}const s=ts(mt(t),e);return n.makeTensorInfo(t,e,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ua(n){const{inputs:t,backend:e}=n,{x:s}=t;return e.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const OX={kernelName:Wh,backendName:"cpu",kernelFunc:ua};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jo(n){const{inputs:t,backend:e}=n,{input:s}=t,r=e.data.get(s.dataId).complexTensorInfos.real,a=e.data.get(r.dataId).values;return e.makeTensorInfo(r.shape,r.dtype,a)}const _X={kernelName:bv,backendName:"cpu",kernelFunc:jo};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zO(n,t,e,s){if(s==="int32"){const r=Int32Array.from(n);return[t,"int32",r]}if(s==="bool"){const r=Ko([0],e),[a,i]=cn((l,u)=>l!==u?1:0)(t,[],n,r,"bool");return[i,"bool",a]}throw new Error(`Error in Cast: failed to cast ${e} to ${s}`)}function Li(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{dtype:a}=s;if(a==="complex64"){if(r.dtype==="complex64")return ua({inputs:{x:r},backend:e});const d=lm(e,r.shape,r.dtype),p=Li({inputs:{x:r},backend:e,attrs:{dtype:"float32"}}),m=ks({inputs:{real:p,imag:d},backend:e});return e.disposeIntermediateTensorInfo(d),e.disposeIntermediateTensorInfo(p),m}if(r.dtype==="complex64"){const d=jo({inputs:{input:r},backend:e}),p=Li({inputs:{x:d},backend:e,attrs:{dtype:a}});return e.disposeIntermediateTensorInfo(d),p}if(!_I(r.dtype,a)){const d=ua({inputs:{x:r},backend:e});return{dataId:d.dataId,shape:d.shape,dtype:a}}const i=e.data.get(r.dataId).values,[l,u,h]=zO(i,r.shape,r.dtype,a);return e.makeTensorInfo(l,u,h)}const FX={kernelName:Ah,backendName:"cpu",kernelFunc:Li};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kn(n,t,e,s){return e==null?({inputs:r,backend:a})=>{const{a:i,b:l}=r,u=a;Lt([i,l],n);const h=u.data.get(i.dataId).values,d=u.data.get(l.dataId).values,p=i.dtype==="string"?Pa(h):h,m=i.dtype==="string"?Pa(d):d,y=s||i.dtype,[b,x]=t(i.shape,l.shape,p,m,y);return u.makeTensorInfo(x,y,b)}:({inputs:r,backend:a})=>{const{a:i,b:l}=r,u=a;if(i.dtype==="complex64"||l.dtype==="complex64"){const h=Li({inputs:{x:i},backend:u,attrs:{dtype:"complex64"}}),d=u.data.get(h.dataId),p=d.complexTensorInfos.real,m=d.complexTensorInfos.imag,y=u.data.get(p.dataId).values,b=u.data.get(m.dataId).values,x=Li({inputs:{x:l},backend:u,attrs:{dtype:"complex64"}}),v=u.data.get(x.dataId),S=v.complexTensorInfos.real,C=v.complexTensorInfos.imag,$=u.data.get(S.dataId).values,T=u.data.get(C.dataId).values,[I,A,R]=e(i.shape,l.shape,y,b,$,T),L=u.makeTensorInfo(R,"float32",I),_=u.makeTensorInfo(R,"float32",A),M=ks({inputs:{real:L,imag:_},backend:u});return u.disposeIntermediateTensorInfo(h),u.disposeIntermediateTensorInfo(x),u.disposeIntermediateTensorInfo(L),u.disposeIntermediateTensorInfo(_),M}else{const h=u.data.get(i.dataId).values,d=u.data.get(l.dataId).values,p=s||i.dtype,[m,y]=t(i.shape,l.shape,h,d,p);return u.makeTensorInfo(y,p,m)}}}function CS(n){return(t,e,s,r,a,i)=>{const l=Yt(t,e),u=mt(l),h=l.length,d=Bt(l),p=Gn("float32",u),m=Gn("float32",u),y=du(t,l),b=du(e,l),x=Ba(s,r),v=Ba(a,i),S=t.length,C=Bt(t),$=e.length,T=Bt(e);if(y.length+b.length===0)for(let I=0;I<p.length;I++){const A=I%x.length,R=I%v.length,L=n(x[A*2],x[A*2+1],v[R*2],v[R*2+1]);p[I]=L.real,m[I]=L.imag}else for(let I=0;I<p.length;I++){const A=Du(I,h,d),R=A.slice(-S);y.forEach(W=>R[W]=0);const L=sa(R,S,C),_=A.slice(-$);b.forEach(W=>_[W]=0);const M=sa(_,$,T),D=n(x[L*2],x[L*2+1],v[M*2],v[M*2+1]);p[I]=D.real,m[I]=D.imag}return[p,m,l]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MO=cn((n,t)=>n+t),LX=CS((n,t,e,s)=>({real:n+e,imag:t+s})),gu=kn(Au,MO,LX),zX={kernelName:Au,backendName:"cpu",kernelFunc:gu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NS(n,t,e,s,r){const a=mt(s),i=ts(r,e);for(let l=0;l<n.length;l++){const u=n[l];if(u<0)throw new Error("Input x must be non-negative!");u>=r||(a>0?i[u]+=t[l]:i[u]+=1)}return i}function BO(n,t,e,s=!1){const r=n.shape[0],a=n.shape[1],i=te([r,e],t.dtype);for(let l=0;l<r;l++)for(let u=0;u<a;u++){const h=n.get(l,u);if(h<0)throw new Error("Input x must be non-negative!");h>=e||(s?i.set(1,l,h):t.size>0?i.set(i.get(l,h)+t.get(l,u),l,h):i.set(i.get(l,h)+1,l,h))}return i}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PO=cn((n,t)=>n&t),MX=kn(Fm,PO),BX={kernelName:Fm,backendName:"cpu",kernelFunc:MX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ha(n){return(t,e,s)=>{const r=an(e,t.length);for(let a=0;a<t.length;++a)r[a]=n(t[a],s);return r}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ce(n,t,e){const s=ha(t);return Ki(n,s,e)}function Ki(n,t,e){return({inputs:s,attrs:r,backend:a})=>{const{x:i}=s;Lt(i,n);const l=a,u=l.data.get(i.dataId).values;let h;if(i.dtype==="string"){if(!Array.isArray(u))throw new Error("String tensor's value was not an instance of Array");h=Pa(u)}else h=u;const d=e||i.dtype,p=t(h,d,r);return l.makeTensorInfo(i.shape,d,p)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VO=ha(n=>Math.ceil(n)),PX=Ki(Rh,VO),VX={kernelName:Rh,backendName:"cpu",kernelFunc:PX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UO(n,t,e,s){const r=an(e,mt(t));if(s&&e!=="string"){let a=0;n.forEach(i=>{const l=mt(i.shape);r.set(i.vals,a),a+=l})}else{let a=0;n.forEach(i=>{const l=e==="string"?Pa(i.vals):i.vals;let u=0;for(let h=0;h<i.shape[0];++h){const d=h*t[1]+a;for(let p=0;p<i.shape[1];++p)r[d+p]=l[u++]}a+=i.shape[1]})}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GO=cn((n,t)=>n===t?1:0),WO=kn(Wm,GO,null,"bool"),UX={kernelName:Wm,backendName:"cpu",kernelFunc:WO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HO=ha(n=>Math.exp(n)),jO=Ki(Bh,HO,"float32"),GX={kernelName:Bh,backendName:"cpu",kernelFunc:jO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qO=ha(n=>Math.expm1(n)),WX=Ki(Ph,qO),HX={kernelName:Ph,backendName:"cpu",kernelFunc:WX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XO=ha(n=>Math.floor(n)),jX=Ki(Vh,XO),qX={kernelName:Vh,backendName:"cpu",kernelFunc:jX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KO=cn((n,t)=>Math.floor(n/t)),XX=kn(Uh,KO,null,"int32"),KX={kernelName:Uh,backendName:"cpu",kernelFunc:XX};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YO(n,t,e,s,r,a,i,l,u){const h=te([s,a],e);for(let d=0;d<s;d++){const p=[];let m=0;for(let y=0;y<r;y++){const b=n[d*r+y];m+=b*i[y],p.push(b)}if(m<0||m>=u/a)throw new Error(`Invalid indices: ${p} does not index into ${l}`);for(let y=0;y<a;y++)h.values[d*a+y]=t.get(...t.indexToLoc(m*a+y))}return h}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZO(n,t,e){const s=te(e,n.dtype);for(let r=0;r<s.size;++r){const i=s.indexToLoc(r).slice(),l=i[0],u=i[2],h=t.locToIndex([l,u]);i[2]=t.values[h];const d=n.locToIndex(i);0<=d&&d<n.values.length&&(s.values[r]=n.values[d])}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QO=cn((n,t)=>n>t?1:0),YX=kn(Xm,QO,null,"bool"),ZX={kernelName:Xm,backendName:"cpu",kernelFunc:YX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JO=cn((n,t)=>n>=t?1:0),QX=kn(Gh,JO,null,"bool"),JX={kernelName:Gh,backendName:"cpu",kernelFunc:QX};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t_=cn((n,t)=>n<t?1:0),tK=kn(Ym,t_,null,"bool"),eK={kernelName:Ym,backendName:"cpu",kernelFunc:tK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e_=cn((n,t)=>n<=t?1:0),nK=kn(Zm,e_,null,"bool"),sK={kernelName:Zm,backendName:"cpu",kernelFunc:nK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n_(n,t,e){const s=(t-n)/(e-1),r=ts(e,"float32");r[0]=n;for(let a=1;a<r.length;a++)r[a]=r[a-1]+s;return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s_=ha(n=>Math.log(n)),rK=Ki(Xh,s_),aK={kernelName:Xh,backendName:"cpu",kernelFunc:rK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r_(n,t,e,s){const r=Gn(s,mt(e));for(let a=0;a<r.length;++a){const i=a*t;let l=n[i];for(let u=0;u<t;++u){const h=n[i+u];(Number.isNaN(h)||h>l)&&(l=h)}r[a]=l}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a_=cn((n,t)=>Math.max(n,t)),iK=kn(Yh,a_),oK={kernelName:Yh,backendName:"cpu",kernelFunc:iK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i_=cn((n,t)=>Math.min(n,t)),lK=kn(Zh,i_),uK={kernelName:Zh,backendName:"cpu",kernelFunc:lK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TS=cn((n,t)=>n*t),cK=CS((n,t,e,s)=>({real:n*e-t*s,imag:n*s+t*e})),py=kn(Jh,TS,cK),hK={kernelName:Jh,backendName:"cpu",kernelFunc:py};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o_(n,t,e){const s=Pi(-1,e);return TS([],t,s,n,e)}function dK(n){const{inputs:t,backend:e}=n,{x:s}=t;Lt(s,"neg");const r=e.data.get(s.dataId).values,[a,i]=o_(r,s.shape,s.dtype);return e.makeTensorInfo(i,s.dtype,a)}const fK={kernelName:lg,backendName:"cpu",kernelFunc:dK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l_=cn((n,t)=>n!==t?1:0),pK=kn(ug,l_,null,"bool"),mK={kernelName:ug,backendName:"cpu",kernelFunc:pK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $S(n,t,e,s,r){const a=t.length,i=mt(t),l=Bt(t),u=Bt(r),h=Gn(e,mt(r));for(let d=0;d<i;++d){const p=Du(d,a,l),m=new Array(p.length);for(let b=0;b<m.length;b++)m[b]=p[s[b]];const y=sa(m,a,u);h[y]=n[d]}return h}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bs(n){const{inputs:t,attrs:e,backend:s}=n,{x:r}=t,{perm:a}=e;Lt(r,"transpose");const i=r.shape.length,l=new Array(i);for(let p=0;p<l.length;p++)l[p]=r.shape[a[p]];const u=s.data.get(r.dataId).values,h=$S(u,r.shape,r.dtype,a,l);return{dataId:s.write(h,l,r.dtype),shape:l,dtype:r.dtype}}const gK={kernelName:nu,backendName:"cpu",kernelFunc:bs};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u_(n,t,e,s){const[r,a]=_n(n,s),i=Os(t,"int32"),l=ts(mt(r),i),u=mt(a);for(let h=0;h<l.length;++h){const d=h*u;let p=1;for(let m=0;m<u;++m)p*=e[d+m];l[h]=p}return{outVals:l,outShape:r,outDtype:i}}function yK(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{axis:a,keepDims:i}=s;Lt(r,"prod");const l=r.shape.length,u=re(a,r.shape),h=qe(u,l);let d=u,p=r;const m=[];h!=null&&(p=bs({inputs:{x:r},backend:e,attrs:{perm:h}}),m.push(p),d=ln(d.length,l));const y=e.data.get(p.dataId).values,{outVals:b,outShape:x,outDtype:v}=u_(p.shape,p.dtype,y,d);let S=x;return i&&(S=on(x,u)),m.forEach(C=>e.disposeIntermediateTensorInfo(C)),e.makeTensorInfo(S,v,b)}const bK={kernelName:mg,backendName:"cpu",kernelFunc:yK};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xK(n,t,e){n.forEach((s,r)=>{if(s<0||s>=e){const a=Du(r,t.length,Bt(t)).join(",");throw new Error(`indices[${a}] = ${s} is not in [0, ${e})`)}})}function vK(n,t){for(let e=0;e<n.length;++e){const s=n[e],r=e===n.length-1?t:n[e+1].length;if(s.length===0)throw new Error("Ragged splits may not be empty");if(s[0]<0)throw new Error("Ragged splits must be non-negative");if(s[s.length-1]>r)throw new Error("Ragged splits must not point past values");for(let a=1;a<s.length;++a)if(s[a-1]>s[a])throw new Error("Ragged splits must be sorted in ascending order")}}function wK(n,t,e,s){const r=[];let a=0;const i=t.length-1+e.length,l=new Array(i).fill(null).map(()=>[0]);vK(e,s);let u=1;for(let h=0;h<t.length-1;++h){u*=t[h];const d=t[h+1];for(let p=1;p<u+1;++p)l[h].push(p*d)}for(let h=0;h<n.length;++h){let d=n[h],p=n[h]+1;for(let m=0;m<e.length;++m){const y=e[m],b=m+t.length-1;if(b>=0){const x=l[b],v=x[x.length-1]-y[d];for(let S=d;S<p;++S)l[b].push(y[S+1]+v)}d=y[d],p=y[p]}p!==d&&(r.push([d,p]),a+=p-d)}return{outSplits:l,valueSlices:r,numValues:a}}function SK(n){const t=[];for(let e=0;e<n.length;++e){const s=n[e].length,r=an("int32",s);t.push(r),n[e].forEach((a,i)=>r[i]=a)}return t}function fk(n,t){const e=n.slice(0,t);for(;e.length<t;)e.push(1);for(let s=t;s<n.length;s++)e[t-1]*=n[s];return e}function CK(n,t,e,s,r,a){const i=fk(t,2)[1],l=fk(a,2)[1];let u=0;for(const h of e)for(let d=h[0];d<h[1];++d){for(let p=0;p<s;++p)r[u*l+p]=n[d*i+p];++u}}function NK(n,t,e,s,r){const a=t.slice();a[0]=r;const i=an(e,mt(a)),l=n.length,u=l===0?0:l/t[0];return CK(n,t,s,u,i,a),[i,a]}function c_(n,t,e,s,r,a,i,l){if(n.length===0)throw new Error("paramsNestedSplits must be non empty");if(t[0].length===0)throw new Error("Split tensors must not be scalars");const u=t[0][0]-1;if(xK(a,i,u),s.length===0)throw new Error("params.rank must be nonzero");const h=s[0],{outSplits:d,valueSlices:p,numValues:m}=wK(a,i,n,h),y=SK(d),b=NK(e,s,r,p,m);return[y,b[0],b[1]]}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pk=2147483647;function h_(n,t,e,s,r,a,i){if(t.length>1)throw new Error("starts must be a scalar or vector");if(r.length>1)throw new Error("limits must be a scalar or vector");if(i.length>1)throw new Error("deltas must be a scalar or vector");const l=t.length===0,u=r.length===0,h=i.length===0,d=[];l||d.push(t[0]),u||d.push(r[0]),h||d.push(i[0]);for(let v=1;v<d.length;++v)if(d[v]!==d[v-1])throw new Error("starts, limits, and deltas must have the same shape");const p=d.length===0?1:d[0],m=an("int32",p+1);m[0]=0;for(let v=0;v<p;++v){const S=l?n[0]:n[v],C=u?s[0]:s[v],$=h?a[0]:a[v];if($===0)throw new Error("Requires delta != 0");let T;if($>0&&C<S||$<0&&C>S)T=0;else if(T=Math.ceil(Math.abs((C-S)/$)),T>pk)throw new Error(`Requires ((limit - start) / delta) <= ${pk}`);m[v+1]=m[v]+T}const y=m[p],b=an(e,y);let x=0;for(let v=0;v<p;++v){const S=m[v+1]-m[v];let C=l?n[0]:n[v];const $=h?a[0]:a[v];for(let T=0;T<S;++T)b[x++]=C,C+=$}return[m,b]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var dr=Or;class um{constructor(t,e,s,r,a,i,l,u,h,d){this.shape=t,this.shapeShape=e,this.values=s,this.valuesShape=r,this.valuesDType=a,this.defaultValue=i,this.defaultValueShape=l,this.rowPartitionValues=u,this.rowPartitionValuesShapes=h,this.rowPartitionTypes=jD(d),this.raggedRank=qD(this.rowPartitionTypes)}getRowPartitionTypeByDimension(t){return this.rowPartitionTypes[0]===dr.FIRST_DIM_SIZE?this.rowPartitionTypes[t+1]:this.rowPartitionTypes[t]}getRowPartitionTensor(t){return this.rowPartitionTypes[0]===dr.FIRST_DIM_SIZE?this.rowPartitionValues[t+1]:this.rowPartitionValues[t]}getMaxWidth(t){const e=this.getRowPartitionTensor(t-1);switch(this.getRowPartitionTypeByDimension(t-1)){case dr.VALUE_ROWIDS:return um.getMaxWidthValueRowID(e);case dr.ROW_SPLITS:return um.getMaxWidthRowSplit(e);default:throw new Error(`Cannot handle partition type ${dr[this.getRowPartitionTypeByDimension(t-1)]}`)}}static getMaxWidthRowSplit(t){const e=t.length;if(e===0||e===1)return 0;let s=0;for(let r=0;r<e-1;++r){const a=t[r+1]-t[r];a>s&&(s=a)}return s}static getMaxWidthValueRowID(t){const e=t.length;if(e===0)return 0;let s=0,r=t[0],a=0;for(let i=1;i<e;++i){const l=t[i];l!==r&&(r=l,a=Math.max(i-s,a),s=i)}return Math.max(e-s,a)}tensorShapeFromTensor(t,e,s=!0){if(e.length===0){if(t[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return gk(t,s)}calculateOutputSize(t){const e=this.valuesShape,s=this.defaultValueShape;XD(s,e);const r=this.tensorShapeFromTensor(this.shape,this.shapeShape),i=HD(this.raggedRank,r,e);i[0]<0&&(i[0]=t);for(let l=1;l<=this.raggedRank;++l)i[l]<0&&(i[l]=this.getMaxWidth(l));return i}calculateFirstParentOutputIndex(t,e,s){const r=Math.min(t,s),a=[];let i=0;for(let l=0;l<r;++l,i+=e)a.push(i);for(let l=r;l<t;++l)a.push(-1);return F(a.length===t,()=>"Final length of result must be equal to firstDimension."),a}calculateOutputIndexRowSplit(t,e,s,r){const a=t.length,i=[];for(let l=0;l<a-1;++l){const u=t[l+1]-t[l];let h=Math.min(r,u),d=e[l];d===-1&&(h=0);for(let p=0;p<h;++p)i.push(d),d+=s;for(let p=0;p<u-h;++p)i.push(-1)}if(a>0&&i.length!==t[a-1])throw new Error("Invalid row split size.");return i}calculateOutputIndexValueRowID(t,e,s,r){const a=t.length,i=[];if(a===0)return[];let l=0,u=t[0];if(u>=e.length)throw new Error(`Got currentValueRowId=${u}, which is not less than ${e.length}`);let h=e[u];i.push(h);for(let d=1;d<a;++d){const p=t[d];if(p===u)h>=0&&(++l,l<r?h+=s:h=-1);else{if(l=0,u=p,p>=e.length)throw new Error(`Got nextValueRowId=${p} which is not less than ${e.length}`);h=e[p]}i.push(h)}if(i.length!==t.length)throw new Error("Invalid row ids.");return i}calculateOutputIndex(t,e,s,r){const a=this.getRowPartitionTensor(t),i=this.getRowPartitionTypeByDimension(t);switch(i){case dr.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(a,e,s,r);case dr.ROW_SPLITS:if(a.length-1>e.length)throw new Error(`Row partition size is greater than output size: ${a.length-1} > ${e.length}`);return this.calculateOutputIndexRowSplit(a,e,s,r);default:throw new Error(`Unsupported partition type: ${dr[i]}`)}}getFirstDimensionSize(){const t=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const e=this.rowPartitionTypes[0];switch(e){case dr.FIRST_DIM_SIZE:return t[0];case dr.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case dr.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${dr[e]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const e=this.getFirstDimensionSize(),s=this.calculateOutputSize(e),r=new Array(this.raggedRank+1);r[r.length-1]=1;for(let u=r.length-2;u>=0;--u)r[u]=r[u+1]*s[u+1];const a=gk(s,!1),i=an(this.valuesDType,mt(a));if(r[0]*s[0]>0){let u=this.calculateFirstParentOutputIndex(e,r[0],s[0]);for(let h=1;h<=this.raggedRank;++h)u=this.calculateOutputIndex(h-1,u,r[h],s[h]);this.setOutput(this.raggedRank,u,i,a)}return[a,i]}setOutput(t,e,s,r){if(s.length===0)return;const a=this.values,i=s;let l=r.slice();l=l.slice(t+1);const u=mt(l),h=e.length;let d=this.defaultValue;if(d.length!==u&&d.length!==1){const b=this.defaultValueShape;at(()=>{const x=J(d,b);d=au(x,l).dataSync()})}let p=0,m=0,y=0;for(let b=0;b<=h;++b){let x=b<h?e[b]:-1;if(x===y){++y;continue}if(m<y){const v=a.subarray(p*u),S=i.subarray(m*u),C=(y-m)*u;mk(S,v,C)}if(b>=h){const v=s.length;x=Math.floor(v/u)}if(x>y)if(this.defaultValue.length===1)i.subarray(y*u,x*u).fill(this.defaultValue[0]),y=x;else for(;x>y;){const v=i.slice(y*u);mk(v,d,u),++y}x<0?(p=b+1,m=y):(p=b,m=y,y=m+1)}}}function mk(n,t,e){for(let s=0;s<e;s++)n[s]=t[s]}function gk(n,t){const e=[];for(let s of n){if(s<0){if(!t)throw new Error(`Dimension ${s} must be >= 0`);if(s<-1)throw new Error(`Dimension ${s} must be >= -1`);s=-1}e.push(s)}return e}function d_(n,t,e,s,r,a,i,l,u,h){return new um(n,t,e,s,r,a,i,l,u,h).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f_(n,t,e,s){const r=n===t,a=n<t&&e<0,i=t<n&&e>1;if(r||a||i)return ts(0,s);const l=Math.abs(Math.ceil((t-n)/e)),u=ts(l,s);t<n&&e===1&&(e=-1),u[0]=n;for(let h=1;h<u.length;h++)u[h]=u[h-1]+e;return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const p_=ha(n=>1/Math.sqrt(n)),TK=Ki(ad,p_),$K={kernelName:ad,backendName:"cpu",kernelFunc:TK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function To(n,t,e,s,r,a,i,l,u,h){const d=[s/r,r],p=n.values,m=t.values;if(s===0)return te(e,t.dtype);const y=u instanceof Cn?u:te(d,t.dtype);typeof u=="string"||typeof u=="number"?y.values.fill(u):typeof u=="boolean"&&y.values.fill(+u);for(let b=0;b<a;b++){const x=[];let v=0;for(let S=0;S<i;S++){const C=p[b*i+S];x.push(C),v+=C*l[S]}if(v<0||v>=s/r)throw new Error(`Invalid indices: ${x} does not index into ${e}`);for(let S=0;S<r;S++)h?y.values[v*r+S]+=m[b*r+S]:y.values[v*r+S]=t.rank===0?m[0]:m[b*r+S]}return y}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kK=ha(n=>1/(1+Math.exp(-n))),m_=Ce(cd,n=>1/(1+Math.exp(-n))),IK={kernelName:cd,backendName:"cpu",kernelFunc:m_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g_(n,t,e,s,r){const a=Rw(s,t,e),i=mt(e),l=Bt(s);if(a){const p=Ow(t,l);return r==="string"?n.slice(p,p+i):n.subarray(p,p+i)}const u=r==="string"?Pa(n):n,h=te(s,r,u),d=te(e,r);for(let p=0;p<d.size;++p){const m=d.indexToLoc(p),y=m.map((b,x)=>b+t[x]);d.set(h.get(...y),...m)}return r==="string"?pA(d.values):d.values}function qo(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{begin:a,size:i}=s;Lt(r,"slice");const[l,u]=Jg(r,a,i);Dw(r,l,u);const h=e.data.get(r.dataId).values,d=g_(h,l,u,r.shape,r.dtype);return e.makeTensorInfo(u,r.dtype,d)}const EK={kernelName:wg,backendName:"cpu",kernelFunc:qo};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y_(n,t,e,s,r,a,i){const l=t[0],u=a[0],h=new Array(u),d=new Array(l),p=t[1];if(u===0){if(l!==0)throw new Error(eA(l));const v=an(e,0),S=an(r,0);return[v,[0,p],S,h,d]}let m=!0,y=0;const b=new Array(u).fill(0);for(let v=0;v<l;++v){const S=n[v*p];if(S<0)throw new Error(nA(v,S));if(S>=u)throw new Error(sA(v,S,u));++b[S],m=m&&S>=y,y=S}let x=!0;for(let v=0;v<u;++v){const S=b[v]===0;h[v]=S,x=x&&!S,b[v]=Math.max(b[v],1),v>0&&(b[v]+=b[v-1])}if(x&&m){const v=n,S=s;for(let C=0;C<l;++C)d[C]=C;return[v,[l,p],S,h,d]}else{const v=b[u-1],S=an(e,v*p),C=an(r,v),$=new Array(u).fill(0);for(let T=0;T<l;++T){const I=n[T*p],A=$[I],R=(I===0?0:b[I-1])+A;$[I]++;for(let L=0;L<p;++L)S[R*p+L]=n[T*p+L];C[R]=s[T],d[T]=R}for(let T=0;T<u;++T)if($[T]===0){const A=T===0?0:b[T-1];S[A*p+0]=T;for(let R=1;R<p;++R)S[A*p+R]=0;C[A]=i}return[S,[v,p],C,h,d]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b_(n,t,e,s,r){const a=mt(s),i=t[0],l=r.length,u=[];let h=1,d=-1;for(let v=0;v<l;++v){const S=r[v];if(S===-1){if(d!==-1)throw new Error(rA(d,v));d=v,u.push(1)}else{if(S<0)throw new Error(aA(v,S));h*=S,u.push(S)}}if(d!==-1){if(h<=0)throw new Error(iA());const v=Math.trunc(a/h);if(h*v!==a)throw new Error(oA(s,u));u[d]=v}if(mt(u)!==a)throw new Error(lA(s,u));const m=s.length,y=[];if(m>0){y[m-1]=1;for(let v=m-2;v>=0;--v)y[v]=y[v+1]*s[v+1]}const b=[];if(l>0){b[l-1]=1;for(let v=l-2;v>=0;--v)b[v]=b[v+1]*u[v+1]}const x=an(e,i*l);for(let v=0;v<i;++v){let S=0;for(let C=0;C<m;++C)S+=n[v*m+C]*y[C];for(let C=0;C<l;++C)x[v*l+C]=Math.trunc(S/b[C]),S%=b[C]}return[x,[i,l],u]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kS(n,t,e,s,r,a=!1,i=0){const l=s.length,u=[t[0],n.length/t[0]],h=u[1],p=l>0?r[l-1]+1:0;if(p<0)throw new Error(qx());const m=t.slice();m[0]=p;const y=m.reduce(($,T)=>$*T,1),b=an(e,y);if(l===0)return p>0&&b.fill(i),[b,m];if(p<=0)throw new Error(qx());let x=0,v=1,S=0,C=r[x];for(;;){let $=0;if(v<l){if($=r[v],C===$){++v;continue}if(C>=$)throw new Error(uA())}if(C<0||C>=p)throw new Error(cA(C,p));C>S&&b.fill(i,S*h,C*h);for(let T=x;T<v;++T){const I=s[T];if(I<0||I>=u[0])throw new Error(hA(T,s[T],u[0]));for(let A=0;A<h;A++)b[C*h+A]+=n[I*h+A]}if(a)for(let T=0;T<h;T++)b[C*h+T]/=v-x;if(x=v,++v,S=C+1,C=$,v>l)break}return S<p&&b.fill(i,S*h,p*h),[b,m]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DK=ha(n=>Math.sqrt(n)),AK=Ce(dd,n=>Math.sqrt(n)),RK={kernelName:dd,backendName:"cpu",kernelFunc:AK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x_=cn((n,t)=>{const e=n-t;return e*e}),OK=kn(fd,x_),_K={kernelName:fd,backendName:"cpu",kernelFunc:OK};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const v_=ha((n,t)=>{const{pattern:e,replaceGlobal:s,rewrite:r}=t;return n.replace(new RegExp(e,s?"g":""),r)}),FK=Ki($g,v_),LK={kernelName:$g,backendName:"cpu",kernelFunc:FK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w_(n,t,e,s){const r=te(n,t.dtype);for(let a=0;a<r.size;a++){const i=r.indexToLoc(a),l=new Array(i.length);for(let u=0;u<l.length;u++)l[u]=i[u]*e[u]+s[u];r.set(t.get(...l),...i)}return r}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zK{constructor(t,e,s,r,a,i){this.separator=Ni(t),this.nGramWidths=e,this.leftPad=Ni(s),this.rightPad=Ni(r),this.padWidth=a,this.preserveShort=i}getPadWidth(t){return Math.min(this.padWidth<0?t-1:this.padWidth,t-1)}getNumNGrams(t,e){const s=this.getPadWidth(e);return Math.max(0,t+2*s-e+1)}createNGrams(t,e,s,r,a,i){for(let l=0;l<a;++l){const u=this.getPadWidth(i),h=Math.max(0,u-l),d=Math.max(0,u-(a-(l+1))),p=i-(h+d),m=e+(h>0?0:l-u);let y=0;y+=h*this.leftPad.length;for(let C=0;C<p;++C)y+=t[m+C].length;y+=d*this.rightPad.length;const b=h+d+p-1;y+=b*this.separator.length,s[r+l]=new Uint8Array(y);const x=s[r+l];let v=0;const S=C=>C.forEach($=>x[v++]=$);for(let C=0;C<h;++C)S(this.leftPad),S(this.separator);for(let C=0;C<p-1;++C)S(t[m+C]),S(this.separator);if(p>0){S(t[m+p-1]);for(let C=0;C<d;++C)S(this.separator),S(this.rightPad)}else{for(let C=0;C<d-1;++C)S(this.rightPad),S(this.separator);S(this.rightPad)}}}compute(t,e){const s=t.length,r=e.length;if(r>0){let u=e[0];if(u!==0)throw new Error(`First split value must be 0, got ${u}`);for(let h=1;h<r;++h){let d=e[h]>=u;if(d=d&&e[h]<=s,!d)throw new Error(`Invalid split value ${e[h]}, must be in [${u}, ${s}]`);u=e[h]}if(u!==s)throw new Error(`Last split value must be data size. Expected ${s}, got ${u}`)}const a=r-1,i=an("int32",r);if(s===0||r===0){const u=new Array(s);for(let h=0;h<=a;++h)i[h]=0;return[u,i]}i[0]=0;for(let u=1;u<=a;++u){const h=e[u]-e[u-1];let d=0;this.nGramWidths.forEach(p=>{d+=this.getNumNGrams(h,p)}),this.preserveShort&&h>0&&d===0&&(d=1),i[u]=i[u-1]+d}const l=new Array(i[a]);for(let u=0;u<a;++u){const h=e[u];let d=i[u];if(this.nGramWidths.forEach(p=>{const m=e[u+1]-e[u],y=this.getNumNGrams(m,p);this.createNGrams(t,h,l,d,y,p),d+=y}),this.preserveShort&&d===i[u]){const p=e[u+1]-e[u];if(p===0)continue;const m=p+2*this.padWidth;this.createNGrams(t,h,l,d,1,m)}}return[l,i]}}function S_(n,t,e,s,r,a,i,l){return new zK(e,s,r,a,i,l).compute(n,t)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MK(n,t,e,s){if(!n.length)return;if(t.length===0){for(let a=0;a<n.length;++a)s.push(n.subarray(a,a+1));return}if(t.length===1){const a=t[0];let i=n.indexOf(a);for(;i!==-1;){const l=n.subarray(0,i);(!e||l.length!==0)&&s.push(l),n=n.subarray(i+1),i=n.indexOf(a)}(!e||n.length!==0)&&s.push(n);return}let r=0;for(let a=0;a<n.length+1;a++)if(a===n.length||t.indexOf(n[a])!==-1){const i=n.subarray(r,a);(!e||i.length!==0)&&s.push(i),r=a+1}}function C_(n,t,e){const s=n.length,r=[];let a=0,i=0;const l=new Array(s);for(let m=0;m<s;++m){const y=r.length;MK(n[m],t,e,r);const b=r.length-y;l[m]=b,a+=b,i=Math.max(i,b)}const u=an("int32",a*2),h=new Array(a),d=[s,i];let p=0;for(let m=0;m<s;++m)for(let y=0;y<l[m];++y)u[p*2]=m,u[p*2+1]=y,h[p]=r[p],++p;return[u,h,d]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N_(n,t){const e=an("int32",n.length);for(let s=0;s<n.length;++s)e[s]=YM(n[s]).modulo(t).getLowBitsUnsigned();return e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T_=cn((n,t)=>n-t),BK=CS((n,t,e,s)=>({real:n-e,imag:t-s})),IS=kn(pd,T_,BK),PK={kernelName:pd,backendName:"cpu",kernelFunc:IS};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $_(n,t){const e=new Array(n.rank);for(let r=0;r<e.length;r++)e[r]=n.shape[r]*t[r];const s=te(e,n.dtype);for(let r=0;r<s.values.length;++r){const a=s.indexToLoc(r),i=new Array(n.rank);for(let u=0;u<i.length;u++)i[u]=a[u]%n.shape[u];const l=n.locToIndex(i);s.values[r]=n.values[l]}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eh=(n,t)=>{const e=t.value-n.value;return e===0?n.index-t.index:e};function k_(n,t,e=0,s=n.length-1){for(;s>e;){if(s-e>600){const l=s-e+1,u=t-e+1,h=Math.log(l),d=.5*Math.exp(2*h/3),p=.5*Math.sqrt(h*d*(l-d)/l)*Math.sign(u-l/2),m=Math.max(e,Math.floor(t-u*d/l+p)),y=Math.min(s,Math.floor(t+(l-u)*d/l+p));k_(n,t,m,y)}const r=n[t];let a=e,i=s;for(Kl(n,e,t),eh(n[s],r)>0&&Kl(n,e,s);a<i;){for(Kl(n,a,i),a++,i--;eh(n[a],r)<0;)a=a+1;for(;eh(n[i],r)>0;)i=i-1}eh(n[e],r)===0?Kl(n,e,i):(i=i+1,Kl(n,i,s)),i<=t&&(e=i+1),t<=i&&(s=i-1)}}function I_(n,t,e,s,r){const a=t[t.length-1],[i,l]=[n.length/a,a],u=Gn(e,i*s),h=Gn("int32",i*s);for(let p=0;p<i;p++){const m=p*l,y=n.subarray(m,m+l);let b=new Array(y.length);y.forEach((C,$)=>b[$]={value:C,index:$}),s<b.length&&(k_(b,s),b=b.slice(0,s)),r&&b.sort(eh);const x=p*s,v=u.subarray(x,x+s),S=h.subarray(x,x+s);for(let C=0;C<s;C++)v[C]=b[C].value,S[C]=b[C].index}const d=t.slice();return d[d.length-1]=s,[te(d,e,u),te(d,"int32",h)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E_(n,t,e,s){const r=re(t,e)[0],a=[1,e[0],1];for(let b=0;b<r;b++)a[0]*=e[b];a[1]=e[r];for(let b=r+1;b<e.length;b++)a[2]*=e[b];const i=new Map,l=new Int32Array(e[r]),u=new Cn(a,s,n),h=[],d=a[0]===1&&a[2]===1;for(let b=0;b<e[r];b++){let x;if(d)x=n[b].toString();else{const S=[];for(let C=0;C<a[0];C++)for(let $=0;$<a[2];$++)S.push(u.get(C,b,$));x=S.join(",")}const v=i.get(x);if(v!=null)l[b]=v;else{const S=i.size;i.set(x,S),l[b]=S,h.push(b)}}const p=a.slice();p[1]=i.size;const m=new Cn(p,s);h.forEach((b,x)=>{for(let v=0;v<a[0];v++)for(let S=0;S<a[2];S++)m.set(u.get(v,b,S),v,x,S)});const y=e.slice();return y[r]=p[1],{outputValues:m.values,outputShape:y,indices:l}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VK=Object.freeze(Object.defineProperty({__proto__:null,addImpl:MO,bincountImpl:NS,bincountReduceImpl:BO,bitwiseAndImpl:PO,castImpl:zO,ceilImpl:VO,concatImpl:UO,equalImpl:GO,expImpl:HO,expm1Impl:qO,floorDivImpl:KO,floorImpl:XO,gatherNdImpl:YO,gatherV2Impl:ZO,greaterEqualImpl:JO,greaterImpl:QO,lessEqualImpl:e_,lessImpl:t_,linSpaceImpl:n_,logImpl:s_,maxImpl:r_,maximumImpl:a_,minimumImpl:i_,multiplyImpl:TS,negImpl:o_,notEqualImpl:l_,prodImpl:u_,raggedGatherImpl:c_,raggedRangeImpl:h_,raggedTensorToTensorImpl:d_,rangeImpl:f_,rsqrtImpl:p_,scatterImpl:To,sigmoidImpl:kK,simpleAbsImpl:LO,sliceImpl:g_,sparseFillEmptyRowsImpl:y_,sparseReshapeImpl:b_,sparseSegmentReductionImpl:kS,sqrtImpl:DK,squaredDifferenceImpl:x_,staticRegexReplaceImpl:v_,stridedSliceImpl:w_,stringNGramsImpl:S_,stringSplitImpl:C_,stringToHashBucketFastImpl:N_,subImpl:T_,tileImpl:$_,topKImpl:I_,transposeImpl:$S,uniqueImpl:E_},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */nE("cpu",()=>new fy,1);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D_=Ce(zh,n=>n>=0?n:Math.exp(n)-1),UK={kernelName:zh,backendName:"cpu",kernelFunc:D_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A_(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{alpha:a}=s;Lt([r],"leakyRelu");const i=mt(r.shape),l=e.data.get(r.dataId).values,u=Gn("float32",i);for(let h=0;h<l.length;h++)u[h]=l[h]<0?a*l[h]:l[h];return e.makeTensorInfo(r.shape,"float32",u)}const GK={kernelName:Km,backendName:"cpu",kernelFunc:A_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WK=cn((n,t)=>n<0?t*n:n);function R_(n){const{inputs:t,backend:e}=n,{x:s,alpha:r}=t;Lt([s,r],"prelu");const a=e.data.get(s.dataId).values,i=e.data.get(r.dataId).values,[l,u]=WK(s.shape,r.shape,a,i,"float32");return e.makeTensorInfo(u,"float32",l)}const HK={kernelName:pg,backendName:"cpu",kernelFunc:R_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O_=Ce(nd,n=>Math.max(0,n)),jK={kernelName:nd,backendName:"cpu",kernelFunc:O_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const __=Ce(sd,n=>Math.min(Math.max(0,n),6)),qK={kernelName:sd,backendName:"cpu",kernelFunc:__};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cm(n,t,e,s,r){if(e==="linear")return ua({inputs:{x:t},backend:n});if(e==="relu")return O_({inputs:{x:t},backend:n});if(e==="elu")return D_({inputs:{x:t},backend:n});if(e==="relu6")return __({inputs:{x:t},backend:n});if(e==="prelu")return R_({inputs:{x:t,alpha:s},backend:n});if(e==="leakyrelu")return A_({inputs:{x:t},backend:n,attrs:{alpha:r}});if(e==="sigmoid")return m_({inputs:{x:t},backend:n});throw new Error(`Activation ${e} has not been implemented for the CPU backend.`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Le(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{shape:a}=s,i=mt(r.shape),l=OI(a,i),u=mt(l);F(i===u,()=>`The new shape (${l}) has ${u} elements and the old shape (${r.shape}) has ${i} elements. The new shape and old shape must have the same number of elements.`),e.incRef(r.dataId);const h=e.data.get(r.dataId);if(h.complexTensorInfos!=null){const d=h.complexTensorInfos.real,p=h.complexTensorInfos.imag;d.shape=l,p.shape=l}return{dataId:r.dataId,shape:l,dtype:r.dtype}}const XK={kernelName:gg,backendName:"cpu",kernelFunc:Le};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F_(n){const{inputs:t,backend:e,attrs:s}=n,{a:r,b:a}=t,{transposeA:i,transposeB:l}=s;Lt([r,a],"matMul");const u=r.shape.length,h=a.shape.length,d=i?r.shape[u-2]:r.shape[u-1],p=l?a.shape[h-1]:a.shape[h-2],m=i?r.shape[u-1]:r.shape[u-2],y=l?a.shape[h-2]:a.shape[h-1],b=r.shape.slice(0,-2),x=a.shape.slice(0,-2),v=mt(b),S=mt(x),$=Yt(r.shape.slice(0,-2),a.shape.slice(0,-2)).concat([m,y]);F(d===p,()=>`Error in matMul: inner shapes (${d}) and (${p}) of Tensors with shapes ${r.shape} and ${a.shape} and transposeA=${i} and transposeB=${l} must match.`);const T=i?[v,d,m]:[v,m,d],I=l?[S,y,p]:[S,p,y],A=Le({inputs:{x:r},backend:e,attrs:{shape:T}}),R=Le({inputs:{x:a},backend:e,attrs:{shape:I}}),L=i?A.shape[1]:A.shape[2],_=i?A.shape[2]:A.shape[1],M=l?R.shape[1]:R.shape[2],D=Math.max(v,S),W=e.data.get(A.dataId).values,et=e.data.get(R.dataId).values,nt=Bt(A.shape),tt=Bt(R.shape),[U,Y,Z]=i?[nt[0],1,nt[1]]:[nt[0],nt[1],1],[G,O,V]=l?[1,tt[1],tt[0]]:[tt[1],1,tt[0]],P=_*M,H=te([D,_,M],A.dtype),Q=H.values,ot=e.blockSize;for(let lt=0;lt<D;lt++){const ht=lt%v,xt=lt%S;for(let Ct=0;Ct<_;Ct+=ot){const Dt=Math.min(Ct+ot,_);for(let It=0;It<M;It+=ot){const Ot=Math.min(It+ot,M);for(let Xt=0;Xt<L;Xt+=ot){const Kt=Math.min(Xt+ot,L);for(let Zt=Ct;Zt<Dt;Zt++)for(let Ht=It;Ht<Ot;Ht++){let jt=0;for(let ie=Xt;ie<Kt;ie++){const mn=W[ht*U+Zt*Y+ie*Z],ve=et[ie*G+Ht*O+xt*V];jt+=mn*ve}Q[lt*P+(Zt*M+Ht)]+=jt}}}}}return e.disposeIntermediateTensorInfo(A),e.disposeIntermediateTensorInfo(R),e.makeTensorInfo($,H.dtype,H.values)}const KK={kernelName:Om,backendName:"cpu",kernelFunc:F_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YK(n){const{inputs:t,backend:e,attrs:s}=n,{a:r,b:a,bias:i,preluActivationWeights:l}=t,{transposeA:u,transposeB:h,activation:d,leakyreluAlpha:p}=s;let m,y,b;const x=[];m=F_({inputs:{a:r,b:a},attrs:{transposeA:u,transposeB:h},backend:e}),i&&(y=gu({inputs:{a:m,b:i},backend:e}),x.push(m),m=y),d&&(b=cm(e,m,d,l,p),x.push(m),m=b);for(const S of x)e.disposeIntermediateTensorInfo(S);return m}const ZK={kernelName:Gp,backendName:"cpu",kernelFunc:YK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QK=Ce(Nh,n=>Math.acos(n)),JK={kernelName:Nh,backendName:"cpu",kernelFunc:QK};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t7=Ce(Th,n=>Math.acosh(n)),e7={kernelName:Th,backendName:"cpu",kernelFunc:t7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n7(n){const{inputs:t,backend:e}=n,s=t;Lt(t,"addN");const r=s.map(l=>e.data.get(l.dataId).values),a=te(s[0].shape,s[0].dtype),i=a.values;for(let l=0;l<s.length;l++){const u=r[l];for(let h=0;h<i.length;h++)i[h]+=u[h]}return e.makeTensorInfo(a.shape,a.dtype,a.values)}const s7={kernelName:Im,backendName:"cpu",kernelFunc:n7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r7(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{axis:a,keepDims:i}=s;Lt(r,"all");const l=re(a,r.shape);let u=l;const h=qe(u,r.shape.length);let d=r;h!=null&&(d=bs({inputs:{x:r},backend:e,attrs:{perm:h}}),u=ln(u.length,r.shape.length)),jn("all",u,d.shape.length);const[p,m]=_n(d.shape,u),y=mt(m),b=ts(mt(p),d.dtype),x=e.data.get(d.dataId).values;for(let S=0;S<b.length;++S){const C=S*y;let $=x[C];for(let T=0;T<y;++T){const I=x[C+T];$=$&&I}b[S]=$}h!=null&&e.disposeIntermediateTensorInfo(d);const v=e.makeTensorInfo(p,d.dtype,b);if(i){const S=on(p,l),C=Le({inputs:{x:v},backend:e,attrs:{shape:S}});return e.disposeIntermediateTensorInfo(v),C}return v}const a7={kernelName:_1,backendName:"cpu",kernelFunc:r7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i7(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{axis:a,keepDims:i}=s;Lt(r,"any");const l=re(a,r.shape);let u=l;const h=qe(u,r.shape.length);let d=r;h!=null&&(d=bs({inputs:{x:r},backend:e,attrs:{perm:h}}),u=ln(u.length,r.shape.length)),jn("any",u,d.shape.length);const[p,m]=_n(d.shape,u),y=mt(m),b=ts(mt(p),d.dtype),x=e.data.get(d.dataId).values;for(let S=0;S<b.length;++S){const C=S*y;let $=x[C];for(let T=0;T<y;++T){const I=x[C+T];$=$||I}b[S]=$}h!=null&&e.disposeIntermediateTensorInfo(d);const v=e.makeTensorInfo(p,d.dtype,b);if(i){const S=on(p,l),C=Le({inputs:{x:v},backend:e,attrs:{shape:S}});return e.disposeIntermediateTensorInfo(v),C}return v}const o7={kernelName:F1,backendName:"cpu",kernelFunc:i7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l7(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{axis:a}=s;Lt(r,"argMax");let i=re(a,r.shape);const l=qe(i,r.shape.length);let u=r;const h=[];l!=null&&(u=bs({inputs:{x:r},backend:e,attrs:{perm:l}}),h.push(u),i=ln(i.length,u.shape.length)),i=[i[0]],jn("argMax",i,u.shape.length);const[d,p]=_n(u.shape,i),m=mt(d),y=ts(m,"int32"),b=mt(p),x=e.data.get(u.dataId).values;for(let v=0;v<y.length;++v){const S=v*b;let C=x[S],$=0;for(let T=0;T<b;++T){const I=x[S+T];I>C&&(C=I,$=T)}y[v]=$}return h.forEach(v=>e.disposeIntermediateTensorInfo(v)),e.makeTensorInfo(d,"int32",y)}const u7={kernelName:Em,backendName:"cpu",kernelFunc:l7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c7(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{axis:a}=s;Lt(r,"argMin");let i=re(a,r.shape);const l=qe(i,r.shape.length);let u=r;const h=[];l!=null&&(u=bs({inputs:{x:r},backend:e,attrs:{perm:l}}),h.push(u),i=ln(i.length,u.shape.length)),i=[i[0]],jn("argMin",i,u.shape.length);const[d,p]=_n(u.shape,i),m=mt(d),y=ts(m,"int32"),b=mt(p),x=e.data.get(u.dataId).values;for(let v=0;v<y.length;++v){const S=v*b;let C=x[S],$=0;for(let T=0;T<b;++T){const I=x[S+T];I<C&&(C=I,$=T)}y[v]=$}return h.forEach(v=>e.disposeIntermediateTensorInfo(v)),e.makeTensorInfo(d,"int32",y)}const h7={kernelName:Dm,backendName:"cpu",kernelFunc:c7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const d7=Ce($h,n=>Math.asin(n)),f7={kernelName:$h,backendName:"cpu",kernelFunc:d7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const p7=Ce(kh,n=>Math.asinh(n)),m7={kernelName:kh,backendName:"cpu",kernelFunc:p7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g7=Ce(Ih,n=>Math.atan(n)),y7={kernelName:Ih,backendName:"cpu",kernelFunc:g7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const b7=cn((n,t)=>Math.atan2(n,t)),x7=kn(Dh,b7),v7={kernelName:Dh,backendName:"cpu",kernelFunc:x7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w7=Ce(Eh,n=>Math.atanh(n)),S7={kernelName:Eh,backendName:"cpu",kernelFunc:w7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ES(n,t,e,s,r,a){const i=r.strideHeight,l=r.strideWidth,u=r.dilationHeight,h=r.dilationWidth,d=r.effectiveFilterHeight,p=r.effectiveFilterWidth,m=r.padInfo.top,y=r.padInfo.left,b=a==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,x=te(r.outShape,e),v=x.values,S=r.outShape[1]*r.outShape[2]*r.outShape[3],C=r.outShape[2]*r.outShape[3],$=r.outShape[3];for(let T=0;T<r.batchSize;++T){const I=T*S,A=T*s[0];for(let R=0;R<r.inChannels;++R)for(let L=0;L<r.outHeight;++L){const _=L*i-m,M=Math.max(0,_),D=Math.min(r.inHeight,d+_),W=I+L*C;for(let et=0;et<r.outWidth;++et){const nt=et*l-y,tt=Math.max(0,nt),U=Math.min(r.inWidth,p+nt);let Y=b,Z=0,G=0;for(let V=M;V<D;V+=u){const P=A+V*s[1];for(let H=tt;H<U;H+=h){const Q=P+H*s[2],ot=n[Q+R];a==="max"&&ot>Y?Y=ot:a==="avg"&&(Z+=ot,G++)}if(isNaN(Y))break}const O=W+et*$+R;v[O]=a==="avg"?Z/G:Y}}}return x}function L_(n,t,e,s,r=!1,a=!1){const i=te(s.outShape,"int32"),l=s.strideHeight,u=s.strideWidth,h=s.dilationHeight,d=s.dilationWidth,p=s.effectiveFilterHeight,m=s.effectiveFilterWidth,y=s.padInfo.top,b=s.padInfo.left,x=te(t,e,n);for(let v=0;v<s.batchSize;++v)for(let S=0;S<s.inChannels;++S)for(let C=0;C<s.outHeight;++C){const $=C*l-y;let T=$;for(;T<0;)T+=h;const I=Math.min(s.inHeight,p+$);for(let A=0;A<s.outWidth;++A){const R=A*u-b;let L=R;for(;L<0;)L+=d;const _=Math.min(s.inWidth,m+R);let M=Number.NEGATIVE_INFINITY,D=-1;for(let W=T;W<I;W+=h){const et=W-$;for(let nt=L;nt<_;nt+=d){const tt=nt-R,U=x.get(v,W,nt,S);U>M&&(M=U,r?D=a?((v*s.inHeight+W)*s.inWidth+nt)*s.inChannels+S:(W*s.inWidth+nt)*s.inChannels+S:D=et*m+tt)}}i.set(D,v,C,A,S)}}return i}function z_(n,t,e,s,r,a){const i=r.strideDepth,l=r.strideHeight,u=r.strideWidth,h=r.dilationDepth,d=r.dilationHeight,p=r.dilationWidth,m=r.effectiveFilterDepth,y=r.effectiveFilterHeight,b=r.effectiveFilterWidth,x=r.padInfo.front,v=r.padInfo.top,S=r.padInfo.left,C=a==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,$=te(r.outShape,e),T=$.values,I=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],A=r.outShape[2]*r.outShape[3]*r.outShape[4],R=r.outShape[3]*r.outShape[4],L=r.outShape[4];for(let _=0;_<r.batchSize;++_){const M=_*I,D=_*s[0];for(let W=0;W<r.inChannels;++W)for(let et=0;et<r.outDepth;++et){const nt=et*i-x;let tt=nt;for(;tt<0;)tt+=h;const U=Math.min(r.inDepth,m+nt),Y=M+et*A;for(let Z=0;Z<r.outHeight;++Z){const G=Z*l-v;let O=G;for(;O<0;)O+=d;const V=Math.min(r.inHeight,y+G),P=Y+Z*R;for(let H=0;H<r.outWidth;++H){const Q=H*u-S;let ot=Q;for(;ot<0;)ot+=p;const lt=Math.min(r.inWidth,b+Q),ht=P+H*L;let xt=C,Ct=0,Dt=0;for(let Ot=tt;Ot<U;Ot+=h){const Xt=D+Ot*s[1];for(let Kt=O;Kt<V;Kt+=d){const Zt=Xt+Kt*s[2];for(let Ht=ot;Ht<lt;Ht+=p){const jt=Zt+Ht*s[3],ie=n[jt+W];if(a==="max"&&ie>xt?xt=ie:a==="avg"&&(Ct+=ie,Dt++),isNaN(xt))break}if(isNaN(xt))break}if(isNaN(xt))break}const It=ht+W;T[It]=a==="avg"?Ct/Math.max(Dt,1):xt}}}}return $}function C7(n,t){const e=te(t.outShape,"int32"),s=t.strideDepth,r=t.strideHeight,a=t.strideWidth,i=t.dilationDepth,l=t.dilationHeight,u=t.dilationWidth,h=t.effectiveFilterDepth,d=t.effectiveFilterHeight,p=t.effectiveFilterWidth,m=t.padInfo.front,y=t.padInfo.top,b=t.padInfo.left;for(let x=0;x<t.batchSize;++x)for(let v=0;v<t.inChannels;++v)for(let S=0;S<t.outDepth;++S){const C=S*s-m;let $=C;for(;$<0;)$+=i;const T=Math.min(t.inDepth,h+C);for(let I=0;I<t.outHeight;++I){const A=I*r-y;let R=A;for(;R<0;)R+=l;const L=Math.min(t.inHeight,d+A);for(let _=0;_<t.outWidth;++_){const M=_*a-b;let D=M;for(;D<0;)D+=u;const W=Math.min(t.inWidth,p+M);let et=Number.NEGATIVE_INFINITY,nt=-1;for(let tt=$;tt<T;tt+=i){const U=tt-C;for(let Y=R;Y<L;Y+=l){const Z=Y-A;for(let G=D;G<W;G+=u){const O=G-M,V=n.get(x,tt,Y,G,v);V>=et&&(et=V,nt=U*d*p+Z*d+O)}}}e.set(nt,x,S,I,_,v)}}}return e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N7(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t;Lt(r,"avgPool");const{filterSize:a,strides:i,pad:l,dimRoundingMode:u}=s,h=1;F(Hn(i,h),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${h}'`);const d=Tr(r.shape,a,i,h,l,u);let p;if(d.filterWidth===1&&d.filterHeight===1&&de(d.inShape,d.outShape))p=ua({inputs:{x:r},backend:e});else{const m=e.data.get(r.dataId).values,y=Bt(r.shape),b=ES(m,r.shape,r.dtype,y,d,"avg");p=e.makeTensorInfo(d.outShape,r.dtype,b.values)}return p}const T7={kernelName:Am,backendName:"cpu",kernelFunc:N7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $7(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{filterSize:a,strides:i,pad:l,dimRoundingMode:u,dataFormat:h}=s;Lt(r,"avgPool3d");const d=Ua(r.shape,a,i,1,l,u,h),p=e.data.get(r.dataId).values,m=z_(p,r.shape,r.dtype,Bt(r.shape),d,"avg");return e.makeTensorInfo(m.shape,"float32",m.values)}const k7={kernelName:Rm,backendName:"cpu",kernelFunc:$7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I7(n){const{inputs:t,backend:e,attrs:s}=n,{dy:r,input:a}=t,{filterSize:i,strides:l,pad:u,dimRoundingMode:h}=s;Lt([r,a],"avgPool3DGrad");const d=Ua(a.shape,i,l,1,u,h),p=d.strideDepth,m=d.strideHeight,y=d.strideWidth,b=d.filterDepth,x=d.filterHeight,v=d.filterWidth,S=d.dilationDepth,C=d.dilationHeight,$=d.dilationWidth,T=d.effectiveFilterDepth,I=d.effectiveFilterHeight,A=d.effectiveFilterWidth,R=T-1-d.padInfo.front,L=A-1-d.padInfo.left,_=I-1-d.padInfo.top,M=te(a.shape,"float32"),D=1/(b*x*v),W=e.bufferSync(r);for(let et=0;et<d.batchSize;++et)for(let nt=0;nt<d.inChannels;++nt)for(let tt=0;tt<d.inDepth;++tt)for(let U=0;U<d.inHeight;++U)for(let Y=0;Y<d.inWidth;++Y){const Z=tt-R,G=U-_,O=Y-L;let V=0;for(let P=0;P<T;P+=S){const H=(Z+P)/p;if(!(H<0||H>=d.outDepth||Math.floor(H)!==H))for(let Q=0;Q<I;Q+=C){const ot=(G+Q)/m;if(!(ot<0||ot>=d.outHeight||Math.floor(ot)!==ot))for(let lt=0;lt<A;lt+=$){const ht=(O+lt)/y;if(ht<0||ht>=d.outWidth||Math.floor(ht)!==ht)continue;const xt=W.get(et,H,ot,ht,nt);V+=xt}}}M.set(V*D,et,tt,U,Y,nt)}return e.makeTensorInfo(M.shape,M.dtype,M.values)}const E7={kernelName:z1,backendName:"cpu",kernelFunc:I7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D7(n){const{inputs:t,backend:e,attrs:s}=n,{dy:r,input:a}=t,i=a;Lt([r,a],"avgPoolGrad");const{filterSize:l,strides:u,pad:h}=s,d=Tr(i.shape,l,u,1,h),p=d.strideHeight,m=d.strideWidth,y=d.filterHeight,b=d.filterWidth,x=d.dilationHeight,v=d.dilationWidth,S=d.effectiveFilterHeight,C=d.effectiveFilterWidth,$=C-1-d.padInfo.left,T=S-1-d.padInfo.top,I=te(i.shape,"float32"),A=1/(y*b),R=e.data.get(r.dataId).values,L=te(r.shape,"float32",R);for(let _=0;_<d.batchSize;++_)for(let M=0;M<d.inChannels;++M)for(let D=0;D<d.inHeight;++D)for(let W=0;W<d.inWidth;++W){const et=D-T,nt=W-$;let tt=0;for(let U=0;U<S;U+=x){const Y=(et+U)/p;if(!(Y<0||Y>=d.outHeight||Math.floor(Y)!==Y))for(let Z=0;Z<C;Z+=v){const G=(nt+Z)/m;if(G<0||G>=d.outWidth||Math.floor(G)!==G)continue;const O=L.get(_,Y,G,M);tt+=O}}I.set(tt*A,_,D,W,M)}return e.makeTensorInfo(I.shape,I.dtype,I.values)}const A7={kernelName:L1,backendName:"cpu",kernelFunc:D7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R7(n){const{inputs:t,backend:e,attrs:s}=n,{x:r,scale:a,offset:i,mean:l,variance:u}=t;F(l.shape.length===u.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),F(i==null||l.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),F(a==null||l.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),Lt([r,l,u,a,i],"batchNorm");let{varianceEpsilon:h}=s;h==null&&(h=.001);const d=e.data.get(r.dataId).values,p=e.data.get(l.dataId).values,m=e.data.get(u.dataId).values,y=a?e.data.get(a.dataId).values:new Float32Array([1]),b=i?e.data.get(i.dataId).values:new Float32Array([0]),x=new Float32Array(d.length),v=b.length,S=y.length,C=m.length,$=p.length;let T=0,I=0,A=0,R=0;for(let L=0;L<d.length;++L)x[L]=b[T++]+(d[L]-p[I++])*y[A++]/Math.sqrt(m[R++]+h),T>=v&&(T=0),I>=$&&(I=0),A>=S&&(A=0),R>=C&&(R=0);return e.makeTensorInfo(r.shape,r.dtype,x)}const O7={kernelName:jm,backendName:"cpu",kernelFunc:R7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _7(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{blockShape:a,crops:i}=s;Lt([r],"batchToSpaceND");const l=a.reduce((S,C)=>S*C),u=kd(r.shape,a,l),h=Id(u.length,a.length),d=Ed(r.shape,a,l),p=Mw(i,a.length),m=Bw(d,i,a.length),y=Le({inputs:{x:r},backend:e,attrs:{shape:u}}),b=bs({inputs:{x:y},backend:e,attrs:{perm:h}}),x=Le({inputs:{x:b},backend:e,attrs:{shape:d}}),v=qo({inputs:{x},backend:e,attrs:{begin:p,size:m}});return e.disposeIntermediateTensorInfo(y),e.disposeIntermediateTensorInfo(b),e.disposeIntermediateTensorInfo(x),v}const F7={kernelName:_m,backendName:"cpu",kernelFunc:_7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L7(n){const{inputs:t,backend:e,attrs:s}=n,{x:r,weights:a}=t,{size:i}=s,l=e.data.get(r.dataId).values,u=e.data.get(a.dataId).values,h=NS(l,u,a.dtype,a.shape,i);return e.makeTensorInfo([i],a.dtype,h)}const z7={kernelName:M1,backendName:"cpu",kernelFunc:L7};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M7(n){const{inputs:t,backend:e}=n,{s0:s,s1:r}=t,a=e.data.get(s.dataId).values,i=e.data.get(r.dataId).values,l=Yt(Array.from(a),Array.from(i));return e.makeTensorInfo([l.length],"int32",Int32Array.from(l))}const B7={kernelName:B1,backendName:"cpu",kernelFunc:M7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const P7=Ce(Oh,(n,t)=>{const e=t;return n>e.clipValueMax?e.clipValueMax:n<e.clipValueMin?e.clipValueMin:n}),V7={kernelName:Oh,backendName:"cpu",kernelFunc:P7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const U7=n=>{const{x:t}=n.inputs,e=n.backend,s=new Float32Array(mt(t.shape)),r=e.data.get(t.dataId),a=r.complexTensorInfos.real,i=r.complexTensorInfos.imag,l=e.data.get(a.dataId).values,u=e.data.get(i.dataId).values;for(let h=0;h<l.length;h++){const d=l[h],p=u[h];s[h]=Math.hypot(d,p)}return e.makeOutput(s,t.shape,"float32")},G7={kernelName:Lm,backendName:"cpu",kernelFunc:U7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yu(n){const{inputs:t,backend:e}=n,{input:s}=t,r=e.data.get(s.dataId).complexTensorInfos.imag,a=e.data.get(r.dataId).values;return e.makeTensorInfo(r.shape,r.dtype,a)}const W7={kernelName:rv,backendName:"cpu",kernelFunc:yu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bu(n){const{inputs:t,backend:e,attrs:s}=n,{axis:r}=s,a=re(r,t[0].shape)[0],i=t.map(x=>x.shape);Fw(i,a);let l=ra(t.map(x=>x.shape),a);if(mt(l)===0)return e.makeTensorInfo(l,t[0].dtype,[]);const u=t.filter(x=>mt(x.shape)>0);if(u.length===1)return ua({inputs:{x:u[0]},backend:e});if(u[0].dtype==="complex64"){const x=u.map(T=>jo({inputs:{input:T},backend:e})),v=u.map(T=>yu({inputs:{input:T},backend:e})),S=bu({inputs:x,backend:e,attrs:{axis:a}}),C=bu({inputs:v,backend:e,attrs:{axis:a}}),$=ks({inputs:{real:S,imag:C},backend:e});return x.forEach(T=>e.disposeIntermediateTensorInfo(T)),v.forEach(T=>e.disposeIntermediateTensorInfo(T)),e.disposeIntermediateTensorInfo(S),e.disposeIntermediateTensorInfo(C),$}const h=u.map(x=>{const S=[-1,mt(x.shape.slice(a))];return Le({inputs:{x},backend:e,attrs:{shape:S}})}),d=h.map(x=>({vals:e.data.get(x.dataId).values,shape:x.shape}));l=ra(h.map(x=>x.shape),1);const p=h[0].shape[0]===1,m=UO(d,l,t[0].dtype,p),y=ra(u.map(x=>x.shape),a),b=e.makeTensorInfo(y,t[0].dtype,m);return h.forEach(x=>e.disposeIntermediateTensorInfo(x)),b}const H7={kernelName:zm,backendName:"cpu",kernelFunc:bu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M_(n){const{inputs:t,backend:e,attrs:s}=n,{x:r,filter:a}=t,{strides:i,pad:l,dataFormat:u,dilations:h,dimRoundingMode:d}=s;Lt([r,a],"conv2d");const p=Ga(u),m=On(r.shape,a.shape,i,h,l,d,!1,p),y=m.filterHeight,b=m.filterWidth,x=m.dilationHeight,v=m.dilationWidth,S=m.padInfo.left,C=m.padInfo.top,$=m.dataFormat==="channelsLast",T=new Cn(m.outShape,r.dtype),I=Bt(r.shape),A=Bt(a.shape),R=I[0],L=$?I[1]:I[2],_=$?I[2]:1,M=$?1:I[1],D=T.strides[0],W=$?T.strides[1]:T.strides[2],et=$?T.strides[2]:1,nt=$?1:T.strides[1],tt=e.data.get(r.dataId).values,U=e.data.get(a.dataId).values,Y=T.values;for(let Z=0;Z<m.batchSize;++Z){const G=Z*R,O=Z*D;for(let V=0;V<m.outHeight;++V){const P=O+V*W,H=V*m.strideHeight-C;for(let Q=0;Q<y;++Q){const ot=H+Q*x;if(ot<0||ot>=m.inHeight)continue;const lt=Q*A[0],ht=G+ot*L;for(let xt=0;xt<m.outWidth;++xt){const Ct=P+xt*et,Dt=xt*m.strideWidth-S;for(let It=0;It<b;++It){const Ot=Dt+It*v;if(Ot<0||Ot>=m.inWidth)continue;const Xt=lt+It*A[1],Kt=ht+Ot*_;let Zt=Xt;for(let Ht=0;Ht<m.inChannels;++Ht){const jt=tt[Kt+Ht*M];for(let ie=0;ie<m.outChannels;++ie)Y[Ct+ie*nt]+=jt*U[Zt+ie];Zt+=m.outChannels}}}}}}return e.makeTensorInfo(T.shape,T.dtype,Y)}const j7={kernelName:Mm,backendName:"cpu",kernelFunc:M_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q7(n){const{inputs:t,backend:e,attrs:s}=n,{x:r,dy:a}=t,{strides:i,pad:l,dataFormat:u,dimRoundingMode:h,filterShape:d}=s;Lt([r,a],"conv2dBackpropFilter");const p=Ga(u),m=On(r.shape,d,i,1,l,h,!1,p),{strideHeight:y,strideWidth:b,filterHeight:x,filterWidth:v}=m,S=m.dataFormat==="channelsLast",C=new Cn(m.filterShape,"float32"),$=m.padInfo.left,T=m.padInfo.top,I=e.data.get(r.dataId).values,A=e.data.get(a.dataId).values,R=new Cn(r.shape,r.dtype,I),L=new Cn(a.shape,a.dtype,A);for(let _=0;_<x;++_){const M=Math.max(0,Math.ceil((T-_)/y)),D=Math.min(m.outHeight,(m.inHeight+T-_)/y);for(let W=0;W<v;++W){const et=Math.max(0,Math.ceil(($-W)/b)),nt=Math.min(m.outWidth,(m.inWidth+$-W)/b);for(let tt=0;tt<m.inChannels;++tt)for(let U=0;U<m.outChannels;++U){let Y=0;for(let Z=0;Z<m.batchSize;++Z)for(let G=M;G<D;++G){const O=_+G*y-T;for(let V=et;V<nt;++V){const P=W+V*b-$;S?Y+=R.get(Z,O,P,tt)*L.get(Z,G,V,U):Y+=R.get(Z,tt,O,P)*L.get(Z,U,G,V)}}C.set(Y,_,W,tt,U)}}}return e.makeTensorInfo(C.shape,C.dtype,C.values)}const X7={kernelName:V1,backendName:"cpu",kernelFunc:q7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K7(n){const{inputs:t,backend:e,attrs:s}=n,{dy:r,filter:a}=t,{inputShape:i,strides:l,pad:u,dataFormat:h,dimRoundingMode:d}=s;Lt([r,a],"conv2dBackpropInput");const p=Bt(a.shape),m=Bt(r.shape);let y=Ga(h);const b=On(i,a.shape,l,1,u,d,!1,y),x=new Cn(b.inShape,"float32"),v=x.values,S=e.data.get(r.dataId).values,C=e.data.get(a.dataId).values,[$,T,I]=p,{batchSize:A,filterHeight:R,filterWidth:L,inChannels:_,inHeight:M,inWidth:D,outChannels:W,outHeight:et,outWidth:nt,strideHeight:tt,strideWidth:U}=b;y=b.dataFormat;const Y=R-1-b.padInfo.top,Z=L-1-b.padInfo.left,G=y==="channelsLast",O=x.strides[0],V=G?x.strides[1]:x.strides[2],P=G?x.strides[2]:1,H=G?1:x.strides[1],Q=m[0],ot=G?m[1]:m[2],lt=G?m[2]:1,ht=G?1:m[1];for(let xt=0;xt<A;++xt)for(let Ct=0;Ct<_;++Ct)for(let Dt=0;Dt<M;++Dt){const It=Dt-Y,Ot=Math.max(0,Math.ceil(It/tt)),Xt=Math.min(et,(R+It)/tt);for(let Kt=0;Kt<D;++Kt){const Zt=Kt-Z,Ht=Math.max(0,Math.ceil(Zt/U)),jt=Math.min(nt,(L+Zt)/U);let ie=0;for(let ve=Ot;ve<Xt;++ve){const Xe=ve*tt-It;for(let ke=Ht;ke<jt;++ke){const tn=ke*U-Zt,en=Q*xt+ot*ve+lt*ke,hn=$*(R-1-Xe)+T*(L-1-tn)+I*Ct;for(let Ke=0;Ke<W;++Ke){const Oe=S[en+ht*Ke],nn=C[hn+Ke];ie+=Oe*nn}}}const mn=O*xt+V*Dt+P*Kt+H*Ct;v[mn]=ie}}return e.makeTensorInfo(x.shape,x.dtype,x.values)}const Y7={kernelName:Bm,backendName:"cpu",kernelFunc:K7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z7(n){const{inputs:t,backend:e,attrs:s}=n,{x:r,filter:a}=t,{strides:i,pad:l,dilations:u}=s;Lt([r,a],"conv3d");const h=Gi(r.shape,a.shape,i,u,l),{filterDepth:d,filterHeight:p,filterWidth:m,dilationDepth:y,dilationHeight:b,dilationWidth:x,padInfo:v}=h,S=v.front,C=v.left,$=v.top,T=new Cn(h.outShape,r.dtype),I=e.data.get(r.dataId).values,A=e.data.get(a.dataId).values,R=T.values,L=Bt(r.shape),_=Bt(a.shape);for(let M=0;M<h.batchSize;++M){const D=M*L[0],W=M*T.strides[0];for(let et=0;et<h.outDepth;++et){const nt=W+et*T.strides[1],tt=et*h.strideDepth-S;for(let U=0;U<d;++U){const Y=tt+U*y;if(Y<0||Y>=h.inDepth)continue;const Z=U*_[0],G=D+Y*L[1];for(let O=0;O<h.outHeight;++O){const V=nt+O*T.strides[2],P=O*h.strideHeight-$;for(let H=0;H<p;++H){const Q=P+H*b;if(Q<0||Q>=h.inHeight)continue;const ot=Z+H*_[1],lt=G+Q*L[2];for(let ht=0;ht<h.outWidth;++ht){const xt=V+ht*h.outChannels,Ct=ht*h.strideWidth-C;for(let Dt=0;Dt<m;++Dt){const It=Ct+Dt*x;if(It<0||It>=h.inWidth)continue;const Ot=ot+Dt*_[2],Xt=lt+It*h.inChannels;let Kt=Ot;for(let Zt=0;Zt<h.inChannels;++Zt){const Ht=I[Xt+Zt];for(let jt=0;jt<h.outChannels;++jt)R[xt+jt]+=Ht*A[Kt+jt];Kt+=h.outChannels}}}}}}}}return e.makeTensorInfo(T.shape,T.dtype,T.values)}const Q7={kernelName:Pm,backendName:"cpu",kernelFunc:Z7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J7(n){const{inputs:t,backend:e,attrs:s}=n,{x:r,dy:a}=t,{strides:i,pad:l,filterShape:u}=s;Lt([r,a],"conv3dBackpropFilterV2");const h=Bt(r.shape),d=Bt(a.shape),p=Gi(r.shape,u,i,1,l),m=p.strideDepth,y=p.strideHeight,b=p.strideWidth,x=p.filterDepth,v=p.filterHeight,S=p.filterWidth,C=new Cn(p.filterShape,"float32"),$=C.values,[T,I,A,R]=C.strides,L=e.data.get(a.dataId).values,[_,M,D,W]=d,et=e.data.get(r.dataId).values,[nt,tt,U,Y]=h,Z=p.padInfo.front,G=p.padInfo.left,O=p.padInfo.top;for(let V=0;V<x;++V){const P=Math.max(0,Math.ceil((Z-V)/m)),H=Math.min(p.outDepth,(p.inDepth+Z-V)/m),Q=V*T;for(let ot=0;ot<v;++ot){const lt=Math.max(0,Math.ceil((O-ot)/y)),ht=Math.min(p.outHeight,(p.inHeight+O-ot)/y),xt=ot*I+Q;for(let Ct=0;Ct<S;++Ct){const Dt=Math.max(0,Math.ceil((G-Ct)/b)),It=Math.min(p.outWidth,(p.inWidth+G-Ct)/b),Ot=Ct*A+xt;for(let Xt=0;Xt<p.inChannels;++Xt){const Kt=Xt*R+Ot;for(let Zt=0;Zt<p.outChannels;++Zt){let Ht=0;for(let jt=0;jt<p.batchSize;++jt){const ie=jt*nt,mn=jt*_;for(let ve=P;ve<H;++ve){const ke=(V+ve*m-Z)*tt+ie,tn=ve*M+mn;for(let en=lt;en<ht;++en){const Ke=(ot+en*y-O)*U+ke,Oe=en*D+tn;for(let nn=Dt;nn<It;++nn){const Wr=(Ct+nn*b-G)*Y+Ke,ss=nn*W+Oe;Ht+=et[Wr+Xt]*L[ss+Zt]}}}}$[Kt+Zt]=Ht}}}}}return e.makeTensorInfo(C.shape,C.dtype,C.values)}const t9={kernelName:U1,backendName:"cpu",kernelFunc:J7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e9(n){const{inputs:t,backend:e,attrs:s}=n,{dy:r,filter:a}=t,{pad:i,strides:l,inputShape:u}=s;Lt([r],"conv3dBackpropInputV2");const h=Bt(r.shape),d=Bt(a.shape),p=Gi(u,a.shape,l,1,i),m=new Cn(p.inShape,"float32"),y=m.values,[b,x,v,S]=m.strides,C=e.data.get(r.dataId).values,[$,T,I,A]=h,R=e.data.get(a.dataId).values,[L,_,M,D]=d,{batchSize:W,filterDepth:et,filterHeight:nt,filterWidth:tt,inChannels:U,inDepth:Y,inHeight:Z,inWidth:G,outChannels:O,outDepth:V,outHeight:P,outWidth:H,strideDepth:Q,strideHeight:ot,strideWidth:lt}=p,ht=et-1-p.padInfo.front,xt=nt-1-p.padInfo.top,Ct=tt-1-p.padInfo.left;for(let Dt=0;Dt<W;++Dt)for(let It=0;It<U;++It)for(let Ot=0;Ot<Y;++Ot){const Xt=Ot-ht,Kt=Math.max(0,Math.ceil(Xt/Q)),Zt=Math.min(V,(et+Xt)/Q);for(let Ht=0;Ht<Z;++Ht){const jt=Ht-xt,ie=Math.max(0,Math.ceil(jt/ot)),mn=Math.min(P,(nt+jt)/ot);for(let ve=0;ve<G;++ve){const Xe=ve-Ct,ke=Math.max(0,Math.ceil(Xe/lt)),tn=Math.min(H,(tt+Xe)/lt);let en=0;for(let hn=Kt;hn<Zt;++hn){const Ke=hn*Q-Xt;for(let Oe=ie;Oe<mn;++Oe){const nn=Oe*ot-jt;for(let Pe=ke;Pe<tn;++Pe){const Wr=Pe*lt-Xe,ss=$*Dt+T*hn+I*Oe+A*Pe,Ku=L*(et-1-Ke)+_*(nt-1-nn)+M*(tt-1-Wr)+D*It;for(let Vs=0;Vs<O;++Vs){const qa=C[ss+Vs],fa=R[Ku+Vs];en+=qa*fa}}}}y[b*Dt+x*Ot+v*Ht+S*ve+It]=en}}}return e.makeTensorInfo(m.shape,m.dtype,m.values)}const n9={kernelName:G1,backendName:"cpu",kernelFunc:e9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s9=Ce(_h,n=>Math.cos(n)),r9={kernelName:_h,backendName:"cpu",kernelFunc:s9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a9=Ce(Fh,n=>Math.cosh(n)),i9={kernelName:Fh,backendName:"cpu",kernelFunc:a9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o9(n){const{inputs:t,backend:e,attrs:s}=n,{image:r,boxes:a,boxInd:i}=t,{cropSize:l,method:u,extrapolationValue:h}=s,[d,p,m,y]=r.shape,b=a.shape[0],[x,v]=l,S=te([b,x,v,y],"float32"),C=e.data.get(a.dataId).values,$=e.data.get(i.dataId).values,T=e.data.get(r.dataId).values,I=Bt(r.shape),A=Bt(S.shape);for(let R=0;R<b;R++){const L=R*4,_=C[L],M=C[L+1],D=C[L+2],W=C[L+3],et=$[R];if(et>=d)continue;const nt=x>1?(D-_)*(p-1)/(x-1):0,tt=v>1?(W-M)*(m-1)/(v-1):0;for(let U=0;U<x;U++){const Y=x>1?_*(p-1)+U*nt:.5*(_+D)*(p-1);if(Y<0||Y>p-1){for(let Z=0;Z<v;Z++)for(let G=0;G<y;G++){const O=G+Z*A[2]+U*A[1]+R*A[0];S.values[O]=h}continue}if(u==="bilinear"){const Z=Math.floor(Y),G=Math.ceil(Y),O=Y-Z;for(let V=0;V<v;V++){const P=v>1?M*(m-1)+V*tt:.5*(M+W)*(m-1);if(P<0||P>m-1){for(let lt=0;lt<y;lt++){const ht=lt+V*A[2]+U*A[1]+R*A[0];S.values[ht]=h}continue}const H=Math.floor(P),Q=Math.ceil(P),ot=P-H;for(let lt=0;lt<y;lt++){let ht=lt+H*I[2]+Z*I[1]+et*I[0];const xt=T[ht];ht=lt+Q*I[2]+Z*I[1]+et*I[0];const Ct=T[ht];ht=lt+H*I[2]+G*I[1]+et*I[0];const Dt=T[ht];ht=lt+Q*I[2]+G*I[1]+et*I[0];const It=T[ht],Ot=xt+(Ct-xt)*ot,Xt=Dt+(It-Dt)*ot;ht=lt+V*A[2]+U*A[1]+R*A[0],S.values[ht]=Ot+(Xt-Ot)*O}}}else for(let Z=0;Z<v;++Z){const G=v>1?M*(m-1)+Z*tt:.5*(M+W)*(m-1);if(G<0||G>m-1){for(let P=0;P<y;P++){const H=P+Z*A[2]+U*A[1]+R*A[0];S.values[H]=h}continue}const O=Math.round(G),V=Math.round(Y);for(let P=0;P<y;P++){const H=P+O*I[2]+V*I[1]+et*I[0],Q=P+Z*A[2]+U*A[1]+R*A[0];S.values[Q]=T[H]}}}}return e.makeTensorInfo(S.shape,S.dtype,S.values)}const l9={kernelName:H1,backendName:"cpu",kernelFunc:o9};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u9(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{axis:a,exclusive:i,reverse:l}=s;Lt(r,"cumprod");const u=qe([a],r.shape.length);let h=r;u!=null&&(h=bs({inputs:{x:r},backend:e,attrs:{perm:u}}));const d=ln(1,r.shape.length)[0];if(d!==h.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${h.shape.length-1} but got axis=${d}`);const p=Os(h.dtype,"int32"),m=R1(mt(h.shape),p),y=e.data.get(h.dataId).values,b=h.shape[h.shape.length-1],x=l?(S,C)=>S+b-C-1:(S,C)=>S+C;for(let S=0;S<y.length;S+=b)for(let C=0;C<b;C++){const $=x(S,C);if(C===0)m[$]=i?1:y[$];else{const T=x(S,C-1);m[$]=i?y[T]*m[T]:y[$]*m[T]}}const v=e.makeTensorInfo(h.shape,p,m);if(u!=null){const S=Wi(u),C=bs({inputs:{x:v},backend:e,attrs:{perm:S}});return e.disposeIntermediateTensorInfo(v),e.disposeIntermediateTensorInfo(h),C}return v}const c9={kernelName:W1,backendName:"cpu",kernelFunc:u9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h9(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{axis:a,exclusive:i,reverse:l}=s;Lt(r,"cumsum");const u=qe([a],r.shape.length);let h=r;u!=null&&(h=bs({inputs:{x:r},backend:e,attrs:{perm:u}}));const d=ln(1,r.shape.length)[0];if(d!==h.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${h.shape.length-1} but got axis=${d}`);const p=Os(h.dtype,"int32"),m=ts(mt(h.shape),p),y=e.data.get(h.dataId).values,b=h.shape[h.shape.length-1],x=l?(S,C)=>S+b-C-1:(S,C)=>S+C;for(let S=0;S<y.length;S+=b)for(let C=0;C<b;C++){const $=x(S,C);if(C===0)m[$]=i?0:y[$];else{const T=x(S,C-1);m[$]=i?y[T]+m[T]:y[$]+m[T]}}const v=e.makeTensorInfo(h.shape,p,m);if(u!=null){const S=Wi(u),C=bs({inputs:{x:v},backend:e,attrs:{perm:S}});return e.disposeIntermediateTensorInfo(v),e.disposeIntermediateTensorInfo(h),C}return v}const d9={kernelName:Vm,backendName:"cpu",kernelFunc:h9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f9(n){const{inputs:t,backend:e,attrs:s}=n,{x:r,weights:a}=t,{size:i,binaryOutput:l}=s;if(r.shape.length===1){const u=e.data.get(r.dataId).values,h=e.data.get(a.dataId).values,d=NS(u,h,a.dtype,a.shape,i);return e.makeTensorInfo([i],a.dtype,d)}else if(r.shape.length===2){const u=e.bufferSync(r),h=e.bufferSync(a),d=BO(u,h,i,l);return e.makeTensorInfo(d.shape,a.dtype,d.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${r.shape.length}.`)}const p9={kernelName:j1,backendName:"cpu",kernelFunc:f9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m9(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{blockSize:a,dataFormat:i}=s;F(i==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${i}`);const l=r.shape[0],u=r.shape[1],h=r.shape[2],d=r.shape[3],p=u*a,m=h*a,y=d/(a*a),b=e.data.get(r.dataId).values,x=new Float32Array(l*p*m*y);let v=0;for(let S=0;S<l;++S)for(let C=0;C<p;++C){const $=Math.floor(C/a),T=C%a;for(let I=0;I<m;++I){const A=Math.floor(I/a),R=I%a,L=(T*a+R)*y;for(let _=0;_<y;++_){const D=_+L+d*(A+h*($+u*S));x[v++]=b[D]}}}return e.makeTensorInfo([l,p,m,y],r.dtype,x)}const g9={kernelName:q1,backendName:"cpu",kernelFunc:m9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B_(n){const{inputs:t,backend:e,attrs:s}=n,{x:r,filter:a}=t,{strides:i,pad:l,dilations:u,dimRoundingMode:h}=s;Lt([r,a],"depthwiseConv2DNative");const d=Bt(r.shape),p=Bt(a.shape);let m=u;m==null&&(m=[1,1]),F(Hn(i,m),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${i} and dilations '${m}'`);const y=On(r.shape,a.shape,i,m,l,h,!0),{filterHeight:b,filterWidth:x,dilationHeight:v,dilationWidth:S,padInfo:C}=y,$=C.left,T=C.top,I=y.outChannels/y.inChannels,A=new Cn(y.outShape,r.dtype),R=e.data.get(r.dataId).values,L=e.data.get(a.dataId).values,_=A.values;for(let M=0;M<y.batchSize;++M){const D=M*d[0],W=M*A.strides[0];for(let et=0;et<y.outHeight;++et){const nt=W+et*A.strides[1],tt=et*y.strideHeight-T;for(let U=0;U<b;++U){const Y=tt+U*v;if(Y<0||Y>=y.inHeight)continue;const Z=U*p[0],G=D+Y*d[1];for(let O=0;O<y.outWidth;++O){const V=nt+O*A.strides[2],P=O*y.strideWidth-$;for(let H=0;H<x;++H){const Q=P+H*S;if(Q<0||Q>=y.inWidth)continue;const ot=Z+H*p[1],lt=G+Q*y.inChannels;let ht=V,xt=ot;for(let Ct=0;Ct<y.inChannels;++Ct){const Dt=R[lt+Ct];for(let It=0;It<I;++It)_[ht+It]+=Dt*L[xt+It];ht+=I,xt+=I}}}}}}return e.makeTensorInfo(A.shape,A.dtype,A.values)}const y9={kernelName:Um,backendName:"cpu",kernelFunc:B_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b9(n){const{inputs:t,backend:e,attrs:s}=n,{x:r,dy:a}=t,{strides:i,dilations:l,pad:u,dimRoundingMode:h,filterShape:d}=s;Lt([r,a],"depthwiseConv2dNativeBackpropFilter");const p=On(r.shape,d,i,l,u,h,!0),{strideHeight:m,strideWidth:y,filterHeight:b,filterWidth:x}=p,v=new Cn(p.filterShape,"float32"),S=p.padInfo.left,C=p.padInfo.top,$=p.outChannels/p.inChannels,T=e.data.get(r.dataId).values,I=new Cn(r.shape,r.dtype,T),A=e.data.get(a.dataId).values,R=new Cn(a.shape,a.dtype,A);for(let L=0;L<b;++L){const _=Math.max(0,Math.ceil((C-L)/m)),M=Math.min(p.outHeight,(p.inHeight+C-L)/m);for(let D=0;D<x;++D){const W=Math.max(0,Math.ceil((S-D)/y)),et=Math.min(p.outWidth,(p.inWidth+S-D)/y);for(let nt=0;nt<p.outChannels;++nt){const tt=Math.trunc(nt/$),U=nt%$;let Y=0;for(let Z=0;Z<p.batchSize;++Z)for(let G=_;G<M;++G){const O=L+G*m-C;for(let V=W;V<et;++V){const P=D+V*y-S;Y+=I.get(Z,O,P,tt)*R.get(Z,G,V,nt)}}v.set(Y,L,D,tt,U)}}}return e.makeTensorInfo(v.shape,v.dtype,v.values)}const x9={kernelName:X1,backendName:"cpu",kernelFunc:b9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v9(n){const{inputs:t,backend:e,attrs:s}=n,{dy:r,filter:a}=t,{strides:i,dilations:l,pad:u,dimRoundingMode:h,inputShape:d}=s;Lt([r,a],"depthwiseConv2DNativeBackpropInput");const p=Bt(r.shape),m=Bt(a.shape),y=On(d,a.shape,i,l,u,h,!0),b=new Cn(y.inShape,"float32"),x=b.values,[v,S,C]=b.strides,$=e.data.get(r.dataId).values,[T,I,A]=p,R=e.data.get(a.dataId).values,[L,_,M]=m,{batchSize:D,filterHeight:W,filterWidth:et,inChannels:nt,inHeight:tt,inWidth:U,outChannels:Y,outHeight:Z,outWidth:G,strideHeight:O,strideWidth:V}=y,P=W-1-y.padInfo.top,H=et-1-y.padInfo.left,Q=Y/nt;for(let ot=0;ot<D;++ot)for(let lt=0;lt<nt;++lt)for(let ht=0;ht<tt;++ht){const xt=ht-P,Ct=Math.max(0,Math.ceil(xt/O)),Dt=Math.min(Z,(W+xt)/O);for(let It=0;It<U;++It){const Ot=It-H,Xt=Math.max(0,Math.ceil(Ot/V)),Kt=Math.min(G,(et+Ot)/V);let Zt=0;for(let Ht=Ct;Ht<Dt;++Ht){const jt=Ht*O-xt;for(let ie=Xt;ie<Kt;++ie){const mn=ie*V-Ot,ve=T*ot+I*Ht+A*ie,Xe=L*(W-1-jt)+_*(et-1-mn)+M*lt;for(let ke=0;ke<Q;++ke){const tn=lt*Q+ke,en=$[ve+tn],hn=R[Xe+ke];Zt+=en*hn}}}x[v*ot+S*ht+C*It+lt]=Zt}}return e.makeTensorInfo(b.shape,b.dtype,b.values)}const w9={kernelName:K1,backendName:"cpu",kernelFunc:v9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S9(n){const{inputs:t,backend:e}=n,{x:s}=t,r=mt(s.shape),a=e.data.get(s.dataId).values,i=te([r,r],s.dtype),l=i.values;for(let h=0;h<a.length;h++)l[h*r+h]=a[h];const u=[...s.shape,...s.shape];return e.makeTensorInfo(u,i.dtype,i.values)}const C9={kernelName:Y1,backendName:"cpu",kernelFunc:S9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N9={kernelName:Gm,backendName:"cpu",kernelFunc:({inputs:n,backend:t,attrs:e})=>{const{x:s,filter:r}=n,{strides:a,pad:i,dilations:l}=e,u=t,h=u.data.get(s.dataId).values,d=s.shape.length,p=u.data.get(r.dataId).values,m=r.shape.length,{batchSize:y,inHeight:b,inWidth:x,inChannels:v,outHeight:S,outWidth:C,padInfo:$,strideHeight:T,strideWidth:I,filterHeight:A,filterWidth:R,dilationHeight:L,dilationWidth:_,outShape:M}=vd(s.shape,r.shape,a,i,"NHWC",l),D=mt(M),W=M.length,et=an(s.dtype,D);for(let tt=0;tt<y;++tt)for(let U=0;U<S;++U){const Y=U*T-$.top;for(let Z=0;Z<C;++Z){const G=Z*I-$.left;for(let O=0;O<v;++O){let V=Number.MIN_SAFE_INTEGER;for(let H=0;H<A;++H){const Q=Y+H*L;if(Q>=0&&Q<b)for(let ot=0;ot<R;++ot){const lt=G+ot*_;if(lt>=0&&lt<x){const ht=sa([tt,Q,lt,O],d,Bt(s.shape)),xt=sa([H,ot,O],m,Bt(r.shape)),Ct=h[ht]+p[xt];Ct>V&&(V=Ct)}}}const P=sa([tt,U,Z,O],W,Bt(M));et[P]=V}}}return{dataId:u.write(Ko(et,s.dtype),M,s.dtype),shape:M,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T9={kernelName:Ix,backendName:"cpu",kernelFunc:({inputs:n,backend:t,attrs:e})=>{const{x:s,filter:r,dy:a}=n,{strides:i,pad:l,dilations:u}=e,h=t,d=xr(s.shape,h.data.get(s.dataId).values),p=xr(r.shape,h.data.get(r.dataId).values),{batchSize:m,inHeight:y,inWidth:b,inChannels:x,outHeight:v,outWidth:S,padInfo:C,strideHeight:$,strideWidth:T,filterHeight:I,filterWidth:A,dilationHeight:R,dilationWidth:L,outShape:_}=vd(s.shape,r.shape,i,l,"NHWC",u);F(a.rank===_.length,()=>`Error in ${Ix}, dy must have the same rank as output ${_.length}, but got ${a.rank}`);const M=xr(_,h.data.get(a.dataId).values),D=LI(r.shape,r.dtype);for(let et=0;et<m;++et)for(let nt=0;nt<v;++nt){const tt=nt*$-C.top;for(let U=0;U<S;++U){const Y=U*T-C.left;for(let Z=0;Z<x;++Z){let G=Number.MIN_SAFE_INTEGER,O=0,V=0;for(let P=0;P<I;++P){const H=tt+P*R;if(H>=0&&H<y)for(let Q=0;Q<A;++Q){const ot=Y+Q*L;if(ot>=0&&ot<b){const lt=d[et][H][ot][Z]+p[P][Q][Z];lt>G&&(G=lt,O=P,V=Q)}}}D[O][V][Z]+=M[et][nt][U][Z]}}}return{dataId:h.write(Ko(D,s.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $9={kernelName:kx,backendName:"cpu",kernelFunc:({inputs:n,backend:t,attrs:e})=>{const{x:s,filter:r,dy:a}=n,{strides:i,pad:l,dilations:u}=e,h=t,d=xr(s.shape,h.data.get(s.dataId).values),p=xr(r.shape,h.data.get(r.dataId).values),{batchSize:m,inHeight:y,inWidth:b,inChannels:x,outHeight:v,outWidth:S,padInfo:C,strideHeight:$,strideWidth:T,filterHeight:I,filterWidth:A,dilationHeight:R,dilationWidth:L,outShape:_}=vd(s.shape,r.shape,i,l,"NHWC",u);F(a.rank===_.length,()=>`Error in ${kx}, dy must have the same rank as output ${_.length}, but got ${a.rank}`);const M=xr(_,h.data.get(a.dataId).values),D=LI(s.shape,s.dtype);for(let et=0;et<m;++et)for(let nt=0;nt<v;++nt){const tt=nt*$-C.top;for(let U=0;U<S;++U){const Y=U*T-C.left;for(let Z=0;Z<x;++Z){let G=Number.MIN_SAFE_INTEGER,O=tt<0?0:tt,V=Y<0?0:Y;for(let P=0;P<I;++P){const H=tt+P*R;if(H>=0&&H<y)for(let Q=0;Q<A;++Q){const ot=Y+Q*L;if(ot>=0&&ot<b){const lt=d[et][H][ot][Z]+p[P][Q][Z];lt>G&&(G=lt,O=H,V=ot)}}}D[et][O][V][Z]+=M[et][nt][U][Z]}}}return{dataId:h.write(Ko(D,s.dtype),s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k9(n){const{inputs:t,backend:e,attrs:s}=n,{image:r}=t,{canvas:a,options:i}=s,{contextOptions:l,imageOptions:u}=i||{},h=(u==null?void 0:u.alpha)||1,d=(l==null?void 0:l.contextType)||"2d";if(d!=="2d")throw new Error(`Context type ${l.contextType} is not supported by the CPU backend.`);const p=a.getContext(d,(l==null?void 0:l.contextAttributes)||{});if(p==null)throw new Error(`Could not get the context with ${d} type.`);const[m,y]=r.shape.slice(0,2),b=r.shape.length===2?1:r.shape[2],x=e.data.get(r.dataId).values,v=r.dtype==="float32"?255:1,S=new Uint8ClampedArray(y*m*4);for(let $=0;$<m*y;++$){const T=[0,0,0,255*h];for(let A=0;A<b;A++){const R=x[$*b+A];if(r.dtype==="float32"){if(R<0||R>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${R}.`)}else if(r.dtype==="int32"&&(R<0||R>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${R}.`);b===1?(T[0]=R*v,T[1]=R*v,T[2]=R*v):T[A]=R*v}const I=$*4;S[I+0]=Math.round(T[0]),S[I+1]=Math.round(T[1]),S[I+2]=Math.round(T[2]),S[I+3]=Math.round(T[3])}a.width=y,a.height=m;const C=new ImageData(S,y,m);return p.putImageData(C,0,0),r}const I9={kernelName:PM,backendName:"cpu",kernelFunc:k9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Md(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{axis:a,keepDims:i}=s;Lt(r,"sum");let l;r.dtype==="bool"?l=Li({inputs:{x:r},backend:e,attrs:{dtype:"int32"}}):l=ua({inputs:{x:r},backend:e});const u=l.shape.length,h=re(a,l.shape),d=qe(h,u);let p=h,m=l;d!=null&&(m=bs({inputs:{x:l},backend:e,attrs:{perm:d}}),p=ln(p.length,u)),jn("sum",p,m.shape.length);const[y,b]=_n(m.shape,p),x=Os(m.dtype,"int32");let v=lm(e,y,x);const S=mt(b),C=e.data.get(v.dataId).values,$=e.data.get(m.dataId).values;for(let T=0;T<C.length;++T){const I=T*S;let A=0;for(let R=0;R<S;++R)A+=$[I+R];C[T]=A}if(i){const T=on(v.shape,h),I=v;v=Le({inputs:{x:v},backend:e,attrs:{shape:T}}),e.disposeIntermediateTensorInfo(I)}return e.disposeIntermediateTensorInfo(l),d!=null&&e.disposeIntermediateTensorInfo(m),v}const E9={kernelName:Sg,backendName:"cpu",kernelFunc:Md};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D9(n){const{inputs:t,backend:e,attrs:s}=n,{equation:r}=s,a=t,{allDims:i,summedDims:l,idDims:u}=qw(r,a.length);Kw(i.length,u,a);const{path:h,steps:d}=Yw(l,u),p=d.length;let m=null,y=i.length;const b=[];for(let x=0;x<p;++x){for(const v of d[x]){const{permutationIndices:S,expandDims:C}=Xw(y,u[v]);let $;Zw(S)?$=a[v]:($=bs({inputs:{x:a[v]},backend:e,attrs:{perm:S}}),b.push($));const T=$.shape.slice();for(let I=0;I<C.length;++I)T.splice(C[I],0,1);de($.shape,T)||($=Le({inputs:{x:$},backend:e,attrs:{shape:T}}),b.push($)),m===null?m=$:(m=py({inputs:{a:$,b:m},backend:e}),b.push(m))}x<p-1&&(h[x]>=0&&(m=Md({inputs:{x:m},backend:e,attrs:{axis:h[x]-(i.length-y),keepDims:!1}}),b.push(m)),y--)}for(const x of b)x!==m&&e.disposeIntermediateTensorInfo(x);return m}const A9={kernelName:Z1,backendName:"cpu",kernelFunc:D9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R9(n){const{inputs:t,backend:e}=n,{dy:s,y:r}=t;Lt([s,r],"eluGrad");const a=new Float32Array(mt(r.shape)),i=e.data.get(r.dataId).values,l=e.data.get(s.dataId).values;for(let u=0;u<i.length;++u){const h=i[u];h>=0?a[u]=l[u]:a[u]=l[u]*(h+1)}return e.makeTensorInfo(r.shape,"float32",a)}const O9={kernelName:Q1,backendName:"cpu",kernelFunc:R9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _9=Pw,F9=Vw,L9=Uw,z9=Gw,M9=Ww,B9=Hw,P9=Ce(Mh,n=>{const t=Math.sign(n),e=Math.abs(n),s=1/(1+_9*e);return t*(1-((((B9*s+M9)*s+z9)*s+L9)*s+F9)*s*Math.exp(-e*e))}),V9={kernelName:Mh,backendName:"cpu",kernelFunc:P9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hm(n){const{inputs:t,backend:e,attrs:s}=n,{input:r}=t,{dim:a}=s,i=r.shape.length,l=r.shape.slice();let u=a;return a<0&&(F(-(i+1)<=a,()=>`Axis must be in the interval [${-(i+1)}, ${i}]`),u=i+a+1),l.splice(u,0,1),Le({inputs:{x:r},backend:e,attrs:{shape:l}})}const U9={kernelName:Hm,backendName:"cpu",kernelFunc:hm};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G9=cn((n,t)=>n/t),DS=kn(Lh,G9),m1={kernelName:Lh,backendName:"cpu",kernelFunc:DS};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P_(n,t,e){const s=n.shape,r=s[0],a=s[1],i=e.data.get(n.dataId),l=i.complexTensorInfos.real,u=i.complexTensorInfos.imag,h=[r,a],d=mt(h),p=Gn("float32",d),m=Gn("float32",d);for(let v=0;v<r;v++){const S=qo({inputs:{x:l},backend:e,attrs:{begin:[v,0],size:[1,a]}}),C=qo({inputs:{x:u},backend:e,attrs:{begin:[v,0],size:[1,a]}}),$=ks({inputs:{real:S,imag:C},backend:e}),{real:T,imag:I}=W9($,t,e),A=Ba(T,I);for(let R=0;R<a;R++){const L=jw(A,R);p[v*a+R]=L.real,m[v*a+R]=L.imag}e.disposeIntermediateTensorInfo(S),e.disposeIntermediateTensorInfo(C),e.disposeIntermediateTensorInfo($)}const y=e.makeTensorInfo(h,"float32",p),b=e.makeTensorInfo(h,"float32",m),x=ks({inputs:{real:y,imag:b},backend:e});return e.disposeIntermediateTensorInfo(y),e.disposeIntermediateTensorInfo(b),x}function W9(n,t,e){const s=mt(n.shape),r=e.data.get(n.dataId),a=e.data.get(r.complexTensorInfos.real.dataId).values,i=e.data.get(r.complexTensorInfos.imag.dataId).values;if(H9(s)){const l=g1(a,i,s,t,e),u=[n.shape[0],n.shape[1]];if(t){const h=e.makeTensorInfo(u,"float32",l.real),d=e.makeTensorInfo(u,"float32",l.imag),p=e.makeTensorInfo([],"float32",Pi(s,"float32")),m=ua({inputs:{x:p},backend:e}),y=m1.kernelFunc({inputs:{a:h,b:p},backend:e}),b=m1.kernelFunc({inputs:{a:d,b:m},backend:e}),x=e.data.get(y.dataId).values,v=e.data.get(b.dataId).values;return e.disposeIntermediateTensorInfo(h),e.disposeIntermediateTensorInfo(d),e.disposeIntermediateTensorInfo(p),e.disposeIntermediateTensorInfo(m),e.disposeIntermediateTensorInfo(y),e.disposeIntermediateTensorInfo(b),{real:x,imag:v}}return l}else{const l=Ba(a,i),u=j9(l,s,t);return KD(u)}}function H9(n){return(n&n-1)===0}function g1(n,t,e,s,r){if(e===1)return{real:n,imag:t};const a=Ba(n,t),i=e/2,l=YD(a),u=l.real,h=l.imag,d=[u.length],p=r.makeTensorInfo(d,"float32",u),m=r.makeTensorInfo(d,"float32",h),y=ks({inputs:{real:p,imag:m},backend:r}),b=ZD(a),x=b.real,v=b.imag,S=[x.length],C=r.makeTensorInfo(S,"float32",x),$=r.makeTensorInfo(S,"float32",v),T=ks({inputs:{real:C,imag:$},backend:r}),I=g1(u,h,i,s,r),A=I.real,R=I.imag,L=[A.length],_=r.makeTensorInfo(L,"float32",A),M=r.makeTensorInfo(L,"float32",R),D=ks({inputs:{real:_,imag:M},backend:r}),W=g1(x,v,i,s,r),et=W.real,nt=W.imag,tt=[et.length],U=r.makeTensorInfo(tt,"float32",et),Y=r.makeTensorInfo(tt,"float32",nt),Z=ks({inputs:{real:U,imag:Y},backend:r}),G=JD(e,s),O=[G.real.length],V=r.makeTensorInfo(O,"float32",G.real),P=r.makeTensorInfo(O,"float32",G.imag),H=ks({inputs:{real:V,imag:P},backend:r}),Q=py({inputs:{a:H,b:Z},backend:r}),ot=gu({inputs:{a:D,b:Q},backend:r}),lt=IS({inputs:{a:D,b:Q},backend:r}),ht=jo({inputs:{input:ot},backend:r}),xt=jo({inputs:{input:lt},backend:r}),Ct=yu({inputs:{input:ot},backend:r}),Dt=yu({inputs:{input:lt},backend:r}),It=bu({inputs:[ht,xt],backend:r,attrs:{axis:0}}),Ot=bu({inputs:[Ct,Dt],backend:r,attrs:{axis:0}}),Xt=r.data.get(It.dataId).values,Kt=r.data.get(Ot.dataId).values;return r.disposeIntermediateTensorInfo(p),r.disposeIntermediateTensorInfo(m),r.disposeIntermediateTensorInfo(y),r.disposeIntermediateTensorInfo(C),r.disposeIntermediateTensorInfo($),r.disposeIntermediateTensorInfo(T),r.disposeIntermediateTensorInfo(_),r.disposeIntermediateTensorInfo(M),r.disposeIntermediateTensorInfo(D),r.disposeIntermediateTensorInfo(U),r.disposeIntermediateTensorInfo(Y),r.disposeIntermediateTensorInfo(Z),r.disposeIntermediateTensorInfo(V),r.disposeIntermediateTensorInfo(P),r.disposeIntermediateTensorInfo(H),r.disposeIntermediateTensorInfo(Q),r.disposeIntermediateTensorInfo(ot),r.disposeIntermediateTensorInfo(lt),r.disposeIntermediateTensorInfo(ht),r.disposeIntermediateTensorInfo(Ct),r.disposeIntermediateTensorInfo(xt),r.disposeIntermediateTensorInfo(Dt),r.disposeIntermediateTensorInfo(It),r.disposeIntermediateTensorInfo(Ot),{real:Xt,imag:Kt}}function j9(n,t,e){const s=new Float32Array(t*2);for(let r=0;r<t;r++){let a=0,i=0;for(let l=0;l<t;l++){const u=tA(r*l,t,e),h=jw(n,l);a+=h.real*u.real-h.imag*u.imag,i+=h.real*u.imag+h.imag*u.real}e&&(a/=t,i/=t),QD(s,a,i,r)}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q9(n){const{inputs:t,backend:e}=n,{input:s}=t,r=mt(s.shape),a=s.shape[s.shape.length-1],i=r/a,l=Le({inputs:{x:s},backend:e,attrs:{shape:[i,a]}}),u=P_(l,!1,e),h=Le({inputs:{x:u},backend:e,attrs:{shape:s.shape}});return e.disposeIntermediateTensorInfo(l),e.disposeIntermediateTensorInfo(u),h}const X9={kernelName:J1,backendName:"cpu",kernelFunc:q9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AS(n){const{backend:t,attrs:e}=n,{shape:s,value:r,dtype:a}=e,i=a||Eu(r),l=an(i,mt(s));return Y9(l,r,i),t.makeTensorInfo(s,i,l)}const K9={kernelName:tv,backendName:"cpu",kernelFunc:AS};function Y9(n,t,e){n.fill(t)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Z9={kernelName:ev,backendName:"cpu",kernelFunc:({inputs:n,attrs:t,backend:e})=>{const{image:s}=n,r=e,a=Gn(s.dtype,mt(s.shape)),[i,l,u,h]=s.shape,d=r.data.get(s.dataId).values;for(let m=0;m<i;m++){const y=m*u*l*h;for(let b=0;b<l;b++){const x=b*(u*h);for(let v=0;v<u;v++){const S=v*h;for(let C=0;C<h;C++){const $=Math.round(u-v-1),T=y+x+S+C;let I=d[T];if($>=0&&$<u){const A=$*h,R=y+x+A+C;I=d[R]}a[T]=I}}}}return{dataId:r.write(a,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q9(n){const{inputs:t,backend:e,attrs:s}=n,{x:r,filter:a,bias:i,preluActivationWeights:l}=t,{strides:u,pad:h,dataFormat:d,dilations:p,dimRoundingMode:m,activation:y,leakyreluAlpha:b}=s;let x=M_({inputs:{x:r,filter:a},backend:e,attrs:{strides:u,pad:h,dataFormat:d,dilations:p,dimRoundingMode:m}});if(i){const v=x;if(d==="NCHW"&&i.shape.length===1&&i.shape[0]!==1){const S=Le({inputs:{x:i},backend:e,attrs:{shape:[i.shape[0],1,1]}});x=gu({inputs:{a:x,b:S},backend:e}),e.disposeIntermediateTensorInfo(S)}else x=gu({inputs:{a:x,b:i},backend:e});e.disposeIntermediateTensorInfo(v)}if(y){const v=x;if(d==="NCHW"&&y==="prelu"&&l.shape.length===1&&l.shape[0]!==1){const S=Le({inputs:{x:l},backend:e,attrs:{shape:[l.shape[0],1,1]}});x=cm(e,x,y,S,b),e.disposeIntermediateTensorInfo(S)}else x=cm(e,x,y,l,b);e.disposeIntermediateTensorInfo(v)}return x}const J9={kernelName:Wp,backendName:"cpu",kernelFunc:Q9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tY(n){const{inputs:t,backend:e,attrs:s}=n,{x:r,filter:a,bias:i,preluActivationWeights:l}=t,{strides:u,pad:h,dataFormat:d,dilations:p,dimRoundingMode:m,activation:y,leakyreluAlpha:b}=s;let x=B_({inputs:{x:r,filter:a},backend:e,attrs:{strides:u,pad:h,dataFormat:d,dilations:p,dimRoundingMode:m}});if(i){const v=x;x=gu({inputs:{a:x,b:i},backend:e}),e.disposeIntermediateTensorInfo(v)}if(y){const v=x;x=cm(e,x,y,l,b),e.disposeIntermediateTensorInfo(v)}return x}const eY={kernelName:Hp,backendName:"cpu",kernelFunc:tY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nY(n){const{inputs:t,backend:e}=n,{params:s,indices:r}=t,a=mt(s.shape),i=r.shape,l=i[i.length-1],[u,h,d,p]=Ew(s,r);if(h===0)return e.makeTensorInfo(u,s.dtype,[]);const m=e.data.get(r.dataId).values,y=e.bufferSync(s),b=YO(m,y,s.dtype,h,l,d,p,s.shape,a);return e.makeTensorInfo(u,s.dtype,b.values)}const sY={kernelName:nv,backendName:"cpu",kernelFunc:nY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rY(n){const{inputs:t,backend:e,attrs:s}=n,{x:r,indices:a}=t,{axis:i,batchDims:l}=s;Lt([r,a],"gatherV2");const u=re(i,r.shape)[0],h=e.data.get(a.dataId).values,d=r.shape[u];for(let T=0;T<h.length;++T){const I=h[T];F(I<=d-1&&I>=0,()=>`GatherV2: the index value ${I} is not in [0, ${d-1}]`)}let p=l;l==null&&(p=0);const m=mt(a.shape),y=Jw(r,a,u,p),b=Le({inputs:{x:r},backend:e,attrs:{shape:[y.batchSize,y.outerSize,y.dimSize,y.sliceSize]}}),x=Le({inputs:{x:a},backend:e,attrs:{shape:[y.batchSize,m/y.batchSize]}}),v=[y.batchSize,y.outerSize,m/y.batchSize,y.sliceSize],S=e.bufferSync(x),C=e.bufferSync(b),$=ZO(C,S,v);return e.disposeIntermediateTensorInfo(b),e.disposeIntermediateTensorInfo(x),e.makeTensorInfo(y.outputShape,$.dtype,$.values)}const aY={kernelName:qm,backendName:"cpu",kernelFunc:rY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iY(n){const{inputs:t,backend:e}=n,{input:s}=t,r=mt(s.shape),a=s.shape[s.shape.length-1],i=r/a,l=Le({inputs:{x:s},backend:e,attrs:{shape:[i,a]}}),u=P_(l,!0,e),h=Le({inputs:{x:u},backend:e,attrs:{shape:s.shape}});return e.disposeIntermediateTensorInfo(l),e.disposeIntermediateTensorInfo(u),h}const oY={kernelName:sv,backendName:"cpu",kernelFunc:iY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lY=Ce(Hh,n=>Number.isFinite(n)?1:0,"bool"),uY={kernelName:Hh,backendName:"cpu",kernelFunc:lY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cY=Ce(jh,n=>Math.abs(n)===1/0?1:0,"bool"),hY={kernelName:jh,backendName:"cpu",kernelFunc:cY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dY=Ce(qh,n=>Number.isNaN(n)?1:0,"bool"),fY={kernelName:qh,backendName:"cpu",kernelFunc:dY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pY(n){const{backend:t,attrs:e}=n,{start:s,stop:r,num:a}=e,i=n_(s,r,a);return t.makeTensorInfo([i.length],"float32",i)}const mY={kernelName:av,backendName:"cpu",kernelFunc:pY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gY=Ce(Kh,n=>Math.log1p(n)),yY={kernelName:Kh,backendName:"cpu",kernelFunc:gY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bY=cn((n,t)=>n&&t),xY=kn(Qm,bY,null,"bool"),vY={kernelName:Qm,backendName:"cpu",kernelFunc:xY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wY=Ce(Jm,n=>n?0:1,"bool"),SY={kernelName:Jm,backendName:"cpu",kernelFunc:wY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CY=cn((n,t)=>n||t),NY=kn(tg,CY,null,"bool"),TY={kernelName:tg,backendName:"cpu",kernelFunc:NY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Y(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{depthRadius:a,bias:i,alpha:l,beta:u}=s;Lt(r,"LRN");const h=r.shape[3],d=h-1,p=e.data.get(r.dataId).values,m=mt(r.shape),y=new Float32Array(m);function b(x){const v=x%h;let S=x-v+Math.max(0,v-a);const C=x-v+Math.min(v+a,d);let $=0;for(;S<=C;S++){const T=p[S];$+=T*T}return $}for(let x=0;x<m;x++){const v=b(x),S=p[x]*Math.pow(i+l*v,-u);y[x]=S}return e.makeTensorInfo(r.shape,r.dtype,y)}const kY={kernelName:eg,backendName:"cpu",kernelFunc:$Y};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IY(n){const{inputs:t,backend:e,attrs:s}=n,{x:r,y:a,dy:i}=t,{depthRadius:l,bias:u,alpha:h,beta:d}=s;Lt(i,"LRNGrad");const p=mt(i.shape),m=i.shape[3],y=e.data.get(i.dataId).values,b=e.data.get(r.dataId).values,x=e.data.get(a.dataId).values,v=new Float32Array(p),S=p;for(let C=0;C<S;C++){const $=C%m,T=C-$+Math.max(0,$-l),I=C-$+Math.min(m,$+l+1);let A=0;for(let R=T;R<I;R++)A+=Math.pow(b[R],2);A=h*A+u;for(let R=T;R<I;R++){let L=-2*h*d*b[R]*x[C]/A;C===R&&(L+=Math.pow(A,-d)),L*=y[C],v[R]+=L}}return e.makeTensorInfo(i.shape,r.dtype,v)}const EY={kernelName:iv,backendName:"cpu",kernelFunc:IY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V_(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{reductionIndices:a,keepDims:i}=s,l=e;let u=r.shape;const h=u.length,d=re(a,u);let p=d;const m=qe(p,h);let y=l.data.get(r.dataId).values;if(m!=null){const T=new Array(h);for(let I=0;I<T.length;I++)T[I]=u[m[I]];y=$S(y,u,r.dtype,m,T),p=ln(p.length,h),u=T}Lt(r,"max"),jn("max",p,h);const[b,x]=_n(u,p),v=mt(x),S=r_(y,v,b,r.dtype),C=l.write(S,b,r.dtype);let $=b;return i&&($=on(b,d)),{dataId:C,shape:$,dtype:r.dtype}}const DY={kernelName:ng,backendName:"cpu",kernelFunc:V_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AY(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t;Lt(r,"maxPool");const{filterSize:a,strides:i,pad:l,dimRoundingMode:u}=s,h=1;F(Hn(i,h),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${h}'`);const d=Tr(r.shape,a,i,h,l,u);let p;if(d.filterWidth===1&&d.filterHeight===1&&de(d.inShape,d.outShape))p=ua({inputs:{x:r},backend:e});else{const m=e.data.get(r.dataId).values,y=Bt(r.shape),b=ES(m,r.shape,r.dtype,y,d,"max");p=e.makeTensorInfo(d.outShape,r.dtype,b.values)}return p}const RY={kernelName:sg,backendName:"cpu",kernelFunc:AY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OY(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{filterSize:a,strides:i,pad:l,dimRoundingMode:u,dataFormat:h}=s;Lt(r,"maxPool3d");const d=Ua(r.shape,a,i,1,l,u,h),p=e.data.get(r.dataId).values,m=z_(p,r.shape,r.dtype,Bt(r.shape),d,"max");return e.makeTensorInfo(m.shape,"float32",m.values)}const _Y={kernelName:rg,backendName:"cpu",kernelFunc:OY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FY(n){const{inputs:t,backend:e,attrs:s}=n,{dy:r,input:a}=t,{filterSize:i,strides:l,pad:u,dimRoundingMode:h}=s;Lt([r,a],"maxPool3DGrad");const d=Ua(a.shape,i,l,1,u,h),p=e.bufferSync(a),m=C7(p,d),y=d.strideDepth,b=d.strideHeight,x=d.strideWidth,v=d.dilationDepth,S=d.dilationHeight,C=d.dilationWidth,$=d.effectiveFilterDepth,T=d.effectiveFilterHeight,I=d.effectiveFilterWidth,A=$-1-d.padInfo.front,R=I-1-d.padInfo.left,L=T-1-d.padInfo.top,_=te(a.shape,"float32"),M=e.bufferSync(r);for(let D=0;D<d.batchSize;++D)for(let W=0;W<d.inChannels;++W)for(let et=0;et<d.inDepth;++et)for(let nt=0;nt<d.inHeight;++nt)for(let tt=0;tt<d.inWidth;++tt){const U=et-A,Y=nt-L,Z=tt-R;let G=0;for(let O=0;O<$;O+=v){const V=(U+O)/y;if(!(V<0||V>=d.outDepth||Math.floor(V)!==V))for(let P=0;P<T;P+=S){const H=(Y+P)/b;if(!(H<0||H>=d.outHeight||Math.floor(H)!==H))for(let Q=0;Q<I;Q+=C){const ot=(Z+Q)/x;if(ot<0||ot>=d.outWidth||Math.floor(ot)!==ot)continue;const lt=$*T*I-1-m.get(D,V,H,ot,W),ht=O*T*I+P*I+Q,xt=lt===ht?1:0;if(xt===0)continue;const Ct=M.get(D,V,H,ot,W);G+=Ct*xt}}}_.set(G,D,et,nt,tt,W)}return e.makeTensorInfo(_.shape,_.dtype,_.values)}const LY={kernelName:lv,backendName:"cpu",kernelFunc:FY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zY(n){const{inputs:t,backend:e,attrs:s}=n,{dy:r,input:a,output:i}=t,l=a;Lt([a,i],"maxPoolGrad");const{filterSize:u,strides:h,pad:d,dimRoundingMode:p}=s,m=Tr(l.shape,u,h,1,d,p),y=e.data.get(l.dataId).values,b=te(m.outShape,l.dtype,L_(y,l.shape,l.dtype,m).values),x=m.strideHeight,v=m.strideWidth,S=m.dilationHeight,C=m.dilationWidth,$=m.effectiveFilterHeight,T=m.effectiveFilterWidth,I=T-1-m.padInfo.left,A=$-1-m.padInfo.top,R=te(l.shape,"float32"),L=e.data.get(r.dataId).values,_=te(r.shape,"float32",L);for(let M=0;M<m.batchSize;++M)for(let D=0;D<m.inChannels;++D)for(let W=0;W<m.inHeight;++W)for(let et=0;et<m.inWidth;++et){const nt=W-A,tt=et-I;let U=0;for(let Y=0;Y<$;Y+=S){const Z=(nt+Y)/x;if(!(Z<0||Z>=m.outHeight||Math.floor(Z)!==Z))for(let G=0;G<T;G+=C){const O=(tt+G)/v;if(O<0||O>=m.outWidth||Math.floor(O)!==O)continue;const V=$*T-1-b.get(M,Z,O,D),P=Y*T+G,H=V===P?1:0;if(H===0)continue;const Q=_.get(M,Z,O,D);U+=Q*H}}R.set(U,M,W,et,D)}return e.makeTensorInfo(R.shape,R.dtype,R.values)}const MY={kernelName:ov,backendName:"cpu",kernelFunc:zY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BY(n,t,e,s,r){const a=Bt(t),i=ES(n,t,e,a,r,"max"),l=L_(n,t,e,r,!0,s);return[i.values,l.values]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PY={kernelName:uv,backendName:"cpu",kernelFunc:({inputs:n,attrs:t,backend:e})=>{const{x:s}=n,{filterSize:r,strides:a,pad:i,includeBatchInIndex:l}=t,u=e;Lt(s,"MaxPoolWithArgmax");const h=u.data.get(s.dataId).values,d=Tr(s.shape,r,a,[1,1],i),[p,m]=BY(h,s.shape,s.dtype,l,d),y=u.write(p,d.outShape,s.dtype),b=u.write(m,d.outShape,s.dtype);return[{dataId:y,shape:d.outShape,dtype:s.dtype},{dataId:b,shape:d.outShape,dtype:"int32"}]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VY(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{axis:a,keepDims:i}=s,l=re(a,r.shape),h=_n(r.shape,l)[1],d=mt(h),p=[],m=e.makeTensorInfo([],"float32",new Float32Array([d]));p.push(m);const y=Li({inputs:{x:r},backend:e,attrs:{dtype:"float32"}});p.push(y);const b=DS({inputs:{a:y,b:m},backend:e});p.push(b);const x=Md({inputs:{x:b},backend:e,attrs:{axis:a,keepDims:i}});return p.forEach(v=>e.disposeIntermediateTensorInfo(v)),x}const UY={kernelName:ag,backendName:"cpu",kernelFunc:VY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GY(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{axis:a,keepDims:i}=s;Lt(r,"min");const l=re(a,r.shape);let u=l;const h=qe(u,r.shape.length);let d=r;h!=null&&(d=bs({inputs:{x:r},backend:e,attrs:{perm:h}}),u=ln(u.length,r.shape.length)),jn("min",u,d.shape.length);const[p,m]=_n(d.shape,u),y=mt(m),b=ts(mt(p),d.dtype),x=e.data.get(d.dataId).values;for(let S=0;S<b.length;++S){const C=S*y;let $=x[C];for(let T=0;T<y;++T){const I=x[C+T];(Number.isNaN(I)||I<$)&&($=I)}b[S]=$}h!=null&&e.disposeIntermediateTensorInfo(d);const v=e.makeTensorInfo(p,d.dtype,b);if(i){const S=on(p,l),C=Le({inputs:{x:v},backend:e,attrs:{shape:S}});return e.disposeIntermediateTensorInfo(v),C}return v}const WY={kernelName:ig,backendName:"cpu",kernelFunc:GY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HY(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{paddings:a,mode:i}=s;Lt(r,"mirrorPad");const l=a.map(($,T)=>$[0]+r.shape[T]+$[1]),u=a.map($=>$[0]),h=a.map(($,T)=>$[0]+r.shape[T]),d=i==="reflect"?0:1,p=e.data.get(r.dataId).values,m=r.shape.length,y=Bt(r.shape),b=mt(l),x=l.length,v=Bt(l),S=Gn(r.dtype,b);for(let $=0;$<b;$++){let T=Du($,x,v);for(let A=0;A<x;A++)T[A]<u[A]?T[A]=u[A]*2-T[A]-d:T[A]>=h[A]&&(T[A]=(h[A]-1)*2-T[A]+d);T=T.map((A,R)=>A-u[R]);const I=sa(T,m,y);S[$]=p[I]}return{dataId:e.write(S,l,r.dtype),shape:l,dtype:r.dtype}}const jY={kernelName:og,backendName:"cpu",kernelFunc:HY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qY=cn((n,t)=>{const e=n%t;return n<0&&t<0||n>=0&&t>=0?e:(e+t)%t}),XY=kn(Qh,qY),KY={kernelName:Qh,backendName:"cpu",kernelFunc:XY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U_(n){const{inputs:t,backend:e,attrs:s}=n,{logits:r}=t,{dim:a}=s,i=r.shape.length;let l=a;if(l===-1&&(l=i-1),l!==i-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${i} and dim was ${l}`);const u=re([l],r.shape),h=V_({inputs:{x:r},backend:e,attrs:{reductionIndices:u,keepDims:!1}}),d=on(h.shape,u),p=Le({inputs:{x:h},backend:e,attrs:{shape:d}}),m=IS({inputs:{a:r,b:p},backend:e}),y=jO({inputs:{x:m},backend:e}),b=Md({inputs:{x:y},backend:e,attrs:{axis:u,keepDims:!1}}),x=Le({inputs:{x:b},backend:e,attrs:{shape:d}}),v=DS({inputs:{a:y,b:x},backend:e});return e.disposeIntermediateTensorInfo(h),e.disposeIntermediateTensorInfo(p),e.disposeIntermediateTensorInfo(m),e.disposeIntermediateTensorInfo(y),e.disposeIntermediateTensorInfo(b),e.disposeIntermediateTensorInfo(x),v}const YY={kernelName:Tg,backendName:"cpu",kernelFunc:U_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZY(n){const{inputs:t,backend:e,attrs:s}=n,{logits:r}=t,{numSamples:a,seed:i,normalized:l}=s;Lt(r,"multinomial");const u=l?r:U_({inputs:{logits:r},backend:e,attrs:{dim:-1}}),h=u.shape[0],d=u.shape[1],p=e.data.get(u.dataId).values,m=[h,a],y=ts(mt(m),"int32");for(let b=0;b<h;++b){const x=b*d,v=new Float32Array(d-1);v[0]=p[x];for(let $=1;$<v.length;++$)v[$]=v[$-1]+p[x+$];const S=Gg.alea(i.toString()),C=b*a;for(let $=0;$<a;++$){const T=S();y[C+$]=v.length;for(let I=0;I<v.length;I++)if(T<v[I]){y[C+$]=I;break}}}return l||e.disposeIntermediateTensorInfo(u),e.makeTensorInfo(m,"int32",y)}const QY={kernelName:cv,backendName:"cpu",kernelFunc:ZY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JY=Sw;function tZ(n){const{inputs:t,backend:e,attrs:s}=n,{boxes:r,scores:a}=t,{maxOutputSize:i,iouThreshold:l,scoreThreshold:u}=s;Lt(r,"NonMaxSuppression");const h=e.data.get(r.dataId).values,d=e.data.get(a.dataId).values,{selectedIndices:p}=JY(h,d,i,l,u);return e.makeTensorInfo([p.length],"int32",new Int32Array(p))}const eZ={kernelName:hv,backendName:"cpu",kernelFunc:tZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nZ=Cw;function sZ(n){const{inputs:t,backend:e,attrs:s}=n,{boxes:r,scores:a}=t,{maxOutputSize:i,iouThreshold:l,scoreThreshold:u,padToMaxOutputSize:h}=s;Lt(r,"NonMaxSuppressionPadded");const d=e.data.get(r.dataId).values,p=e.data.get(a.dataId).values,{selectedIndices:m,validOutputs:y}=nZ(d,p,i,l,u,h);return[e.makeTensorInfo([m.length],"int32",new Int32Array(m)),e.makeTensorInfo([],"int32",new Int32Array([y]))]}const rZ={kernelName:dv,backendName:"cpu",kernelFunc:sZ};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aZ=Nw;function iZ(n){const{inputs:t,backend:e,attrs:s}=n,{boxes:r,scores:a}=t,{maxOutputSize:i,iouThreshold:l,scoreThreshold:u,softNmsSigma:h}=s;Lt(r,"NonMaxSuppressionWithScore");const d=e.data.get(r.dataId).values,p=e.data.get(a.dataId).values,m=i,y=l,b=u,x=h,{selectedIndices:v,selectedScores:S}=aZ(d,p,m,y,b,x);return[e.makeTensorInfo([v.length],"int32",new Int32Array(v)),e.makeTensorInfo([S.length],"float32",new Float32Array(S))]}const oZ={kernelName:fv,backendName:"cpu",kernelFunc:iZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lZ(n){const{inputs:t,backend:e,attrs:s}=n,{indices:r}=t,{dtype:a,depth:i,onValue:l,offValue:u}=s;Lt(r,"oneHot");const h=mt(r.shape),d=new Float32Array(h*i);d.fill(u);const p=e.data.get(r.dataId).values;for(let m=0;m<h;++m)p[m]>=0&&p[m]<i&&(d[m*i+p[m]]=l);return e.makeTensorInfo([...r.shape,i],a,d)}const uZ={kernelName:hg,backendName:"cpu",kernelFunc:lZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dm(n){const{inputs:t,backend:e}=n,{x:s}=t;if(s.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(s.dtype==="complex64"){const r=jo({inputs:{input:s},backend:e}),a=dm({inputs:{x:r},backend:e}),i=yu({inputs:{input:s},backend:e}),l=dm({inputs:{x:i},backend:e}),u=ks({inputs:{real:a,imag:l},backend:e});return e.disposeIntermediateTensorInfo(r),e.disposeIntermediateTensorInfo(a),e.disposeIntermediateTensorInfo(i),e.disposeIntermediateTensorInfo(l),u}else return AS({backend:e,attrs:{shape:s.shape,value:0,dtype:s.dtype}})}const cZ={kernelName:Eg,backendName:"cpu",kernelFunc:dm};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G_(n){const{inputs:t,backend:e}=n,{x:s}=t;if(s.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(s.dtype==="complex64"){const r=jo({inputs:{input:s},backend:e}),a=G_({inputs:{x:r},backend:e}),i=yu({inputs:{input:s},backend:e}),l=dm({inputs:{x:i},backend:e}),u=ks({inputs:{real:a,imag:l},backend:e});return e.disposeIntermediateTensorInfo(r),e.disposeIntermediateTensorInfo(a),e.disposeIntermediateTensorInfo(i),e.disposeIntermediateTensorInfo(l),u}else return AS({backend:e,attrs:{shape:s.shape,value:1,dtype:s.dtype}})}const hZ={kernelName:cg,backendName:"cpu",kernelFunc:G_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W_(n){const{inputs:t,backend:e,attrs:s}=n,{axis:r}=s;if(t.length===1)return hm({inputs:{input:t[0]},backend:e,attrs:{dim:r}});const a=t[0].shape,i=t[0].dtype;t.forEach(d=>{Bs(a,d.shape,"All tensors passed to stack must have matching shapes"),F(i===d.dtype,()=>"All tensors passed to stack must have matching dtypes")});const l=[],u=t.map(d=>{const p=hm({inputs:{input:d},backend:e,attrs:{dim:r}});return l.push(p),p}),h=bu({inputs:u,backend:e,attrs:{axis:r}});return l.forEach(d=>e.disposeIntermediateTensorInfo(d)),h}const dZ={kernelName:dg,backendName:"cpu",kernelFunc:W_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fZ(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{paddings:a,constantValue:i}=s;Lt(r,"pad");const l=a.map((C,$)=>C[0]+r.shape[$]+C[1]),u=a.map(C=>C[0]),h=e.data.get(r.dataId).values,d=mt(r.shape),p=r.shape.length,m=Bt(r.shape),y=mt(l),b=l.length,x=Bt(l),v=Gn(r.dtype,y);i!==0&&v.fill(i);for(let C=0;C<d;C++){const T=Du(C,p,m).map((A,R)=>A+u[R]),I=sa(T,b,x);v[I]=h[C]}return{dataId:e.write(v,l,r.dtype),shape:l,dtype:r.dtype}}const H_={kernelName:fg,backendName:"cpu",kernelFunc:fZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pZ=cn((n,t)=>Math.pow(n,t)),mZ=kn(td,pZ),gZ={kernelName:td,backendName:"cpu",kernelFunc:mZ};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yZ(n){const{inputs:t,backend:e,attrs:s}=n,{paramsNestedSplits:r,paramsDenseValues:a,indices:i}=t,{outputRaggedRank:l}=s,u=r.map(S=>e.data.get(S.dataId).values),h=r.map(S=>S.shape),d=e.data.get(a.dataId).values,p=e.data.get(i.dataId).values,[m,y,b]=c_(u,h,d,a.shape,a.dtype,p,i.shape),x=m.map(S=>e.makeTensorInfo([S.length],"int32",S)),v=e.makeTensorInfo(b,a.dtype,y);return x.concat([v])}const bZ={kernelName:pv,backendName:"cpu",kernelFunc:yZ};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xZ(n){const{inputs:t,backend:e}=n,{starts:s,limits:r,deltas:a}=t,i=e.data.get(s.dataId).values,l=e.data.get(r.dataId).values,u=e.data.get(a.dataId).values,[h,d]=h_(i,s.shape,s.dtype,l,r.shape,u,a.shape),p=e.makeTensorInfo([h.length],"int32",h),m=e.makeTensorInfo([d.length],s.dtype,d);return[p,m]}const vZ={kernelName:mv,backendName:"cpu",kernelFunc:xZ};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wZ(n){const{inputs:t,backend:e,attrs:s}=n,{shape:r,values:a,defaultValue:i,rowPartitionTensors:l}=t,{rowPartitionTypes:u}=s,h=e.data.get(r.dataId).values,d=e.data.get(a.dataId).values,p=e.data.get(i.dataId).values,m=l.map(v=>e.data.get(v.dataId).values),y=l.map(v=>v.shape),[b,x]=d_(h,r.shape,d,a.shape,a.dtype,p,i.shape,m,y,u);return e.makeTensorInfo(b,a.dtype,x)}const SZ={kernelName:gv,backendName:"cpu",kernelFunc:wZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CZ(n){const{backend:t,attrs:e}=n,{start:s,stop:r,dtype:a,step:i}=e,l=f_(s,r,i,a);return t.makeTensorInfo([l.length],a,l)}const NZ={kernelName:yv,backendName:"cpu",kernelFunc:CZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TZ=Ce(ed,n=>1/n),$Z={kernelName:ed,backendName:"cpu",kernelFunc:TZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kZ(n){const{inputs:t,backend:e,attrs:s}=n,{images:r}=t,{alignCorners:a,halfPixelCenters:i,size:l}=s;Lt(r,"resizeBilinear");const u=Bt(r.shape),[h,d]=l,[p,m,y,b]=r.shape,x=e.data.get(r.dataId).values,v=new Float32Array(mt([p,h,d,b])),S=[a&&h>1?m-1:m,a&&d>1?y-1:y],C=[a&&h>1?h-1:h,a&&d>1?d-1:d];let $=0;const T=S[0]/C[0],I=S[1]/C[1];for(let A=0;A<p;A++)for(let R=0;R<h;R++){let L;i?L=T*(R+.5)-.5:L=T*R;const _=Math.max(0,Math.floor(L)),M=L-_,D=Math.min(m-1,Math.ceil(L)),W=A*u[0]+_*u[1],et=A*u[0]+D*u[1];for(let nt=0;nt<d;nt++){let tt;i?tt=I*(nt+.5)-.5:tt=I*nt;const U=Math.max(0,Math.floor(tt)),Y=tt-U,Z=Math.min(y-1,Math.ceil(tt)),G=W+U*u[2],O=et+U*u[2],V=W+Z*u[2],P=et+Z*u[2];for(let H=0;H<b;H++){const Q=x[G+H],ot=x[O+H],lt=x[V+H],ht=x[P+H],xt=Q+(lt-Q)*Y,Ct=ot+(ht-ot)*Y,Dt=xt+(Ct-xt)*M;v[$++]=Dt}}}return e.makeTensorInfo([p,h,d,b],"float32",v)}const IZ={kernelName:bg,backendName:"cpu",kernelFunc:kZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EZ(n){const{inputs:t,backend:e,attrs:s}=n,{images:r,dy:a}=t,{alignCorners:i}=s;Lt([a,r],"resizeBilinearGrad");const l=Bt(r.shape),[u,h,d,p]=r.shape,[,m,y]=a.shape,b=new Float32Array(u*h*d*p),x=[i&&m>1?h-1:h,i&&y>1?d-1:d],v=[i&&m>1?m-1:m,i&&y>1?y-1:y],S=x[0]/v[0],C=x[1]/v[1],$=e.data.get(a.dataId).values;let T=0;for(let I=0;I<u;I++){const A=I*l[0];for(let R=0;R<m;R++){const L=R*S,_=Math.floor(L),M=Math.min(Math.ceil(L),h-1),D=A+_*l[1],W=A+M*l[1],et=L-_,nt=1-et;for(let tt=0;tt<y;tt++){const U=tt*C,Y=Math.floor(U),Z=Math.min(Math.ceil(U),d-1),G=U-Y,O=1-G,V=D+Y*l[2],P=D+Z*l[2],H=W+Y*l[2],Q=W+Z*l[2],ot=nt*O,lt=nt*G,ht=et*O,xt=et*G;for(let Ct=0;Ct<p;Ct++){const Dt=$[T++];b[V+Ct]+=Dt*ot,b[P+Ct]+=Dt*lt,b[H+Ct]+=Dt*ht,b[Q+Ct]+=Dt*xt}}}}return e.makeTensorInfo([u,d,h,p],"float32",b)}const DZ={kernelName:vv,backendName:"cpu",kernelFunc:EZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AZ(n){const{inputs:t,backend:e,attrs:s}=n,{images:r}=t,{alignCorners:a,halfPixelCenters:i,size:l}=s;Lt(r,"resizeNearestNeighbor");const u=Bt(r.shape),[h,d]=l,[p,m,y,b]=r.shape,x=e.data.get(r.dataId).values,v=new Float32Array(p*h*d*b),S=[a&&h>1?m-1:m,a&&d>1?y-1:y],C=[a&&h>1?h-1:h,a&&d>1?d-1:d],$=S[0]/C[0],T=S[1]/C[1];let I=0;for(let A=0;A<p;A++){const R=A*u[0];for(let L=0;L<h;L++){const _=i?$*(L+.5):$*L;let M=Math.min(m-1,a?Math.round(_):Math.floor(_));i&&(M=Math.max(0,M));const D=R+M*u[1];for(let W=0;W<d;W++){const et=i?T*(W+.5):T*W;let nt=Math.min(y-1,a?Math.round(et):Math.floor(et));i&&(nt=Math.max(0,nt));const tt=D+nt*u[2];for(let U=0;U<b;U++){const Y=x[tt+U];v[I++]=Y}}}}return e.makeTensorInfo([p,h,d,b],r.dtype,v)}const RZ={kernelName:yg,backendName:"cpu",kernelFunc:AZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OZ(n){const{inputs:t,backend:e,attrs:s}=n,{images:r,dy:a}=t,{alignCorners:i}=s;Lt([a,r],"resizeNearestNeighborGrad");const l=Bt(r.shape),u=Bt(a.shape),[h,d,p,m]=r.shape,[,y,b]=a.shape,x=new Float32Array(h*d*p*m),v=e.data.get(a.dataId).values,S=[i&&y>1?d-1:d,i&&b>1?p-1:p],C=[i&&y>1?y-1:y,i&&b>1?b-1:b],$=S[0]/C[0],T=S[1]/C[1],I=1/$,A=1/T,R=Math.ceil(I)*2+2,L=Math.ceil(A)*2+2;for(let _=0;_<h;_++){const M=_*l[0];for(let D=0;D<d;D++){const W=M+D*l[1],et=Math.floor(D*I),nt=Math.floor(et-R/2);for(let tt=0;tt<p;tt++){const U=W+tt*l[2],Y=Math.floor(tt*A),Z=Math.floor(Y-L/2);for(let G=0;G<m;G++){let O=0;for(let V=0;V<R;V++){const P=V+nt;if(P<0||P>=y)continue;const H=M+P*u[1],Q=P*$,ot=Math.min(d-1,i?Math.round(Q):Math.floor(Q));if(D===ot)for(let lt=0;lt<L;lt++){const ht=lt+Z;if(ht<0||ht>=b)continue;const xt=H+ht*u[2],Ct=ht*T,Dt=Math.min(p-1,i?Math.round(Ct):Math.floor(Ct));tt===Dt&&(O+=v[xt+G])}}x[U+G]=O}}}}return e.makeTensorInfo(r.shape,r.dtype,x)}const _Z={kernelName:xv,backendName:"cpu",kernelFunc:OZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FZ(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{dims:a}=s;Lt(r,"reverse");const i=r.shape.length,l=re(a,r.shape);if(i===0)return ua({inputs:{x:r},backend:e});const u=new Cn(r.shape,r.dtype),h=e.bufferSync(r);for(let d=0;d<u.size;d++){const p=u.indexToLoc(d),m=p.slice();l.forEach(y=>m[y]=r.shape[y]-1-m[y]),u.set(h.get(...m),...p)}return e.makeTensorInfo(u.shape,u.dtype,u.values)}const LZ={kernelName:xg,backendName:"cpu",kernelFunc:FZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zZ={kernelName:zv,backendName:"cpu",kernelFunc:({inputs:n,attrs:t,backend:e})=>{const{image:s}=n,{radians:r,fillValue:a,center:i}=t,l=e,u=Gn(s.dtype,mt(s.shape)),[h,d,p,m]=s.shape,[y,b]=zw(i,d,p),x=255,v=Math.sin(r),S=Math.cos(r),C=l.data.get(s.dataId).values;for(let T=0;T<h;T++){const I=T*p*d*m;for(let A=0;A<d;A++){const R=A*(p*m);for(let L=0;L<p;L++){const _=L*m;for(let M=0;M<m;M++){const D=[h,A,L,M],W=D[2],et=D[1];let nt=(W-y)*S-(et-b)*v,tt=(W-y)*v+(et-b)*S;nt=Math.round(nt+y),tt=Math.round(tt+b);let U=a;if(typeof a!="number"&&(M===3?U=x:U=a[M]),nt>=0&&nt<p&&tt>=0&&tt<d){const Z=tt*(p*m),G=nt*m,O=I+Z+G+M;U=C[O]}const Y=I+R+_+M;u[Y]=U}}}}return{dataId:l.write(u,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MZ=Ce(rd,n=>{const t=Math.floor(n);return n-t<.5?Math.floor(n):n-t>.5?Math.ceil(n):t%2===0?t:t+1}),BZ={kernelName:rd,backendName:"cpu",kernelFunc:MZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PZ(n){const{inputs:t,backend:e,attrs:s}=n,{indices:r,updates:a}=t,{shape:i}=s,{sliceRank:l,numUpdates:u,sliceSize:h,strides:d,outputSize:p}=Qo(a,r,i),m=!0,y=e.bufferSync(r),b=e.bufferSync(a),x=To(y,b,i,p,h,u,l,d,0,m);return e.makeTensorInfo(i,x.dtype,x.values)}const VZ={kernelName:wv,backendName:"cpu",kernelFunc:PZ};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UZ(n,t){let e=0,s=n.length,r=0;for(;e<s;)r=Math.floor((e+s)/2),n[r]<t?e=r+1:s=r;return s}function GZ(n,t){let e=0,s=n.length,r=0;for(;e<s;)r=Math.floor((e+s)/2),n[r]<=t?e=r+1:s=r;return s}function WZ(n,t,e,s,r,a){const i=an("int32",e*r);for(let l=0;l<e;++l){const u=n.slice(l*s,(l+1)*s),h=l*r;for(let d=0;d<r;++d)i[h+d]=a==="left"?UZ(u,t[d+h]):GZ(u,t[d+h])}return i}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HZ(n){const{inputs:t,backend:e,attrs:s}=n,{sortedSequence:r,values:a}=t,{side:i}=s,l=e.data.get(r.dataId).values,u=e.data.get(a.dataId).values,h=WZ(l,u,r.shape[0],r.shape[1],a.shape[1],i);return e.makeTensorInfo(a.shape,"int32",h)}const jZ={kernelName:Cv,backendName:"cpu",kernelFunc:HZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qZ(n){const{inputs:t,backend:e}=n,{condition:s,t:r,e:a}=t;Lt([s,r,a],"select");const i=s.shape.length,l=e.data.get(s.dataId).values,u=e.data.get(r.dataId).values,h=e.data.get(a.dataId).values,d=Os(r.dtype,a.dtype),p=ts(mt(r.shape),d);let m=0;const y=i===0||i>1||r.shape.length===1?1:mt(r.shape.slice(1));for(let b=0;b<l.length;b++)for(let x=0;x<y;x++)l[b]===1?p[m++]=u[b]:p[m++]=h[b];return e.makeTensorInfo(r.shape,d,p)}const XZ={kernelName:vg,backendName:"cpu",kernelFunc:qZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KZ=ey,YZ=ny,ZZ=Ce(id,n=>n>=0?YZ*n:KZ*(Math.exp(n)-1)),QZ={kernelName:id,backendName:"cpu",kernelFunc:ZZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JZ=Ce(ud,n=>n<0?-1:n>0?1:0),tQ={kernelName:ud,backendName:"cpu",kernelFunc:JZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eQ=Ce(od,n=>Math.sin(n)),nQ={kernelName:od,backendName:"cpu",kernelFunc:eQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sQ=Ce(ld,n=>Math.sinh(n)),rQ={kernelName:ld,backendName:"cpu",kernelFunc:sQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aQ=11920928955078125e-23,yk=Math.log(aQ)+2,iQ=Ce(hd,n=>{const t=n>-yk,e=n<yk,s=Math.exp(n);let r;return e?r=s:t?r=n:r=Math.log(1+s),r}),oQ={kernelName:hd,backendName:"cpu",kernelFunc:iQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lQ(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{blockShape:a,paddings:i}=s;Lt([r],"spaceToBatchND");const l=mt(a),u=[[0,0]];u.push(...i);for(let A=1+a.length;A<r.shape.length;++A)u.push([0,0]);const h=H_.kernelFunc({inputs:{x:r},backend:e,attrs:{paddings:u,constantValue:0}}),d=kd(h.shape,a,l,!1),p=Id(d.length,a.length,!1),m=Ed(h.shape,a,l,!1),x=Le({inputs:{x:h},backend:e,attrs:{shape:d}}),C=bs({inputs:{x},backend:e,attrs:{perm:p}}),I=Le({inputs:{x:C},backend:e,attrs:{shape:m}});return e.disposeIntermediateTensorInfo(h),e.disposeIntermediateTensorInfo(x),e.disposeIntermediateTensorInfo(C),I}const uQ={kernelName:Cg,backendName:"cpu",kernelFunc:lQ};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cQ(n){const{inputs:t,backend:e}=n,{indices:s,values:r,denseShape:a,defaultValue:i}=t;if(a.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${a.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${s.shape}`);if(r.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${r.shape}`);if(i.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${i.shape}`);const l=e.data.get(s.dataId).values,u=e.data.get(r.dataId).values,h=e.data.get(a.dataId).values,d=e.data.get(i.dataId).values[0],[p,m,y,b,x]=y_(l,s.shape,s.dtype,u,r.dtype,h,d);return[e.makeTensorInfo(m,s.dtype,p),e.makeTensorInfo([m[0]],r.dtype,y),e.makeTensorInfo([b.length],"bool",new Uint8Array(b.map(v=>Number(v)))),e.makeTensorInfo([x.length],s.dtype,new Int32Array(x))]}const hQ={kernelName:Nv,backendName:"cpu",kernelFunc:cQ};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dQ(n){const{inputs:t,backend:e}=n,{inputIndices:s,inputShape:r,newShape:a}=t;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${s.shape}`);if(r.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${r.shape}`);if(a.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${a.shape}`);const i=Array.from(e.data.get(r.dataId).values),l=e.data.get(s.dataId).values,u=Array.from(e.data.get(a.dataId).values),[h,d,p]=b_(l,s.shape,s.dtype,i,u);return[e.makeTensorInfo(d,s.dtype,h),e.makeTensorInfo([p.length],a.dtype,new Int32Array(p))]}const fQ={kernelName:Tv,backendName:"cpu",kernelFunc:dQ};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pQ(n){const{inputs:t,backend:e}=n,{data:s,indices:r,segmentIds:a}=t;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${r.shape}`);if(a.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${a.shape}`);if(r.shape[0]!==a.shape[0])throw new Error("segmentIds and indices should have same size.");const i=e.data.get(s.dataId).values,l=e.data.get(r.dataId).values,u=e.data.get(a.dataId).values,[h,d]=kS(i,s.shape,s.dtype,l,u,!0);return e.makeTensorInfo(d,s.dtype,h)}const mQ={kernelName:$v,backendName:"cpu",kernelFunc:pQ};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gQ(n){const{inputs:t,backend:e}=n,{data:s,indices:r,segmentIds:a}=t;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${r.shape}`);if(a.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${a.shape}`);if(r.shape[0]!==a.shape[0])throw new Error("segmentIds and indices should have same size.");const i=e.data.get(s.dataId).values,l=e.data.get(r.dataId).values,u=e.data.get(a.dataId).values,[h,d]=kS(i,s.shape,s.dtype,l,u);return e.makeTensorInfo(d,s.dtype,h)}const yQ={kernelName:kv,backendName:"cpu",kernelFunc:gQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bQ(n){const{inputs:t,backend:e,attrs:s}=n,{sparseIndices:r,sparseValues:a,defaultValue:i}=t,{outputShape:l}=s,{sliceRank:u,numUpdates:h,sliceSize:d,strides:p,outputSize:m}=Qo(a,r,l),y=!1,b=e.bufferSync(r);let x;switch(a.dtype){case"bool":{const v=e.bufferSync(a),S=!!e.data.get(i.dataId).values[0];x=To(b,v,l,m,d,h,u,p,S,y);break}case"float32":{const v=e.bufferSync(a),S=e.data.get(i.dataId).values[0];x=To(b,v,l,m,d,h,u,p,S,y);break}case"int32":{const v=e.bufferSync(a),S=e.data.get(i.dataId).values[0];x=To(b,v,l,m,d,h,u,p,S,y);break}case"string":{const v=e.bufferSync(a),S=ki(e.data.get(i.dataId).values[0]);x=To(b,v,l,m,d,h,u,p,S,y);break}default:throw new Error(`Unsupported type ${a.dtype}`)}return e.makeTensorInfo(l,x.dtype,x.values)}const xQ={kernelName:Iv,backendName:"cpu",kernelFunc:bQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vQ(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{numOrSizeSplits:a,axis:i}=s,l=re(i,r.shape)[0],u=Qw(r,a,l),h=new Array(r.shape.length).fill(0),d=r.shape.slice();return u.map(p=>{const m=[...d];m[l]=p;const y=qo({inputs:{x:r},backend:e,attrs:{begin:h,size:m}});return h[l]+=p,y})}const wQ={kernelName:Ng,backendName:"cpu",kernelFunc:vQ};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SQ={kernelName:Ev,backendName:"cpu",kernelFunc:({inputs:n,backend:t})=>{const{x:e}=n,s=t;Lt(e,"square");const r=s.data.get(e.dataId).values,a=new Float32Array(r.length);for(let l=0;l<r.length;++l){const u=r[l];a[l]=u*u}return{dataId:s.write(a,e.shape,e.dtype),shape:e.shape,dtype:e.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CQ=Ce(bd,(n,t)=>{const e=t;return isNaN(n)?NaN:n>0?1:e.alpha}),NQ={kernelName:bd,backendName:"cpu",kernelFunc:CQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TQ(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{begin:a,end:i,strides:l,beginMask:u,endMask:h,ellipsisMask:d,newAxisMask:p,shrinkAxisMask:m}=s;Lt(r,"stridedSlice");const{finalShapeSparse:y,finalShape:b,isIdentity:x,sliceDim0:v,isSimpleSlice:S,begin:C,end:$,strides:T}=_w(r.shape,a,i,l,u,h,d,p,m);let I;if(x)I=Le({inputs:{x:r},backend:e,attrs:{shape:b}});else if(v||S){F(r.shape.length>=1,()=>`Input must have rank at least 1, got: ${r.shape.length}`);const A=Aw(C,$,T),R=qo({inputs:{x:r},backend:e,attrs:{begin:C,size:A}});I=Le({inputs:{x:R},backend:e,attrs:{shape:b}}),e.disposeIntermediateTensorInfo(R)}else{const A=e.bufferSync(r),R=w_(y,A,T,C);I=e.makeTensorInfo(b,R.dtype,R.values)}return I}const $Q={kernelName:Dv,backendName:"cpu",kernelFunc:TQ};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kQ(n){const{inputs:t,backend:e,attrs:s}=n,{separator:r,nGramWidths:a,leftPad:i,rightPad:l,padWidth:u,preserveShortSequences:h}=s,{data:d,dataSplits:p}=t,m=e.data.get(d.dataId).values,y=e.data.get(p.dataId).values,[b,x]=S_(m,y,r,a,i,l,u,h);return[e.makeTensorInfo([b.length],"string",b),e.makeTensorInfo(p.shape,"int32",x)]}const IQ={kernelName:Av,backendName:"cpu",kernelFunc:kQ};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EQ(n){const{inputs:t,backend:e,attrs:s}=n,{skipEmpty:r}=s,{input:a,delimiter:i}=t;if(a.dtype!=="string")throw new Error("Input must be of datatype string");if(a.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${a.shape}`);if(i.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${i.shape}`);const l=e.data.get(a.dataId).values,u=e.data.get(i.dataId).values[0],[h,d,p]=C_(l,u,r),m=d.length;return[e.makeTensorInfo([m,2],"int32",h),e.makeTensorInfo([m],"string",d),e.makeTensorInfo([2],"int32",new Int32Array(p))]}const DQ={kernelName:Rv,backendName:"cpu",kernelFunc:EQ};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AQ(n){const{inputs:t,backend:e,attrs:s}=n,{numBuckets:r}=s,{input:a}=t;if(a.dtype!=="string")throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");const i=e.data.get(a.dataId).values,l=N_(i,r);return e.makeTensorInfo(a.shape,"int32",l)}const RQ={kernelName:Ov,backendName:"cpu",kernelFunc:AQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OQ=Ce(md,n=>Math.tan(n)),_Q={kernelName:md,backendName:"cpu",kernelFunc:OQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FQ=Ce(gd,n=>Math.tanh(n)),LQ={kernelName:gd,backendName:"cpu",kernelFunc:FQ};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zQ(n){const{inputs:t,backend:e}=n,{tensor:s,indices:r,updates:a}=t,{sliceRank:i,numUpdates:l,sliceSize:u,strides:h,outputSize:d}=Qo(a,r,s.shape),p=!1,m=e.bufferSync(r),y=e.bufferSync(a),b=e.bufferSync(s),x=To(m,y,s.shape,d,u,l,i,h,b,p);return e.makeTensorInfo(s.shape,x.dtype,x.values)}const MQ={kernelName:Sv,backendName:"cpu",kernelFunc:zQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BQ(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{reps:a}=s;Lt(r,"tile");const i=$_(e.bufferSync(r),a);return e.makeTensorInfo(i.shape,i.dtype,i.values)}const PQ={kernelName:yd,backendName:"cpu",kernelFunc:BQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VQ(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{k:a,sorted:i}=s;Lt(r,"topk");const l=e.data.get(r.dataId).values,[u,h]=I_(l,r.shape,r.dtype,a,i);return[e.makeTensorInfo(u.shape,u.dtype,u.values),e.makeTensorInfo(h.shape,h.dtype,h.values)]}const UQ={kernelName:_v,backendName:"cpu",kernelFunc:VQ};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GQ(n){const{inputs:t,attrs:e,backend:s}=n,{image:r,transforms:a}=t,{interpolation:i,fillMode:l,fillValue:u,outputShape:h}=e,[d,p,m,y]=r.shape,[b,x]=h??[p,m],v=[d,b,x,y],S=Bt(r.shape),C=S[0],$=S[1],T=S[2],I=Bt(v),A=I[0],R=I[1],L=I[2],_=Gn(r.dtype,mt(v));_.fill(u);const M=s.data.get(r.dataId).values,D=s.data.get(a.dataId).values;for(let et=0;et<d;++et){const nt=a.shape[0]===1?D:D.subarray(et*8,et*8+8);for(let tt=0;tt<b;++tt)for(let U=0;U<x;++U)for(let Y=0;Y<y;++Y){let Z;const G=nt[6]*U+nt[7]*tt+1;if(G===0)continue;const O=(nt[0]*U+nt[1]*tt+nt[2])/G,V=(nt[3]*U+nt[4]*tt+nt[5])/G,P=bk(O,m,l),H=bk(V,p,l);switch(i){case"nearest":Z=KQ(M,p,m,C,$,T,et,H,P,Y,u);break;case"bilinear":Z=YQ(M,p,m,C,$,T,et,H,P,Y,u);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${i}`)}const Q=et*A+tt*R+U*L+Y;_[Q]=Z}return s.makeTensorInfo(v,r.dtype,_)}return{dataId:s.write(_,v,r.dtype),shape:r.shape,dtype:r.dtype}}const WQ={kernelName:Fv,backendName:"cpu",kernelFunc:GQ};function bk(n,t,e){switch(e){case"reflect":return HQ(n,t);case"wrap":return jQ(n,t);case"nearest":return XQ(n,t);case"constant":default:return qQ(n)}}function HQ(n,t){let e=n;if(e<0)if(t<=1)e=0;else{const s=2*t;e<s&&(e=s*Math.trunc(-e/s)+e),e=e<-t?e+s:-e-1}else if(e>t-1)if(t<=1)e=0;else{const s=2*t;e-=s*Math.trunc(e/s),e>=t&&(e=s-e-1)}return _o(0,e,t-1)}function jQ(n,t){let e=n;if(e<0)if(t<=1)e=0;else{const s=t-1;e+=t*(Math.trunc(-e/s)+1)}else if(e>t-1)if(t<=1)e=0;else{const s=t-1;e-=t*Math.trunc(e/s)}return _o(0,e,t-1)}function qQ(n,t){return n}function XQ(n,t){return _o(0,n,t-1)}function nh(n,t,e,s,r,a,i,l,u,h,d){const p=i*s+l*r+u*a+h;return 0<=l&&l<t&&0<=u&&u<e?n[p]:d}function KQ(n,t,e,s,r,a,i,l,u,h,d){const p=Math.round(l),m=Math.round(u);return nh(n,t,e,s,r,a,i,p,m,h,d)}function YQ(n,t,e,s,r,a,i,l,u,h,d){const p=Math.floor(l),m=Math.floor(u),y=p+1,b=m+1,x=(b-u)*nh(n,t,e,s,r,a,i,p,m,h,d)+(u-m)*nh(n,t,e,s,r,a,i,p,b,h,d),v=(b-u)*nh(n,t,e,s,r,a,i,y,m,h,d)+(u-m)*nh(n,t,e,s,r,a,i,y,b,h,d);return(y-l)*x+(l-p)*v}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZQ(n){const{inputs:t,attrs:e,backend:s}=n,{axis:r}=e,{x:a}=t;Lt(a,"unique");const i=s.data.get(a.dataId).values,{outputValues:l,outputShape:u,indices:h}=E_(i,r,a.shape,a.dtype);return[s.makeTensorInfo(u,a.dtype,l),s.makeTensorInfo([h.length],"int32",h)]}const QQ={kernelName:Lv,backendName:"cpu",kernelFunc:ZQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JQ(n){const{inputs:t,backend:e,attrs:s}=n,{value:r}=t;let{axis:a}=s;a<0&&(a+=r.shape.length);const i=r.shape.length,l=r.shape[a],u=new Array(i-1);let h=0;for(let y=0;y<i;y++)y!==a&&(u[h++]=r.shape[y]);const d=new Array(i).fill(0),p=r.shape.slice();p[a]=1;const m=new Array(l);for(let y=0;y<m.length;y++){d[a]=y;const b=qo({inputs:{x:r},backend:e,attrs:{begin:d,size:p}});m[y]=Le({inputs:{x:b},backend:e,attrs:{shape:u}}),e.disposeIntermediateTensorInfo(b)}return m}const tJ={kernelName:kg,backendName:"cpu",kernelFunc:JQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eJ(n){const{inputs:t,backend:e,attrs:s}=n,{x:r,segmentIds:a}=t,{numSegments:i}=s;Lt(r,"unsortedSegmentSum");const l=r.shape.length,u=a.shape.length,h=[],d=[],p=l-u;let m=a;for(let b=0;b<p;++b){const x=hm({inputs:{input:m},backend:e,attrs:{dim:b+1}});m=x,d.push(x)}for(let b=0;b<i;++b){const x=Pi(b,"int32"),v=e.makeTensorInfo([],"int32",x),S=WO({inputs:{a:v,b:m},backend:e}),C=Li({inputs:{x:S},backend:e,attrs:{dtype:"float32"}}),$=py({inputs:{a:C,b:r},backend:e}),T=Md({inputs:{x:$},backend:e,attrs:{axis:0,keepDims:!1}});h.push(T),d.push(v),d.push(S),d.push(C),d.push($),d.push(T)}const y=W_({inputs:h,backend:e,attrs:{axis:0}});return d.forEach(b=>e.disposeIntermediateTensorInfo(b)),y}const nJ={kernelName:Ig,backendName:"cpu",kernelFunc:eJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sJ=[ZK,AX,JK,e7,zX,s7,a7,o7,u7,h7,f7,m7,y7,v7,S7,T7,k7,E7,A7,KK,O7,F7,z7,BX,B7,FX,VX,V7,RX,G7,H7,j7,X7,Y7,Q7,t9,n9,r9,i9,l9,c9,d9,p9,g9,y9,x9,w9,C9,N9,T9,$9,I9,A9,UK,O9,UX,V9,GX,U9,HX,X9,K9,Z9,qX,KX,J9,eY,sY,aY,ZX,JX,OX,oY,W7,uY,hY,fY,GK,eK,sK,mY,aK,yY,vY,SY,TY,kY,EY,DY,oK,RY,_Y,LY,MY,PY,UY,WY,uK,jY,KY,QY,hK,fK,eZ,rZ,oZ,mK,uZ,hZ,dZ,H_,gZ,HK,bK,bZ,vZ,SZ,NZ,_X,m1,$Z,jK,qK,XK,IZ,DZ,RZ,_Z,LZ,zZ,BZ,$K,VZ,jZ,XZ,QZ,IK,tQ,nQ,rQ,EK,YY,oQ,uQ,hQ,fQ,mQ,yQ,xQ,wQ,RK,SQ,_K,LK,NQ,$Q,IQ,DQ,RQ,PK,E9,_Q,LQ,MQ,PQ,UQ,WQ,gK,QQ,tJ,nJ,cZ];for(const n of sJ)BI(n);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Co={},hp={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function rJ(n,t){Co[n]=t}function Vr(n,t){if(!(n in Co)||t!=null){const s=iJ(n,t);if(s!==null)Co[n]=s;else return console.log("Could not get context for WebGL version",n),null}const e=Co[n];return e==null||e.isContextLost()?(delete Co[n],Vr(n)):(e.disable(e.DEPTH_TEST),e.disable(e.STENCIL_TEST),e.disable(e.BLEND),e.disable(e.DITHER),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SAMPLE_COVERAGE),e.enable(e.SCISSOR_TEST),e.enable(e.CULL_FACE),e.cullFace(e.BACK),Co[n])}function aJ(n){if(!ut().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&n===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function iJ(n,t){if(n!==1&&n!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const e=t??aJ(n);return e.addEventListener("webglcontextlost",s=>{s.preventDefault(),delete Co[n]},!1),ut().getBool("SOFTWARE_WEBGL_ENABLED")&&(hp.failIfMajorPerformanceCaveat=!1),n===1?e.getContext("webgl",hp)||e.getContext("experimental-webgl",hp):e.getContext("webgl2",hp)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var bh;(function(n){n[n.DENSE=0]="DENSE",n[n.SHARED_BATCH=1]="SHARED_BATCH"})(bh||(bh={}));var Zs;(function(n){n[n.RENDER=0]="RENDER",n[n.UPLOAD=1]="UPLOAD",n[n.PIXELS=2]="PIXELS",n[n.DOWNLOAD=3]="DOWNLOAD"})(Zs||(Zs={}));var Vn;(function(n){n[n.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",n[n.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",n[n.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",n[n.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",n[n.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(Vn||(Vn={}));function Bd(n,t){return[t,n]}function oJ(n,t){return n*t}function dp(n){const t=mt(n),e=Math.ceil(t/4);return Cx(e)}function Mu(n,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(n/2))]}function lJ(n,t){const[e,s]=Mu(n,t);return e*s*4}function RS(n,t){const e=n;let s,r,a,i,l,u,h,d,p,m;return ut().getNumber("WEBGL_VERSION")===2?(s=e.R32F,r=e.R16F,a=e.RGBA16F,i=e.RGBA32F,l=e.RED,h=4,d=1,p=e.HALF_FLOAT,m=e.FLOAT,u=e.RGBA8):(s=n.RGBA,r=n.RGBA,a=n.RGBA,i=e.RGBA,l=n.RGBA,h=4,d=4,p=t!=null?t.HALF_FLOAT_OES:null,m=n.FLOAT,u=n.RGBA),{internalFormatFloat:s,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:a,internalFormatPackedFloat:i,textureFormatFloat:l,downloadTextureFormat:u,downloadUnpackNumChannels:h,defaultNumChannels:d,textureTypeHalfFloat:p,textureTypeFloat:m}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function At(n,t){const e=t();return ut().getBool("DEBUG")&&uJ(n),e}function uJ(n){const t=n.getError();if(t!==n.NO_ERROR)throw new Error("WebGL Error: "+fJ(n,t))}const cJ=596e-10,hJ=65504;function dJ(n){return!!(ut().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||n===0||cJ<Math.abs(n)&&Math.abs(n)<hJ)}function fJ(n,t){switch(t){case n.NO_ERROR:return"NO_ERROR";case n.INVALID_ENUM:return"INVALID_ENUM";case n.INVALID_VALUE:return"INVALID_VALUE";case n.INVALID_OPERATION:return"INVALID_OPERATION";case n.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case n.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case n.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${t}`}}function fp(n,t){return ja(n,()=>n.getExtension(t),'Extension "'+t+'" not supported on this browser.')}function pJ(n,t){const e=ja(n,()=>n.createShader(n.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(At(n,()=>n.shaderSource(e,t)),At(n,()=>n.compileShader(e)),n.getShaderParameter(e,n.COMPILE_STATUS)===!1)throw console.log(n.getShaderInfoLog(e)),new Error("Failed to compile vertex shader.");return e}function mJ(n,t){const e=ja(n,()=>n.createShader(n.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(At(n,()=>n.shaderSource(e,t)),At(n,()=>n.compileShader(e)),ut().get("ENGINE_COMPILE_ONLY"))return e;if(n.getShaderParameter(e,n.COMPILE_STATUS)===!1)throw j_(t,n.getShaderInfoLog(e)),new Error("Failed to compile fragment shader.");return e}const gJ=/ERROR: [0-9]+:([0-9]+):/g;function j_(n,t){const e=gJ.exec(t);if(e==null){console.log(`Couldn't parse line number in error: ${t}`),console.log(n);return}const s=+e[1],r=n.split(`
`),a=r.length.toString().length+2,i=r.map((p,m)=>eu((m+1).toString(),a)+p);let l=0;for(let p=0;p<i.length;p++)l=Math.max(i[p].length,l);const u=i.slice(0,s-1),h=i.slice(s-1,s),d=i.slice(s);console.log(u.join(`
`)),console.log(t.split(`
`)[0]),console.log(`%c ${eu(h[0],l)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(d.join(`
`))}function yJ(n){return ja(n,()=>n.createProgram(),"Unable to create WebGLProgram.")}function bJ(n,t){if(At(n,()=>n.linkProgram(t)),!ut().get("ENGINE_COMPILE_ONLY")&&n.getProgramParameter(t,n.LINK_STATUS)===!1)throw console.log(n.getProgramInfoLog(t)),new Error("Failed to link vertex and fragment shaders.")}function rx(n,t){if(At(n,()=>n.validateProgram(t)),n.getProgramParameter(t,n.VALIDATE_STATUS)===!1)throw console.log(n.getProgramInfoLog(t)),new Error("Shader program validation failed.")}function xJ(n,t){const e=ja(n,()=>n.createBuffer(),"Unable to create WebGLBuffer");return At(n,()=>n.bindBuffer(n.ARRAY_BUFFER,e)),At(n,()=>n.bufferData(n.ARRAY_BUFFER,t,n.STATIC_DRAW)),e}function vJ(n,t){const e=ja(n,()=>n.createBuffer(),"Unable to create WebGLBuffer");return At(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,e)),At(n,()=>n.bufferData(n.ELEMENT_ARRAY_BUFFER,t,n.STATIC_DRAW)),e}function wJ(n){return ja(n,()=>n.createTexture(),"Unable to create WebGLTexture.")}function SJ(n,t){const e=ut().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(n<=0||t<=0){const s=`[${n}x${t}]`;throw new Error("Requested texture size "+s+" is invalid.")}if(n>e||t>e){const s=`[${n}x${t}]`,r=`[${e}x${e}]`;throw new Error("Requested texture size "+s+" greater than WebGL maximum on this browser / GPU "+r+".")}}function CJ(n){return ja(n,()=>n.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function xk(n,t,e,s,r,a,i){const l=n.getAttribLocation(t,e);return l===-1?!1:(At(n,()=>n.bindBuffer(n.ARRAY_BUFFER,s)),At(n,()=>n.vertexAttribPointer(l,r,n.FLOAT,!1,a,i)),At(n,()=>n.enableVertexAttribArray(l)),!0)}function NJ(n,t,e){EJ(n,e),At(n,()=>n.activeTexture(n.TEXTURE0+e)),At(n,()=>n.bindTexture(n.TEXTURE_2D,t))}function TJ(n,t,e){return ja(n,()=>n.getUniformLocation(t,e),'uniform "'+e+'" not present in program.')}function $J(n,t,e){return n.getUniformLocation(t,e)}function kJ(n,t,e,s){At(n,()=>NJ(n,t,s)),At(n,()=>n.uniform1i(e,s))}function ax(n,t,e){At(n,()=>n.bindFramebuffer(n.FRAMEBUFFER,e)),At(n,()=>n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,t,0))}function vk(n,t){At(n,()=>n.bindFramebuffer(n.FRAMEBUFFER,t)),At(n,()=>n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,null,0))}function pp(n){const t=n.checkFramebufferStatus(n.FRAMEBUFFER);if(t!==n.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+IJ(n,t))}function IJ(n,t){switch(t){case n.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case n.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case n.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case n.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${t}`}}function ja(n,t,e){const s=At(n,()=>t());if(s==null)throw new Error(e);return s}function EJ(n,t){const e=n.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,s=t+n.TEXTURE0;if(s<n.TEXTURE0||s>e){const r=`[gl.TEXTURE0, gl.TEXTURE${e}]`;throw new Error(`textureUnit must be in ${r}.`)}}function xu(n,t=2){return mt(n.slice(0,n.length-t))}function vu(n){if(n.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[n.length>1?n[n.length-2]:1,n[n.length-1]]}function mp(n){let t=[1,1,1];return n.length===0||n.length===1&&n[0]===1||(t=[xu(n),...vu(n)]),t}function DJ(n,t=!1){let e=ut().getNumber("WEBGL_MAX_TEXTURE_SIZE"),s=ut().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");s===1/0&&ut().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(s=e/2),t&&(e=e*2,s=s*2,n=n.map((l,u)=>u>=n.length-2?A1(n[u]):n[u]),n.length===1&&(n=[2,n[0]])),n.length!==2&&(n=Bi(n).newShape);let r=mt(n),a=null;n.length<=1&&r<=e?a=[1,r]:n.length===2&&n[0]<=e&&n[1]<=e?a=n:n.length===3&&n[0]*n[1]<=e&&n[2]<=e?a=[n[0]*n[1],n[2]]:n.length===3&&n[0]<=e&&n[1]*n[2]<=e?a=[n[0],n[1]*n[2]]:n.length===4&&n[0]*n[1]*n[2]<=e&&n[3]<=e?a=[n[0]*n[1]*n[2],n[3]]:n.length===4&&n[0]<=e&&n[1]*n[2]*n[3]<=e&&(a=[n[0],n[1]*n[2]*n[3]]);const i=a!=null&&Math.max(...a)>s&&Math.min(...a)<=(t?2:1)&&Math.min(...a)>0;if(a==null||i)if(t){const l=xu(n);let u=2,h=2;n.length&&([u,h]=vu(n)),r=l*(u/2)*(h/2),a=Cx(r).map(d=>d*2)}else a=Cx(r);return a}function gp(n){return n%2===0}function fm(n,t){if(n=n.slice(-2),t=t.slice(-2),de(n,t)||!n.length||!t.length||n[0]===0||n[1]===0||t[0]===0||t[1]===0)return!0;if(n.length!==t.length){const e=n[n.length-1],s=t[t.length-1];if(e===s||gp(e)&&gp(s)&&(n[0]===1||t[0]===1))return!0}return n[1]===t[1]&&gp(n[0])&&gp(t[0])}let ix,ox;function AJ(n){if(ix==null){const t=Vr(n);ix=t.getParameter(t.MAX_TEXTURE_SIZE)}return ix}function RJ(n){if(ox==null){const t=Vr(n);ox=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,ox)}function OJ(n){if(n===0)return 0;let t;const e=Vr(n);return br(e,"EXT_disjoint_timer_query_webgl2")&&n===2?t=2:br(e,"EXT_disjoint_timer_query")?t=1:t=0,t}function br(n,t){return n.getExtension(t)!=null}function wk(n){try{if(Vr(n)!=null)return!0}catch(t){return console.log("Error when getting WebGL context: ",t),!1}return!1}function _J(n){if(n===0)return!1;const t=Vr(n);if(n===1){if(!br(t,"OES_texture_float"))return!1}else if(!br(t,"EXT_color_buffer_float"))return!1;return y1(t)}function FJ(n){if(n===0)return!1;const t=Vr(n);if(n===1){if(!br(t,"OES_texture_float")||!br(t,"WEBGL_color_buffer_float"))return!1}else{if(br(t,"EXT_color_buffer_float"))return y1(t);const s="EXT_color_buffer_half_float";if(br(t,s)){const r=t.getExtension(s);return LJ(t,r)}return!1}return y1(t)}function y1(n){const t=RS(n),e=n.createTexture();n.bindTexture(n.TEXTURE_2D,e),n.texImage2D(n.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);const a=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,a),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,e,0);const i=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;return n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteTexture(e),n.deleteFramebuffer(a),i}function LJ(n,t){const e=RS(n,t),s=n.createTexture();n.bindTexture(n.TEXTURE_2D,s),n.texImage2D(n.TEXTURE_2D,0,e.internalFormatHalfFloat,1,1,0,e.textureFormatFloat,e.textureTypeHalfFloat,null);const i=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,i),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,s,0);const l=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;return n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteTexture(s),n.deleteFramebuffer(i),l}function zJ(n){return n!==2?!1:Vr(n).fenceSync!=null}function Pd(n,t){Array.isArray(n)||(n=[n]),n.forEach(e=>{e!=null&&F(e.dtype!=="complex64",()=>`${t} does not support complex64 tensors in the WebGL backend.`)})}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mt=ut();Mt.registerFlag("HAS_WEBGL",()=>Mt.getNumber("WEBGL_VERSION")>0);Mt.registerFlag("WEBGL_VERSION",()=>wk(2)?2:wk(1)?1:0);Mt.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);Mt.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>Mt.get("WEBGL_VERSION")===2);Mt.registerFlag("WEBGL_CPU_FORWARD",()=>!0);Mt.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);Mt.registerFlag("WEBGL_PACK",()=>Mt.getBool("HAS_WEBGL"));Mt.registerFlag("WEBGL_PACK_NORMALIZATION",()=>Mt.getBool("WEBGL_PACK"));Mt.registerFlag("WEBGL_PACK_CLIP",()=>Mt.getBool("WEBGL_PACK"));Mt.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>Mt.getBool("WEBGL_PACK"));Mt.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>Mt.getBool("WEBGL_PACK"));Mt.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>Mt.getBool("WEBGL_PACK"));Mt.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>Mt.getBool("WEBGL_PACK"));Mt.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>Mt.getBool("WEBGL_PACK"));Mt.registerFlag("WEBGL_PACK_REDUCE",()=>Mt.getBool("WEBGL_PACK"));Mt.registerFlag("WEBGL_LAZILY_UNPACK",()=>Mt.getBool("WEBGL_PACK"));Mt.registerFlag("WEBGL_CONV_IM2COL",()=>Mt.getBool("WEBGL_PACK"));Mt.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>Mt.getBool("WEBGL_PACK"));Mt.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>AJ(Mt.getNumber("WEBGL_VERSION")));Mt.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>RJ(Mt.getNumber("WEBGL_VERSION")));Mt.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const n=Mt.getNumber("WEBGL_VERSION");return n===0?0:OJ(n)});Mt.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>Mt.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!QI());Mt.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>_J(Mt.getNumber("WEBGL_VERSION")));Mt.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>Mt.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:Mt.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));Mt.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>FJ(Mt.getNumber("WEBGL_VERSION")));Mt.registerFlag("WEBGL_FENCE_API_ENABLED",()=>zJ(Mt.getNumber("WEBGL_VERSION")));Mt.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>Mt.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);Mt.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,n=>{if(typeof n!="number")throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${n}.`);if(n<0&&n!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${n}.`)});Mt.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>QI()?1:-1,n=>{if(typeof n!="number")throw new Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${n}.`);if(n<0&&n!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${n}.`)});Mt.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);Mt.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);Mt.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);Mt.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);Mt.registerFlag("WEBGL_EXP_CONV",()=>!1);Mt.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>Mt.getBool("IS_TEST"));Mt.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);Mt.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);Mt.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);Mt.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ds(){let n,t,e,s,r,a,i,l,u,h;return ut().getNumber("WEBGL_VERSION")===2?(n="#version 300 es",t="in",e="out",s="in",r="texture",a="outputColor",i="out vec4 outputColor;",l=ut().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",u="",h=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(n="",t="attribute",e="varying",s="varying",r="texture2D",a="gl_FragColor",i="",l=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,u=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,h=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:n,attribute:t,varyingVs:e,varyingFs:s,texture2D:r,output:a,defineOutput:i,defineSpecialNaN:l,defineSpecialInf:u,defineRound:h}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function el(n,t,e="index"){const s=Bt(t);return s.map((r,a)=>{const i=`int ${n[a]} = ${e} / ${r}`,l=a===s.length-1?`int ${n[a+1]} = ${e} - ${n[a]} * ${r}`:`index -= ${n[a]} * ${r}`;return`${i}; ${l};`}).join("")}function my(n,t,e="index"){const s=Bt(t);return s.map((r,a)=>{const i=`int ${n[a]} = ${e} / outShapeStrides[${a}]`,l=a===s.length-1?`int ${n[a+1]} = ${e} - ${n[a]} * outShapeStrides[${a}]`:`index -= ${n[a]} * outShapeStrides[${a}]`;return`${i}; ${l};`}).join("")}function MJ(n,t){const e=n.length,s=n.map(a=>`${t}[${a}]`),r=new Array(e-1);r[e-2]=s[e-1];for(let a=e-3;a>=0;--a)r[a]=`(${r[a+1]} * ${s[a+1]})`;return r}function BJ(n,t,e="index"){const s=n.map((a,i)=>i),r=MJ(s,t);return r.map((a,i)=>{const l=`int ${n[i]} = ${e} / ${r[i]}`,u=i===r.length-1?`int ${n[i+1]} = ${e} - ${n[i]} * ${r[i]}`:`index -= ${n[i]} * ${r[i]}`;return`${l}; ${u};`}).join("")}function OS(n){const t=Bt(n).map(e=>e.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${t[0]} + coords.y * ${t[1]} + coords.z;
  }
`}function _S(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const q_=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:X_}=e6;function PJ(n,t,e){const s=[];if(n.forEach(y=>{const b=mt(y.shapeInfo.logicalShape);if(y.shapeInfo.isUniform?s.push(`uniform float ${y.name}${b>1?`[${b}]`:""};`):(s.push(`uniform sampler2D ${y.name};`),s.push(`uniform int offset${y.name};`)),e.enableShapeUniforms){const{uniformShape:x}=FS(e.packedInputs,y.shapeInfo.logicalShape,y.shapeInfo.texShape);switch(x.length){case 1:s.push(`uniform int ${y.name}Shape;`);break;case 2:s.push(`uniform ivec2 ${y.name}Shape;`);break;case 3:s.push(`uniform ivec3 ${y.name}Shape;`);break;case 4:s.push(`uniform ivec4 ${y.name}Shape;`);break}s.push(`uniform ivec2 ${y.name}TexShape;`)}}),e.enableShapeUniforms){switch(t.logicalShape.length){case 1:s.push("uniform int outShape;");break;case 2:s.push("uniform ivec2 outShape;"),s.push("uniform int outShapeStrides;");break;case 3:s.push("uniform ivec3 outShape;"),s.push("uniform ivec2 outShapeStrides;");break;case 4:s.push("uniform ivec4 outShape;"),s.push("uniform ivec3 outShapeStrides;");break}s.push("uniform ivec2 outTexShape;")}e.customUniforms&&e.customUniforms.forEach(y=>{s.push(`uniform ${y.type} ${y.name}${y.arrayIndex?`[${y.arrayIndex}]`:""};`)});const r=s.join(`
`),a=n.map(y=>VJ(y,t,e.packedInputs,e.enableShapeUniforms)).join(`
`),i=t.texShape,l=ds(),u=WJ(l);let h,d,p=qJ(l);return t.isPacked?(h=UJ(t.logicalShape,i,e.enableShapeUniforms),d=jJ(l)):(h=GJ(t.logicalShape,i,e.enableShapeUniforms),d=HJ(l)),e.packedInputs&&(p+=ZJ),[p,u,d,r,h,a,e.userCode].join(`
`)}function Bu(n,t=!1){const e=n.shapeInfo.logicalShape;switch(e.length){case 0:return utt(n,t);case 1:return htt(n,t);case 2:return ftt(n,t);case 3:return mtt(n,t);case 4:return ytt(n,t);case 5:return btt(n);case 6:return xtt(n);default:throw new Error(`${e.length}-D input sampling is not yet supported`)}}function K_(n,t){switch(n.shapeInfo.logicalShape.length){case 0:return ltt(n);case 1:return ctt(n,t);case 2:return dtt(n,t);case 3:return ptt(n,t);default:return gtt(n,t)}}function VJ(n,t,e=!1,s){let r="";e?r+=K_(n,s):r+=Bu(n,s);const a=n.shapeInfo.logicalShape,i=t.logicalShape;return a.length<=i.length&&(e?r+=vtt(n,t):r+=wtt(n,t)),r}function UJ(n,t,e){switch(n.length){case 0:return Y_();case 1:return QJ(n,t,e);case 2:return itt(n,t,e);case 3:return ttt(n,t,e);default:return ntt(n,t,e)}}function GJ(n,t,e){switch(n.length){case 0:return Y_();case 1:return JJ(n,t,e);case 2:return ott(n,t,e);case 3:return ett(n,t,e);case 4:return stt(n,t,e);case 5:return rtt(n,t);case 6:return att(n,t);default:throw new Error(`${n.length}-D output sampling is not yet supported`)}}function WJ(n){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${n.texture2D}(textureSampler, uv).r;
    }
  `}function HJ(n){return`
    void setOutput(float val) {
      ${n.output} = vec4(val, 0, 0, 0);
    }
  `}function jJ(n){return`
    void setOutput(vec4 val) {
      ${n.output} = val;
    }
  `}function qJ(n){return`${n.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${n.varyingFs} vec2 resultUV;
    ${n.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${n.defineSpecialNaN}
    ${n.defineSpecialInf}
    ${n.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${XJ}
    ${KJ}
    ${YJ}
  `}const XJ=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,KJ=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,YJ=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,ZJ=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function Y_(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function QJ(n,t,e){const s=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];return s[0]===1?e?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${s[1]}.0);
      }
    `:s[1]===1?e?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${s[0]}.0);
      }
    `:e?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      return 2 * (resTexRC.x * ${s[1]} + resTexRC.y);
    }
  `}function JJ(n,t,e){return t[0]===1?e?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${t[1]}.0);
      }
    `:t[1]===1?e?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${t[0]}.0);
      }
    `:e?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${t[0]}, ${t[1]}));
      return resTexRC.x * ${t[1]} + resTexRC.y;
    }
  `}function ttt(n,t,e){if(e)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const s=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],r=Math.ceil(n[2]/2),a=r*Math.ceil(n[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      int b = index / ${a};
      index -= b * ${a};

      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec3(b, r, c);
    }
  `}function ett(n,t,e){if(e)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${my(["r","c","d"],n)}
    return ivec3(r, c, d);
  }
`;const s=el(["r","c","d"],n);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;
      ${s}
      return ivec3(r, c, d);
    }
  `}function ntt(n,t,e){if(e)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const s=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],r=Math.ceil(n[n.length-1]/2),a=r*Math.ceil(n[n.length-2]/2);let i=a,l="",u="b, r, c";for(let h=2;h<n.length-1;h++)i*=n[n.length-h-1],l=`
      int b${h} = index / ${i};
      index -= b${h} * ${i};
    `+l,u=`b${h}, `+u;return`
    ivec${n.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      ${l}

      int b = index / ${a};
      index -= b * ${a};

      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec${n.length}(${u});
    }
  `}function stt(n,t,e){if(e)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${my(["r","c","d","d2"],n)}
      return ivec4(r, c, d, d2);
    }
  `;const s=el(["r","c","d","d2"],n);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;
      ${s}
      return ivec4(r, c, d, d2);
    }
  `}function rtt(n,t){const e=el(["r","c","d","d2","d3"],n);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${t[0]},
                             ${t[1]}));

      int index = resTexRC.x * ${t[1]} + resTexRC.y;

      ${e}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function att(n,t){const e=el(["r","c","d","d2","d3","d4"],n);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;

      ${e}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function itt(n,t,e){const s=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(de(n,t))return e?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${s[0]}, ${s[1]}));
      }
    `;const r=Math.ceil(n[1]/2);return e?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));

      int index = resTexRC.x * ${s[1]} + resTexRC.y;
      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec2(r, c);
    }
  `}function ott(n,t,e){return de(n,t)?e?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${t[0]}, ${t[1]}));
      }
    `:n[1]===1?e?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${t[0]}, ${t[1]}));
        int index = resTexRC.x * ${t[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:n[0]===1?e?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${t[0]}, ${t[1]}));
        int index = resTexRC.x * ${t[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:e?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;
      int r = index / ${n[1]};
      int c = index - r * ${n[1]};
      return ivec2(r, c);
    }
  `}function nl(n){return`offset${n}`}function ltt(n){const t=n.name,e="get"+t.charAt(0).toUpperCase()+t.slice(1),s=ds();return`
    vec4 ${e}() {
      return ${s.texture2D}(${t}, halfCR);
    }
  `}function utt(n,t){const e=n.name,s="get"+e.charAt(0).toUpperCase()+e.slice(1);if(n.shapeInfo.isUniform)return`float ${s}() {return ${e};}`;const[r,a]=n.shapeInfo.texShape;if(r===1&&a===1)return`
      float ${s}() {
        return sampleTexture(${e}, halfCR);
      }
    `;const i=nl(e);if(t)return`
    float ${s}() {
      vec2 uv = uvFromFlat(${e}TexShape[0], ${e}TexShape[1], ${i});
      return sampleTexture(${e}, uv);
    }
  `;const[l,u]=n.shapeInfo.texShape;return`
    float ${s}() {
      vec2 uv = uvFromFlat(${l}, ${u}, ${i});
      return sampleTexture(${e}, uv);
    }
  `}function ctt(n,t){const e=n.name,s="get"+e.charAt(0).toUpperCase()+e.slice(1),r=n.shapeInfo.texShape,a=ds();if(t)return`
    vec4 ${s}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${e}TexShape[0]) / 2.0), ceil(float(${e}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${a.texture2D}(${e}, uv);
    }
  `;const i=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)];return`
    vec4 ${s}(int index) {
      vec2 uv = packedUVfrom1D(
        ${i[0]}, ${i[1]}, index);
      return ${a.texture2D}(${e}, uv);
    }
  `}function htt(n,t){const e=n.name,s="get"+e.charAt(0).toUpperCase()+e.slice(1);if(n.shapeInfo.isUniform)return`
      float ${s}(int index) {
        ${Pu(n)}
      }
    `;const r=n.shapeInfo.texShape,a=r[0],i=r[1];if(i===1&&a===1)return`
      float ${s}(int index) {
        return sampleTexture(${e}, halfCR);
      }
    `;const l=nl(e);return i===1?t?`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${l}) + 0.5) / float(${e}TexShape[0]));
        return sampleTexture(${e}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${l}) + 0.5) / ${a}.0);
        return sampleTexture(${e}, uv);
      }
    `:a===1?t?`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${l}) + 0.5) / float(${e}TexShape[1]), 0.5);
        return sampleTexture(${e}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${l}) + 0.5) / ${i}.0, 0.5);
        return sampleTexture(${e}, uv);
      }
    `:t?`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${e}TexShape[0], ${e}TexShape[1], index + ${l});
      return sampleTexture(${e}, uv);
    }
  `:`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${a}, ${i}, index + ${l});
      return sampleTexture(${e}, uv);
    }
  `}function dtt(n,t){const e=n.shapeInfo.logicalShape,s=n.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),a=n.shapeInfo.texShape,i=a[0],l=a[1],u=ds();if(a!=null&&de(e,a))return t?`
      vec4 ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);

        return ${u.texture2D}(${s}, uv);
      }
    `:`
      vec4 ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${l}.0, ${i}.0);

        return ${u.texture2D}(${s}, uv);
      }
    `;if(t)return`
    vec4 ${r}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${u.texture2D}(${s}, uv);
    }
  `;const h=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],d=Math.ceil(e[1]/2);return`
    vec4 ${r}(int row, int col) {
      vec2 uv = packedUVfrom2D(${d}, ${h[0]}, ${h[1]}, row, col);
      return ${u.texture2D}(${s}, uv);
    }
  `}function ftt(n,t){const e=n.shapeInfo.logicalShape,s=n.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),a=n.shapeInfo.texShape;if(a!=null&&de(e,a)){if(t)return`
      float ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `;const m=a[0],y=a[1];return`
    float ${r}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${y}.0, ${m}.0);
      return sampleTexture(${s}, uv);
    }
  `}const{newShape:i,keptDims:l}=Bi(e),u=i;if(u.length<e.length){const m=Vu(n,u),y=["row","col"];return`
      ${Bu(m,t)}
      float ${r}(int row, int col) {
        return ${r}(${Uu(y,l)});
      }
    `}if(n.shapeInfo.isUniform)return`
      float ${r}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${e[1]}, 1)));
        ${Pu(n)}
      }
    `;const h=a[0],d=a[1],p=nl(s);return d===1?t?`
      float ${r}(int row, int col) {
        float index = dot(vec3(row, col, ${p}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${s}TexShape[0]));
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col) {
      float index = dot(vec3(row, col, ${p}), vec3(${e[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${h}.0);
      return sampleTexture(${s}, uv);
    }
  `:h===1?t?`
      float ${r}(int row, int col) {
        float index = dot(vec3(row, col, ${p}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${s}TexShape[1]), 0.5);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col) {
      float index = dot(vec3(row, col, ${p}), vec3(${e[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${d}.0, 0.5);
      return sampleTexture(${s}, uv);
    }
  `:t?`
      float ${r}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${s}Shape[1] + col + ${p};
        vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
        return sampleTexture(${s}, uv);
      }
    `:`
  float ${r}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${e[1]} + col + ${p};
    vec2 uv = uvFromFlat(${h}, ${d}, index);
    return sampleTexture(${s}, uv);
  }
`}function ptt(n,t){const e=n.shapeInfo.logicalShape,s=n.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),a=n.shapeInfo.texShape,i=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];if(e[0]===1){const m=e.slice(1),y=[1,2],b=Vu(n,m),x=["b","row","col"];return`
        ${K_(b,t)}
        vec4 ${r}(int b, int row, int col) {
          return ${r}(${Uu(x,y)});
        }
      `}const l=ds();if(t)return`
    vec4 ${r}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${l.texture2D}(${s}, uv);
    }
  `;const u=i[0],h=i[1],d=Math.ceil(e[2]/2),p=d*Math.ceil(e[1]/2);return`
    vec4 ${r}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${u}, ${h}, ${p}, ${d}, b, row, col);
      return ${l.texture2D}(${s}, uv);
    }
  `}function mtt(n,t){const e=n.shapeInfo.logicalShape,s=n.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),a=e[1]*e[2],i=e[2],{newShape:l,keptDims:u}=Bi(e),h=l;if(h.length<e.length){const x=Vu(n,h),v=["row","col","depth"];return`
        ${Bu(x,t)}
        float ${r}(int row, int col, int depth) {
          return ${r}(${Uu(v,u)});
        }
      `}if(n.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${a}, ${i}, 1)));
        ${Pu(n)}
      }
    `;const d=n.shapeInfo.texShape,p=d[0],m=d[1],y=n.shapeInfo.flatOffset;if(m===a&&y==null)return t?`
      float ${r}(int row, int col, int depth) {
        int stride1 = ${s}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
        float ${r}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${i}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${m}.0, ${p}.0);
          return sampleTexture(${s}, uv);
        }
      `;if(m===i&&y==null)return t?`
      float ${r}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${s}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${e[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${m}.0, ${p}.0);
      return sampleTexture(${s}, uv);
    }
  `;const b=nl(s);return t?`
    float ${r}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${s}Shape[1] * ${s}Shape[2];
      int stride1 = ${s}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${b};
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
      return sampleTexture(${s}, uv);
    }
    `:`
      float ${r}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${a} + col * ${i} + depth + ${b};
        vec2 uv = uvFromFlat(${p}, ${m}, index);
        return sampleTexture(${s}, uv);
      }
  `}function gtt(n,t){const e=n.name,s="get"+e.charAt(0).toUpperCase()+e.slice(1),r=ds();if(t)return`
    vec4 ${s}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${e}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${e}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${e}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${e}TexShape[0]) / 2.0), ceil(float(${e}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${r.texture2D}(${e}, uv);
    }
  `;const a=n.shapeInfo.logicalShape,i=a.length,l=n.shapeInfo.texShape,u=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)],h=u[0],d=u[1],p=Math.ceil(a[i-1]/2);let m=p*Math.ceil(a[i-2]/2),y="int b, int row, int col",b=`b * ${m} + (row / 2) * ${p} + (col / 2)`;for(let x=2;x<i-1;x++)y=`int b${x}, `+y,m*=a[i-x-1],b=`b${x} * ${m} + `+b;return`
    vec4 ${s}(${y}) {
      int index = ${b};
      int texR = index / ${d};
      int texC = index - texR * ${d};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${d}, ${h});
      return ${r.texture2D}(${e}, uv);
    }
  `}function ytt(n,t){const e=n.shapeInfo.logicalShape,s=n.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),a=e[3],i=e[2]*a,l=e[1]*i,{newShape:u,keptDims:h}=Bi(e);if(u.length<e.length){const C=Vu(n,u),$=["row","col","depth","depth2"];return`
      ${Bu(C,t)}
      float ${r}(int row, int col, int depth, int depth2) {
        return ${r}(${Uu($,h)});
      }
    `}if(n.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${l}, ${i}, ${a}, 1)));
        ${Pu(n)}
      }
    `;const d=n.shapeInfo.flatOffset,p=n.shapeInfo.texShape,m=p[0],y=p[1],b=`int stride2 = ${s}Shape[3];`,x=`int stride1 = ${s}Shape[2] * stride2;`,v=`int stride0 = ${s}Shape[1] * stride1;`;if(y===l&&d==null)return t?`
      float ${r}(int row, int col, int depth, int depth2) {
        ${b}
        ${x}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${i}, ${a}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${y}.0, ${m}.0);
        return sampleTexture(${s}, uv);
      }
    `;if(y===a&&d==null)return t?`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${s}Shape[1] * ${s}Shape[2], ${s}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${e[1]*e[2]}, ${e[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${y}.0, ${m}.0);
        return sampleTexture(${s}, uv);
      }
    `;const S=nl(s);return t?`
    float ${r}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${b}
      ${x}
      ${v}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index + ${S});
      return sampleTexture(${s}, uv);
    }
  `:`
    float ${r}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${l} + col * ${i} +
          depth * ${a} + depth2;
      vec2 uv = uvFromFlat(${m}, ${y}, index + ${S});
      return sampleTexture(${s}, uv);
    }
  `}function btt(n){const t=n.shapeInfo.logicalShape,e=n.name,s="get"+e.charAt(0).toUpperCase()+e.slice(1),r=t[4],a=t[3]*r,i=t[2]*a,l=t[1]*i,{newShape:u,keptDims:h}=Bi(t);if(u.length<t.length){const x=Vu(n,u),v=["row","col","depth","depth2","depth3"];return`
      ${Bu(x)}
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        return ${s}(${Uu(v,h)});
      }
    `}if(n.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${l}, ${i}, ${a}, ${r})) +
          depth3;
        ${Pu(n)}
      }
    `;const d=n.shapeInfo.flatOffset,p=n.shapeInfo.texShape,m=p[0],y=p[1];if(y===l&&d==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${i}, ${a}, ${r}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${y}.0, ${m}.0);
        return sampleTexture(${e}, uv);
      }
    `;if(y===r&&d==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${t[1]*t[2]*t[3]},
               ${t[2]*t[3]}, ${t[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${y}.0, ${m}.0);
        return sampleTexture(${e}, uv);
      }
    `;const b=nl(e);return`
    float ${s}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${l} + col * ${i} + depth * ${a} +
          depth2 * ${r} + depth3 + ${b};
      vec2 uv = uvFromFlat(${m}, ${y}, index);
      return sampleTexture(${e}, uv);
    }
  `}function xtt(n){const t=n.shapeInfo.logicalShape,e=n.name,s="get"+e.charAt(0).toUpperCase()+e.slice(1),{newShape:r,keptDims:a}=Bi(t);if(r.length<t.length){const v=Vu(n,r),S=["row","col","depth","depth2","depth3","depth4"];return`
      ${Bu(v)}
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${s}(${Uu(S,a)});
      }
    `}const i=t[5],l=t[4]*i,u=t[3]*l,h=t[2]*u,d=t[1]*h;if(n.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${d}, ${h}, ${u}, ${l})) +
          dot(
            vec2(depth3, depth4),
            vec2(${i}, 1)));
        ${Pu(n)}
      }
    `;const p=n.shapeInfo.flatOffset,m=n.shapeInfo.texShape,y=m[0],b=m[1];if(b===d&&p==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${h}, ${u}, ${l}, ${i})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${b}.0, ${y}.0);
        return sampleTexture(${e}, uv);
      }
    `;if(b===i&&p==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${t[1]*t[2]*t[3]*t[4]},
               ${t[2]*t[3]*t[4]},
               ${t[3]*t[4]},
               ${t[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${b}.0, ${y}.0);
        return sampleTexture(${e}, uv);
      }
    `;const x=nl(e);return`
    float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${d} + col * ${h} + depth * ${u} +
          depth2 * ${l} + depth3 * ${i} + depth4 + ${x};
      vec2 uv = uvFromFlat(${y}, ${b}, index);
      return sampleTexture(${e}, uv);
    }
  `}function Pu(n){const t=n.name,e=mt(n.shapeInfo.logicalShape);return e<2?`return ${t};`:`
    for (int i = 0; i < ${e}; i++) {
      if (i == index) {
        return ${t}[i];
      }
    }
  `}function vtt(n,t){const e=n.name,s=e.charAt(0).toUpperCase()+e.slice(1),r="get"+s+"AtOutCoords",a=n.shapeInfo.logicalShape.length,i=t.logicalShape.length,l=X_(n.shapeInfo.logicalShape,t.logicalShape),u=$e(i),h=i-a;let d;const p=["x","y","z","w","u","v"];a===0?d="":i<2&&l.length>=1?d="coords = 0;":d=l.map(C=>`coords.${p[C+h]} = 0;`).join(`
`);let m="";i<2&&a>0?m="coords":m=n.shapeInfo.logicalShape.map((C,$)=>`coords.${p[$+h]}`).join(", ");let y="return outputValue;";const x=mt(n.shapeInfo.logicalShape)===1,S=mt(t.logicalShape)===1;if(a===1&&!x&&!S)y=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(x&&!S)i===1?y=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:y=`
        return vec4(outputValue.x);
      `;else if(l.length){const C=a-2,$=a-1;l.indexOf(C)>-1&&l.indexOf($)>-1?y="return vec4(outputValue.x);":l.indexOf(C)>-1?y="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":l.indexOf($)>-1&&(y="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${r}() {
      ${u} coords = getOutputCoords();
      ${d}
      vec4 outputValue = get${s}(${m});
      ${y}
    }
  `}function wtt(n,t){const e=n.name,s=e.charAt(0).toUpperCase()+e.slice(1),r="get"+s+"AtOutCoords",a=t.texShape,i=n.shapeInfo.texShape,l=n.shapeInfo.logicalShape.length,u=t.logicalShape.length;if(!n.shapeInfo.isUniform&&l===u&&n.shapeInfo.flatOffset==null&&de(i,a))return`
      float ${r}() {
        return sampleTexture(${e}, resultUV);
      }
    `;const h=$e(u),d=X_(n.shapeInfo.logicalShape,t.logicalShape),p=u-l;let m;const y=["x","y","z","w","u","v"];l===0?m="":u<2&&d.length>=1?m="coords = 0;":m=d.map(x=>`coords.${y[x+p]} = 0;`).join(`
`);let b="";return u<2&&l>0?b="coords":b=n.shapeInfo.logicalShape.map((x,v)=>`coords.${y[v+p]}`).join(", "),`
    float ${r}() {
      ${h} coords = getOutputCoords();
      ${m}
      return get${s}(${b});
    }
  `}function $e(n){if(n<=1)return"int";if(n===2)return"ivec2";if(n===3)return"ivec3";if(n===4)return"ivec4";if(n===5)return"ivec5";if(n===6)return"ivec6";throw Error(`GPU for rank ${n} is not yet supported`)}function FS(n,t,e){const{newShape:s,keptDims:r}=Bi(t),a=t.length,i=n&&a===3&&t[0]===1,l=i?t.slice(1):s,u=!n&&a>1&&!de(t,e)&&s.length<a||i;return{useSqueezeShape:u,uniformShape:u?l:t,keptDims:r}}function Vu(n,t){const e=JSON.parse(JSON.stringify(n));return e.shapeInfo.logicalShape=t,e}function Uu(n,t){return t.map(e=>n[e]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Stt(n,t,e,s){const r=e.map((d,p)=>{const m={logicalShape:d.shape,texShape:d.isUniform?null:d.texData.texShape,isUniform:d.isUniform,isPacked:d.isUniform?!1:d.texData.isPacked,flatOffset:null};return d.texData!=null&&d.texData.slice!=null&&d.texData.slice.flatOffset>0&&(m.flatOffset=d.texData.slice.flatOffset),{name:t.variableNames[p],shapeInfo:m}}),a=r.map(d=>d.shapeInfo),i={logicalShape:s.shape,texShape:s.texData.texShape,isUniform:!1,isPacked:s.texData.isPacked,flatOffset:null},l=PJ(r,i,t),u=mJ(n.gl,l),h=n.createProgram(u);return ut().get("ENGINE_COMPILE_ONLY")?{program:t,fragmentShader:u,source:l,webGLProgram:h,inShapeInfos:a,outShapeInfo:i,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(n.buildVao(h),Object.assign({program:t,fragmentShader:u,source:l,webGLProgram:h,inShapeInfos:a,outShapeInfo:i},Z_(n,t,h)))}function Z_(n,t,e){const s=[],r=[];let a,i,l,u=null,h=null;h=n.getUniformLocation(e,"NAN",!1),ut().getNumber("WEBGL_VERSION")===1&&(u=n.getUniformLocation(e,"INFINITY",!1));const d=!1;for(const p of t.variableNames){const m={name:p,uniform:n.getUniformLocation(e,p,d),offset:n.getUniformLocation(e,`offset${p}`,d)};t.enableShapeUniforms&&(m.shape=n.getUniformLocation(e,`${p}Shape`,d),m.texShape=n.getUniformLocation(e,`${p}TexShape`,d)),s.push(m)}if(t.enableShapeUniforms&&(a=n.getUniformLocation(e,"outShape",d),l=n.getUniformLocation(e,"outShapeStrides",d),i=n.getUniformLocation(e,"outTexShape",d)),t.customUniforms)for(const p of t.customUniforms)r.push(n.getUniformLocation(e,p.name,d));return{variablesLocations:s,customUniformLocations:r,infLoc:u,nanLoc:h,outShapeLocation:a,outShapeStridesLocation:l,outTexShapeLocation:i}}function Sk(n,t){if(n.length!==t.length)throw Error(`Binary was compiled with ${n.length} inputs, but was executed with ${t.length} inputs`);n.forEach((e,s)=>{const r=e.logicalShape,a=t[s],i=a.shape;if(!de(r,i))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${r} and ${i} must match`);if(e.isUniform&&a.isUniform)return;const l=e.texShape,u=a.isUniform?null:a.texData.texShape;if(!de(l,u))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${l} and ${u} must match`)})}function Ctt(n,t,e,s,r){t.program.enableShapeUniforms||(Sk(t.inShapeInfos,e),Sk([t.outShapeInfo],[s]));const a=s.texData.texture,i=s.texData.texShape;s.texData.isPacked?n.setOutputPackedMatrixTexture(a.texture,i[0],i[1]):n.setOutputMatrixTexture(a.texture,i[0],i[1]),n.setProgram(t.webGLProgram),n.bindVertexArray(t.webGLProgram.vao),ut().getNumber("WEBGL_VERSION")===1&&t.infLoc!==null&&n.gl.uniform1f(t.infLoc,1/0),t.nanLoc!==null&&n.gl.uniform1f(t.nanLoc,NaN);for(let u=0;u<e.length;++u){const h=e[u],{uniform:d,offset:p,shape:m,texShape:y}=t.variablesLocations[u];if(m){const{uniformShape:b}=FS(t.program.packedInputs,h.shape,h.texData.texShape);switch(b.length){case 1:n.gl.uniform1iv(m,new Int32Array(b));break;case 2:n.gl.uniform2iv(m,new Int32Array(b));break;case 3:n.gl.uniform3iv(m,new Int32Array(b));break;case 4:n.gl.uniform4iv(m,new Int32Array(b));break}}if(y&&n.gl.uniform2i(y,h.texData.texShape[0],h.texData.texShape[1]),d!=null){if(h.isUniform){if(mt(h.shape)<2)n.gl.uniform1f(d,h.uniformValues[0]);else{let b=h.uniformValues;b instanceof Float32Array||(b=new Float32Array(b)),n.gl.uniform1fv(d,b)}continue}h.texData.slice!=null&&p!=null&&n.gl.uniform1i(p,h.texData.slice.flatOffset),n.setInputMatrixTexture(h.texData.texture.texture,d,u)}}const l=t.outShapeLocation;if(l)switch(s.shape.length){case 1:n.gl.uniform1iv(l,new Int32Array(s.shape));break;case 2:n.gl.uniform2iv(l,new Int32Array(s.shape));break;case 3:n.gl.uniform3iv(l,new Int32Array(s.shape));break;case 4:n.gl.uniform4iv(l,new Int32Array(s.shape));break}if(t.outShapeStridesLocation){const u=Bt(s.shape);switch(s.shape.length){case 2:n.gl.uniform1iv(t.outShapeStridesLocation,new Int32Array(u));break;case 3:n.gl.uniform2iv(t.outShapeStridesLocation,new Int32Array(u));break;case 4:n.gl.uniform3iv(t.outShapeStridesLocation,new Int32Array(u));break}}if(t.outTexShapeLocation&&n.gl.uniform2i(t.outTexShapeLocation,s.texData.texShape[0],s.texData.texShape[1]),t.program.customUniforms&&r)for(let u=0;u<t.program.customUniforms.length;++u){const h=t.program.customUniforms[u],d=t.customUniformLocations[u],p=r[u];if(h.type==="float")n.gl.uniform1fv(d,p);else if(h.type==="vec2")n.gl.uniform2fv(d,p);else if(h.type==="vec3")n.gl.uniform3fv(d,p);else if(h.type==="vec4")n.gl.uniform4fv(d,p);else if(h.type==="int")n.gl.uniform1iv(d,p);else if(h.type==="ivec2")n.gl.uniform2iv(d,p);else if(h.type==="ivec3")n.gl.uniform3iv(d,p);else if(h.type==="ivec4")n.gl.uniform4iv(d,p);else throw Error(`uniform type ${h.type} is not supported yet.`)}n.executeProgram()}function Ntt(n,t,e){let s="";t.concat(e).forEach(i=>{const l=i.texData!=null&&i.texData.slice!=null&&i.texData.slice.flatOffset>0;if(n.enableShapeUniforms&&!i.isUniform){const u=i.texData.texShape,{useSqueezeShape:h,uniformShape:d,keptDims:p}=FS(n.packedInputs,i.shape,u);let m="",y="",b="";if(d.length===1&&n.packedInputs){const I=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)];m=`${I[0]>1}_${I[1]>1}`}else if(d.length===2&&!n.packedInputs)y=`${d[0]>1}_${d[1]>1}`;else if(d.length>2&&!n.packedInputs){const I=Bt(d);b=`${I[0]===u[1]}_${I[I.length-1]===u[1]}`}const x=i.shape.length,v=d.length===2&&de(i.shape,u),S=mt(i.shape)===1,C=du(i.shape,e.shape),$=!n.packedInputs&&x===e.shape.length&&de(u,e.texData.texShape),T=n.packedInputs||d.length>2?"":`${u[0]>1}_${u[1]>1}`;s+=`${x}_${$}_${h?p:""}_${d.length}_${S}_${C}_${v}_${m}_${y}_${b}_${T}_${l}`}else{const u=i.isUniform?"uniform":i.texData.texShape;s+=`${i.shape}_${u}_${l}`}});const r=n.userCode;let a=n.constructor.name;return a+="_"+s+"_"+r+`${ut().getNumber("WEBGL_VERSION")}`,a}function ns(n){return ut().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&n<=4}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ttt{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=bh.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const e=ds();this.outputShape=t,this.enableShapeUniforms=ns(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?my(["r","c","d"],t):el(["r","c","d"],t)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${e.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $tt{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=bh.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const e=ds();this.outputShape=t,this.enableShapeUniforms=ns(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?my(["r","c","d"],t):el(["r","c","d"],t)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${e.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ktt{constructor(t){this.variableNames=["A"],this.outTexUsage=Zs.DOWNLOAD;const e=ds();this.outputShape=t,this.userCode=`
      ${q_}

      void main() {
        float x = getAAtOutCoords();
        ${e.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Itt{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Zs.DOWNLOAD;const e=ds();this.outputShape=t,this.userCode=`
      ${q_}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${e.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ett={R:0,G:1,B:2,A:3};class Ck{constructor(t,e=!1,s="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=ds();this.outputShape=t,this.enableShapeUniforms=ns(this.outputShape.length);let a="result";e&&(a="floor(result * 255. + 0.5)");let i="";for(let l=0;l<s.length;l++){const u=s[l];i+=`
          if(offset == ${l}) {
            result = values[${Ett[u]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?_S():OS(t)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${s.length});

        flatIndex = idiv(flatIndex, ${s.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${r.texture2D}(A, uv);
          ${i}
        }
        ${r.output} = vec4(${a}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Dtt{constructor(t,e=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const s=ds();this.outputShape=t,this.enableShapeUniforms=ns(this.outputShape.length);let r="",a="result";e&&(a="floor(result * 255. + 0.5)");for(let i=0;i<=1;i++)for(let l=0;l<=1;l++){const u=i*2+l;r+=`
          localCoords = coords;
          if(localCoords[2] + ${l} < ${this.enableShapeUniforms?"outShape[2]":`${t[2]}`}) {
          localCoords[2] += ${l};
          if (localCoords[1] + ${i} < ${this.enableShapeUniforms?"outShape[1]":`${t[1]}`}) {
            localCoords[1] += ${i};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${s.texture2D}(A, uv);

            if (offset == 0) {
              result[${u}] = values[0];
            } else if (offset == 1) {
              result[${u}] = values[1];
            } else if (offset == 2) {
              result[${u}] = values[2];
            } else {
              result[${u}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?_S():OS(t)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${r}

          ${s.output} = ${a};
        }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Att(n){const t=ds(),e=`${t.version}
    precision highp float;
    ${t.attribute} vec3 clipSpacePos;
    ${t.attribute} vec2 uv;
    ${t.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return pJ(n,e)}function Rtt(n){const t=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return xJ(n,t)}function Ott(n){const t=new Uint16Array([0,1,2,2,1,3]);return vJ(n,t)}function Vd(n,t,e,s,r,a){SJ(t,e);const i=wJ(n),l=n.TEXTURE_2D;return At(n,()=>n.bindTexture(l,i)),At(n,()=>n.texParameteri(l,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE)),At(n,()=>n.texParameteri(l,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE)),At(n,()=>n.texParameteri(l,n.TEXTURE_MIN_FILTER,n.NEAREST)),At(n,()=>n.texParameteri(l,n.TEXTURE_MAG_FILTER,n.NEAREST)),ut().getNumber("WEBGL_VERSION")===1?At(n,()=>n.texImage2D(l,0,s,t,e,0,r,a,null)):At(n,()=>n.texStorage2D(l,1,s,t,e)),At(n,()=>n.bindTexture(n.TEXTURE_2D,null)),{texture:i,texShape:[e,t]}}function Q_(n){return n.internalFormatFloat}function _tt(n,t,e,s){const[r,a]=Bd(t,e);return Vd(n,r,a,Q_(s),s.textureFormatFloat,n.FLOAT)}function J_(n){return n.internalFormatHalfFloat}function Ftt(n,t,e,s){const[r,a]=Bd(t,e);return Vd(n,r,a,J_(s),s.textureFormatFloat,s.textureTypeHalfFloat)}function tF(n){return n.downloadTextureFormat}function Ltt(n,t,e,s){const[r,a]=Bd(t,e);return Vd(n,r,a,tF(s),n.RGBA,n.UNSIGNED_BYTE)}function eF(n){return n.internalFormatPackedFloat}function ztt(n,t,e,s){const[r,a]=Mu(t,e);return Vd(n,r,a,eF(s),n.RGBA,n.FLOAT)}function nF(n){return n.internalFormatPackedHalfFloat}function Mtt(n,t,e,s){const[r,a]=Mu(t,e);return Vd(n,r,a,nF(s),n.RGBA,s.textureTypeHalfFloat)}function Btt(n,t,e){return At(n,()=>n.bindBuffer(n.ARRAY_BUFFER,e)),xk(n,t,"clipSpacePos",e,3,20,0)&&xk(n,t,"uv",e,2,20,12)}function Ptt(n,t,e,s,r,a){At(n,()=>n.bindTexture(n.TEXTURE_2D,t));let i,l,u;r instanceof Uint8Array?(i=new Uint8Array(e*s*4),l=n.UNSIGNED_BYTE,u=n.RGBA):(i=new Float32Array(e*s*4),l=n.FLOAT,u=a.internalFormatPackedFloat),i.set(r),ut().getNumber("WEBGL_VERSION")===2?At(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,e,s,n.RGBA,l,i)):At(n,()=>n.texImage2D(n.TEXTURE_2D,0,u,e,s,0,n.RGBA,l,i)),At(n,()=>n.bindTexture(n.TEXTURE_2D,null))}function Vtt(n,t,e){At(n,()=>n.bindTexture(n.TEXTURE_2D,t)),e.data instanceof Uint8Array?ut().getNumber("WEBGL_VERSION")===2?At(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,e.width,e.height,n.RGBA,n.UNSIGNED_BYTE,e.data)):At(n,()=>n.texImage2D(n.TEXTURE_2D,0,n.RGBA,e.width,e.height,0,n.RGBA,n.UNSIGNED_BYTE,e.data)):ut().getNumber("WEBGL_VERSION")===2?At(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,e)):At(n,()=>n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,e)),At(n,()=>n.bindTexture(n.TEXTURE_2D,null))}function Utt(n,t,e,s){const r=n.createBuffer();At(n,()=>n.bindBuffer(n.PIXEL_PACK_BUFFER,r));const l=4*4*t*e;return At(n,()=>n.bufferData(n.PIXEL_PACK_BUFFER,l,n.STREAM_READ)),At(n,()=>n.readPixels(0,0,e,t,n.RGBA,n.FLOAT,0)),At(n,()=>n.bindBuffer(n.PIXEL_PACK_BUFFER,null)),r}function Gtt(n,t,e){const s=n,r=new Float32Array(e);return s.bindBuffer(s.PIXEL_PACK_BUFFER,t),s.getBufferSubData(s.PIXEL_PACK_BUFFER,0,r),s.bindBuffer(s.PIXEL_PACK_BUFFER,null),r}function Wtt(n,t,e,s){const[r,a]=Bd(t,e),i=4,l=new Uint8Array(oJ(t*e,i));return At(n,()=>n.readPixels(0,0,r,a,s.downloadTextureFormat,n.UNSIGNED_BYTE,l)),new Float32Array(l.buffer)}function Htt(n,t,e,s,r,a,i,l){const u=n,h=new Float32Array(lJ(a,i));return u.bindBuffer(u.PIXEL_PACK_BUFFER,t),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,h),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),h}function jtt(n,t,e){const s=new Float32Array(t*e*4);return At(n,()=>n.readPixels(0,0,e,t,n.RGBA,n.FLOAT,s)),s}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lx{constructor(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const e=ut().getNumber("WEBGL_VERSION");if(t!=null?(this.gl=t,rJ(e,t)):this.gl=Vr(e),t=this.gl,ut().getNumber("WEBGL_VERSION")===2){const a=t;this.createVertexArray=()=>At(a,()=>a.createVertexArray()),this.bindVertexArray=i=>At(a,()=>a.bindVertexArray(i)),this.deleteVertexArray=i=>At(a,()=>a.deleteVertexArray(i)),this.getVertexArray=()=>At(a,()=>a.getParameter(a.VERTEX_ARRAY_BINDING))}else if(t!=null){const a=t.getExtension("OES_vertex_array_object");if(a==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>At(t,()=>a.createVertexArrayOES()),this.bindVertexArray=i=>At(t,()=>a.bindVertexArrayOES(i)),this.deleteVertexArray=i=>At(t,()=>a.deleteVertexArrayOES(i)),this.getVertexArray=()=>At(t,()=>t.getParameter(a.VERTEX_ARRAY_BINDING_OES))}let s="WEBGL_color_buffer_float";const r="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),ut().getNumber("WEBGL_VERSION")===1){const a="OES_texture_float",i="OES_texture_half_float";if(this.textureFloatExtension=fp(this.gl,a),br(this.gl,i))this.textureHalfFloatExtension=fp(this.gl,i);else if(ut().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(s),br(this.gl,r))this.colorBufferHalfFloatExtension=fp(this.gl,r);else if(ut().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(s="EXT_color_buffer_float",br(this.gl,s))this.colorBufferFloatExtension=this.gl.getExtension(s);else if(br(this.gl,r))this.colorBufferHalfFloatExtension=this.gl.getExtension(r);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=Rtt(this.gl),this.indexBuffer=Ott(this.gl),this.framebuffer=CJ(this.gl),this.textureConfig=RS(this.gl,this.textureHalfFloatExtension)}get debug(){return ut().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const t=this.gl;At(t,()=>t.finish()),At(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,null)),At(t,()=>t.deleteFramebuffer(this.framebuffer)),At(t,()=>t.bindBuffer(t.ARRAY_BUFFER,null)),At(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)),At(t,()=>t.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(t,e){return this.throwIfDisposed(),_tt(this.gl,t,e,this.textureConfig)}createFloat16MatrixTexture(t,e){return this.throwIfDisposed(),Ftt(this.gl,t,e,this.textureConfig)}createUnsignedBytesMatrixTexture(t,e){return this.throwIfDisposed(),Ltt(this.gl,t,e,this.textureConfig)}uploadPixelDataToTexture(t,e){this.throwIfDisposed(),Vtt(this.gl,t,e)}uploadDenseMatrixToTexture(t,e,s,r){this.throwIfDisposed(),Ptt(this.gl,t,e,s,r,this.textureConfig)}createFloat16PackedMatrixTexture(t,e){return this.throwIfDisposed(),Mtt(this.gl,t,e,this.textureConfig)}createPackedMatrixTexture(t,e){return this.throwIfDisposed(),ztt(this.gl,t,e,this.textureConfig)}deleteMatrixTexture(t){this.throwIfDisposed(),this.outputTexture===t&&(vk(this.gl,this.framebuffer),this.outputTexture=null),At(this.gl,()=>this.gl.deleteTexture(t))}downloadByteEncodedFloatMatrixFromOutputTexture(t,e,s){return this.downloadMatrixDriver(t,()=>Wtt(this.gl,e,s,this.textureConfig))}downloadPackedMatrixFromBuffer(t,e,s,r,a,i){return Htt(this.gl,t,e,s,r,a,i,this.textureConfig)}downloadFloat32MatrixFromBuffer(t,e){return Gtt(this.gl,t,e)}createBufferFromTexture(t,e,s){this.bindTextureToFrameBuffer(t);const r=Utt(this.gl,e,s,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}createAndWaitForFence(){const t=this.createFence(this.gl);return this.pollFence(t)}createFence(t){let e,s;if(ut().getBool("WEBGL_FENCE_API_ENABLED")){const r=t,a=r.fenceSync(r.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),s=()=>{const i=r.clientWaitSync(a,0,0);return i===r.ALREADY_SIGNALED||i===r.CONDITION_SATISFIED},e=a}else ut().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(e=this.beginQuery(),this.endQuery(),s=()=>this.isQueryAvailable(e,ut().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):s=()=>!0;return{query:e,isFencePassed:s}}downloadMatrixFromPackedTexture(t,e,s){return this.downloadMatrixDriver(t,()=>jtt(this.gl,e,s))}createProgram(t){this.throwIfDisposed();const e=this.gl;this.vertexShader==null&&(this.vertexShader=Att(e));const s=yJ(e);At(e,()=>e.attachShader(s,this.vertexShader)),At(e,()=>e.attachShader(s,t)),bJ(e,s);const r=Object.assign(s,{vao:this.createVertexArray()});return this.debug&&rx(e,r),r}buildVao(t){this.setProgram(t),this.bindVertexArray(t.vao);const e=this.gl;At(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),Btt(e,t,this.vertexBuffer)}deleteProgram(t){this.throwIfDisposed(),t===this.program&&(this.program=null),t!=null&&(At(this.gl,()=>this.gl.deleteProgram(t)),this.deleteVertexArray(t.vao))}setProgram(t){this.throwIfDisposed(),this.program=t,this.program!=null&&this.debug&&rx(this.gl,this.program),At(this.gl,()=>this.gl.useProgram(t))}getUniformLocation(t,e,s=!0){return this.throwIfDisposed(),s?TJ(this.gl,t,e):$J(this.gl,t,e)}getAttributeLocation(t,e){return this.throwIfDisposed(),At(this.gl,()=>this.gl.getAttribLocation(t,e))}getUniformLocationNoThrow(t,e){return this.throwIfDisposed(),this.gl.getUniformLocation(t,e)}setInputMatrixTexture(t,e,s){this.throwIfDisposed(),this.throwIfNoProgram(),kJ(this.gl,t,e,s)}setOutputMatrixTexture(t,e,s){this.setOutputMatrixTextureDriver(t,s,e)}setOutputPackedMatrixTexture(t,e,s){this.throwIfDisposed();const[r,a]=Mu(e,s);this.setOutputMatrixTextureDriver(t,r,a)}setOutputMatrixWriteRegion(t,e,s,r){this.setOutputMatrixWriteRegionDriver(s,t,r,e)}setOutputPackedMatrixWriteRegion(t,e,s,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&rx(this.gl,this.program),pp(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const t=this.gl;if(this.debug){const e=this.getVertexArray();console.assert(e===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}At(t,()=>t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),At(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=fp(this.gl,ut().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(ut().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const s=this.gl,r=this.getQueryTimerExtensionWebGL2(),a=s.createQuery();return s.beginQuery(r.TIME_ELAPSED_EXT,a),a}const t=this.getQueryTimerExtensionWebGL1(),e=t.createQueryEXT();return t.beginQueryEXT(t.TIME_ELAPSED_EXT,e),e}endQuery(){if(ut().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const e=this.gl,s=this.getQueryTimerExtensionWebGL2();e.endQuery(s.TIME_ELAPSED_EXT);return}const t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(t){return await t2(()=>this.disposed||this.isQueryAvailable(t,ut().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(t,ut().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(t,e){if(e===0)return null;if(e===2){const s=this.gl;return s.getQueryParameter(t,s.QUERY_RESULT)/1e6}else{const s=this.getQueryTimerExtensionWebGL1();return s.getQueryObjectEXT(t,s.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(t,e){if(e===0)return!0;if(e===2){const s=this.gl,r=this.getQueryTimerExtensionWebGL2(),a=s.getQueryParameter(t,s.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),a&&!this.disjoint}else{const s=this.getQueryTimerExtensionWebGL1(),r=s.getQueryObjectEXT(t,s.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(s.GPU_DISJOINT_EXT)),r&&!this.disjoint}}pollFence(t){return new Promise(e=>{this.addItemToPoll(()=>t.isFencePassed(),()=>e())})}pollItems(){const t=qtt(this.itemsToPoll.map(e=>e.isDoneFn));for(let e=0;e<=t;++e){const{resolveFn:s}=this.itemsToPoll[e];s()}this.itemsToPoll=this.itemsToPoll.slice(t+1)}addItemToPoll(t,e){if(this.itemsToPoll.push({isDoneFn:t,resolveFn:e}),this.itemsToPoll.length>1)return;let s;"setTimeoutCustom"in ut().platform&&(s=ut().platform.setTimeoutCustom.bind(ut().platform)),t2(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,s)}bindTextureToFrameBuffer(t){this.throwIfDisposed(),ax(this.gl,t,this.framebuffer),this.debug&&pp(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(ax(this.gl,this.outputTexture,this.framebuffer),this.debug&&pp(this.gl)):vk(this.gl,this.framebuffer)}downloadMatrixDriver(t,e){this.bindTextureToFrameBuffer(t);const s=e();return this.unbindTextureToFrameBuffer(),s}setOutputMatrixTextureDriver(t,e,s){this.throwIfDisposed();const r=this.gl;ax(r,t,this.framebuffer),this.debug&&pp(r),this.outputTexture=t,At(r,()=>r.viewport(0,0,e,s)),At(r,()=>r.scissor(0,0,e,s))}setOutputMatrixWriteRegionDriver(t,e,s,r){this.throwIfDisposed(),At(this.gl,()=>this.gl.scissor(t,e,s,r))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function qtt(n){let t=0;for(;t<n.length&&n[t]();++t);return t-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:Xtt,bincountImpl:sF,bincountReduceImpl:Ktt,bitwiseAndImpl:Ytt,castImpl:Ztt,ceilImpl:Qtt,concatImpl:Jtt,equalImpl:tet,expImpl:eet,expm1Impl:net,floorImpl:set,gatherNdImpl:ret,gatherV2Impl:aet,greaterImpl:iet,greaterEqualImpl:oet,lessImpl:uet,lessEqualImpl:cet,linSpaceImpl:het,logImpl:det,maxImpl:fet,maximumImpl:pet,minimumImpl:met,multiplyImpl:get,negImpl:yet,notEqualImpl:bet,prodImpl:xet,raggedGatherImpl:vet,raggedRangeImpl:wet,raggedTensorToTensorImpl:Cet,rangeImpl:Net,rsqrtImpl:Tet,scatterImpl:$et,sigmoidImpl:ket,simpleAbsImpl:rF,sliceImpl:Iet,sparseFillEmptyRowsImpl:Eet,sparseReshapeImpl:Det,sparseSegmentReductionImpl:aF,sqrtImpl:Aet,staticRegexReplaceImpl:Ret,stridedSliceImpl:Oet,stringNGramsImpl:_et,stringSplitImpl:Fet,stringToHashBucketFastImpl:Let,subImpl:zet,tileImpl:Met,topKImpl:Bet,transposeImpl:LS,uniqueImpl:Pet}=VK;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iF(n,t){return["x","y","z","w","u","v"].slice(0,t).map(e=>`${n}.${e}`)}function us(n,t){return t===1?[n]:iF(n,t)}function Vet(n,t){if(n===1)return"rc";let e="";for(let s=0;s<n;s++)e+=t[s],s<n-1&&(e+=",");return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Uet{constructor(t){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=t,this.rank=t.length,this.enableShapeUniforms=ns(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const e=us("rc",this.rank),s=$e(this.rank),r=this.getOutOfBoundsCondition(e),a=this.getSetup(e),i=this.getOutput(e);this.userCode=`
        void main() {
          ${s} rc = getOutputCoords();

          if(${r}) {
            setOutput(vec4(0));
          } else {
            ${a}

            setOutput(vec4(${i}));
          }
        }
      `}}getSourceCoordsArr(t){const e=[];for(let s=0;s<=1;s++)for(let r=0;r<=1;r++){let a=`${s===0?"r":"rp1"}, ${r===0?"c":"cp1"}`;for(let i=2;i<this.rank;i++)a=`${t[t.length-1-i]},`+a;e.push(a)}return e}getOutOfBoundsCondition(t){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let e="";for(let s=this.rank-2;s<this.rank;s++)e+=`${t[s]} >= ${this.enableShapeUniforms?`outShape[${s}]`:this.outputShape[s]}`,s<this.rank-1&&(e+="||");return e}getSetup(t){if(this.rank===1)return"";const e=t.slice(-2),s=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],r=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${e[0]};
      int c = ${e[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${s};
      bool rEdge = rp1 >= ${r};
    `}getOutput(t){const e=this.getSourceCoordsArr(t);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${e[0]}),
            cEdge ? 0. : getA(${e[1]}),
            rEdge ? 0. : getA(${e[2]}),
            rEdge || cEdge ? 0. : getA(${e[3]})`}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oF{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=t,this.enableShapeUniforms=ns(this.outputShape.length);let s="";for(let r=0;r<4;r++){let a="thisRC = rc;";r%2===1&&(a+="thisRC.z += 1;"),r>1&&(a+="thisRC.y += 1;"),s+=`
        ${a}
        ${r>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${r}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${r>0?"}":""}
      `}this.userCode=`
      ${Get(e,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?_S():OS(t)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":t[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":t[2]};

        ${s}

        setOutput(result);
      }
    `}}function Get(n,t){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${t?BJ(["r","c","d"],"inputShape"):el(["r","c","d"],n)}
      return ivec3(r, c, d);
    }
  `}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Wet{constructor(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(t,e,s){const r=Tk(e,s),a=$k(t,r,s);a in this.freeTextures||(this.freeTextures[a]=[]),a in this.usedTextures||(this.usedTextures[a]=[]);const i=Nk(t,r,this.gpgpu.gl,this.gpgpu.textureConfig,s);if(this.freeTextures[a].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=i,this.log();const u=this.freeTextures[a].pop();return this.usedTextures[a].push(u),u}let l;return r===Vn.PACKED_2X2_FLOAT32?l=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):r===Vn.PACKED_2X2_FLOAT16?l=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):r===Vn.UNPACKED_FLOAT32?l=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):r===Vn.UNPACKED_FLOAT16?l=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):r===Vn.PACKED_4X1_UNSIGNED_BYTE&&(l=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[a].push(l),this.numUsedTextures++,this._numBytesAllocated+=i,this.log(),l}releaseTexture(t,e,s,r){if(this.freeTextures==null)return;const a=Tk(s,r),i=$k(e,a,r);i in this.freeTextures||(this.freeTextures[i]=[]);const l=Nk(e,a,this.gpgpu.gl,this.gpgpu.textureConfig,r),u=ut().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");u!==-1&&this._numBytesAllocated>u?(this.gpgpu.deleteMatrixTexture(t.texture),this._numBytesAllocated-=l):(this.freeTextures[i].push(t),this.numFreeTextures++,this._numBytesFree+=l),this.numUsedTextures--;const h=this.usedTextures[i],d=h&&h.indexOf(t);if(d==null||d<0)throw new Error("Cannot release a texture that was never provided by this texture manager");h[d]=h[h.length-1],h.pop(),this.log()}log(){if(!this.logEnabled)return;const t=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${t})`);const e=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*e)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const t in this.freeTextures)this.freeTextures[t].forEach(e=>{this.gpgpu.deleteMatrixTexture(e.texture)});for(const t in this.usedTextures)this.usedTextures[t].forEach(e=>{this.gpgpu.deleteMatrixTexture(e.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function Het(n,t){const e=n;if(t===e.R32F)return 4;if(t===e.R16F)return 2;if(t===e.RGBA32F)return 16;if(t===n.RGBA)return 16;if(t===e.RGBA16F)return 8;if(t===e.RGBA8)return 4;throw new Error(`Unknown internal format ${t}`)}function Nk(n,t,e,s,r){const a=jet(t,s);let i;if(r){const[u,h]=Mu(n[0],n[1]);i=u*h}else{const[u,h]=Bd(n[0],n[1]);i=u*h}const l=Het(e,a);return i*l}function jet(n,t){switch(n){case Vn.PACKED_2X2_FLOAT32:return eF(t);case Vn.PACKED_2X2_FLOAT16:return nF(t);case Vn.UNPACKED_FLOAT32:return Q_(t);case Vn.UNPACKED_FLOAT16:return J_(t);case Vn.PACKED_4X1_UNSIGNED_BYTE:return tF(t);default:throw new Error(`Unknown physical texture type ${n}`)}}function qet(n){return ut().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?n?Vn.PACKED_2X2_FLOAT32:Vn.UNPACKED_FLOAT32:n?Vn.PACKED_2X2_FLOAT16:Vn.UNPACKED_FLOAT16}function Tk(n,t){if(n===Zs.UPLOAD)return Vn.PACKED_2X2_FLOAT32;if(n===Zs.RENDER||n==null)return qet(t);if(n===Zs.DOWNLOAD||n===Zs.PIXELS)return Vn.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${n}`)}function $k(n,t,e){return`${n[0]}_${n[1]}_${t}_${e}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class na{constructor(t,e){this.variableNames=["A"],this.outputShape=t,this.enableShapeUniforms=ns(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${e}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const kr="if (isnan(x)) return x;",Xet="return x;",kk="return abs(x);",Ket="return (x >= 0.0) ? x : (exp(x) - 1.0);",Yet=kr+`
  return (x < 0.0) ? 0.0 : x;
`,Zet=kr+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,bi="return x;",Qet="return 1.0 / (1.0 + exp(-1.0 * x));";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jet="return x;",tnt=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,ent=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,nnt=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,snt="return 1.0 / (1.0 + exp(-1.0 * x));";class Si{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.enableShapeUniforms=ns(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${e}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rnt{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=t,this.enableShapeUniforms=ns(this.outputShape.length);const e=t.length,s=us("rc",e),r=$e(e),a=Vet(e,s),i=s.slice(-2),l=e<=1?"rc":`vec2(${i.join(",")})`;this.userCode=`
      void main() {
        ${r} rc = getOutputCoords();
        vec4 packedInput = getA(${a});

        setOutput(getChannel(packedInput, ${l}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ant=xw,int=1e-7,ont=1e-4,yp={};function lnt(n){return n in yp||(yp[n]={}),yp[n]}const unt=ut().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),cnt=600;function hnt(){return ut().global.screen==null?1024:ut().global.screen.height*ut().global.screen.width*window.devicePixelRatio*cnt/1024/1024}class gy extends D1{nextDataId(){return gy.nextDataId++}constructor(t){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!ut().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let e;if(t!=null){if(t instanceof lx)e=t;else{const s=Vr(ut().getNumber("WEBGL_VERSION"),t);e=new lx(s)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const s=Vr(ut().getNumber("WEBGL_VERSION"));e=new lx(s),this.binaryCache=lnt(ut().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=e,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new Wet(this.gpgpu),this.numMBBeforeWarning=hnt(),this.texData=new RI(this,Zr())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(t,e,s,r,a,i){const l=this.makeTensorInfo(e,s),u=this.texData.get(l.dataId);u.isPacked=!1,u.texture={texture:t,texShape:[r,a]},u.texShape=[r,a];const h=mp(e),d=new Ck(h,!1,i),p=this.runWebGLProgram(d,[l],s,[[r,a]]);return p.shape=e,u.texture=null,this.disposeIntermediateTensorInfo(l),p.dataId}write(t,e,s){if((ut().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||ut().getBool("DEBUG"))&&this.checkNumericalProblems(t),s==="complex64"&&t!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const r={id:this.nextDataId()};return this.texData.set(r,{shape:e,dtype:s,values:t,usage:Zs.UPLOAD,refCount:1}),r}refCount(t){return this.texData.has(t)?this.texData.get(t).refCount:0}incRef(t){const e=this.texData.get(t);e.refCount++}decRef(t){if(this.texData.has(t)){const e=this.texData.get(t);e.refCount--}}move(t,e,s,r,a){if(ut().getBool("DEBUG")&&this.checkNumericalProblems(e),r==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(t,{shape:s,dtype:r,values:e,usage:Zs.UPLOAD,refCount:a})}disposeIntermediateTensorInfo(t){this.disposeData(t.dataId)}readSync(t){const e=this.texData.get(t),{values:s,dtype:r,complexTensorInfos:a,slice:i,shape:l,isPacked:u}=e;if(i!=null){let m;u?m=new Si(l,bi):m=new na(l,bi);const y=this.runWebGLProgram(m,[{dataId:t,shape:l,dtype:r}],r),b=this.readSync(y.dataId);return this.disposeIntermediateTensorInfo(y),b}if(s!=null)return this.convertAndCacheOnCPU(t);if(r==="string")return s;const h=this.activeTimers!=null;let d;h&&(d=ps());let p;if(r==="complex64"){const m=this.readSync(a.real.dataId),y=this.readSync(a.imag.dataId);p=Ba(m,y)}else p=this.getValuesFromTexture(t);return h&&(this.downloadWaitMs+=ps()-d),this.convertAndCacheOnCPU(t,p)}async read(t){if(this.pendingRead.has(t)){const b=this.pendingRead.get(t);return new Promise(x=>b.push(x))}const e=this.texData.get(t),{values:s,shape:r,slice:a,dtype:i,complexTensorInfos:l,isPacked:u}=e;if(a!=null){let b;u?b=new Si(r,bi):b=new na(r,bi);const x=this.runWebGLProgram(b,[{dataId:t,shape:r,dtype:i}],i),v=this.read(x.dataId);return this.disposeIntermediateTensorInfo(x),v}if(s!=null)return this.convertAndCacheOnCPU(t);if(ut().getBool("DEBUG")&&!ut().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&ut().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let h=null,d;if(i!=="complex64"&&ut().get("WEBGL_BUFFER_SUPPORTED")){d=this.decode(t);const b=this.texData.get(d.dataId);h=this.gpgpu.createBufferFromTexture(b.texture.texture,...dp(r))}this.pendingRead.set(t,[]),i!=="complex64"&&await this.gpgpu.createAndWaitForFence();let p;if(i==="complex64"){const b=await Promise.all([this.read(l.real.dataId),this.read(l.imag.dataId)]),x=b[0],v=b[1];p=Ba(x,v)}else if(h==null)p=this.getValuesFromTexture(t);else{const b=mt(r);p=this.gpgpu.downloadFloat32MatrixFromBuffer(h,b)}if(d!=null&&this.disposeIntermediateTensorInfo(d),h!=null){const b=this.gpgpu.gl;At(b,()=>b.deleteBuffer(h))}const m=this.convertAndCacheOnCPU(t,p),y=this.pendingRead.get(t);return this.pendingRead.delete(t),y.forEach(b=>b(m)),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t)&&Zr().removeDataId(t,this),this.pendingDeletes--),m}readToGPU(t,e={}){const s=this.texData.get(t),{values:r,shape:a,slice:i,dtype:l,isPacked:u,texture:h}=s;if(l==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(i!=null){let y;u?y=new Si(a,bi):y=new na(a,bi);const b=this.runWebGLProgram(y,[{dataId:t,shape:a,dtype:l}],l),x=this.readToGPU(b,e);return this.disposeIntermediateTensorInfo(b),x}if(h==null)throw r!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const d=this.decode(t,e.customTexShape),p=Zr().makeTensorFromTensorInfo(d),m=this.texData.get(d.dataId);return Object.assign({tensorRef:p},m.texture)}bufferSync(t){const e=this.readSync(t.dataId);if(t.dtype==="string")try{const s=e.map(r=>ki(r));return te(t.shape,t.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return te(t.shape,t.dtype,e)}checkNumericalProblems(t){if(t!=null)for(let e=0;e<t.length;e++){const s=t[e];if(!dJ(s))throw ut().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${s} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${s} cannot be represented on this device.`)}}getValuesFromTexture(t){const{shape:e,dtype:s,isPacked:r}=this.texData.get(t),a=mt(e);if(ut().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const m=this.decode(t),y=this.texData.get(m.dataId),b=this.gpgpu.downloadMatrixFromPackedTexture(y.texture.texture,...dp(e)).subarray(0,a);return this.disposeIntermediateTensorInfo(m),b}const i=ut().getBool("WEBGL_PACK")&&r===!0,l=i?mp(e):e,u=i?new Itt(l):new ktt(l),h=this.runWebGLProgram(u,[{shape:l,dtype:s,dataId:t}],"float32"),d=this.texData.get(h.dataId),p=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(d.texture.texture,d.texShape[0],d.texShape[1]).subarray(0,a);return this.disposeIntermediateTensorInfo(h),p}timerAvailable(){return ut().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(t){const e=this.activeTimers,s=[];let r=!1;this.programTimersStack==null?(this.programTimersStack=s,r=!0):this.activeTimers.push(s),this.activeTimers=s,t();const a=Lo(this.activeTimers.map(u=>u.query)).filter(u=>u!=null),i=Lo(this.activeTimers.map(u=>u.name)).filter(u=>u!=null);this.activeTimers=e,r&&(this.programTimersStack=null);const l={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(ut().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const u=await Promise.all(a);l.kernelMs=$M(u),l.getExtraProfileInfo=()=>u.map((h,d)=>({name:i[d],ms:h})).map(h=>`${h.name}: ${h.ms}`).join(", ")}else l.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,l})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return ut().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:ps(),endMs:null}}endTimer(t){return ut().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),t):(t.endMs=ps(),t)}async getQueryTime(t){if(ut().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(t);const e=t;return e.endMs-e.startMs}disposeData(t,e=!1){if(this.pendingDisposal.has(t))return!1;if(!this.texData.has(t))return!0;if(e?this.texData.get(t).refCount=0:this.texData.get(t).refCount--,!e&&this.texData.get(t).refCount>0)return!1;if(this.pendingRead.has(t))return this.pendingDisposal.add(t),this.pendingDeletes++,!1;this.releaseGPUData(t);const{complexTensorInfos:s}=this.texData.get(t);return s!=null&&(this.disposeData(s.real.dataId,e),this.disposeData(s.imag.dataId,e)),this.texData.delete(t),!0}releaseGPUData(t){const{texture:e,dtype:s,texShape:r,usage:a,isPacked:i,slice:l}=this.texData.get(t),u=l&&l.origDataId||t,h=this.dataRefCount.get(u);h>1?this.dataRefCount.set(u,h-1):(this.dataRefCount.delete(u),e!=null&&(this.numBytesInGPU-=this.computeBytes(r,s),this.textureManager.releaseTexture(e,r,a,i)));const d=this.texData.get(t);d.texture=null,d.texShape=null,d.isPacked=!1,d.slice=null}getTexture(t){return this.uploadToGPU(t),this.texData.get(t).texture.texture}getDataInfo(t){return this.texData.get(t)}shouldExecuteOnCPU(t,e=unt){return ut().getBool("WEBGL_CPU_FORWARD")&&t.every(s=>this.texData.get(s.dataId).texture==null&&mt(s.shape)<e)}getGPGPUContext(){return this.gpgpu}where(t){Ys("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const e=t.dataSync();return ant(t.shape,e)}packedUnaryOp(t,e,s){const r=new Si(t.shape,e),a=this.compileAndRun(r,[t],s);return Zr().makeTensorFromTensorInfo(a)}abs(t){if(this.shouldExecuteOnCPU([t])&&t.dtype!=="complex64"){const r=rF(this.texData.get(t.dataId).values);return this.makeOutput(t.shape,t.dtype,r)}if(ut().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,kk,t.dtype);const e=new na(t.shape,kk),s=this.compileAndRun(e,[t]);return Zr().makeTensorFromTensorInfo(s)}makeTensorInfo(t,e,s){let r;if(e==="string"&&s!=null&&s.length>0&&Ch(s[0])){const a=s.map(i=>Ni(i));r=this.write(a,t,e)}else r=this.write(s,t,e);return this.texData.get(r).usage=null,{dataId:r,shape:t,dtype:e}}makeOutput(t,e,s){return Zr().makeTensorFromTensorInfo(this.makeTensorInfo(t,e,s),this)}unpackTensor(t){const e=new rnt(t.shape);return this.runWebGLProgram(e,[t],t.dtype)}packTensor(t){const e=new Uet(t.shape);return this.runWebGLProgram(e,[t],t.dtype,null,!0)}packedReshape(t,e){const s=[xu(t.shape),...vu(t.shape)],r={dtype:t.dtype,shape:s,dataId:t.dataId},a=[xu(e),...vu(e)],i=new oF(a,s),l=!0,u=[s],h=this.runWebGLProgram(i,[r],t.dtype,u,l);return{dataId:h.dataId,shape:e,dtype:h.dtype}}decode(t,e){const s=this.texData.get(t),{isPacked:r,shape:a,dtype:i}=s;if(e!=null){const m=mt(a),y=e[0]*e[1]*4;F(m<=y,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const l=mp(a);let u;r?u=new $tt(l):u=new Ttt(l);const h=!0,d=[e??dp(l)],p=this.runWebGLProgram(u,[{shape:l,dtype:i,dataId:t}],i,d,h,e);return{dtype:i,shape:a,dataId:p.dataId}}runWebGLProgram(t,e,s,r,a=!1,i){const l=this.makeTensorInfo(t.outputShape,s),u=this.texData.get(l.dataId);if(t.packedOutput&&(u.isPacked=!0),t.outPackingScheme===bh.DENSE){const S=i??dp(t.outputShape);u.texShape=S.map(C=>C*2)}if(t.outTexUsage!=null&&(u.usage=t.outTexUsage),mt(l.shape)===0)return u.values=Gn(l.dtype,0),l;const h=[],d=e.map(S=>{if(S.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let C=this.texData.get(S.dataId);if(C.texture==null){if(!t.packedInputs&&mt(S.shape)<=ut().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:S.shape,texData:null,isUniform:!0,uniformValues:C.values};t.packedInputs&&(C.isPacked=!0,C.shape=S.shape)}if(this.uploadToGPU(S.dataId),!!C.isPacked!=!!t.packedInputs)S=C.isPacked?this.unpackTensor(S):this.packTensor(S),h.push(S),C=this.texData.get(S.dataId);else if(C.isPacked&&!fm(C.shape,S.shape)){const $=S,T=S.shape;S.shape=C.shape,S=this.packedReshape(S,T),h.push(S),C=this.texData.get(S.dataId),$.shape=T}return{shape:S.shape,texData:C,isUniform:!1}});this.uploadToGPU(l.dataId);const p={shape:l.shape,texData:u,isUniform:!1},m=Ntt(t,d,p),y=this.getAndSaveBinary(m,()=>Stt(this.gpgpu,t,d,p)),b=this.activeTimers!=null;let x;b&&(x=this.startTimer()),ut().get("ENGINE_COMPILE_ONLY")||Ctt(this.gpgpu,y,d,p,r),h.forEach(S=>this.disposeIntermediateTensorInfo(S)),b&&(x=this.endTimer(x),this.activeTimers.push({name:t.constructor.name,query:this.getQueryTime(x)}));const v=ut().getNumber("WEBGL_FLUSH_THRESHOLD");if(v>0){const S=ps();S-this.lastGlFlushTime>v&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=S)}if(!ut().getBool("WEBGL_LAZILY_UNPACK")&&u.isPacked&&a===!1){const S=this.unpackTensor(l);return this.disposeIntermediateTensorInfo(l),S}return l}compileAndRun(t,e,s,r,a=!1){return s=s||e[0].dtype,this.runWebGLProgram(t,e,s,r,a)}getAndSaveBinary(t,e){return t in this.binaryCache||(this.binaryCache[t]=e()),this.binaryCache[t]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(ut().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(e=>{this.gpgpu.deleteProgram(this.binaryCache[e].webGLProgram),delete this.binaryCache[e]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=at(()=>{if(!ut().get("WEBGL_RENDER_FLOAT32_ENABLED")){const t=ut().getBool("DEBUG");ut().set("DEBUG",!1);const e=this.abs(Vt(1e-8)).dataSync()[0];if(ut().set("DEBUG",t),e>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?int:ont}uploadToGPU(t){const e=this.texData.get(t),{shape:s,dtype:r,values:a,texture:i,usage:l,isPacked:u}=e;if(i!=null)return;const h=this.activeTimers!=null;let d;h&&(d=ps());let p=e.texShape;if(p==null&&(p=DJ(s,u),e.texShape=p),a!=null){const m=mp(s);let y,b=p[1],x=p[0];const v=a instanceof Uint8Array||a instanceof Uint8ClampedArray;(u||!v)&&([b,x]=Mu(p[0],p[1])),u?y=new Dtt(m,v):y=new Ck(m,v);const S=v?[x,b]:p,C=this.makeTensorInfo(S,r),$=this.texData.get(C.dataId);v?$.usage=Zs.PIXELS:$.usage=Zs.UPLOAD,$.texShape=S,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(C.dataId),b,x,a);const T=[[x,b]],A=this.runWebGLProgram(y,[C],r,T,!0),R=this.texData.get(A.dataId);e.texShape=R.texShape,e.isPacked=R.isPacked,e.usage=R.usage,ut().get("ENGINE_COMPILE_ONLY")?this.disposeData(A.dataId):(e.texture=R.texture,e.values=null,this.texData.delete(A.dataId)),this.disposeIntermediateTensorInfo(C),h&&(this.uploadWaitMs+=ps()-d)}else{const m=this.acquireTexture(p,l,r,u);e.texture=m}}convertAndCacheOnCPU(t,e){const s=this.texData.get(t),{dtype:r}=s;return e!=null&&(s.values=dnt(e,r)),s.values}acquireTexture(t,e,s,r){if(this.numBytesInGPU+=this.computeBytes(t,s),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const a=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${a} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(t,e,r)}computeBytes(t,e){return t[0]*t[1]*Up(e)}checkCompileCompletion(){for(const[,t]of Object.entries(this.binaryCache))this.checkCompletion_(t)}async checkCompileCompletionAsync(){const t=[];if(this.gpgpu.parallelCompilationExtension){for(const[,e]of Object.entries(this.binaryCache))t.push(this.checkCompletionAsync_(e));return Promise.all(t)}else{for(const[,e]of Object.entries(this.binaryCache)){const s=new Promise(r=>{try{this.checkCompletion_(e),r(!0)}catch(a){throw a}});t.push(s)}return Promise.all(t)}}async checkCompletionAsync_(t){return this.gpgpu.gl.getProgramParameter(t.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(t):(await WD(),this.checkCompletionAsync_(t))}checkCompletion_(t){if(this.gpgpu.gl.getProgramParameter(t.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(t.webGLProgram)),this.gpgpu.gl.getShaderParameter(t.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(j_(t.source,this.gpgpu.gl.getShaderInfoLog(t.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const t of Object.values(this.binaryCache)){this.gpgpu.buildVao(t.webGLProgram);const{variablesLocations:e,customUniformLocations:s,infLoc:r,nanLoc:a,outShapeLocation:i,outShapeStridesLocation:l,outTexShapeLocation:u}=Z_(this.gpgpu,t.program,t.webGLProgram);t.variablesLocations=e,t.customUniformLocations=s,t.infLoc=r,t.nanLoc=a,t.outShapeLocation=i,t.outShapeStridesLocation=l,t.outTexShapeLocation=u}}createTensorFromGPUData(t,e,s){t.channels=t.channels||"RGBA";const{texture:r,height:a,width:i,channels:l}=t,u=Zr().backend;if(!u.gpgpu.gl.isTexture(r))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const h=u.writeTexture(r,e,s,a,i,l);return Zr().makeTensorFromDataId(h,e,s,u)}}gy.nextDataId=0;function dnt(n,t){if(t==="float32"||t==="complex64")return n;if(t==="int32"||t==="bool"){const e=t==="int32"?new Int32Array(n.length):new Uint8Array(n.length);for(let s=0;s<e.length;++s)e[s]=Math.round(n[s]);return e}else throw new Error(`Unknown dtype ${t}`)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */JI()&&nE("webgl",()=>new gy,2);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zS=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class Xo{constructor(t,e,s){this.variableNames=["A","B"],this.outputShape=Yt(e,s),this.enableShapeUniforms=ns(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${t}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sl=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class Gu{constructor(t,e,s,r=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Yt(e,s);const a=this.outputShape.length;this.enableShapeUniforms=ns(a);let i="";if(r)if(a===0||mt(this.outputShape)===1)i=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(i=`
          ${$e(a)} coords = getOutputCoords();
        `,a===1)this.enableShapeUniforms?i+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:i+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const u=us("coords",a);this.enableShapeUniforms?i+=`
            bool nextRowOutOfBounds =
              (${u[a-2]} + 1) >= outShape[${a} - 2];
            bool nextColOutOfBounds =
              (${u[a-1]} + 1) >= outShape[${a} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:i+=`
            bool nextRowOutOfBounds =
              (${u[a-2]} + 1) >= ${this.outputShape[a-2]};
            bool nextColOutOfBounds =
              (${u[a-1]} + 1) >= ${this.outputShape[a-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${t}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${i}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ms(n){const{inputs:t,backend:e}=n,{x:s}=t;return e.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const fnt={kernelName:Wh,backendName:"webgl",kernelFunc:Ms};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yi(n){const{inputs:t,backend:e}=n,{real:s,imag:r}=t,a=e.makeTensorInfo(s.shape,"complex64"),i=e.texData.get(a.dataId),l=Ms({inputs:{x:s},backend:e}),u=Ms({inputs:{x:r},backend:e});return i.complexTensorInfos={real:l,imag:u},a}const pnt={kernelName:P1,backendName:"webgl",kernelFunc:Yi};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lF="return (a < 0.) ? b * a : a;",uF=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function mnt(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{alpha:a}=s,i=e.makeTensorInfo([],"float32",Pi(a,"float32")),l=ut().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Gu(uF,r.shape,i.shape):new Xo(lF,r.shape,i.shape),u=e.runWebGLProgram(l,[r,i],"float32");return e.disposeIntermediateTensorInfo(i),u}const gnt={kernelName:Km,backendName:"webgl",kernelFunc:mnt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cF="return (a < 0.) ? b * a : a;",hF=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function ynt(n){const{inputs:t,backend:e}=n,{x:s,alpha:r}=t,a=ut().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Gu(hF,s.shape,r.shape):new Xo(cF,s.shape,r.shape);return e.runWebGLProgram(a,[s,r],"float32")}const bnt={kernelName:pg,backendName:"webgl",kernelFunc:ynt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wu="if (isnan(x)) return x;";function me({opSnippet:n,packedOpSnippet:t,cpuKernelImpl:e,dtype:s}){return({inputs:r,backend:a})=>{const{x:i}=r,l=a,u=s||i.dtype;if(l.shouldExecuteOnCPU([i])&&e!=null){const p=l.texData.get(i.dataId),m=e(p.values,u);return l.makeTensorInfo(i.shape,u,m)}const h=ut().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&t!=null;let d;return h?d=new Si(i.shape,t):d=new na(i.shape,n),l.runWebGLProgram(d,[i],u)}}function Xn({opSnippet:n,packedOpSnippet:t,checkOutOfBounds:e=!1,supportsComplex:s=!1,cpuKernelImpl:r,dtype:a}){return({inputs:i,backend:l})=>{const{a:u,b:h}=i,d=l;if(s&&u.dtype==="complex64"){const b=d.texData.get(u.dataId),x=d.texData.get(h.dataId),[v,S]=[[b.complexTensorInfos.real,x.complexTensorInfos.real],[b.complexTensorInfos.imag,x.complexTensorInfos.imag]].map($=>{const[T,I]=$,A={dataId:T.dataId,dtype:T.dtype,shape:u.shape},R={dataId:I.dataId,dtype:I.dtype,shape:h.shape},L=new Xo(n,u.shape,h.shape);return d.runWebGLProgram(L,[A,R],Os(T.dtype,I.dtype))}),C=Yi({inputs:{real:v,imag:S},backend:d});return d.disposeIntermediateTensorInfo(v),d.disposeIntermediateTensorInfo(S),C}const p=a||Os(u.dtype,h.dtype);if((u.dtype==="string"||h.dtype==="string"||d.shouldExecuteOnCPU([u,h]))&&r!=null){const b=d.texData.get(u.dataId).values,x=d.texData.get(h.dataId).values,v=u.dtype==="string"?Pa(b):b,S=u.dtype==="string"?Pa(x):x,[C,$]=r(u.shape,h.shape,v,S,p),T=d.makeTensorInfo($,p),I=d.texData.get(T.dataId);return I.values=C,T}const m=ut().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&t!=null;let y;return m?y=new Gu(t,u.shape,h.shape,e):y=new Xo(n,u.shape,h.shape),d.runWebGLProgram(y,[u,h],p)}}function xh(n,t=!1){if(n==="linear")return t?Jet:Xet;if(n==="relu")return t?ent:Yet;if(n==="elu")return t?tnt:Ket;if(n==="relu6")return t?nnt:Zet;if(n==="prelu")return t?hF:cF;if(n==="leakyrelu")return t?uF:lF;if(n==="sigmoid")return t?snt:Qet;throw new Error(`Activation ${n} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dF{constructor(t,e,s,r=!1,a=!1,i=!1,l=null,u=!1,h=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=s,this.enableShapeUniforms=ns(this.outputShape.length);const d=r?t[1]:t[2],p=Math.ceil(d/2),m=r?"i * 2, rc.y":"rc.y, i * 2",y=a?"rc.z, i * 2":"i * 2, rc.z",b=r?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],x=a?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let v="",S="";l&&(u?v=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${l}
        }`:h?v=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${l}
        }`:v=`vec4 activation(vec4 x) {
          ${l}
        }`,S="result = activation(result);");const C=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),u&&this.variableNames.push("preluActivationWeights"),h&&this.variableNames.push("leakyreluAlpha");let $="rc.x",T="rc.x";t[0]<e[0]?$=`imod(rc.x, ${t[0]})`:e[0]<t[0]&&(T=`imod(rc.x, ${e[0]})`),this.userCode=`
      ${v}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${p}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${$};
        int batchB = ${T};
        for (int i = 0; i < ${p}; i++) {
          vec4 a = getMatrixA(batchA, ${m});
          vec4 b = getMatrixB(batchB, ${y});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${b[0]} * ${x[0]});
          result += (${b[1]} * ${x[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${C}

        ${S}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ik={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class Ek{constructor(t,e,s){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Yt(e,s),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${t}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dk="return a * b;";function MS(n){const{inputs:t,backend:e}=n,{a:s,b:r}=t,a=Os(s.dtype,r.dtype);if(s.dtype==="complex64"){const l=e.texData.get(s.dataId),u=e.texData.get(r.dataId),h=new Ek(Ik.REAL,s.shape,r.shape),d=new Ek(Ik.IMAG,s.shape,r.shape),p=[{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:s.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:s.shape},{dataId:u.complexTensorInfos.real.dataId,dtype:u.complexTensorInfos.real.dtype,shape:r.shape},{dataId:u.complexTensorInfos.imag.dataId,dtype:u.complexTensorInfos.imag.dtype,shape:r.shape}],m=e.runWebGLProgram(h,p,"float32"),y=e.runWebGLProgram(d,p,"float32"),b=Yi({inputs:{real:m,imag:y},backend:e});return e.disposeIntermediateTensorInfo(m),e.disposeIntermediateTensorInfo(y),b}if(e.shouldExecuteOnCPU([s,r])){const l=e.texData.get(s.dataId),u=e.texData.get(r.dataId),[h,d]=get(s.shape,r.shape,l.values,u.values,a),p=e.makeTensorInfo(d,a),m=e.texData.get(p.dataId);return m.values=h,p}let i;return ut().getBool("WEBGL_PACK_BINARY_OPERATIONS")?i=new Gu(Dk,s.shape,r.shape):i=new Xo(Dk,s.shape,r.shape),e.runWebGLProgram(i,[s,r],a)}const xnt={kernelName:Jh,backendName:"webgl",kernelFunc:MS};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vnt(n,t,e){const s=[xu(n.shape),...vu(n.shape)],r={dtype:n.dtype,shape:s,dataId:n.dataId},a=[xu(t),...vu(t)],i=new oF(a,s),l=!0,u=[s],h=e.runWebGLProgram(i,[r],n.dtype,u,l);return{dataId:h.dataId,shape:t,dtype:h.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $t(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{shape:a}=s,i=e,l=mt(r.shape),u=OI(a,l),h=mt(u);F(l===h,()=>`The new shape (${u}) has ${h} elements and the old shape (${r.shape}) has ${l} elements. The new shape and old shape must have the same number of elements.`);const d=i.texData.get(r.dataId);return d.isPacked&&!fm(r.shape,u)&&!(d.texture!==null&&fm(d.shape,u))?vnt(r,u,i):(i.incRef(r.dataId),{dataId:r.dataId,shape:u,dtype:r.dtype})}const wnt={kernelName:gg,backendName:"webgl",kernelFunc:$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ak{constructor(t,e){this.variableNames=["x"];const{windowSize:s,batchSize:r,inSize:a,outSize:i}=t;this.outputShape=[r,i];const l=Math.floor(s/4)*4,u=s%4;let h="sumValue += dot(values, ones);";if(e!=null){const p=1/e;h=`sumValue += dot(values * ${uu(p)?p.toPrecision(2):p}, ones);`}let d="";a%s>0&&(d=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${d}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        float sumValue = 0.0;

        for (int i = 0; i < ${l}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${h}
        }

        int inIdx = inOffset + ${l};
        if (${u===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${h}
        } else if (${u===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${h}
        } else if (${u===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${h}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Snt{constructor(t,e){this.variableNames=["x"];const{windowSize:s,batchSize:r,inSize:a,outSize:i}=t;this.outputShape=[r,i];let l="0.0",u="";e==="prod"?l="1.0":e==="min"?(l="1.0 / 1e-20",u="min"):e==="max"&&(l="-1.0 / 1e-20",u="max");let h=`${e}(${e}(${e}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;e==="sum"?h="sumValue":e==="prod"?h="prodValue":e==="all"?h="allValue":e==="any"&&(h="anyValue");const d=Math.floor(s/4)*4,p=s%4;let m=`
      if (${e==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${e==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${u}(values, minMaxValue);
        if (${e==="min"} || ${e==="max"}) {
          minMaxValue = ${u}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,y="vec4";e==="all"?(l="1.0",m=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,y="bvec4"):e==="any"&&(l="0.0",m=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,y="bvec4");let b="";a%s>0&&(b=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${l};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${b}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        vec4 minMaxValue = vec4(${l});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${d}; i += 4) {
          int inIdx = inOffset + i;
          ${y} values = ${y}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${m}
        }

        int inIdx = inOffset + ${d};
        if (${p===1}) {
          ${y} values = ${y}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${m}
        } else if (${p===2}) {
          ${y} values = ${y}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${m}
        } else if (${p===3}) {
          ${y} values = ${y}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${m}
        }
        setOutput(${h});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cnt(n){const t=[];for(;t.length===0||t[t.length-1].outSize!==1;){const e=t.length?t[t.length-1].outSize:n[1],s=ty(e);t.push({inSize:e,windowSize:s,outSize:Math.ceil(e/s)})}return t}function rl(n,t,e,s){const r=Cnt(n.shape);let a=n;for(let i=0;i<r.length;i++){const{inSize:l,windowSize:u,outSize:h}=r[i];let d,p;e==="mean"?d=i===0?new Ak({windowSize:u,inSize:l,batchSize:n.shape[0],outSize:h},l):new Ak({windowSize:u,inSize:l,batchSize:n.shape[0],outSize:h}):d=new Snt({windowSize:u,inSize:l,batchSize:n.shape[0],outSize:h},e),p=a,a=s.runWebGLProgram(d,[a],t),p.dataId!==n.dataId&&s.disposeIntermediateTensorInfo(p)}return a}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Nnt{constructor(t,e){this.variableNames=["A"];const s=new Array(t.length);for(let i=0;i<s.length;i++)s[i]=t[e[i]];this.outputShape=s,this.rank=s.length;const r=$e(this.rank),a=Tnt(e);this.userCode=`
    void main() {
      ${r} resRC = getOutputCoords();
      setOutput(getA(${a}));
    }
    `}}function Tnt(n){const t=n.length;if(t>6)throw Error(`Transpose for rank ${t} is not yet supported`);const e=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],s=new Array(t);for(let r=0;r<n.length;r++)s[n[r]]=e[r];return s.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $nt{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const s=new Array(t.length);for(let d=0;d<s.length;d++)s[d]=t[e[d]];if(this.outputShape=s,this.rank=s.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const r=$e(this.rank),a=iF("rc",this.rank),i=new Array(this.rank);for(let d=0;d<e.length;d++)i[e[d]]=a[d];const l=`vec2(${i.slice(-2).join()})`,u=`++${a[this.rank-1]} < ${s[this.rank-1]}`,h=`getChannel(getA(${i.join()}), ${l})`;this.userCode=`
    void main() {
      ${r} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${h};
      if(${u}) {
        result[1] = ${h};
      }
      --${a[this.rank-1]};
      if(++${a[this.rank-2]} < ${s[this.rank-2]}) {
        result[2] = ${h};
        if(${u}) {
          result[3] = ${h};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yy(n,t,e){const s=ut().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new $nt(n.shape,t):new Nnt(n.shape,t);return e.runWebGLProgram(s,[n],n.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function knt(n,t,e,s){const r=t,a=n.shape.length,i=re(r,n.shape);let l=i;const u=qe(l,a),h=u!=null;let d=n;h&&(d=yy(n,u,s),l=ln(l.length,a)),jn("sum",l,a);const[p,m]=_n(d.shape,l);let y=p;e&&(y=on(p,i));const b=mt(m),v=mt(n.shape)/b,S=$t({inputs:{x:d},attrs:{shape:[v,b]},backend:s}),C=Mv(n.dtype),$=rl(S,C,"sum",s),T=$t({inputs:{x:$},attrs:{shape:y},backend:s});return s.disposeIntermediateTensorInfo(S),s.disposeIntermediateTensorInfo($),h&&s.disposeIntermediateTensorInfo(d),T}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function by(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{axis:a,keepDims:i}=s;return knt(r,a,i,e)}const Int={kernelName:Sg,backendName:"webgl",kernelFunc:by};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cs(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{perm:a}=s,i=e,l=r.shape.length,u=new Array(l);for(let d=0;d<u.length;d++)u[d]=r.shape[a[d]];let h;if(i.shouldExecuteOnCPU([r])){const p=i.texData.get(r.dataId).values,m=LS(p,r.shape,r.dtype,a,u);h=i.makeTensorInfo(u,r.dtype);const y=i.texData.get(h.dataId);y.values=m}else h=yy(r,a,i);return h}const Ent={kernelName:nu,backendName:"webgl",kernelFunc:cs};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fF=1e3;function pm({a:n,b:t,transposeA:e,transposeB:s,backend:r,bias:a=null,preluActivationWeights:i=null,leakyreluAlpha:l=0,activation:u=null}){const h=n.shape.length,d=t.shape.length,p=e?n.shape[h-2]:n.shape[h-1],m=s?t.shape[d-1]:t.shape[d-2],y=e?n.shape[h-1]:n.shape[h-2],b=s?t.shape[d-2]:t.shape[d-1],x=n.shape.slice(0,-2),v=t.shape.slice(0,-2),S=mt(x),C=mt(v),T=Yt(n.shape.slice(0,-2),t.shape.slice(0,-2)).concat([y,b]);F(p===m,()=>`Error in matMul: inner shapes (${p}) and (${m}) of Tensors with shapes ${n.shape} and ${t.shape} and transposeA=${e} and transposeB=${s} must match.`);const I=e?[S,p,y]:[S,y,p],A=s?[C,b,m]:[C,m,b],R=$t({inputs:{x:n},backend:r,attrs:{shape:I}}),L=$t({inputs:{x:t},backend:r,attrs:{shape:A}}),_=[R,L],M=Math.max(S,C),D=e?R.shape[1]:R.shape[2],W=a!=null,et=i!=null,nt=u==="leakyrelu",tt=u!=null?xh(u,!0):null,U=W||et||nt||tt!=null;let Y;if((y===1||b===1)&&D>fF&&U===!1){let G=R,O=L;e&&(G=cs({inputs:{x:R},backend:r,attrs:{perm:[0,2,1]}}),_.push(G)),s&&(O=cs({inputs:{x:L},backend:r,attrs:{perm:[0,2,1]}}),_.push(O));const V=b!==1,P=b===1;let H=G;V&&(H=$t({inputs:{x:G},backend:r,attrs:{shape:[M,D,1]}}),_.push(H));const Q=b===1?2:1;let ot=O;P&&(ot=$t({inputs:{x:O},backend:r,attrs:{shape:[M,1,D]}}),_.push(ot));const lt=MS({inputs:{a:H,b:ot},backend:r});Y=by({inputs:{x:lt},backend:r,attrs:{axis:Q,keepDims:!0}}),_.push(lt)}else{const G=Os(n.dtype,t.dtype),O=new dF(I,A,[M,y,b],e,s,W,tt,et,nt),V=[R,L];if(a!=null&&V.push(a),et&&V.push(i),nt){const P=r.makeTensorInfo([],"float32",Pi(l,"float32"));V.push(P),_.push(P)}Y=r.runWebGLProgram(O,V,G)}const Z=$t({inputs:{x:Y},backend:r,attrs:{shape:T}});_.push(Y);for(const G of _)r.disposeIntermediateTensorInfo(G);return Z}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dnt(n){const{inputs:t,backend:e,attrs:s}=n,{a:r,b:a,bias:i,preluActivationWeights:l}=t,{transposeA:u,transposeB:h,activation:d,leakyreluAlpha:p}=s;return pm({a:r,b:a,transposeA:u,transposeB:h,backend:e,bias:i,preluActivationWeights:l,leakyreluAlpha:p,activation:d})}const Ant={kernelName:Gp,backendName:"webgl",kernelFunc:Dnt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rk="return abs(x);";function Rnt(n){const{inputs:t,backend:e}=n,{x:s}=t;if(e.shouldExecuteOnCPU([s])&&s.dtype!=="complex64"){const a=e.texData.get(s.dataId),i=rF(a.values);return e.makeTensorInfo(s.shape,s.dtype,i)}let r;return ut().getBool("WEBGL_PACK_UNARY_OPERATIONS")?r=new Si(s.shape,Rk):r=new na(s.shape,Rk),e.runWebGLProgram(r,[s],s.dtype)}const Ont={kernelName:km,backendName:"webgl",kernelFunc:Rnt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _nt=kr+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,Fnt=me({opSnippet:_nt}),Lnt={kernelName:Nh,backendName:"webgl",kernelFunc:Fnt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const znt=kr+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,Mnt=me({opSnippet:znt}),Bnt={kernelName:Th,backendName:"webgl",kernelFunc:Mnt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ok="return a + b;",Pnt=Xn({opSnippet:Ok,packedOpSnippet:Ok,supportsComplex:!0,cpuKernelImpl:Xtt}),Vnt={kernelName:Au,backendName:"webgl",kernelFunc:Pnt};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Unt{constructor(t,e){this.outputShape=[],this.outputShape=t,this.variableNames=e.map((a,i)=>`T${i}`);const s=[];this.variableNames.forEach(a=>{s.push(`float v${a} = get${a}AtOutCoords();`)});const r=this.variableNames.map(a=>`v${a}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        float result = ${r};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Gnt{constructor(t,e){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.variableNames=e.map((a,i)=>`T${i}`);const s=[];this.variableNames.forEach(a=>{s.push(`vec4 v${a} = get${a}AtOutCoords();`)});const r=this.variableNames.map(a=>`v${a}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        vec4 result = ${r};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rp(n){const{inputs:t,backend:e}=n,s=t;if(s.length===1)return Ms({inputs:{x:s[0]},backend:e});if(s.length>ut().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const u=Math.floor(s.length/2),h=Rp({inputs:s.slice(0,u),backend:e}),d=Rp({inputs:s.slice(u),backend:e});return Rp({inputs:[h,d],backend:e})}const r=s.map(u=>u.dtype).reduce((u,h)=>Os(u,h)),a=s.map(u=>u.shape),l=ut().getBool("WEBGL_PACK")?new Gnt(s[0].shape,a):new Unt(s[0].shape,a);return e.runWebGLProgram(l,s,r)}const Wnt={kernelName:Im,backendName:"webgl",kernelFunc:Rp};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hnt(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{axis:a,keepDims:i}=s,l=r.shape.length,u=re(a,r.shape);let h=u;const d=qe(h,l);let p=r;d!=null&&(p=cs({inputs:{x:r},backend:e,attrs:{perm:d}}),h=ln(h.length,l)),jn("all",h,l);const[m,y]=_n(p.shape,h),b=mt(y),x=$t({inputs:{x:p},backend:e,attrs:{shape:[-1,b]}}),v=rl(x,x.dtype,"all",e);let S;if(i){const C=on(m,u);S=$t({inputs:{x:v},backend:e,attrs:{shape:C}})}else S=$t({inputs:{x:v},backend:e,attrs:{shape:m}});return e.disposeIntermediateTensorInfo(x),e.disposeIntermediateTensorInfo(v),d!=null&&e.disposeIntermediateTensorInfo(p),S}const jnt={kernelName:_1,backendName:"webgl",kernelFunc:Hnt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qnt(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{axis:a,keepDims:i}=s,l=r.shape.length,u=re(a,r.shape);let h=u;const d=qe(h,l);let p=r;d!=null&&(p=cs({inputs:{x:r},backend:e,attrs:{perm:d}}),h=ln(h.length,l)),jn("any",h,l);const[m,y]=_n(p.shape,h),b=mt(y),x=$t({inputs:{x:p},backend:e,attrs:{shape:[-1,b]}}),v=rl(x,x.dtype,"any",e);let S;if(i){const C=on(m,u);S=$t({inputs:{x:v},backend:e,attrs:{shape:C}})}else S=$t({inputs:{x:v},backend:e,attrs:{shape:m}});return e.disposeIntermediateTensorInfo(x),e.disposeIntermediateTensorInfo(v),d!=null&&e.disposeIntermediateTensorInfo(p),S}const Xnt={kernelName:F1,backendName:"webgl",kernelFunc:qnt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Knt{constructor(t,e,s){this.variableNames=["A"];const{windowSize:r,batchSize:a,outSize:i}=t;s||this.variableNames.push("bestIndicesA"),this.outputShape=[a,i];const l=e==="max"?">":"<",u=s?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${r}; i++) {
          int inIdx = ${u};
          float candidate = getA(batch, inIdx);
          if (candidate ${l} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ynt{constructor(t,e,s,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,F(t.length>2,()=>`Packed arg${s.charAt(0).toUpperCase()+s.slice(1)} supports only inputs with rank above 2.`);const a=t[t.length-1],i=Math.ceil(a/e);this.outputShape=t.slice(0,-1),i>1&&this.outputShape.push(i),r||this.variableNames.push("bestIndicesA");const l=this.outputShape,u=l.length,h=$e(u),d=us("coords",u);let p,m;if(i===1){m=u+1;const L=$e(m);p=`
        ${L} sourceLocR = ${L}(${d.join()}, 0);
        ++${d[u-1]};
        ${L} sourceLocG = ${L}(${d.join()}, 0);
        ++${d[u-2]};
        ${L} sourceLocA = ${L}(${d.join()}, 0);
        --${d[u-1]};
        ${L} sourceLocB = ${L}(${d.join()}, 0);
        --${d[u-2]};`}else m=u,p=`
        ${h} sourceLocR = coords;
        ++${d[u-1]};
        ${h} sourceLocG = coords;
        ++${d[u-2]};
        ${h} sourceLocA = coords;
        --${d[u-1]};
        ${h} sourceLocB = coords;
        --${d[u-2]};`;const y=["x","y","z","w","u","v"].slice(0,m),b="."+y[m-1],x=y.map(L=>"int "+L),v=us("sourceLocR",m-1).concat("inIdx.r"),S=us("sourceLocG",m-1).concat("inIdx.g"),C=us("sourceLocB",m-1).concat("inIdx.b"),$=us("sourceLocA",m-1).concat("inIdx.a"),T=s==="max"?"greaterThan":"lessThan",I=r?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${v.join()}),
                             getBestIndicesAChannel(${S.join()}),
                             getBestIndicesAChannel(${C.join()}),
                             getBestIndicesAChannel(${$.join()})));`,A=`vec4(
            getAChannel(${v.join()}),
            hasNextCol ? getAChannel(${S.join()}) : 0.,
            hasNextRow ? getAChannel(${C.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${$.join()}) : 0.)`,R=r?"":`
      float getBestIndicesAChannel(${x.join()}) {
        return getChannel(getBestIndicesA(${y.join()}),
                                          vec2(${y.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${x.join()}) {
        return getChannel(getA(${y.join()}),
                               vec2(${y.slice(-2).join()}));
      }
      ${R}
      void main() {
        ${h} coords = getOutputCoords();
        bool hasNextCol = ${d[u-1]} < ${l[u-1]-1};
        bool hasNextRow = ${d[u-2]} < ${l[u-2]-1};
        ${p}
        ivec4 srcIdx = ivec4(sourceLocR${b}, sourceLocG${b},
          sourceLocB${b}, sourceLocA${b}) * ${e};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${A};

        for (int i = 0; i < ${e}; i++) {
          inIdx = srcIdx;
          ${I}
          vec4 candidate = ${A};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${T}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pF(n,t,e,s=null){let r=t.shape[0],a=t.shape[1];s!=null&&(r=s.shape[0],a=s.shape[1]);const i=ty(a),l={windowSize:i,inSize:a,batchSize:r,outSize:Math.ceil(a/i)},u=new Knt(l,e,s==null),h=[t];s!=null&&h.push(s);const d=n.runWebGLProgram(u,h,"int32");if(d.shape[1]===1)return d;const p=pF(n,t,e,d);return n.disposeIntermediateTensorInfo(d),p}function mF(n,t,e,s=null){const r=s!=null?s.shape:t.shape,a=r[r.length-1],i=ty(a),l=new Ynt(r,i,e,s==null),u=s==null?[t]:[t,s],h=n.runWebGLProgram(l,u,"int32");if(h.shape.length===t.shape.length){const d=mF(n,t,e,h);return n.disposeIntermediateTensorInfo(h),d}return h}function gF(n,t,e,s){const r=[e];if(jn("arg"+s.charAt(0).toUpperCase()+s.slice(1),r,t.shape.length),!ut().getBool("WEBGL_PACK_REDUCE")||t.shape.length<=2){const a=[],i=n.texData.get(t.dataId),l=i!==null&&i.isPacked;let u=t;l&&(u=n.unpackTensor(t),a.push(u));const[h,d]=_n(u.shape,r),p=mt(d),m=$t({inputs:{x:u},backend:n,attrs:{shape:[-1,p]}});a.push(m);const y=pF(n,m,s);a.push(y);const b=$t({inputs:{x:y},backend:n,attrs:{shape:h}});return a.forEach(x=>n.disposeIntermediateTensorInfo(x)),b}return mF(n,t,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Znt(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{axis:a}=s;let i=re(a,r.shape);const l=qe(i,r.shape.length);let u=r;const h=[];l!=null&&(u=cs({inputs:{x:r},backend:e,attrs:{perm:l}}),h.push(u),i=ln(i.length,u.shape.length)),jn("argMax",[i[0]],u.shape.length);const d=gF(e,u,i[0],"max");return h.forEach(p=>e.disposeIntermediateTensorInfo(p)),d}const Qnt={kernelName:Em,backendName:"webgl",kernelFunc:Znt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jnt(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{axis:a}=s;let i=re(a,r.shape);const l=qe(i,r.shape.length);let u=r;const h=[];l!=null&&(u=cs({inputs:{x:r},backend:e,attrs:{perm:l}}),h.push(u),i=ln(i.length,u.shape.length)),jn("argMin",[i[0]],u.shape.length);const d=gF(e,u,i[0],"min");return h.forEach(p=>e.disposeIntermediateTensorInfo(p)),d}const tst={kernelName:Dm,backendName:"webgl",kernelFunc:Jnt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const est=kr+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,nst=me({opSnippet:est}),sst={kernelName:$h,backendName:"webgl",kernelFunc:nst};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rst=kr+"return log(x + sqrt(x * x + 1.0));",ast=me({opSnippet:rst}),ist={kernelName:kh,backendName:"webgl",kernelFunc:ast};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ost=kr+`
  return atan(x);
`,lst=me({opSnippet:ost}),ust={kernelName:Ih,backendName:"webgl",kernelFunc:lst};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cst=zS+`
  return atan(a, b);
`,hst=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+sl+`
  return result;
`,dst=Xn({opSnippet:cst,packedOpSnippet:hst}),fst={kernelName:Dh,backendName:"webgl",kernelFunc:dst};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pst=kr+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,mst=me({opSnippet:pst}),gst={kernelName:Eh,backendName:"webgl",kernelFunc:mst};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vh{constructor(t,e,s,r=!1,a=!1){if(this.variableNames=["x"],e==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const i=t.filterWidth,l=t.strideHeight,u=t.strideWidth,h=t.dilationHeight,d=t.dilationWidth,p=t.effectiveFilterHeight,m=t.effectiveFilterWidth,y=t.padInfo.top,b=t.padInfo.left;this.outputShape=t.outShape;const x=e==="avg",v=`((batch  * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + d`,S=`(xR * ${t.inWidth} + xC) * ${t.inChannels} + d`;let C="0.0";if(x||(C="-1.0 / 1e-20"),s){const L=">=";this.userCode=`
        const ivec2 strides = ivec2(${l}, ${u});
        const ivec2 pads = ivec2(${y}, ${b});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${p};
              wR += ${h}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${m};
                wC += ${d}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${t.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${L} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${r?a?v:S:`wR * ${m} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const $="max";let T=`${e}(${e}(${e}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;e==="avg"&&(T="avgValue / max(count, 1.0)");const I=Math.floor(i/4)*4,A=i%4,R=`
      if (${x}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${$}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${l}, ${u});
      const ivec2 pads = ivec2(${y}, ${b});
      const float initializationValue = ${C};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${t.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${C});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${p};
            wR += ${h}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${t.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${I}; wC += 4) {
            int xC = xCCorner + wC * ${d};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${d}, d),
              getValue(batch, xR, xC + 2 * ${d}, d),
              getValue(batch, xR, xC + 3 * ${d}, d)
            );

            ${R}
          }

          int xC = xCCorner + ${I};
          if (${A===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${R}
          } else if (${A===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${d}, d),
              initializationValue,
              initializationValue
            );

            ${R}
          } else if (${A===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${d}, d),
              getValue(batch, xR, xC + 2 * ${d}, d),
              initializationValue
            );

            ${R}
          }
        }
        setOutput(${T});
      }
    `}}class BS{constructor(t,e,s,r=!1,a=!1){if(this.variableNames=["x"],e==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const i=t.filterWidth,l=t.strideDepth,u=t.strideHeight,h=t.strideWidth,d=t.dilationDepth,p=t.dilationHeight,m=t.dilationWidth,y=t.effectiveFilterDepth,b=t.effectiveFilterHeight,x=t.effectiveFilterWidth,v=t.padInfo.front,S=t.padInfo.top,C=t.padInfo.left;this.outputShape=t.outShape;const $=e==="avg";let T="0.0";if($||(T="-1.0 / 1e-20"),s){const M=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${l}, ${u}, ${h});
        const ivec3 pads = ivec3(${v}, ${S}, ${C});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${y};
              wD += ${d}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${t.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${b};
                wR += ${p}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${t.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${x};
                  wC += ${m}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${t.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${M} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${r?a?`(((batch * ${t.inDepth} + xD) * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + ch`:`((xD * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + ch`:`wD * ${b} * ${x} +
                      wR * ${x} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const I="max";let A=`${e}(${e}(${e}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;e==="avg"&&(A="avgValue / max(count, 1.0)");const R=Math.floor(i/4)*4,L=i%4,_=`
      if (${$}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${I}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${l}, ${u}, ${h});
      const ivec3 pads = ivec3(${v}, ${S}, ${C});
      const float initializationValue = ${T};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${t.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${T});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${y};
            wD += ${d}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${t.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${b};
            wR += ${p}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${R}; wC += 4) {
              int xC = xCCorner + wC * ${m};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${m}, ch),
                getValue(batch, xD, xR, xC + 2 * ${m}, ch),
                getValue(batch, xD, xR, xC + 3 * ${m}, ch)
              );

              ${_}
            }

            int xC = xCCorner + ${R};
            if (${L===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${_}
            } else if (${L===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${m}, ch),
                initializationValue,
                initializationValue
              );

              ${_}
            } else if (${L===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${m}, ch),
                getValue(batch, xD, xR, xC + 2 * ${m}, ch),
                initializationValue
              );

              ${_}
            }
          }
        }
        setOutput(${A});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yst(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t;Pd(r,"avgPool");const{filterSize:a,strides:i,pad:l,dimRoundingMode:u}=s,h=1;F(Hn(i,h),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${h}'`);const d=Tr(r.shape,a,i,h,l,u);if(d.filterWidth===1&&d.filterHeight===1&&de(d.inShape,d.outShape))return Ms({inputs:{x:r},backend:e});const p=new vh(d,"avg",!1);return e.runWebGLProgram(p,[r],"float32")}const bst={kernelName:Am,backendName:"webgl",kernelFunc:yst};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xst(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{filterSize:a,strides:i,pad:l,dimRoundingMode:u,dataFormat:h}=s,d=[1,1,1],p=Ua(r.shape,a,i,d,l,u,h),m=new BS(p,"avg",!1);return e.runWebGLProgram(m,[r],"float32")}const vst={kernelName:Rm,backendName:"webgl",kernelFunc:xst};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wst{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;const e=t.filterHeight,s=t.filterWidth,r=t.strideHeight,a=t.strideWidth,i=t.dilationHeight,l=t.dilationWidth,u=t.effectiveFilterHeight,h=t.effectiveFilterWidth,d=u-1-t.padInfo.top,p=h-1-t.padInfo.left,m=1/(e*s);this.userCode=`
      const ivec2 pads = ivec2(${d}, ${p});
      const float avgMultiplier = float(${m});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${u};
            wR += ${i}) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${h};
            wC+= ${l}) {
            float dyC = float(dyCCorner + wC) / ${a}.0;

            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class Sst{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;const e=t.filterDepth,s=t.filterHeight,r=t.filterWidth,a=t.strideDepth,i=t.strideHeight,l=t.strideWidth,u=t.dilationDepth,h=t.dilationHeight,d=t.dilationWidth,p=t.effectiveFilterDepth,m=t.effectiveFilterHeight,y=t.effectiveFilterWidth,b=p-1-t.padInfo.front,x=m-1-t.padInfo.top,v=y-1-t.padInfo.left,S=1/(e*s*r);this.userCode=`
      const ivec3 pads = ivec3(${b}, ${x}, ${v});
      const float avgMultiplier = float(${S});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${p};
            wD += ${u}) {
          float dyD = float(dyDCorner + wD) / ${a}.0;

          if (dyD < 0.0 || dyD >= ${t.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${m};
              wR += ${h}) {
            float dyR = float(dyRCorner + wR) / ${i}.0;

            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${y};
                wC += ${d}) {
              float dyC = float(dyCCorner + wC) / ${l}.0;

              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cst(n){const{inputs:t,backend:e,attrs:s}=n,{dy:r,input:a}=t,i=a,{filterSize:l,strides:u,pad:h,dimRoundingMode:d}=s,p=[1,1,1],m=Ua(i.shape,l,u,p,h,d),y=new Sst(m);return e.runWebGLProgram(y,[r],i.dtype)}const Nst={kernelName:z1,backendName:"webgl",kernelFunc:Cst};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tst(n){const{inputs:t,backend:e,attrs:s}=n,{dy:r,input:a}=t,i=a;Pd([r,a],"avgPoolGrad");const{filterSize:l,strides:u,pad:h}=s,d=Tr(i.shape,l,u,1,h),p=new wst(d);return e.runWebGLProgram(p,[r],i.dtype)}const $st={kernelName:L1,backendName:"webgl",kernelFunc:Tst};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kst(n){const{inputs:t,backend:e,attrs:s}=n,{a:r,b:a}=t,{transposeA:i,transposeB:l}=s;return pm({a:r,b:a,transposeA:i,transposeB:l,backend:e})}const Ist={kernelName:Om,backendName:"webgl",kernelFunc:kst};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Est{constructor(t,e,s,r,a,i){this.outputShape=[],this.variableNames=["x","mean","variance"],Yt(t,e),Yt(t,s);let l="0.0";r!=null&&(Yt(t,r),this.variableNames.push("offset"),l="getOffsetAtOutCoords()");let u="1.0";a!=null&&(Yt(t,a),this.variableNames.push("scale"),u="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${l};
        float scale = ${u};
        float inv = scale * inversesqrt(variance + float(${i}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Dst{constructor(t,e,s,r,a,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Yt(t,e),Yt(t,s);let l="vec4(0.0)";r!=null&&(Yt(t,r),this.variableNames.push("offset"),l="getOffsetAtOutCoords()");let u="vec4(1.0)";a!=null&&(Yt(t,a),this.variableNames.push("scale"),u="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`
      void main() {
        vec4 offset = ${l};
        vec4 scale = ${u};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${i}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ast=({inputs:n,backend:t,attrs:e})=>{const{x:s,mean:r,variance:a,offset:i,scale:l}=n;F(r.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),F(i==null||r.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),F(l==null||r.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:u}=e;u==null&&(u=.001);const h=[s,r,a];let d=null;i!=null&&(d=i.shape,h.push(i));let p=null;l!=null&&(p=l.shape,h.push(l));const m=ut().getBool("WEBGL_PACK_NORMALIZATION")?new Dst(s.shape,r.shape,a.shape,d,p,u):new Est(s.shape,r.shape,a.shape,d,p,u);return t.runWebGLProgram(m,h,h[0].dtype)},Rst={kernelName:jm,backendName:"webgl",kernelFunc:Ast};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ost{constructor(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;const e=$e(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const s=_st(this.rank);let r;const a=t.map((i,l)=>`sourceLoc.${b1[l]} = start[${l}] + coords.${b1[l]};`);r=`
        ${e} sourceLoc;
        ${e} coords = getOutputCoords();
        ${a.join(`
`)}
      `,this.userCode=`
      void main() {
        ${r}
        setOutput(getSource(${s}));
      }
    `}}const b1=["x","y","z","w","u","v"];function _st(n){if(n===1)return"sourceLoc";if(n<=6)return b1.slice(0,n).map(t=>"sourceLoc."+t).join(",");throw Error(`Slicing for rank ${n} is not yet supported`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fst{constructor(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const e=$e(this.rank),s=us("coords",this.rank),r=us("sourceLoc",this.rank),a=this.rank===1?"sourceLoc":`vec2(${r.slice(-2).join()})`,i=`getChannel(getSource(${r.join()}), ${a})`,l=`
      result.x = ${i};
      if (++${s[this.rank-1]} < ${t[this.rank-1]}) {
        ++${r[this.rank-1]};
        result.y = ${i};
        --${r[this.rank-1]};
      }
    `,u=this.rank===1?"":`
      --${s[this.rank-1]};
      if (++${s[this.rank-2]} < ${t[this.rank-2]}) {
        ++${r[this.rank-2]};
        result.z = ${i};
        if (++${s[this.rank-1]} < ${t[this.rank-1]}) {
          ++${r[this.rank-1]};
          result.w = ${i};
        }
      }
    `,h=this.rank<=4?`sourceLoc = coords +
            ${e}(${t.map((d,p)=>`start[${p}]`).join()});`:t.map((d,p)=>`${r[p]} = ${s[p]} + start[${p}];`).join(`
`);this.userCode=`
      void main() {
        ${e} coords = getOutputCoords();
        ${e} sourceLoc;
        ${h}
        vec4 result = vec4(0.);
        ${l}
        ${u}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lst(n,t,e,s){const r=s.texData.get(n.dataId),a=s.makeTensorInfo(e,n.dtype),i=s.texData.get(a.dataId);Object.assign(i,r),i.refCount=1,i.shape=e,i.dtype=n.dtype;let l=Ow(t,Bt(n.shape));r.slice&&(l+=r.slice.flatOffset),i.slice={flatOffset:l,origDataId:r.slice&&r.slice.origDataId||n.dataId};const u=s.dataRefCount.get(i.slice.origDataId)||1;return s.dataRefCount.set(i.slice.origDataId,u+1),a}function Hu(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{begin:a,size:i}=s,[l,u]=Jg(r,a,i);if(Dw(r,l,u),mt(u)===0)return e.makeTensorInfo(u,r.dtype,[]);if(e.shouldExecuteOnCPU([r])||r.dtype==="string"){const p=e.texData.get(r.dataId),m=Iet(p.values,l,u,r.shape,r.dtype);return e.makeTensorInfo(u,r.dtype,m)}const{isPacked:h}=e.texData.get(r.dataId),d=Rw(r.shape,l,u);if(h||!d){const p=ut().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Fst(u):new Ost(u),m=[l];return e.runWebGLProgram(p,[r],r.dtype,m)}return e.uploadToGPU(r.dataId),Lst(r,l,u,e)}const zst={kernelName:wg,backendName:"webgl",kernelFunc:Hu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mst=n=>{const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{blockShape:a,crops:i}=s;F(r.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const l=a.reduce((C,$)=>C*$),u=kd(r.shape,a,l),h=Id(u.length,a.length),d=Ed(r.shape,a,l),p=Mw(i,a.length),m=Bw(d,i,a.length),y=[],b=$t({inputs:{x:r},backend:e,attrs:{shape:u}}),x=cs({inputs:{x:b},backend:e,attrs:{perm:h}}),v=$t({inputs:{x},backend:e,attrs:{shape:d}}),S=Hu({inputs:{x:v},backend:e,attrs:{begin:p,size:m}});return y.push(b),y.push(x),y.push(v),y.forEach(C=>e.disposeIntermediateTensorInfo(C)),S},Bst={kernelName:_m,backendName:"webgl",kernelFunc:Mst};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pst(n){const{inputs:t,backend:e,attrs:s}=n,{x:r,weights:a}=t,{size:i}=s,l=e.readSync(r.dataId),u=e.readSync(a.dataId),h=sF(l,u,a.dtype,a.shape,i);return e.makeTensorInfo([i],a.dtype,h)}const Vst={kernelName:M1,backendName:"webgl",kernelFunc:Pst};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ust=`
  int r = int(a.r) & int(b.r);
  int g = int(a.g) & int(b.g);
  int rb = int(a.b) & int(b.b);
  int ra = int(a.a) & int(b.a);
  return vec4(r, g, rb, ra);
`,Gst=`
  return float(int(a.r) & int(b.r));
`;function Wst(n){const{inputs:t,backend:e}=n,{a:s,b:r}=t,a=ut().getBool("WEBGL_PACK_BINARY_OPERATIONS"),i=ut().getNumber("WEBGL_VERSION");if(e.shouldExecuteOnCPU([s,r])||i===1){const u=e.texData.get(s.dataId).values,h=e.texData.get(r.dataId).values,[d,p]=Ytt(s.shape,r.shape,u,h,s.dtype),m=e.makeTensorInfo(p,s.dtype),y=e.texData.get(m.dataId);return y.values=d,m}let l;return a?l=new Gu(Ust,s.shape,r.shape,!1):l=new Xo(Gst,s.shape,r.shape),e.runWebGLProgram(l,[s,r],s.dtype)}const Hst={kernelName:Fm,backendName:"webgl",kernelFunc:Wst};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jst(n){const{inputs:t,backend:e}=n,{s0:s,s1:r}=t,a=e.readSync(s.dataId),i=e.readSync(r.dataId),l=Yt(Array.from(a),Array.from(i));return e.makeTensorInfo([l.length],"int32",Int32Array.from(l))}const qst={kernelName:B1,backendName:"webgl",kernelFunc:jst};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xst="return float(a != b);",yF=Xn({opSnippet:Xst,cpuKernelImpl:bet,dtype:"bool"}),Kst={kernelName:ug,backendName:"webgl",kernelFunc:yF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ud(n){const{inputs:t,backend:e}=n,{input:s}=t,r=e.texData.get(s.dataId);return Ms({inputs:{x:r.complexTensorInfos.real},backend:e})}const Yst={kernelName:bv,backendName:"webgl",kernelFunc:Ud};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zst="return float(int(x));";function Qst(n,t){const e=new na(n.shape,Zst),s=t.runWebGLProgram(e,[n],"int32");return{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x1(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{dtype:a}=s;if(a==="complex64"){if(r.dtype==="complex64")return Ms({inputs:{x:r},backend:e});const i=vn(r.shape),l=x1({inputs:{x:r},backend:e,attrs:{dtype:"float32"}}),u=Yi({inputs:{real:l,imag:i},backend:e});return i.dispose(),e.disposeIntermediateTensorInfo(l),u}if(r.dtype==="complex64"){const i=Ud({inputs:{input:r},backend:e}),l=x1({inputs:{x:i},backend:e,attrs:{dtype:a}});return e.disposeIntermediateTensorInfo(i),l}if(!_I(r.dtype,a)){const i=Ms({inputs:{x:r},backend:e});return{dataId:i.dataId,shape:i.shape,dtype:a}}if(e.shouldExecuteOnCPU([r])){const i=e.texData.get(r.dataId).values,[l,u,h]=Ztt(i,r.shape,r.dtype,a);return e.makeTensorInfo(l,u,h)}if(a==="int32")return Qst(r,e);if(a==="bool"){const i=e.makeTensorInfo([],"bool",Gn("bool",1)),u=yF({inputs:{a:r,b:i},backend:e});return e.disposeIntermediateTensorInfo(i),u}throw new Error(`Error in Cast: failed to cast ${r.dtype} to ${a}`)}const Jst={kernelName:Ah,backendName:"webgl",kernelFunc:x1};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _k="return ceil(x);",trt=me({opSnippet:_k,packedOpSnippet:_k,cpuKernelImpl:Qtt}),ert={kernelName:Rh,backendName:"webgl",kernelFunc:trt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nrt{constructor(t){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=t,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class srt{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=t,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rrt(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{clipValueMin:a,clipValueMax:i}=s;let l;ut().getBool("WEBGL_PACK_CLIP")?l=new srt(r.shape):l=new nrt(r.shape);const u=[[a],[i]];return e.runWebGLProgram(l,[r],r.dtype,u)}const art={kernelName:Oh,backendName:"webgl",kernelFunc:rrt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class irt{constructor(t){this.variableNames=["real","imag"],this.outputShape=t,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fk(n,t){return{dataId:t.dataId,dtype:t.dtype,shape:n.shape}}function ort(n){const{inputs:t,backend:e}=n,{x:s}=t,r=e.texData.get(s.dataId),a=new irt(s.shape),i=[Fk(s,r.complexTensorInfos.real),Fk(s,r.complexTensorInfos.imag)];return e.runWebGLProgram(a,i,i[0].dtype)}const lrt={kernelName:Lm,backendName:"webgl",kernelFunc:ort};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class urt{constructor(t){this.outputShape=[],this.outputShape=ra(t,1),this.variableNames=t.map((i,l)=>`T${l}`);const e=new Array(t.length-1);e[0]=t[0][1];for(let i=1;i<e.length;i++)e[i]=e[i-1]+t[i][1];const s=[`if (yC < ${e[0]}) setOutput(getT0(yR, yC));`];for(let i=1;i<e.length;i++){const l=e[i-1];s.push(`else if (yC < ${e[i]}) setOutput(getT${i}(yR, yC-${l}));`)}const r=e.length,a=e[e.length-1];s.push(`else setOutput(getT${r}(yR, yC-${a}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${s.join(`
        `)}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class crt{constructor(t,e){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=ra(t,e);const s=this.outputShape,r=s.length,a=$e(r),i=us("coords",r),l=["x","y","z","w","u","v"].slice(0,r);this.variableNames=t.map((x,v)=>`T${v}`);const u=new Array(t.length-1);u[0]=t[0][e];for(let x=1;x<u.length;x++)u[x]=u[x-1]+t[x][e];const h=l[e],d=l.slice(-2),p=l.join();let m=`if (${h} < ${u[0]}) {
        return getChannel(
            getT0(${p}), vec2(${d.join()}));
        }`;for(let x=1;x<u.length;x++){const v=u[x-1];m+=`
        if (${h} < ${u[x]}  && ${h} >= ${u[x-1]}) {
          return getChannel(
            getT${x}(${bp(l,h,v)}),
            vec2(${bp(d,h,v)}));
        }`}const y=u.length,b=u[u.length-1];m+=`
        return getChannel(
          getT${y}(${bp(l,h,b)}),
          vec2(${bp(d,h,b)}));`,this.userCode=`
      float getValue(${l.map(x=>"int "+x)}) {
        ${m}
      }

      void main() {
        ${a} coords = getOutputCoords();
        vec4 result = vec4(getValue(${i}), 0., 0., 0.);

        ${i[r-1]} = ${i[r-1]} + 1;
        if (${i[r-1]} < ${s[r-1]}) {
          result.g = getValue(${i});
        }

        ${i[r-2]} = ${i[r-2]} + 1;
        if (${i[r-2]} < ${s[r-2]}) {
          result.a = getValue(${i});
        }

        ${i[r-1]} = ${i[r-1]} - 1;
        if (${i[r-2]} < ${s[r-2]} &&
            ${i[r-1]} < ${s[r-1]}) {
          result.b = getValue(${i});
        }
        setOutput(result);
      }
    `}}function bp(n,t,e){const s=n.indexOf(t);return n.map((a,i)=>i===s?`${a} - ${e}`:a).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xy(n){const{inputs:t,backend:e}=n,{input:s}=t,r=e.texData.get(s.dataId);return Ms({inputs:{x:r.complexTensorInfos.imag},backend:e})}const hrt={kernelName:rv,backendName:"webgl",kernelFunc:xy};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sh(n,t,e){const s=n[0].dtype;if(s==="complex64"){const y=n.map(C=>Ud({inputs:{input:C},backend:e})),b=n.map(C=>xy({inputs:{input:C},backend:e})),x=sh(y,t,e),v=sh(b,t,e),S=Yi({inputs:{real:x,imag:v},backend:e});return y.forEach(C=>e.disposeIntermediateTensorInfo(C)),b.forEach(C=>e.disposeIntermediateTensorInfo(C)),e.disposeIntermediateTensorInfo(x),e.disposeIntermediateTensorInfo(v),S}let r=e.shouldExecuteOnCPU(n);if(s==="string"&&(r=!0),r){const y=n.map(T=>{const A=[-1,mt(T.shape.slice(t))];return $t({inputs:{x:T},backend:e,attrs:{shape:A}})}),b=y.map(T=>({vals:e.readSync(T.dataId),shape:T.shape})),x=ra(y.map(T=>T.shape),1),v=y[0].shape[0]===1,S=Jtt(b,x,s,v),C=ra(n.map(T=>T.shape),t),$=e.makeTensorInfo(C,s,S);return y.forEach(T=>e.disposeIntermediateTensorInfo(T)),$}const a=n.filter(y=>mt(y.shape)>0),i=ut().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&a[0].shape.length>1;if(a.length===1){const y=i?new na(n[0].shape,bi):new Si(n[0].shape,bi);return e.runWebGLProgram(y,n,s)}const l=ut().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(a.length>l){const y=[];for(let x=0;x<a.length;x+=l){const v=a.slice(x,x+l);y.push(sh(v,t,e))}const b=sh(y,t,e);for(const x of y)e.disposeIntermediateTensorInfo(x);return b}if(i){const y=new crt(a.map(b=>b.shape),t);return e.runWebGLProgram(y,a,s)}const{tensors2D:u,outShape:h}=drt(a,t,e),d=new urt(u.map(y=>y.shape)),p=e.runWebGLProgram(d,u,s);u.forEach(y=>e.disposeIntermediateTensorInfo(y));const m=$t({inputs:{x:p},attrs:{shape:h},backend:e});return e.disposeIntermediateTensorInfo(p),m}function drt(n,t,e){const s=ra(n.map(a=>a.shape),t);return{tensors2D:n.map(a=>$t({inputs:{x:a},attrs:{shape:[-1,mt(a.shape.slice(t))]},backend:e})),outShape:s}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bF(n){const{inputs:t,backend:e,attrs:s}=n,{axis:r}=s,a=re(r,t[0].shape)[0],i=t.map(h=>h.shape);Fw(i,a);const l=ra(t.map(h=>h.shape),a);if(mt(l)===0)return e.makeTensorInfo(l,t[0].dtype,[]);const u=t.filter(h=>mt(h.shape)>0);return u.length===1?Ms({inputs:{x:u[0]},backend:e}):sh(u,a,e)}const frt={kernelName:zm,backendName:"webgl",kernelFunc:bF};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xF{constructor(t,e=!1,s=null,r=!1,a=!1){this.variableNames=["x","W"],this.outputShape=t.outShape;const i=t.padInfo.top,l=t.padInfo.left,u=t.strideHeight,h=t.strideWidth,d=t.dilationHeight,p=t.dilationWidth,m=t.filterHeight,y=t.filterWidth,b=Math.floor(t.inChannels/4)*4,x=t.inChannels%4,v=t.dataFormat==="channelsLast",S=v?1:2,C=v?2:3,$=v?3:1;let T="",I="";s&&(r?T=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:a?T=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:T=`
          float activation(float x) {
            ${s}
          }
        `,I="result = activation(result);");const A=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${T}

      const ivec2 strides = ivec2(${u}, ${h});
      const ivec2 pads = ivec2(${i}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${$}];

        ivec2 xRCCorner =
            ivec2(coords[${S}], coords[${C}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${m}; wR++) {
          int xR = xRCorner + wR * ${d};

          if (xR < 0 || xR >= ${t.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${y}; wC++) {
            int xC = xCCorner + wC * ${p};

            if (xC < 0 || xC >= ${t.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${b}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${v}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${x===1}) {

              if (${v}) {
                dotProd +=
                    getX(batch, xR, xC, ${b}) *
                    getW(wR, wC, ${b}, d2);
              } else {
                dotProd +=
                    getX(batch, ${b}, xR, xC) *
                    getW(wR, wC, ${b}, d2);
              }

            } else if (${x===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${b}, d2),
                getW(wR, wC, ${b} + 1, d2)
              );

              if (${v}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${b}),
                  getX(batch, xR, xC, ${b} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${b}, xR, xC),
                  getX(batch, ${b} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${x===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${b}, d2),
                getW(wR, wC, ${b} + 1, d2),
                getW(wR, wC, ${b} + 2, d2)
              );

              if (${v}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${b}),
                  getX(batch, xR, xC, ${b} + 1),
                  getX(batch, xR, xC, ${b} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${b}, xR, xC),
                  getX(batch, ${b} + 1, xR, xC),
                  getX(batch, ${b} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${A}
        ${I}
        setOutput(result);
      }
    `}}class prt{constructor(t){this.variableNames=["x","W"],this.outputShape=t.outShape;const e=t.padInfo.front,s=t.padInfo.top,r=t.padInfo.left,a=t.strideDepth,i=t.strideHeight,l=t.strideWidth,u=t.dilationDepth,h=t.dilationHeight,d=t.dilationWidth,p=t.filterDepth,m=t.filterHeight,y=t.filterWidth,b=Math.floor(t.inChannels/4)*4,x=t.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${a}, ${i}, ${l});
      const ivec3 pads = ivec3(${e}, ${s}, ${r});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${p}; wF++) {
          int xF = xFCorner + wF * ${u};

          if (xF < 0 || xF >= ${t.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${m}; wR++) {
            int xR = xRCorner + wR * ${h};

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${y}; wC++) {
              int xC = xCCorner + wC * ${d};

              if (xC < 0 || xC >= ${t.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${b}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${x===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${b}) *
                  getW(wF, wR, wC, ${b}, d2);
              } else if (${x===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${b}),
                  getX(batch, xF, xR, xC, ${b} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${b}, d2),
                  getW(wF, wR, wC, ${b} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${x===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${b}),
                  getX(batch, xF, xR, xC, ${b} + 1),
                  getX(batch, xF, xR, xC, ${b} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${b}, d2),
                  getW(wF, wR, wC, ${b} + 1, d2),
                  getW(wF, wR, wC, ${b} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vF{constructor(t,e=!1,s=null,r=!1,a=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=ns(this.outputShape.length);const i=t.padInfo.left,l=t.strideWidth,u=t.dilationWidth,h=t.filterHeight,d=t.filterWidth,p=d;let m=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let v=0;v<d;v++)m+=`
           vec4 xTexelC${v*2};
           int xTexelC${v*2}Ready;
           vec4 xTexelC${v*2+1};
           int xTexelC${v*2+1}Ready;
           vec4 xC${v};`;m+=`
     for (int r = 0; r < ${h}; r++) {
      for (int d1 = 0; d1 < ${t.inChannels}; d1 += 2) {
       `;for(let v=0;v<d;v++)m+=`
           xTexelC${v*2} = vec4(0.0);
           xTexelC${v*2}Ready = 0;
           xTexelC${v*2+1} = vec4(0.0);
           xTexelC${v*2+1}Ready = 0;
           xC${v} = vec4(0.0);`;m+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let v=0;v<(p+1)/2;v++){const S=v*2;if(m+=`
           xC = xCCorner + ${S*u};
           `,l===1){if(S<d&&(i%2===1?(m+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${S}Ready == 0) {
                   xTexelC${S} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${S}.zw = vec2(0.0);
                   }
                   xTexelC${S}Ready = 1;
                 }
               `,u===1&&S>0?m+=`
                 xC${S} = vec4(xTexelC${S-2}.zw, xTexelC${S}.xy);
                 `:m+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${S} = vec4(previous.zw, xTexelC${S}.xy);
                   } else {
                     xC${S} = vec4(0.0, 0.0, xTexelC${S}.xy);
                   }
                   `):m+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${S}Ready == 0) {
                   xTexelC${S} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${S}.zw = vec2(0.0);
                   }
                   xTexelC${S}Ready = 1;
                 }

                 xC${S} = xTexelC${S};
                 `,S+1<d)){const C=i%2===0?A1(u):u;u%2===0&&i%2===1||u%2!==0&&i%2!==1?(m+=`
                   xCOffset = xC + imod(pads[1], 2) + ${C};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${S+1}Ready == 0) {
                     xTexelC${S+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${S+1}.zw = vec2(0.0);
                     }
                     xTexelC${S+1}Ready = 1;
                   }
                   `,u>1?m+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${S+1} = vec4(previous.zw, xTexelC${S+1}.xy);
                     } else {
                      xC${S+1} = vec4(0.0, 0.0, xTexelC${S+1}.xy);
                     }
                     `:m+=`
                     xC${S+1} = vec4(xTexelC${S}.zw, xTexelC${S+1}.xy);
                     `):C===1?m+=`
                     xC${S+1} = xTexelC${S};
                     `:m+=`
                     xCOffset = xC + ${C};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${S+1}Ready == 0) {
                       xTexelC${S+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${S+1}.zw = vec2(0.0);
                       }
                       xTexelC${S+1}Ready = 1;
                     }

                     xC${S+1} = xTexelC${S+1};
                     `}}else S<d&&(i%2===1?(m+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${S}Ready == 0) {
                   xTexelC${S} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${S}.zw = vec2(0.0);
                   }
                   xTexelC${S}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${S+1}Ready == 0) {
                   xTexelC${S+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${S+1}.zw = vec2(0.0);
                   }
                   xTexelC${S+1}Ready = 1;
                 }

                 xC${S} = vec4(xTexelC${S}.zw, xTexelC${S+1}.zw);
               `,S+1<d&&(m+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${S+1} = vec4(xTexelC${S+1}.xy, final.xy);
                 `)):(m+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${S}Ready == 0) {
                   xTexelC${S} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${S}.zw = vec2(0.0);
                   }
                   xTexelC${S}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${S+1}Ready == 0) {
                   xTexelC${S+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${S+1}.zw = vec2(0.);
                   }
                   xTexelC${S+1}Ready = 1;
                 }

                 xC${S} = vec4(
                   xTexelC${S}.xy, xTexelC${S+1}.xy);
               `,S+1<d&&(m+=`
                   xC${S+1} = vec4(xTexelC${S}.zw, xTexelC${S+1}.zw);
                 `)));S<d&&(m+=`
             wTexel = getW(r, ${S}, d1, d2);
             dotProd += xC${S}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${t.inChannels}) {
               dotProd += xC${S}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,S+1<d&&(m+=`
               wTexel = getW(r, ${S+1}, d1, d2);
               dotProd += xC${S+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${t.inChannels}) {
                 dotProd += xC${S+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}m+=`
     }
   `,m+=`
     }
   `,m+=`
     }
   `;let y="",b="";s&&(r?y=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${s}
         }`:a?y=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${s}
         }`:y=`vec4 activation(vec4 x) {
           ${s}
         }`,b="result = activation(result);");const x=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${y}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${m}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${x}
         ${b}
         setOutput(result);
       }
     `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mrt{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=t,this.enableShapeUniforms=ns(this.outputShape.length);const{dataFormat:s}=e,r=ds(),a=s==="channelsLast",i=a?1:2,l=a?2:3,u=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${t[2]} && pos < ${t[1]}) {`;let h="";for(let d=0;d<=1;d++)for(let p=0;p<=1;p++)h+=`
          blockIndex = rc.z + ${p};
          pos = rc.y + ${d};

          ${u}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${i}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${l}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${a}) {
                  innerDims = vec2(d1, ch);
                  result[${d*2+p}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${d*2+p}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${h}

        ${r.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mm(n,t){const e=n.length;return e>=3?t?[...n.slice(0,-3),n[e-3]*n[e-2],n[e-1]]:[...n.slice(0,-3),n[e-3],n[e-2]*n[e-1]]:!t&&e===1&&n[0]>1?[n[0],1]:null}function wF({x:n,filter:t,convInfo:e,backend:s,bias:r=null,preluActivationWeights:a=null,leakyreluAlpha:i=0,activation:l=null}){const u=n.shape,h=s.texData.get(n.dataId),d=e.inChannels,p=u[0]*u[1]*u[2],m=e.outChannels,y=e.dataFormat==="channelsLast",b=!1,x=!1;let v;const S=[];if(a!=null){const T=mm(a.shape,y);T!=null&&(a=$t({inputs:{x:a},backend:s,attrs:{shape:T}}),S.push(a))}if(r!=null){const T=mm(r.shape,y);T!=null&&(r=$t({inputs:{x:r},backend:s,attrs:{shape:T}}),S.push(r))}if(!((p===1||m===1)&&d>fF)&&h.isPacked&&y&&h.texture!=null&&u[2]%2!==0&&de(h.shape.slice(-3),u.slice(-3))){const T=u[0]*u[1]*(u[2]+1),I={dataId:n.dataId,shape:[1,T,e.inChannels],dtype:n.dtype},A=h.shape;h.shape=h.shape.slice(),h.shape[h.shape.length-2]++,F(fm(h.shape,I.shape),()=>`packed reshape ${h.shape} to ${I.shape} isn't free`);const R=$t({inputs:{x:t},backend:s,attrs:{shape:[1,e.inChannels,e.outChannels]}});S.push(R);const L=pm({a:I,b:R,backend:s,transposeA:b,transposeB:x,bias:r,activation:l,preluActivationWeights:a,leakyreluAlpha:i}),_=s.texData.get(L.dataId);F(_.isPacked,()=>"batchMatMul result is expected to be packed"),h.shape=A,_.shape=e.outShape,v=Ms({inputs:{x:L},backend:s}),v.shape=e.outShape,S.push(L)}else{const T=e.outHeight*e.outWidth,I=$t({inputs:{x:n},backend:s,attrs:{shape:y?[e.batchSize,T,e.inChannels]:[e.batchSize,e.inChannels,T]}}),A=$t({inputs:{x:t},backend:s,attrs:{shape:[1,e.inChannels,e.outChannels]}}),R=pm({a:y?I:A,b:y?A:I,transposeA:!y,transposeB:x,backend:s,bias:r,activation:l,preluActivationWeights:a,leakyreluAlpha:i});v=$t({inputs:{x:R},backend:s,attrs:{shape:e.outShape}}),S.push(I),S.push(A),S.push(R)}for(const T of S)s.disposeIntermediateTensorInfo(T);return v}function SF({x:n,filter:t,convInfo:e,backend:s,bias:r=null,preluActivationWeights:a=null,leakyreluAlpha:i=0,activation:l=null}){const{filterWidth:u,filterHeight:h,inChannels:d,outWidth:p,outHeight:m,dataFormat:y}=e,b=y==="channelsLast",x=u*h*d,v=m*p,S=[e.batchSize,x,v],C=!0,$=!1,T=[];if(a!=null){const Z=mm(a.shape,b);Z!=null&&(a=$t({inputs:{x:a},backend:s,attrs:{shape:Z}}),T.push(a))}if(r!=null){const Z=mm(r.shape,b);Z!=null&&(r=$t({inputs:{x:r},backend:s,attrs:{shape:Z}}),T.push(r))}const I=$t({inputs:{x:t},backend:s,attrs:{shape:[1,x,mt(t.shape)/x]}});T.push(I);const A=new mrt(S,e),R=[n.shape,[e.padInfo.top,e.padInfo.left],[e.strideHeight,e.strideWidth],[e.dilationHeight,e.dilationWidth],[e.inChannels],[e.filterWidth*e.inChannels],[e.outWidth]],L=s.runWebGLProgram(A,[n],"float32",R),_=$t({inputs:{x:L},backend:s,attrs:{shape:S}});T.push(L),T.push(_);const M=r!=null,D=a!=null,W=l==="leakyrelu",et=l?xh(l,!0):null,nt=new dF(b?_.shape:I.shape,b?I.shape:_.shape,b?[e.batchSize,v,e.outChannels]:[e.batchSize,e.outChannels,v],C,$,M,et,D,W),tt=b?[_,I]:[I,_];if(r&&tt.push(r),D&&tt.push(a),W){const Z=s.makeTensorInfo([],"float32",Pi(i,"float32"));tt.push(Z),T.push(Z)}const U=s.runWebGLProgram(nt,tt,"float32"),Y=$t({inputs:{x:U},backend:s,attrs:{shape:e.outShape}});T.push(U);for(const Z of T)s.disposeIntermediateTensorInfo(Z);return Y}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function grt(n){const{inputs:t,backend:e,attrs:s}=n,{x:r,filter:a}=t,{strides:i,pad:l,dataFormat:u,dilations:h,dimRoundingMode:d}=s,p=Ga(u),m=On(r.shape,a.shape,i,h,l,d,!1,p);let y;if(m.filterHeight===1&&m.filterWidth===1&&m.dilationHeight===1&&m.dilationWidth===1&&m.strideHeight===1&&m.strideWidth===1&&(m.padInfo.type==="SAME"||m.padInfo.type==="VALID"))y=wF({x:r,filter:a,convInfo:m,backend:e});else if(m.strideWidth<=2&&p==="channelsLast"&&ut().getBool("WEBGL_EXP_CONV")){const x=new vF(m),v=[[m.padInfo.top,m.padInfo.left],[m.strideHeight,m.strideWidth],[m.dilationHeight,m.dilationWidth],[m.inHeight,m.inWidth]];y=e.runWebGLProgram(x,[r,a],"float32",v)}else if(ut().getBool("WEBGL_CONV_IM2COL"))y=SF({x:r,filter:a,convInfo:m,backend:e});else{const x=new xF(m);y=e.runWebGLProgram(x,[r,a],"float32")}const b=$t({inputs:{x:y},backend:e,attrs:{shape:m.outShape}});return e.disposeIntermediateTensorInfo(y),b}const yrt={kernelName:Mm,backendName:"webgl",kernelFunc:grt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class brt{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const e=t.strideHeight,s=t.strideWidth,r=t.padInfo.top,a=t.padInfo.left,i=t.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${t.batchSize}; b++) {
          for (int yR = 0; yR < ${t.outHeight}; yR++) {
            int xR = wR + yR * ${e} - ${r};

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${t.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${a};

              if (xC < 0 || xC >= ${t.inWidth}) {
                continue;
              }

              ${i?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class xrt{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const e=t.filterHeight,s=t.filterWidth,r=t.strideHeight,a=t.strideWidth,i=t.dataFormat==="channelsLast",l=e-1-t.padInfo.top,u=s-1-t.padInfo.left,h=i?1:2,d=i?2:3,p=i?3:1;this.userCode=`
      const ivec2 pads = ivec2(${l}, ${u});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${p}];

        ivec2 dyCorner = ivec2(coords[${h}], coords[${d}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${e}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${e} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${a}.0;

            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            for (int d2 = 0; d2 < ${t.outChannels}; d2++) {

              if (${i}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class vrt{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const e=t.strideDepth,s=t.strideHeight,r=t.strideWidth,a=t.padInfo.front,i=t.padInfo.top,l=t.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${t.batchSize}; b++) {
          for (int yF = 0; yF < ${t.outDepth}; yF++) {
            int xF = wF + yF * ${e} - ${a};

            if (xF < 0 || xF >= ${t.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${t.outHeight}; yR++) {
              int xR = wR + yR * ${s} - ${i};

              if (xR < 0 || xR >= ${t.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${t.outWidth}; yC++) {
                int xC = wC + yC * ${r} - ${l};

                if (xC < 0 || xC >= ${t.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class wrt{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const e=t.filterDepth,s=t.filterHeight,r=t.filterWidth,a=t.strideDepth,i=t.strideHeight,l=t.strideWidth,u=e-1-t.padInfo.front,h=s-1-t.padInfo.top,d=r-1-t.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${u}, ${h}, ${d});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${e}; wF++) {
          float dyF = float(dyFCorner + wF) / ${a}.0;

          if (dyF < 0.0 || dyF >= ${t.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${e} - 1 - wF;

          for (int wR = 0; wR < ${s}; wR++) {
            float dyR = float(dyRCorner + wR) / ${i}.0;

            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${s} - 1 - wR;

            for (int wC = 0; wC < ${r}; wC++) {
              float dyC = float(dyCCorner + wC) / ${l}.0;

              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${r} - 1 - wC;

              for (int d2 = 0; d2 < ${t.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Srt(n){const{inputs:t,backend:e,attrs:s}=n,{x:r,dy:a}=t,{strides:i,pad:l,dataFormat:u,dimRoundingMode:h,filterShape:d}=s,p=Ga(u),m=On(r.shape,d,i,1,l,h,!1,p),y=new brt(m);return e.runWebGLProgram(y,[r,a],"float32")}const Crt={kernelName:V1,backendName:"webgl",kernelFunc:Srt};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Nrt{constructor(t){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=t.inShape,this.enableShapeUniforms=ns(this.outputShape.length);const e=t.filterHeight,s=t.filterWidth,r=e-1-t.padInfo.top,a=s-1-t.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${r}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${e}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${e} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            int wCPerm = ${s} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${t.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${t.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${t.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${t.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${t.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Trt(n){const{inputs:t,backend:e,attrs:s}=n,{dy:r,filter:a}=t,{inputShape:i,strides:l,pad:u,dataFormat:h,dimRoundingMode:d}=s,p=Ga(h),m=On(i,a.shape,l,1,u,d,!1,p);if(ut().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&p==="channelsLast"){const y=[[m.strideHeight,m.strideWidth]],b=new Nrt(m);return e.runWebGLProgram(b,[r,a],"float32",y)}else{const y=new xrt(m);return e.runWebGLProgram(y,[r,a],"float32")}}const $rt={kernelName:Bm,backendName:"webgl",kernelFunc:Trt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function krt(n){const{inputs:t,backend:e,attrs:s}=n,{x:r,filter:a}=t,{strides:i,pad:l,dilations:u}=s,h=Gi(r.shape,a.shape,i,u,l),d=new prt(h);return e.runWebGLProgram(d,[r,a],"float32")}const Irt={kernelName:Pm,backendName:"webgl",kernelFunc:krt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ert(n){const{inputs:t,backend:e,attrs:s}=n,{x:r,dy:a}=t,{strides:i,pad:l,filterShape:u}=s,h=Gi(r.shape,u,i,1,l),d=new vrt(h);return e.runWebGLProgram(d,[r,a],"float32")}const Drt={kernelName:U1,backendName:"webgl",kernelFunc:Ert};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Art(n){const{inputs:t,backend:e,attrs:s}=n,{dy:r,filter:a}=t,{pad:i,strides:l,inputShape:u}=s,h=Gi(u,a.shape,l,1,i),d=new wrt(h);return e.runWebGLProgram(d,[r,a],"float32")}const Rrt={kernelName:G1,backendName:"webgl",kernelFunc:Art};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ort=Wu+`
  return cos(x);
`,_rt=`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${sl}
  return result;
`,Frt=me({opSnippet:Ort,packedOpSnippet:_rt}),Lrt={kernelName:_h,backendName:"webgl",kernelFunc:Frt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zrt=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,Mrt=me({opSnippet:zrt}),Brt={kernelName:Fh,backendName:"webgl",kernelFunc:Mrt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Prt{constructor(t,e,s,r,a){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[i,l,u,h]=t,[d]=e,[p,m]=s;this.outputShape=[d,p,m,h];const y=r==="bilinear"?1:0,[b,x]=[`${l-1}.0`,`${u-1}.0`],[v,S,C]=p>1?[`${(l-1)/(p-1)}`,"(y2-y1) * height_ratio",`y1*${b} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${b}`],[$,T,I]=m>1?[`${(u-1)/(m-1)}`,"(x2-x1) * width_ratio",`x1*${x} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${x}`];this.userCode=`
      const float height_ratio = float(${v});
      const float width_ratio = float(${$});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${i}) {
          return;
        }

        float height_scale = ${S};
        float width_scale = ${T};

        float in_y = ${C};
        if( in_y < 0.0 || in_y > ${b} ) {
          setOutput(float(${a}));
          return;
        }
        float in_x = ${I};
        if( in_x < 0.0 || in_x > ${x} ) {
          setOutput(float(${a}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${y} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vrt=n=>{const{inputs:t,backend:e,attrs:s}=n,{image:r,boxes:a,boxInd:i}=t,{cropSize:l,method:u,extrapolationValue:h}=s,d=new Prt(r.shape,a.shape,l,u,h);return e.runWebGLProgram(d,[r,a,i],"float32")},Urt={kernelName:H1,backendName:"webgl",kernelFunc:Vrt};var wh;(function(n){n.Prod="*",n.Sum="+"})(wh||(wh={}));class Lk{constructor(t,e,s,r){this.op=t,this.outputShape=e,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const a=this.outputShape.length,i=this.op===wh.Prod?"1.0":"0.0",l=s?i:`getX(${zk(a,"coords",this.op)})`,u=this.outputShape[this.outputShape.length-1];let h="",d="";s?(h=r?`end != ${u-1}`:"end != 0",d=r?"end + 1":"end - 1"):(h=r?`end + pow2 < ${u}`:"end >= pow2",d=r?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${$e(a)} coords = getOutputCoords();
        int end = ${Mk(a,"coords",this.op)};
        float val = ${l};
        int pow2 = int(pow(2.0, index));
        if (${h}) {
          int idx = ${d};
          ${Mk(a,"coords",this.op)} = idx;
          val ${this.op}= getX(${zk(a,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function zk(n,t,e){if(n===1)return`${t}`;if(n===2)return`${t}.x, ${t}.y`;if(n===3)return`${t}.x, ${t}.y, ${t}.z`;if(n===4)return`${t}.x, ${t}.y, ${t}.z, ${t}.w`;throw new Error(`Cumulative ${e} for rank ${n} is not yet supported`)}function Mk(n,t,e){if(n===1)return`${t}`;if(n===2)return`${t}.y`;if(n===3)return`${t}.z`;if(n===4)return`${t}.w`;throw new Error(`Cumulative ${e} for rank ${n} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CF(n,t,e,s,r,a){const i=t.shape.length,l=qe([s],i);let u=t;l!=null&&(u=cs({inputs:{x:t},backend:e,attrs:{perm:l}}));const h=ln(1,i)[0];if(h!==i-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${t.shape.length-1} but got axis=${s}`);const d=u.shape[h];let p=Ms({inputs:{x:u},backend:e});for(let m=0;m<=Math.ceil(Math.log2(d))-1;m++){const y=new Lk(n,u.shape,!1,a),b=[[m]],x=p;p=e.runWebGLProgram(y,[p],p.dtype,b),e.disposeIntermediateTensorInfo(x)}if(r){const m=new Lk(n,u.shape,r,a),y=p;p=e.runWebGLProgram(m,[p],p.dtype),e.disposeIntermediateTensorInfo(y)}if(l!=null){const m=Wi(l),y=cs({inputs:{x:p},backend:e,attrs:{perm:m}});return e.disposeIntermediateTensorInfo(p),e.disposeIntermediateTensorInfo(u),y}return p}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Grt(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{axis:a,exclusive:i,reverse:l}=s;return CF(wh.Prod,r,e,a,i,l)}const Wrt={kernelName:W1,backendName:"webgl",kernelFunc:Grt};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hrt(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{axis:a,exclusive:i,reverse:l}=s;return CF(wh.Sum,r,e,a,i,l)}const jrt={kernelName:Vm,backendName:"webgl",kernelFunc:Hrt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qrt(n){const{inputs:t,backend:e,attrs:s}=n,{x:r,weights:a}=t,{size:i,binaryOutput:l}=s;if(r.shape.length===1){const u=e.readSync(r.dataId),h=e.readSync(a.dataId),d=sF(u,h,a.dtype,a.shape,i);return e.makeTensorInfo([i],a.dtype,d)}else if(r.shape.length===2){const u=e.bufferSync(r),h=e.bufferSync(a),d=Ktt(u,h,i,l);return e.makeTensorInfo(d.shape,a.dtype,d.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${r.shape.length}.`)}const Xrt={kernelName:j1,backendName:"webgl",kernelFunc:qrt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Krt{constructor(t,e,s){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=e,this.dataFormat=s,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${e};
      int offset_h = imod(h, ${e});
      int in_w = w / ${e};
      int offset_w = imod(w, ${e});
      int offset_d = (offset_h * ${e} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yrt(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{blockSize:a,dataFormat:i}=s,l=r.shape[0],u=i==="NHWC"?r.shape[1]:r.shape[2],h=i==="NHWC"?r.shape[2]:r.shape[3],d=i==="NHWC"?r.shape[3]:r.shape[1],p=u*a,m=h*a,y=d/(a*a),b=i==="NHWC"?[l,p,m,y]:[l,y,p,m],x=new Krt(b,a,i);return e.runWebGLProgram(x,[r],r.dtype)}const Zrt={kernelName:q1,backendName:"webgl",kernelFunc:Yrt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class NF{constructor(t,e=!1,s=null,r=!1,a=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=ns(this.outputShape.length);const i=t.filterHeight,l=t.filterWidth,u=t.outChannels/t.inChannels;let h="",d="";s&&(r?h=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:a?h=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:h=`
          float activation(float x) {
            ${s}
          }
        `,d="result = activation(result);");const p=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${h}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${u};
        int q = d2 - d1 * ${u};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${i}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${l}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${p}
        ${d}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class TF{constructor(t,e=!1,s=null,r=!1,a=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=ns(this.outputShape.length);const i=t.outChannels/t.inChannels,l=t.padInfo.left,u=t.strideWidth,h=t.dilationWidth,d=t.filterHeight,p=t.filterWidth,m=p;let y=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let S=0;S<p;S++)y+=`
          vec4 xTexelC${S*2};
          int xTexelC${S*2}Ready;
          vec4 xTexelC${S*2+1};
          int xTexelC${S*2+1}Ready;
          vec4 xC${S};`;y+=`
    for (int r = 0; r < ${d}; r++) {
      `;for(let S=0;S<p;S++)y+=`
          xTexelC${S*2} = vec4(0.0);
          xTexelC${S*2}Ready = 0;
          xTexelC${S*2+1} = vec4(0.0);
          xTexelC${S*2+1}Ready = 0;
          xC${S} = vec4(0.0);`;y+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let S=0;S<(m+1)/2;S++){const C=S*2;if(y+=`
          xC = xCCorner + ${C*h};
          `,u===1){if(C<p&&(l%2===1?(y+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${C}Ready == 0) {
                  xTexelC${C} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${C}.zw = vec2(0.0);
                  }
                  xTexelC${C}Ready = 1;
                }
              `,h===1&&C>0?y+=`
                xC${C} = vec4(xTexelC${C-2}.zw, xTexelC${C}.xy);
                `:y+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${C} = vec4(previous.zw, xTexelC${C}.xy);
                  } else {
                    xC${C} = vec4(0.0, 0.0, xTexelC${C}.xy);
                  }
                  `):y+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${C}Ready == 0) {
                  xTexelC${C} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${C}.zw = vec2(0.0);
                  }
                  xTexelC${C}Ready = 1;
                }

                xC${C} = xTexelC${C};
                `,C+1<p)){const $=l%2===0?A1(h):h;h%2===0&&l%2===1||h%2!==0&&l%2!==1?(y+=`
                  xCOffset = xC + imod(pads[1], 2) + ${$};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${C+1}Ready == 0) {
                    xTexelC${C+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${C+1}.zw = vec2(0.0);
                    }
                    xTexelC${C+1}Ready = 1;
                  }
                  `,h>1?y+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${C+1} = vec4(previous.zw, xTexelC${C+1}.xy);
                    } else {
                     xC${C+1} = vec4(0.0, 0.0, xTexelC${C+1}.xy);
                    }
                    `:y+=`
                    xC${C+1} = vec4(xTexelC${C}.zw, xTexelC${C+1}.xy);
                    `):$===1?y+=`
                    xC${C+1} = xTexelC${C};
                    `:y+=`
                    xCOffset = xC + ${$};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${C+1}Ready == 0) {
                      xTexelC${C+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${C+1}.zw = vec2(0.0);
                      }
                      xTexelC${C+1}Ready = 1;
                    }

                    xC${C+1} = xTexelC${C+1};
                    `}}else C<p&&(l%2===1?(y+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${C}Ready == 0) {
                  xTexelC${C} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${C}.zw = vec2(0.0);
                  }
                  xTexelC${C}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${C+1}Ready == 0) {
                  xTexelC${C+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${C+1}.zw = vec2(0.0);
                  }
                  xTexelC${C+1}Ready = 1;
                }

                xC${C} = vec4(xTexelC${C}.zw, xTexelC${C+1}.zw);
              `,C+1<p&&(y+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${C+1} = vec4(xTexelC${C+1}.xy, final.xy);
                `)):(y+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${C}Ready == 0) {
                  xTexelC${C} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${C}.zw = vec2(0.0);
                  }
                  xTexelC${C}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${C+1}Ready == 0) {
                  xTexelC${C+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${C+1}.zw = vec2(0.);
                  }
                  xTexelC${C+1}Ready = 1;
                }

                xC${C} = vec4(
                  xTexelC${C}.xy, xTexelC${C+1}.xy);
              `,C+1<p&&(y+=`
                  xC${C+1} = vec4(xTexelC${C}.zw, xTexelC${C+1}.zw);
                `)));C<p&&(y+=`
            wTexel = getW(r, ${C}, d1, q);
            dotProd += xC${C} * vec4(wTexel.xz, wTexel.xz);
          `,C+1<p&&(y+=`
              wTexel = getW(r, ${C+1}, d1, q);
              dotProd += xC${C+1} * vec4(wTexel.xz, wTexel.xz);
            `))}y+=`
    }
  `,y+=`
      }
    `;let b="",x="";s&&(r?b=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:a?b=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:b=`vec4 activation(vec4 x) {
          ${s}
        }`,x="result = activation(result);");const v=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${b}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${i};
        int q = d2 - d1 * ${i};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${y}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${v}
        ${x}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qrt(n){const{inputs:t,backend:e,attrs:s}=n,{x:r,filter:a}=t,{strides:i,pad:l,dilations:u,dimRoundingMode:h}=s;let d=u;d==null&&(d=[1,1]),F(Hn(i,d),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${i} and dilations '${d}'`);const p=On(r.shape,a.shape,i,d,l,h,!0);let m;ut().getBool("WEBGL_PACK_DEPTHWISECONV")&&p.strideWidth<=2&&p.outChannels/p.inChannels===1?m=new TF(p):m=new NF(p);const y=[[p.padInfo.top,p.padInfo.left],[p.strideHeight,p.strideWidth],[p.dilationHeight,p.dilationWidth],[p.inHeight,p.inWidth]];return e.runWebGLProgram(m,[r,a],"float32",y)}const Jrt={kernelName:Um,backendName:"webgl",kernelFunc:Qrt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tat{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const e=t.strideHeight,s=t.strideWidth,r=t.padInfo.top,a=t.padInfo.left,i=t.outChannels/t.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${i} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${t.batchSize}; b++) {
          for (int yR = 0; yR < ${t.outHeight}; yR++) {
            int xR = wR + yR * ${e} - ${r};

            if (xR < 0 || xR >= ${t.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${t.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${a};

              if (xC < 0 || xC >= ${t.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class eat{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const e=t.filterHeight,s=t.filterWidth,r=t.strideHeight,a=t.strideWidth,i=e-1-t.padInfo.top,l=s-1-t.padInfo.left,u=t.outChannels/t.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${i}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${e}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${e} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${a}.0;

            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${u}; dm++) {
              int d2 = d1 * ${u} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nat(n){const{inputs:t,backend:e,attrs:s}=n,{x:r,dy:a}=t,{strides:i,dilations:l,pad:u,dimRoundingMode:h,filterShape:d}=s,p=On(r.shape,d,i,l,u,h,!0),m=new tat(p);return e.runWebGLProgram(m,[r,a],"float32")}const sat={kernelName:X1,backendName:"webgl",kernelFunc:nat};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rat(n){const{inputs:t,backend:e,attrs:s}=n,{dy:r,filter:a}=t,{strides:i,dilations:l,pad:u,dimRoundingMode:h,inputShape:d}=s,p=On(d,a.shape,i,l,u,h,!0),m=new eat(p);return e.runWebGLProgram(m,[r,a],"float32")}const aat={kernelName:K1,backendName:"webgl",kernelFunc:rat};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class iat{constructor(t){this.variableNames=["X"],this.outputShape=[t,t],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oat(n){const{inputs:t,backend:e}=n,{x:s}=t,r=[...s.shape,...s.shape],a=mt(s.shape),i=$t({inputs:{x:s},backend:e,attrs:{shape:[a]}}),l=new iat(a),u=e.runWebGLProgram(l,[i],i.dtype),h=$t({inputs:{x:u},backend:e,attrs:{shape:r}});return e.disposeIntermediateTensorInfo(i),e.disposeIntermediateTensorInfo(u),h}const lat={kernelName:Y1,backendName:"webgl",kernelFunc:oat};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uat{constructor(t){this.variableNames=["x","W"],this.outputShape=t.outShape;const{inHeight:e,inWidth:s,padInfo:r,strideHeight:a,strideWidth:i,filterHeight:l,filterWidth:u,dilationHeight:h,dilationWidth:d}=t,{top:p,left:m}=r;this.userCode=`
      const ivec2 strides = ivec2(${a}, ${i});
      const ivec2 pads = ivec2(${p}, ${m});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${l}; h++) {
          int hIn = hBeg + h * ${h};

          if (hIn >= 0 && hIn < ${e}) {
            for (int w = 0; w < ${u}; w++) {
              int wIn = wBeg + w * ${d};

              if (wIn >= 0 && wIn < ${s}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cat(n){const{inputs:t,backend:e,attrs:s}=n,{x:r,filter:a}=t,{strides:i,pad:l,dilations:u}=s,h=vd(r.shape,a.shape,i,l,"NHWC",u);let d;const p=new uat(h);d=e.runWebGLProgram(p,[r,a],"float32");const m=$t({inputs:{x:d},backend:e,attrs:{shape:h.outShape}});return e.disposeIntermediateTensorInfo(d),m}const hat={kernelName:Gm,backendName:"webgl",kernelFunc:cat};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dat(n){const{inputs:t,backend:e,attrs:s}=n,{equation:r}=s,a=t,{allDims:i,summedDims:l,idDims:u}=qw(r,a.length);Kw(i.length,u,a);const{path:h,steps:d}=Yw(l,u),p=d.length;let m=null,y=i.length;const b=[];for(let x=0;x<p;++x){for(const v of d[x]){const{permutationIndices:S,expandDims:C}=Xw(y,u[v]);let $;Zw(S)?$=a[v]:($=cs({inputs:{x:a[v]},backend:e,attrs:{perm:S}}),b.push($));const T=$.shape.slice();for(let I=0;I<C.length;++I)T.splice(C[I],0,1);de($.shape,T)||($=$t({inputs:{x:$},backend:e,attrs:{shape:T}}),b.push($)),m===null?m=$:(m=MS({inputs:{a:$,b:m},backend:e}),b.push(m))}x<p-1&&(h[x]>=0&&(m=by({inputs:{x:m},backend:e,attrs:{axis:h[x]-(i.length-y),keepDims:!1}}),b.push(m)),y--)}for(const x of b)x!==m&&e.disposeIntermediateTensorInfo(x);return m}const fat={kernelName:Z1,backendName:"webgl",kernelFunc:dat};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pat="return (x >= 0.0) ? x : (exp(x) - 1.0);",mat=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,gat=me({opSnippet:pat,packedOpSnippet:mat}),yat={kernelName:zh,backendName:"webgl",kernelFunc:gat};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bat="return (b >= 0.0) ? a : a * (b + 1.0);",xat=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,vat=n=>{const{inputs:t,backend:e}=n,{dy:s,y:r}=t,a=ut().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Gu(xat,s.shape,r.shape):new Xo(bat,s.shape,r.shape);return e.runWebGLProgram(a,[s,r],s.dtype)},wat={kernelName:Q1,backendName:"webgl",kernelFunc:vat};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sat=`
  return vec4(equal(a, b));
`,Cat="return float(a == b);",Nat=Xn({opSnippet:Cat,packedOpSnippet:Sat,dtype:"bool",cpuKernelImpl:tet}),Tat={kernelName:Wm,backendName:"webgl",kernelFunc:Nat};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $at=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${Pw};
  float a1 = ${Vw};
  float a2 = ${Uw};
  float a3 = ${Gw};
  float a4 = ${Ww};
  float a5 = ${Hw};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,kat=me({opSnippet:$at}),Iat={kernelName:Mh,backendName:"webgl",kernelFunc:kat};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eat=Wu+`
  return exp(x);
`,Dat=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,$F=me({opSnippet:Eat,packedOpSnippet:Dat,cpuKernelImpl:eet,dtype:"float32"}),Aat={kernelName:Bh,backendName:"webgl",kernelFunc:$F};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v1(n){const{inputs:t,attrs:e,backend:s}=n,{dim:r}=e,{input:a}=t,i=a.shape.length,l=a.shape.slice();let u=r;return r<0&&(F(-(i+1)<=r,()=>`Axis must be in the interval [${-(i+1)}, ${i}]`),u=i+r+1),l.splice(u,0,1),$t({inputs:{x:a},backend:s,attrs:{shape:l}})}const Rat={kernelName:Hm,backendName:"webgl",kernelFunc:v1};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bk="return exp(x) - 1.0;",Oat=me({opSnippet:Bk,packedOpSnippet:Bk,cpuKernelImpl:net}),_at={kernelName:Ph,backendName:"webgl",kernelFunc:Oat};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Pk{constructor(t,e,s){this.variableNames=["real","imag"];const r=e[1];this.outputShape=e;const a=s?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,i=s?`${r}.0`:"1.0";let l;if(t==="real")l="return real * expR - imag * expI;";else if(t==="imag")l="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${t}.`);this.userCode=`
      const float exponentMultiplier = ${a};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${l}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${r});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${r}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${i};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kF(n,t,e){const s=e.texData.get(n.dataId),r=mt(n.shape),a=n.shape[n.shape.length-1],i=r/a,l=$t({inputs:{x:n},backend:e,attrs:{shape:[i,a]}}),u=l.shape,h=new Pk("real",u,t),d=new Pk("imag",u,t),p=[{dataId:s.complexTensorInfos.real.dataId,dtype:s.complexTensorInfos.real.dtype,shape:u},{dataId:s.complexTensorInfos.imag.dataId,dtype:s.complexTensorInfos.imag.dtype,shape:u}],m=e.runWebGLProgram(h,p,"float32"),y=e.runWebGLProgram(d,p,"float32"),b=Yi({inputs:{real:m,imag:y},backend:e});e.disposeIntermediateTensorInfo(m),e.disposeIntermediateTensorInfo(y);const x=$t({inputs:{x:b},backend:e,attrs:{shape:n.shape}});return e.disposeIntermediateTensorInfo(l),e.disposeIntermediateTensorInfo(b),x}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fat(n){const{inputs:t,backend:e}=n,{input:s}=t;return kF(s,!1,e)}const Lat={kernelName:J1,backendName:"webgl",kernelFunc:Fat};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zat{constructor(t,e){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=t,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gd(n){const{backend:t,attrs:e}=n,{shape:s,value:r}=e;let{dtype:a}=e;if(a=a||Eu(r),a==="string"){const i=an(a,mt(s));return i.fill(r),t.makeTensorInfo(s,a,i)}else{const i=new zat(s,r),l=[[r]];return t.runWebGLProgram(i,[],a,l)}}const Mat={kernelName:tv,backendName:"webgl",kernelFunc:Gd};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Bat{constructor(t){this.variableNames=["Image"],this.outputShape=[];const e=t[2];this.outputShape=t,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${e} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${e}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pat={kernelName:ev,backendName:"webgl",kernelFunc:({inputs:n,backend:t})=>{const{image:e}=n,s=t,r=new Bat(e.shape);return s.runWebGLProgram(r,[e],e.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vk="return floor(x);",Vat=me({opSnippet:Vk,packedOpSnippet:Vk,cpuKernelImpl:set}),Uat={kernelName:Vh,backendName:"webgl",kernelFunc:Vat};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gat=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,Wat=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,Hat=Xn({opSnippet:Gat,packedOpSnippet:Wat,dtype:"int32"}),jat={kernelName:Uh,backendName:"webgl",kernelFunc:Hat};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qat{constructor(t){this.variableNames=["A"];const e=ds(),[s,r]=t;this.outputShape=t,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}.0, ${s}.0);

        vec4 values = ${e.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xat{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const e=ds(),[s,r]=t;this.outputShape=t,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${r}.0, ${s}.0);
            vec4 values = ${e.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${e.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kat={kernelName:Ex,backendName:"webgl",kernelFunc:Yat};let jl,ux=ut().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function Yat(n){const{inputs:t,backend:e,attrs:s}=n;let{pixels:r}=t;const{numChannels:a}=s,i=typeof HTMLVideoElement<"u"&&r instanceof HTMLVideoElement,l=typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement,[u,h]=i?[r.videoWidth,r.videoHeight]:[r.width,r.height],d=[h,u],p=[h,u,a];if(l||i){const x=ut().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(jl==null||x!==ux)&&(ux=x,jl=document.createElement("canvas").getContext("2d",{willReadFrequently:ux})),jl.canvas.width=u,jl.canvas.height=h,jl.drawImage(r,0,0,u,h),r=jl.canvas}const m=e.makeTensorInfo(d,"int32");e.texData.get(m.dataId).usage=Zs.PIXELS,e.gpgpu.uploadPixelDataToTexture(e.getTexture(m.dataId),r);const y=ut().getBool("WEBGL_PACK")?new Xat(p):new qat(p),b=e.runWebGLProgram(y,[m],"int32");return e.disposeData(m.dataId),b}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zat(n){const{inputs:t,backend:e,attrs:s}=n,{x:r,filter:a,bias:i,preluActivationWeights:l}=t,{strides:u,pad:h,dataFormat:d,dilations:p,dimRoundingMode:m,activation:y,leakyreluAlpha:b}=s,x=Ga(d),v=On(r.shape,a.shape,u,p,h,m,!1,x);let S;const C=[],$=i!=null,T=l!=null,I=y==="leakyrelu",A=()=>{const L=[r,a],_=(M,D)=>{if(D==="NCHW"&&M.shape.length===1&&M.shape[0]!==1){const W=$t({inputs:{x:M},backend:e,attrs:{shape:[M.shape[0],1,1]}});return C.push(W),W}return M};if($&&L.push(_(i,d)),T&&L.push(_(l,d)),I){const M=e.makeTensorInfo([],"float32",Pi(b,"float32"));L.push(M),C.push(M)}return L};if(v.filterHeight===1&&v.filterWidth===1&&v.dilationHeight===1&&v.dilationWidth===1&&v.strideHeight===1&&v.strideWidth===1&&(v.padInfo.type==="SAME"||v.padInfo.type==="VALID"))S=wF({x:r,filter:a,convInfo:v,backend:e,bias:i,activation:y,preluActivationWeights:l,leakyreluAlpha:b});else if(v.strideWidth<=2&&x==="channelsLast"&&ut().getBool("WEBGL_EXP_CONV")){const L=y?xh(y,!0):null,_=new vF(v,$,L,T,I),M=[[v.padInfo.top,v.padInfo.left],[v.strideHeight,v.strideWidth],[v.dilationHeight,v.dilationWidth],[v.inHeight,v.inWidth]],D=A();S=e.runWebGLProgram(_,D,"float32",M)}else if(ut().getBool("WEBGL_CONV_IM2COL"))S=SF({x:r,filter:a,convInfo:v,backend:e,bias:i,activation:y,preluActivationWeights:l,leakyreluAlpha:b});else{const L=y?xh(y,!1):null,_=new xF(v,$,L,T,I),M=A();S=e.runWebGLProgram(_,M,"float32")}const R=$t({inputs:{x:S},backend:e,attrs:{shape:v.outShape}});return C.push(S),C.forEach(L=>e.disposeIntermediateTensorInfo(L)),R}const Qat={kernelName:Wp,backendName:"webgl",kernelFunc:Zat};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jat(n){const{inputs:t,backend:e,attrs:s}=n,{x:r,filter:a,bias:i,preluActivationWeights:l}=t,{strides:u,pad:h,dilations:d,dimRoundingMode:p,activation:m,leakyreluAlpha:y}=s,b=[];let x=d;x==null&&(x=[1,1]),F(Hn(u,x),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${u} and dilations '${x}'`);const v=On(r.shape,a.shape,u,x,h,p,!0),S=ut().getBool("WEBGL_PACK_DEPTHWISECONV")&&v.strideWidth<=2&&v.outChannels/v.inChannels===1,C=m?xh(m,S):null,$=[r,a],T=i!=null,I=l!=null,A=m==="leakyrelu";if(T&&$.push(i),I&&$.push(l),A){const M=e.makeTensorInfo([],"float32",Pi(y,"float32"));$.push(M),b.push(M)}let R;S?R=new TF(v,T,C,I,A):R=new NF(v,T,C,I,A);const L=[[v.padInfo.top,v.padInfo.left],[v.strideHeight,v.strideWidth],[v.dilationHeight,v.dilationWidth],[v.inHeight,v.inWidth]],_=e.runWebGLProgram(R,$,"float32",L);return b.forEach(M=>e.disposeIntermediateTensorInfo(M)),_}const tit={kernelName:Hp,backendName:"webgl",kernelFunc:Jat};class eit{constructor(t,e,s,r){this.sliceDim=t,this.strides=e,this.paramsShape=r,this.variableNames=["x","indices"],this.outputShape=s;const a=$e(s.length);let i=`
    int index;`;for(let l=0;l<this.sliceDim;l++)i+=`
          index = round(getIndices(coords[0], ${l}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[l]};
          flattenIndex += index * ${this.strides[l]};`;this.userCode=`
         void main() {
          ${a} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${i}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nit(n){const{inputs:t,backend:e}=n,{params:s,indices:r}=t,a=r.shape,i=a[a.length-1],l=mt(s.shape),[u,h,d,p]=Ew(s,r),m=$t({inputs:{x:r},backend:e,attrs:{shape:[h,i]}}),y=$t({inputs:{x:s},backend:e,attrs:{shape:[mt(s.shape)/d,d]}});if(e.shouldExecuteOnCPU([s,r])||s.dtype==="string"){const S=e.readSync(r.dataId),C=e.bufferSync(s),$=ret(S,C,s.dtype,h,i,d,p,s.shape,l);return e.makeTensorInfo(u,s.dtype,$.values)}const b=new eit(i,p,[h,d],s.shape),x=e.runWebGLProgram(b,[y,m],y.dtype),v=$t({inputs:{x},backend:e,attrs:{shape:u}});return e.disposeIntermediateTensorInfo(m),e.disposeIntermediateTensorInfo(y),e.disposeIntermediateTensorInfo(x),v}const sit={kernelName:nv,backendName:"webgl",kernelFunc:nit};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rit{constructor(t,e){this.variableNames=["A","indices"],this.outputShape=e,this.rank=e.length;const s=$e(this.rank),r=ait(t);this.userCode=`
      void main() {
        ${s} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${t[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${r}));
      }
    `}}function ait(n,t){const e=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[];for(let r=0;r<n.length;r++)r===2?s.push("index"):s.push(`${e[r]}`);return s.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IF(n){const{inputs:t,backend:e,attrs:s}=n,{x:r,indices:a}=t,{axis:i,batchDims:l}=s,u=re(i,r.shape)[0];if(ut().get("DEBUG")){const C=e.readSync(a.dataId),$=r.shape[u];for(let T=0;T<C.length;++T){const I=C[T];F(I<=$-1&&I>=0,()=>`GatherV2: the index value ${I} is not in [0, ${$-1}]`)}}const h=Jw(r,a,u,l),d=mt(a.shape),p=[],m=$t({inputs:{x:r},backend:e,attrs:{shape:[h.batchSize,h.outerSize,h.dimSize,h.sliceSize]}}),y=$t({inputs:{x:a},backend:e,attrs:{shape:[h.batchSize,d/h.batchSize]}});p.push(m),p.push(y);const b=[h.batchSize,h.outerSize,d/h.batchSize,h.sliceSize];if(e.shouldExecuteOnCPU([r,a])||r.dtype==="string"){const C=e.bufferSync(y),$=e.bufferSync(m),T=aet($,C,b);return p.forEach(I=>e.disposeIntermediateTensorInfo(I)),e.makeTensorInfo(h.outputShape,T.dtype,T.values)}const x=new rit(m.shape,b),v=e.runWebGLProgram(x,[m,y],m.dtype);p.push(v);const S=$t({inputs:{x:v},backend:e,attrs:{shape:h.outputShape}});return p.forEach(C=>e.disposeIntermediateTensorInfo(C)),S}const iit={kernelName:qm,backendName:"webgl",kernelFunc:IF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oit="return float(a > b);",lit=`
  return vec4(greaterThan(a, b));
`,uit=Xn({opSnippet:oit,packedOpSnippet:lit,cpuKernelImpl:iet,dtype:"bool"}),cit={kernelName:Xm,backendName:"webgl",kernelFunc:uit};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hit="return float(a >= b);",dit=`
  return vec4(greaterThanEqual(a, b));
`,fit=Xn({opSnippet:hit,packedOpSnippet:dit,dtype:"bool",cpuKernelImpl:oet}),pit={kernelName:Gh,backendName:"webgl",kernelFunc:fit};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mit(n){const{inputs:t,backend:e}=n,{input:s}=t;return kF(s,!0,e)}const git={kernelName:sv,backendName:"webgl",kernelFunc:mit};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yit="return float(!isnan(x) && !isinf(x));",bit=me({opSnippet:yit,dtype:"bool"}),xit={kernelName:Hh,backendName:"webgl",kernelFunc:bit};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vit="return float(isinf(x));",wit=me({opSnippet:vit,dtype:"bool"}),Sit={kernelName:jh,backendName:"webgl",kernelFunc:wit};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cit="return float(isnan(x));",Nit=me({opSnippet:Cit,dtype:"bool"}),Tit={kernelName:qh,backendName:"webgl",kernelFunc:Nit};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $it="return float(a < b);",kit=`
  return vec4(lessThan(a, b));
`,Iit=Xn({opSnippet:$it,packedOpSnippet:kit,cpuKernelImpl:uet,dtype:"bool"}),Eit={kernelName:Ym,backendName:"webgl",kernelFunc:Iit};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dit="return float(a <= b);",Ait=`
  return vec4(lessThanEqual(a, b));
`,Rit=Xn({opSnippet:Dit,packedOpSnippet:Ait,cpuKernelImpl:cet,dtype:"bool"}),Oit={kernelName:Zm,backendName:"webgl",kernelFunc:Rit};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _it(n){const{backend:t,attrs:e}=n,{start:s,stop:r,num:a}=e,i=het(s,r,a);return t.makeTensorInfo([i.length],"float32",i)}const Fit={kernelName:av,backendName:"webgl",kernelFunc:_it};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lit=Wu+`
  return x < 0.0 ? 0./0. : log(x);
`,zit=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,Mit=me({opSnippet:Lit,packedOpSnippet:zit,cpuKernelImpl:det}),Bit={kernelName:Xh,backendName:"webgl",kernelFunc:Mit};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pit=Wu+`
  return log(1.0 + x);
`,Vit=me({opSnippet:Pit}),Uit={kernelName:Kh,backendName:"webgl",kernelFunc:Vit};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Git="return float(a >= 1.0 && b >= 1.0);",Wit=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,Hit=Xn({opSnippet:Git,packedOpSnippet:Wit,dtype:"bool"}),jit={kernelName:Qm,backendName:"webgl",kernelFunc:Hit};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qit="return float(!(x >= 1.0));",Xit=me({opSnippet:qit}),Kit={kernelName:Jm,backendName:"webgl",kernelFunc:Xit};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yit="return float(a >= 1.0 || b >= 1.0);",Zit=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,Qit=Xn({opSnippet:Yit,packedOpSnippet:Zit,dtype:"bool"}),Jit={kernelName:tg,backendName:"webgl",kernelFunc:Qit};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tot{constructor(t,e,s,r,a){this.variableNames=["x"],this.outputShape=[];const i=e,l=t[3]-1;this.outputShape=t;let u;const h=`float(${s}) + float(${r}) * sum`;a===.5?u=`inversesqrt(${h})`:a===1?u=`1.0/(${h})`:u=`exp(log(${h}) * float(-${a}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${i}; j <= ${i}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${l}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${u};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eot{constructor(t,e,s,r,a){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const i=e,l=t[3]-1;this.outputShape=t;let u;const h=`float(${s}) + float(${r}) * sum`;a===.5?u=`inversesqrt(${h})`:a===1?u=`1.0/(${h})`:u=`exp(log(${h}) * float(-${a}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${i};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${i}; j <= ${i}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${l}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${u};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const not=n=>{const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{depthRadius:a,bias:i,alpha:l,beta:u}=s,h=ut().getBool("WEBGL_PACK_NORMALIZATION")?new eot(r.shape,a,i,l,u):new tot(r.shape,a,i,l,u);return e.runWebGLProgram(h,[r],r.dtype)},sot={kernelName:eg,backendName:"webgl",kernelFunc:not};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rot{constructor(t,e,s,r,a){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=e,this.bias=s,this.alpha=r,this.beta=a,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${e})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${e} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${r}) * norm + float(${s});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${r})
                * float(${a})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${a});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aot=n=>{const{inputs:t,backend:e,attrs:s}=n,{x:r,y:a,dy:i}=t,{depthRadius:l,bias:u,alpha:h,beta:d}=s,p=new rot(r.shape,l,u,h,d);return e.runWebGLProgram(p,[r,a,i],r.dtype)},iot={kernelName:iv,backendName:"webgl",kernelFunc:aot};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oot(n,t,e,s){const r=mt(t),i=mt(n.shape)/r,l=$t({inputs:{x:n},attrs:{shape:[i,r]},backend:s}),u=rl(l,n.dtype,"max",s),h=$t({inputs:{x:u},attrs:{shape:e},backend:s});return s.disposeIntermediateTensorInfo(l),s.disposeIntermediateTensorInfo(u),h}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EF(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{reductionIndices:a,keepDims:i}=s,l=r.shape.length,u=re(a,r.shape);let h=u;const d=qe(h,l),p=d!=null,m=e.shouldExecuteOnCPU([r]);let y=r;if(p){if(m){const $=e.texData.get(y.dataId).values,T=new Array(l);for(let R=0;R<T.length;R++)T[R]=r.shape[d[R]];const I=LS($,r.shape,r.dtype,d,T);y=e.makeTensorInfo(T,r.dtype);const A=e.texData.get(y.dataId);A.values=I}else y=yy(r,d,e);h=ln(h.length,l)}jn("max",h,l);const[b,x]=_n(y.shape,h);let v=b;i&&(v=on(b,u));let S;if(m){const $=e.texData.get(y.dataId).values,T=fet($,mt(x),v,r.dtype);S=e.makeTensorInfo(v,r.dtype);const I=e.texData.get(S.dataId);I.values=T}else S=oot(y,x,v,e);return p&&e.disposeIntermediateTensorInfo(y),S}const lot={kernelName:ng,backendName:"webgl",kernelFunc:EF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uot=zS+`
  return max(a, b);
`,cot=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+sl+`
  return result;
`,hot=Xn({opSnippet:uot,packedOpSnippet:cot,cpuKernelImpl:pet}),dot={kernelName:Yh,backendName:"webgl",kernelFunc:hot};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fot(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t;Pd(r,"maxPool");const{filterSize:a,strides:i,pad:l,dimRoundingMode:u}=s,h=1;F(Hn(i,h),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${h}'`);const d=Tr(r.shape,a,i,h,l,u);if(d.filterWidth===1&&d.filterHeight===1&&de(d.inShape,d.outShape))return Ms({inputs:{x:r},backend:e});const p=new vh(d,"max",!1);return e.runWebGLProgram(p,[r],r.dtype)}const pot={kernelName:sg,backendName:"webgl",kernelFunc:fot};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mot(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{filterSize:a,strides:i,pad:l,dataFormat:u,dimRoundingMode:h}=s,d=[1,1,1],p=Ua(r.shape,a,i,d,l,h,u),m=new BS(p,"max",!1);return e.runWebGLProgram(m,[r],r.dtype)}const got={kernelName:rg,backendName:"webgl",kernelFunc:mot};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yot{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;const e=t.strideHeight,s=t.strideWidth,r=t.dilationHeight,a=t.effectiveFilterHeight,i=t.effectiveFilterWidth,l=a-1-t.padInfo.top,u=i-1-t.padInfo.left,h=a*i-1;this.userCode=`
      const ivec2 pads = ivec2(${l}, ${u});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${a};
          wR += ${r}) {
          float dyR = float(dyRCorner + wR) / ${e}.0;

          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${i}; wC++) {
            float dyC = float(dyCCorner + wC) / ${s}.0;

            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${h} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${i} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class bot{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;const e=t.strideDepth,s=t.strideHeight,r=t.strideWidth,a=t.dilationDepth,i=t.dilationHeight,l=t.dilationWidth,u=t.effectiveFilterDepth,h=t.effectiveFilterHeight,d=t.effectiveFilterWidth,p=u-1-t.padInfo.front,m=h-1-t.padInfo.top,y=d-1-t.padInfo.left,b=u*h*d-1;this.userCode=`
      const ivec3 pads = ivec3(${p}, ${m}, ${y});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${u};
           wD += ${a}) {
          float dyD = float(dyDCorner + wD) / ${e}.0;

          if (dyD < 0.0 || dyD >= ${t.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${h};
              wR += ${i}) {
            float dyR = float(dyRCorner + wR) / ${s}.0;

            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${d};
                wC += ${l}) {
              float dyC = float(dyCCorner + wC) / ${r}.0;

              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${b} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${h} * ${d} +
                  wR * ${d} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xot(n){const{inputs:t,backend:e,attrs:s}=n,{dy:r,input:a}=t,i=a,{filterSize:l,strides:u,pad:h,dimRoundingMode:d}=s,p=[1,1,1],m=Ua(i.shape,l,u,p,h,d),y=new BS(m,"max",!0),b=e.runWebGLProgram(y,[i],i.dtype),x=new bot(m),v=e.runWebGLProgram(x,[r,b],i.dtype);return e.disposeIntermediateTensorInfo(b),v}const vot={kernelName:lv,backendName:"webgl",kernelFunc:xot};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wot(n){const{inputs:t,backend:e,attrs:s}=n,{dy:r,input:a,output:i}=t,l=a;Pd([a,i],"maxPoolGrad");const{filterSize:u,strides:h,pad:d,dimRoundingMode:p}=s,m=Tr(l.shape,u,h,1,d,p),y=!0,b=new vh(m,"max",y),x=e.runWebGLProgram(b,[l],l.dtype),v=new yot(m),S=e.runWebGLProgram(v,[r,x],l.dtype);return e.disposeIntermediateTensorInfo(x),S}const Sot={kernelName:ov,backendName:"webgl",kernelFunc:wot};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cot(n,t,e,s){let r=new vh(e,"max",!1);const a=s.runWebGLProgram(r,[n],"float32");r=new vh(e,"max",!0,!0,t);const i=s.runWebGLProgram(r,[n],"float32");return[a,i]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Not={kernelName:uv,backendName:"webgl",kernelFunc:({inputs:n,attrs:t,backend:e})=>{const{x:s}=n,{filterSize:r,strides:a,pad:i,includeBatchInIndex:l}=t,u=e;F(s.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${s.shape.length}.`);const h=[1,1];F(Hn(a,h),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${a} and dilations '${h}'`);const d=Tr(s.shape,r,a,h,i),[p,m]=Cot(s,l,d,u);return[p,m]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tot(n,t,e,s){const r=mt(t),i=mt(n.shape)/r,l=$t({inputs:{x:n},attrs:{shape:[i,r]},backend:s}),u=rl(l,"float32","mean",s),h=$t({inputs:{x:u},attrs:{shape:e},backend:s});return s.disposeIntermediateTensorInfo(l),s.disposeIntermediateTensorInfo(u),h}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $ot={kernelName:ag,backendName:"webgl",kernelFunc:({inputs:n,attrs:t,backend:e})=>{const{x:s}=n,{keepDims:r,axis:a}=t,i=e,l=s.shape.length,u=re(a,s.shape);let h=u;const d=qe(h,l),p=d!=null,m=i.shouldExecuteOnCPU([s]),y=[];let b=s;if(p){if(m){const T=i.texData.get(b.dataId).values,I=new Array(l);for(let L=0;L<I.length;L++)I[L]=s.shape[d[L]];const A=LS(T,s.shape,s.dtype,d,I);b=i.makeTensorInfo(I,s.dtype);const R=i.texData.get(b.dataId);R.values=A}else b=yy(s,d,i);y.push(b),h=ln(h.length,l)}jn("sum",h,l);const[x,v]=_n(b.shape,h);let S=x;r&&(S=on(x,u));const C=Tot(b,v,S,i);for(const $ of y)i.disposeIntermediateTensorInfo($);return C}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kot(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{axis:a,keepDims:i}=s,l=r.shape.length,u=re(a,r.shape);let h=u;const d=qe(h,l);let p=r;d!=null&&(p=cs({inputs:{x:r},backend:e,attrs:{perm:d}}),h=ln(h.length,r.shape.length)),jn("min",h,l);const[m,y]=_n(p.shape,h),b=mt(y),x=$t({inputs:{x:p},backend:e,attrs:{shape:[-1,b]}}),v=rl(x,x.dtype,"min",e);let S;if(i){const C=on(m,u);S=$t({inputs:{x:v},backend:e,attrs:{shape:C}})}else S=$t({inputs:{x:v},backend:e,attrs:{shape:m}});return e.disposeIntermediateTensorInfo(x),e.disposeIntermediateTensorInfo(v),d!=null&&e.disposeIntermediateTensorInfo(p),S}const Iot={kernelName:ig,backendName:"webgl",kernelFunc:kot};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eot=zS+`
  return min(a, b);
`,Dot=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+sl+`
  return result;
`,Aot=Xn({opSnippet:Eot,packedOpSnippet:Dot,cpuKernelImpl:met}),Rot={kernelName:Zh,backendName:"webgl",kernelFunc:Aot};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Oot{constructor(t,e,s){this.variableNames=["x"],this.outputShape=e.map((d,p)=>d[0]+t[p]+d[1]);const r=t.length,a=$e(r),i=e.map(d=>d[0]).join(","),l=e.map((d,p)=>d[0]+t[p]).join(","),u=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r),h=s==="reflect"?0:1;if(r===1){this.userCode=`
        int start = ${i};
        int end = ${l};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${h};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${h};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${a} start = ${a}(${i});
      ${a} end = ${a}(${l});

      void main() {
        ${a} outC = getOutputCoords();
        for (int i = 0; i < ${r}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${h};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${h};
          }
        }
        ${a} coords = outC - start;
        setOutput(getX(${u}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _ot{constructor(t,e,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.map((b,x)=>b[0]+t[x]+b[1]);const r=t.length,a=$e(r),i=e.map(b=>b[0]).join(","),l=e.map((b,x)=>b[0]+t[x]).join(","),u=us("rc",r),h=us("source",r),d=`${u[r-1]} < ${this.outputShape[r-1]}`,p=r===1?"source":`vec2(${h.slice(-2).join()})`,m=s==="reflect"?0:1;let y="";if(r===1){const b=`
        ${a} source = rc;
        if (source < start) {
          source = start * 2 - source - ${m};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${m};
        }
        source -= start;
      `;y=`
        ${a} rc = outputLoc;
        ${b}
        result[0] = getChannel(getX(${h.join()}), ${p});
        ${u[r-1]} += 1;
        if(${d}) {
          ${b}
          result[1] = getChannel(getX(${h.join()}), ${p});
        }
      `}else{const b=`
        ${a} source = rc;
        ${a} lt = ${a}(lessThan(source, start));
        ${a} gte = ${a}(greaterThanEqual(source, end));
        ${a} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${m}) +
                gte * ((end - 1) * 2 - source + ${m});
        source -= start;
      `;y=`
        ${a} rc = outputLoc;
        ${b}
        result[0] = getChannel(getX(${h.join()}), ${p});
        ${u[r-1]} += 1;
        if(${d}) {
          ${b}
          result[1] = getChannel(getX(${h.join()}), ${p});
        }
        rc = outputLoc;
        ${u[r-2]} += 1;
        if(${u[r-2]} < ${this.outputShape[r-2]}) {
          ${b}
          result[2] = getChannel(getX(${h.join()}), ${p});
          ${u[r-1]} += 1;
          if(${d}) {
            ${b}
            result[3] = getChannel(getX(${h.join()}), ${p});
          }
        }
      `}this.userCode=`
      const ${a} start = ${a}(${i});
      const ${a} end = ${a}(${l});

      void main() {
        ${a} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${y}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fot=({inputs:n,backend:t,attrs:e})=>{const{x:s}=n,{paddings:r,mode:a}=e,i=ut().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new _ot(s.shape,r,a):new Oot(s.shape,r,a);return t.runWebGLProgram(i,[s],s.dtype)},Lot={kernelName:og,backendName:"webgl",kernelFunc:Fot};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zot=`if (b == 0.0) return NAN;
  return mod(a, b);`,Mot=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+sl+`
  return result;
`,Bot=Xn({opSnippet:zot,packedOpSnippet:Mot}),Pot={kernelName:Qh,backendName:"webgl",kernelFunc:Bot};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Vot{constructor(t,e,s){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[t,s],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${e-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${e-1}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uot=`
if (a == b) {
  return 1.0;
};
return a / b;`,Got=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,DF=Xn({opSnippet:Uot,packedOpSnippet:Got,checkOutOfBounds:!0}),Wot={kernelName:Lh,backendName:"webgl",kernelFunc:DF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uk="return a - b;",AF=Xn({opSnippet:Uk,packedOpSnippet:Uk,supportsComplex:!0,cpuKernelImpl:zet}),Hot={kernelName:pd,backendName:"webgl",kernelFunc:AF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RF(n){const{inputs:t,backend:e,attrs:s}=n,{logits:r}=t,{dim:a}=s,i=re([a],r.shape),l=EF({inputs:{x:r},backend:e,attrs:{reductionIndices:i,keepDims:!1}}),u=on(l.shape,i),h=$t({inputs:{x:l},backend:e,attrs:{shape:u}}),d=AF({inputs:{a:r,b:h},backend:e}),p=$F({inputs:{x:d},backend:e}),m=by({inputs:{x:p},backend:e,attrs:{axis:i,keepDims:!1}}),y=$t({inputs:{x:m},backend:e,attrs:{shape:u}}),b=DF({inputs:{a:p,b:y},backend:e});return e.disposeIntermediateTensorInfo(l),e.disposeIntermediateTensorInfo(h),e.disposeIntermediateTensorInfo(d),e.disposeIntermediateTensorInfo(p),e.disposeIntermediateTensorInfo(m),e.disposeIntermediateTensorInfo(y),b}const jot={kernelName:Tg,backendName:"webgl",kernelFunc:RF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qot(n){const{inputs:t,backend:e,attrs:s}=n,{logits:r}=t,{numSamples:a,seed:i,normalized:l}=s,u=l?r:RF({inputs:{logits:r},backend:e,attrs:{dim:r.shape.length-1}}),h=u.shape[0],d=u.shape[1],p=new Vot(h,d,a),m=[[i]],y=e.runWebGLProgram(p,[u],"int32",m);return l||e.disposeIntermediateTensorInfo(u),y}const Xot={kernelName:cv,backendName:"webgl",kernelFunc:qot};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kot=kr+`
  return -x;
`,Yot=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function Zot(n){const{inputs:t,backend:e}=n,{x:s}=t;if(e.shouldExecuteOnCPU([s])){const a=e.texData.get(s.dataId),[i,l]=yet(a.values,s.shape,s.dtype);return e.makeTensorInfo(l,s.dtype,i)}let r;return ut().getBool("WEBGL_PACK_UNARY_OPERATIONS")?r=new Si(s.shape,Yot):r=new na(s.shape,Kot),e.runWebGLProgram(r,[s],s.dtype)}const Qot={kernelName:lg,backendName:"webgl",kernelFunc:Zot};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jot=Sw;function tlt(n){Ys("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:e,attrs:s}=n,{boxes:r,scores:a}=t,{maxOutputSize:i,iouThreshold:l,scoreThreshold:u}=s,h=e.readSync(r.dataId),d=e.readSync(a.dataId),{selectedIndices:p}=Jot(h,d,i,l,u);return e.makeTensorInfo([p.length],"int32",new Int32Array(p))}const elt={kernelName:hv,backendName:"webgl",kernelFunc:tlt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nlt=Cw;function slt(n){Ys("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:e,attrs:s}=n,{boxes:r,scores:a}=t,{maxOutputSize:i,iouThreshold:l,scoreThreshold:u,padToMaxOutputSize:h}=s,d=e.readSync(r.dataId),p=e.readSync(a.dataId),{selectedIndices:m,validOutputs:y}=nlt(d,p,i,l,u,h);return[e.makeTensorInfo([m.length],"int32",new Int32Array(m)),e.makeTensorInfo([],"int32",new Int32Array([y]))]}const rlt={kernelName:dv,backendName:"webgl",kernelFunc:slt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const alt=Nw;function ilt(n){Ys("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:e,attrs:s}=n,{boxes:r,scores:a}=t,{maxOutputSize:i,iouThreshold:l,scoreThreshold:u,softNmsSigma:h}=s,d=e.readSync(r.dataId),p=e.readSync(a.dataId),m=i,y=l,b=u,x=h,{selectedIndices:v,selectedScores:S}=alt(d,p,m,y,b,x);return[e.makeTensorInfo([v.length],"int32",new Int32Array(v)),e.makeTensorInfo([S.length],"float32",new Float32Array(S))]}const olt={kernelName:fv,backendName:"webgl",kernelFunc:ilt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class llt{constructor(t,e,s,r){this.variableNames=["indices"],this.outputShape=[t,e],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${r}), float(${s}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ult=n=>{const{inputs:t,backend:e,attrs:s}=n,{indices:r}=t,{dtype:a,depth:i,onValue:l,offValue:u}=s,h=mt(r.shape),d=new llt(h,i,l,u),p=$t({inputs:{x:r},backend:e,attrs:{shape:[h]}}),m=e.runWebGLProgram(d,[p],a);e.disposeIntermediateTensorInfo(p);const y=[...r.shape,i],b=$t({inputs:{x:m},backend:e,attrs:{shape:y}});return e.disposeIntermediateTensorInfo(m),b},clt={kernelName:hg,backendName:"webgl",kernelFunc:ult};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gm(n){const{inputs:t,backend:e}=n,{x:s}=t;if(s.dtype==="complex64"){const r=Ud({inputs:{input:s},backend:e}),a=gm({inputs:{x:r},backend:e}),i=xy({inputs:{input:s},backend:e}),l=gm({inputs:{x:i},backend:e}),u=Yi({inputs:{real:a,imag:l},backend:e});return e.disposeIntermediateTensorInfo(r),e.disposeIntermediateTensorInfo(a),e.disposeIntermediateTensorInfo(i),e.disposeIntermediateTensorInfo(l),u}else return Gd({attrs:{shape:s.shape,dtype:s.dtype,value:s.dtype==="string"?"":0},backend:e})}const hlt={kernelName:Eg,backendName:"webgl",kernelFunc:gm};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OF(n){const{inputs:t,backend:e}=n,{x:s}=t;if(s.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(s.dtype==="complex64"){const r=Ud({inputs:{input:s},backend:e}),a=OF({inputs:{x:r},backend:e}),i=xy({inputs:{input:s},backend:e}),l=gm({inputs:{x:i},backend:e}),u=Yi({inputs:{real:a,imag:l},backend:e});return e.disposeIntermediateTensorInfo(r),e.disposeIntermediateTensorInfo(a),e.disposeIntermediateTensorInfo(i),e.disposeIntermediateTensorInfo(l),u}else return Gd({attrs:{shape:s.shape,dtype:s.dtype,value:1},backend:e})}const dlt={kernelName:cg,backendName:"webgl",kernelFunc:OF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function flt(n){const{inputs:t,backend:e,attrs:s}=n,{axis:r}=s;if(t.length===1)return v1({inputs:{input:t[0]},backend:e,attrs:{dim:r}});const a=t[0].shape,i=t[0].dtype;t.forEach(d=>{Bs(a,d.shape,"All tensors passed to stack must have matching shapes"),F(i===d.dtype,()=>"All tensors passed to stack must have matching dtypes")});const l=[],u=t.map(d=>{const p=v1({inputs:{input:d},backend:e,attrs:{dim:r}});return l.push(p),p}),h=bF({inputs:u,backend:e,attrs:{axis:r}});return l.forEach(d=>e.disposeIntermediateTensorInfo(d)),h}const plt={kernelName:dg,backendName:"webgl",kernelFunc:flt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mlt{constructor(t,e,s){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=e.map((h,d)=>h[0]+t[d]+h[1]);const r=t.length,a=$e(r),i=e.map(h=>h[0]).join(","),l=e.map((h,d)=>h[0]+t[d]).join(","),u=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);if(r===1){this.userCode=`
        int start = ${i};
        int end = ${l};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${a} start = ${a}(${i});
      ${a} end = ${a}(${l});

      void main() {
        ${a} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${a} coords = outC - start;
          setOutput(getX(${u}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class glt{constructor(t,e,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=e.map((x,v)=>x[0]+t[v]+x[1]);const r=t.length,a=$e(r),i=e.map(x=>x[0]).join(","),l=e.map((x,v)=>x[0]+t[v]).join(","),u=us("rc",r),h=us("source",r),d=`${u[r-1]} < ${this.outputShape[r-1]}`,p=r===1?"source":`vec2(${h.slice(-2).join()})`,m=[`${a} rc = outputLoc;`,`${u[r-1]} += 1;
       if(${d}) {
      `,r===1?"":`}
       rc = outputLoc;
       ${u[r-2]} += 1;
       if(${u[r-2]} < ${this.outputShape[r-2]}) {`,r===1?"":`  ${u[r-1]} += 1;
         if(${d}) {`],y=r===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let b="";for(let x=0,v=r===1?2:4;x<v;x++)b+=`
        ${m[x]}
        if (${y}) {
          result[${x}] = float(value);
        } else {
          ${a} source = rc - start;
          result[${x}] = getChannel(getX(${h.join()}), ${p});
        }
      `;b+=r===1?"} ":"}}",this.userCode=`
      const ${a} start = ${a}(${i});
      const ${a} end = ${a}(${l});

      void main() {
        ${a} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${b}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _F=n=>{const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{paddings:a,constantValue:i}=s;if(mt(r.shape)===0){const h=a.map((d,p)=>d[0]+r.shape[p]+d[1]);return Gd({backend:e,attrs:{shape:h,value:i,dtype:r.dtype}})}const l=ut().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new glt(r.shape,a,i):new mlt(r.shape,a,i),u=[[i]];return e.runWebGLProgram(l,[r],r.dtype,u)},ylt={kernelName:fg,backendName:"webgl",kernelFunc:_F};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const blt=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,xlt=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+sl+`
  return result;
`,vlt=Xn({opSnippet:blt,packedOpSnippet:xlt}),wlt={kernelName:td,backendName:"webgl",kernelFunc:vlt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Slt(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{axis:a,keepDims:i}=s,l=r.shape.length,u=[],h=re(a,r.shape);let d=h;const p=qe(d,l);let m=r;p!=null&&(m=cs({inputs:{x:r},backend:e,attrs:{perm:p}}),d=ln(d.length,l),u.push(m)),jn("prod",d,l);let y;if(e.shouldExecuteOnCPU([m])){const b=e.texData.get(m.dataId).values,{outVals:x,outShape:v,outDtype:S}=xet(m.shape,m.dtype,b,d);y=e.makeTensorInfo(v,S,x)}else{const[b,x]=_n(m.shape,d),v=mt(x),S=$t({inputs:{x:m},backend:e,attrs:{shape:[-1,v]}}),C=Mv(r.dtype),$=rl(S,C,"prod",e);y=$t({inputs:{x:$},backend:e,attrs:{shape:b}}),u.push(S),u.push($)}if(i){u.push(y);const b=on(y.shape,h);y=$t({inputs:{x:y},backend:e,attrs:{shape:b}})}return u.forEach(b=>e.disposeIntermediateTensorInfo(b)),y}const Clt={kernelName:mg,backendName:"webgl",kernelFunc:Slt};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nlt(n){const{inputs:t,backend:e,attrs:s}=n,{paramsNestedSplits:r,paramsDenseValues:a,indices:i}=t,{outputRaggedRank:l}=s,u=r.map(S=>e.readSync(S.dataId)),h=r.map(S=>S.shape),d=e.readSync(a.dataId),p=e.readSync(i.dataId),[m,y,b]=vet(u,h,d,a.shape,a.dtype,p,i.shape,l),x=m.map(S=>e.makeTensorInfo([S.length],"int32",S)),v=e.makeTensorInfo(b,a.dtype,y);return x.concat([v])}const Tlt={kernelName:pv,backendName:"webgl",kernelFunc:Nlt};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $lt(n){const{inputs:t,backend:e}=n,{starts:s,limits:r,deltas:a}=t,i=e.readSync(s.dataId),l=e.readSync(r.dataId),u=e.readSync(a.dataId),[h,d]=wet(i,s.shape,s.dtype,l,r.shape,u,a.shape),p=e.makeTensorInfo([h.length],"int32",h),m=e.makeTensorInfo([d.length],s.dtype,d);return[p,m]}const klt={kernelName:mv,backendName:"webgl",kernelFunc:$lt};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ilt(n){const{inputs:t,backend:e,attrs:s}=n,{shape:r,values:a,defaultValue:i,rowPartitionTensors:l}=t,{rowPartitionTypes:u}=s,h=e.readSync(r.dataId),d=e.readSync(a.dataId),p=e.readSync(i.dataId),m=l.map(v=>e.readSync(v.dataId)),y=l.map(v=>v.shape),[b,x]=Cet(h,r.shape,d,a.shape,a.dtype,p,i.shape,m,y,u);return e.makeTensorInfo(b,a.dtype,x)}const Elt={kernelName:gv,backendName:"webgl",kernelFunc:Ilt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FF=n=>{const{backend:t,attrs:e}=n,{start:s,stop:r,step:a,dtype:i}=e,l=Net(s,r,a,i);return t.makeTensorInfo([l.length],i,l)},Dlt={kernelName:yv,backendName:"webgl",kernelFunc:FF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Alt="return 1.0 / x;",Rlt=me({opSnippet:Alt}),Olt={kernelName:ed,backendName:"webgl",kernelFunc:Rlt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _lt=kr+`
  return (x < 0.0) ? 0.0 : x;
`,Flt=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Llt=me({opSnippet:_lt,packedOpSnippet:Flt}),zlt={kernelName:nd,backendName:"webgl",kernelFunc:Llt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mlt=kr+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Blt=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Plt=me({opSnippet:Mlt,packedOpSnippet:Blt}),Vlt={kernelName:sd,backendName:"webgl",kernelFunc:Plt};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ult{constructor(t,e,s,r,a){this.variableNames=["A"],this.outputShape=[];const[i,l,u,h]=t;this.outputShape=[i,e,s,h];const d=[r&&e>1?l-1:l,r&&s>1?u-1:u],p=[r&&e>1?e-1:e,r&&s>1?s-1:s];let m;a?m="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":m="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${d[0]/p[0]},
          ${d[1]/p[1]});
      const vec2 inputShapeRC = vec2(${l}.0, ${u}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${m};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Glt{constructor(t,e,s,r,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[i,l,u,h]=t;this.outputShape=[i,e,s,h];const d=[r&&e>1?l-1:l,r&&s>1?u-1:u],p=[r&&e>1?e-1:e,r&&s>1?s-1:s];let m;a?m="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":m="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${d[0]/p[0]},
          ${d[1]/p[1]},
          ${d[1]/p[1]});
      const vec3 inputShapeRC = vec3(${l}.0, ${u}.0,
                                     ${u}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${m};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${h-1};
        bool hasNextRow = coords.z < ${s-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wlt(n){const{inputs:t,backend:e,attrs:s}=n,{images:r}=t,{alignCorners:a,halfPixelCenters:i,size:l}=s,[u,h]=l,d=ut().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Glt(r.shape,u,h,a,i):new Ult(r.shape,u,h,a,i);return e.runWebGLProgram(d,[r],"float32")}const Hlt={kernelName:bg,backendName:"webgl",kernelFunc:Wlt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jlt{constructor(t,e,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e;const[,r,a]=e,[,i,l]=t,u=[s&&i>1?r-1:r,s&&l>1?a-1:a],h=[s&&i>1?i-1:i,s&&l>1?l-1:l],d=u[0]/h[0],p=u[1]/h[1],m=1/d,y=1/p,b=Math.ceil(m)*2+2,x=Math.ceil(y)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${d});
        const float widthScale = float(${p});

        const float invHeightScale = float(${m});
        const float invWidthScale = float(${y});

        const int winHeight = int(${b});
        const int winWidth = int(${x});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${i}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${l}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${r-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${a-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qlt(n){const{inputs:t,backend:e,attrs:s}=n,{images:r,dy:a}=t,{alignCorners:i}=s,l=new jlt(a.shape,r.shape,i);return e.runWebGLProgram(l,[a],a.dtype)}const Xlt={kernelName:vv,backendName:"webgl",kernelFunc:qlt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Klt{constructor(t,e,s,r,a){this.variableNames=["A"],this.outputShape=[];const[i,l,u,h]=t;this.outputShape=[i,e,s,h];const d=[r&&e>1?l-1:l,r&&s>1?u-1:u],p=[r&&e>1?e-1:e,r&&s>1?s-1:s],m=r?"0.5":"0.0";let y;a?y="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":y="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${d[0]/p[0]},
          ${d[1]/p[1]});
      const vec2 inputShapeRC = vec2(${l}.0, ${u}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${y};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${m})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ylt{constructor(t,e,s,r,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[i,l,u,h]=t;this.outputShape=[i,e,s,h];const d=[r&&e>1?l-1:l,r&&s>1?u-1:u],p=[r&&e>1?e-1:e,r&&s>1?s-1:s],m=r?"0.5":"0.0";let y;a?y="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":y="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${d[0]/p[0]},
          ${d[1]/p[1]},
          ${d[1]/p[1]});
      const vec3 inputShapeRC = vec3(${l}.0, ${u}.0,
                                     ${u}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${y};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${m})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${h-1};
        bool hasNextRow = coords.z < ${s-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zlt(n){const{inputs:t,backend:e,attrs:s}=n,{images:r}=t,{alignCorners:a,halfPixelCenters:i,size:l}=s,[u,h]=l,d=ut().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Ylt(r.shape,u,h,a,i):new Klt(r.shape,u,h,a,i);return e.runWebGLProgram(d,[r],r.dtype)}const Qlt={kernelName:yg,backendName:"webgl",kernelFunc:Zlt};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jlt{constructor(t,e,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e;const[,r,a]=e,[,i,l]=t,u=[s&&i>1?r-1:r,s&&l>1?a-1:a],h=[s&&i>1?i-1:i,s&&l>1?l-1:l],d=u[0]/h[0],p=u[1]/h[1],m=1/d,y=1/p,b=Math.ceil(m)*2+2,x=Math.ceil(y)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${d});
        const float widthScale = float(${p});

        const float invHeightScale = float(${m});
        const float invWidthScale = float(${y});

        const int winHeight = int(${b});
        const int winWidth = int(${x});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${i}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${l}) {
              continue;
            }

            float sourceFracRow =
              float(${u[0]}) *
                (float(dyR) / float(${h[0]}));

            float sourceFracCol =
                float(${u[1]}) *
                  (float(dyC) / float(${h[1]}));

            int sourceNearestRow = int(min(
                float(int(${r}) - 1),
                ${s} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${a}) - 1),
                ${s} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tut(n){const{inputs:t,backend:e,attrs:s}=n,{images:r,dy:a}=t,{alignCorners:i}=s,l=new Jlt(a.shape,r.shape,i);return e.runWebGLProgram(l,[a],a.dtype)}const eut={kernelName:xv,backendName:"webgl",kernelFunc:tut};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nut{constructor(t,e){this.variableNames=["x"];const s=t.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);if(this.outputShape=t,s===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${t[0]} - coord - 1));
        }
      `;return}const r=l=>e.indexOf(l)!==-1&&t[l]!==1?`${t[l]} - coords[${l}] - 1`:`coords[${l}]`,a=t.map((l,u)=>r(u)).join(","),i=$e(s);this.userCode=`
      void main() {
        ${i} coords = getOutputCoords();
        setOutput(getX(${a}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sut{constructor(t,e){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const s=t.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);this.outputShape=t;const r=us("rc",s),a=`${r[s-1]} + 1 < ${this.outputShape[s-1]}`,i=`${r[s-2]} + 1 < ${this.outputShape[s-2]}`,l=$e(s);s===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${t[0]} - rc - 1),
            ${t[0]} - rc - 1);
          if(${a}){
              result.g = getChannel(getX(${t[0]} - (rc  + 1) - 1),
                ${t[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${l} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${u(r.slice())};
          if(${a}){
            result.g = ${h(r.slice())};
          }
          if(${i}) {
            result.b = ${d(r.slice())};
            if(${a}) {
              result.a = ${p(r.slice())};
            }
          }
          setOutput(result);
        }
    `;function u(b){return m(b)}function h(b){return b[s-1]="("+b[s-1]+" + 1)",m(b)}function d(b){return b[s-2]="("+b[s-2]+" + 1)",m(b)}function p(b){return b[s-1]="("+b[s-1]+" + 1)",b[s-2]="("+b[s-2]+" + 1)",m(b)}function m(b){const x=t.map((C,$)=>y($,b)),v=x.join(","),S=x.slice(-2).join(",");return`getChannel(getX(${v}), vec2(${S}))`}function y(b,x){return e.indexOf(b)!==-1&&t[b]!==1?`${t[b]} - ${x[b]} - 1`:`${x[b]}`}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rut(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{dims:a}=s,i=r.shape.length,l=re(a,r.shape);if(i===0)return Ms({inputs:{x:r},backend:e});const u=ut().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new sut(r.shape,l):new nut(r.shape,l);return e.runWebGLProgram(u,[r],r.dtype)}const aut={kernelName:xg,backendName:"webgl",kernelFunc:rut};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class iut{constructor(t,e){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const s=t[1],r=t[2];this.outputShape=t;let a="";typeof e=="number"?a=`float outputValue = ${e.toFixed(2)};`:a=`
        vec3 fill = vec3(${e.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${a}
          if(coordX >= 0 && coordX < ${r} && coordY >= 0 && coordY < ${s}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const out={kernelName:zv,backendName:"webgl",kernelFunc:({inputs:n,attrs:t,backend:e})=>{const{image:s}=n,{radians:r,fillValue:a,center:i}=t,l=e,u=new iut(s.shape,a),[h,d]=zw(i,s.shape[1],s.shape[2]),p=[[h,d,Math.sin(r),Math.cos(r)]];return l.runWebGLProgram(u,[s],s.dtype,p)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lut=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,uut=me({opSnippet:lut}),cut={kernelName:rd,backendName:"webgl",kernelFunc:uut};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hut="return inversesqrt(x);",dut=me({opSnippet:hut,cpuKernelImpl:Tet}),fut={kernelName:ad,backendName:"webgl",kernelFunc:dut};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class PS{constructor(t,e,s,r,a,i,l=!0,u=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;const h=$e(a.length),d=$e(i.length);let p="";s===1?p="i":s===2&&(p="i, j");const m=`getIndices(${p})`;let y="";r===1?y="i":r===2&&(y="i, coords[1]");const b=`getUpdates(${y})`;let x="";u&&(x="coords[0], coords[1]");const v=`getDefaultValue(${x})`,S=e>1?"strides[j]":"strides";this.userCode=`
        ${h} strides = ${h}(${a});

        void main() {
          ${d} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${t}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${e}; j++) {
              int index = round(${m});
              flattenedIndex += index * ${S};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${b};
              found = true;
            }
          }
          setOutput(mix(${v}, sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class put{constructor(t,e,s,r,a,i,l=!0,u=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=i;const h=$e(a.length),d=$e(i.length);let p="";s===1?p="i":s===2&&(p="i, j");const m=`getIndices(${p})`;let y="";r===1?y="i":r===2&&(y="i, coords[1]");const b=`getUpdates(${y})`;let x="";u&&(x="coords[0], coords[1]");const v=`getDefaultValue(${x})`,S=e>1?"strides[j]":"strides",C=e>1?"strides[j + 1]":"strides";this.userCode=`
        ${h} strides = ${h}(${a});

        void main() {
          ${d} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${t}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${e}; j+=2) {
              ivec4 index = round(${m});
              flattenedIndex += index.xz * ${S};
              if (j + 1 < ${e}) {
                flattenedIndex += index.yw * ${C};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${b};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${v}, sum, found));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mut(n){const{inputs:t,backend:e,attrs:s}=n,{indices:r,updates:a}=t,{shape:i}=s,{sliceRank:l,numUpdates:u,sliceSize:h,strides:d,outputSize:p}=Qo(a,r,i),m=[p/h,h];if(p===0)return e.makeTensorInfo(i,r.dtype);const y=$t({inputs:{x:r},backend:e,attrs:{shape:[u,l]}}),b=$t({inputs:{x:a},backend:e,attrs:{shape:[u,h]}}),x=e.makeTensorInfo([],"float32",new Float32Array([0]));let v;ut().getBool("WEBGL_PACK")?v=new put(u,l,y.shape.length,b.shape.length,d,m):v=new PS(u,l,y.shape.length,b.shape.length,d,m);const S=e.runWebGLProgram(v,[b,y,x],b.dtype),C=$t({inputs:{x:S},backend:e,attrs:{shape:i}});return e.disposeIntermediateTensorInfo(y),e.disposeIntermediateTensorInfo(b),e.disposeIntermediateTensorInfo(S),e.disposeIntermediateTensorInfo(x),C}const gut={kernelName:wv,backendName:"webgl",kernelFunc:mut};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yut{constructor(t,e,s,r){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[t,s];const a="while (left < right) {",i=`for (int i = 0; i < ${Math.ceil(Math.log2(e+1))}; ++i) { if (left >= right) break;`,l=ut().getNumber("WEBGL_VERSION")===2?a:i,u=r==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${l}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${u} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function but(n){const{inputs:t,backend:e,attrs:s}=n,{sortedSequence:r,values:a}=t,{side:i}=s,l=new yut(r.shape[0],r.shape[1],a.shape[1],i),u=[[r.shape[1]]];return e.runWebGLProgram(l,[r,a],"int32",u)}const xut={kernelName:Cv,backendName:"webgl",kernelFunc:but};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vut{constructor(t,e,s){this.variableNames=["c","a","b"],this.outputShape=e;let r,a;if(s>4)throw Error(`Where for rank ${s} is not yet supported`);if(s===1)a="resRC",r="resRC";else{const l=["resRC.x","resRC.y","resRC.z","resRC.w"],u=[],h=[];for(let d=0;d<e.length;d++)h.push(`${l[d]}`),d<t&&u.push(`${l[d]}`);r=u.join(),a=h.join()}const i=$e(s);this.userCode=`
      void main() {
        ${i} resRC = getOutputCoords();
        float cVal = getC(${r});
        if (cVal >= 1.0) {
          setOutput(getA(${a}));
        } else {
          setOutput(getB(${a}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wut(n){const{inputs:t,backend:e}=n,{condition:s,t:r,e:a}=t,i=new vut(s.shape.length,r.shape,r.shape.length);return e.runWebGLProgram(i,[s,r,a],Os(r.dtype,a.dtype))}const Sut={kernelName:vg,backendName:"webgl",kernelFunc:wut};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cut=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${ey};
  float scale = ${ny};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,Nut=me({opSnippet:Cut}),Tut={kernelName:id,backendName:"webgl",kernelFunc:Nut};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $ut=Wu+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,kut=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Iut=me({opSnippet:$ut,packedOpSnippet:kut,cpuKernelImpl:ket}),Eut={kernelName:cd,backendName:"webgl",kernelFunc:Iut};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dut=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,Aut=me({opSnippet:Dut}),Rut={kernelName:ud,backendName:"webgl",kernelFunc:Aut};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Out=Wu+`
  return sin(x);
`,_ut=`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${sl}
  return result;
`,Fut=me({opSnippet:Out,packedOpSnippet:_ut}),Lut={kernelName:od,backendName:"webgl",kernelFunc:Fut};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zut=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,Mut=me({opSnippet:zut}),But={kernelName:ld,backendName:"webgl",kernelFunc:Mut};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Put=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,Vut=me({opSnippet:Put}),Uut={kernelName:hd,backendName:"webgl",kernelFunc:Vut};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gut=n=>{const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{blockShape:a,paddings:i}=s;F(r.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const l=a.reduce((S,C)=>S*C),u=[[0,0]];u.push(...i);for(let S=1+a.length;S<r.shape.length;++S)u.push([0,0]);const h=[],d=_F({inputs:{x:r},backend:e,attrs:{paddings:u,constantValue:0}}),p=kd(d.shape,a,l,!1),m=Id(p.length,a.length,!1),y=Ed(d.shape,a,l,!1),b=$t({inputs:{x:d},backend:e,attrs:{shape:p}}),x=cs({inputs:{x:b},backend:e,attrs:{perm:m}}),v=$t({inputs:{x},backend:e,attrs:{shape:y}});return h.push(d),h.push(b),h.push(x),h.forEach(S=>e.disposeIntermediateTensorInfo(S)),v},Wut={kernelName:Cg,backendName:"webgl",kernelFunc:Gut};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hut(n){const{inputs:t,backend:e}=n,{indices:s,values:r,denseShape:a,defaultValue:i}=t;if(a.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${a.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${s.shape}`);if(r.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${r.shape}`);if(i.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${i.shape}`);const l=e.readSync(s.dataId),u=e.readSync(r.dataId),h=e.readSync(a.dataId),d=e.readSync(i.dataId)[0],[p,m,y,b,x]=Eet(l,s.shape,s.dtype,u,r.dtype,h,d);return[e.makeTensorInfo(m,s.dtype,p),e.makeTensorInfo([m[0]],r.dtype,y),e.makeTensorInfo([b.length],"bool",new Uint8Array(b.map(v=>Number(v)))),e.makeTensorInfo([x.length],s.dtype,new Int32Array(x))]}const jut={kernelName:Nv,backendName:"webgl",kernelFunc:Hut};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qut(n){const{inputs:t,backend:e}=n,{inputIndices:s,inputShape:r,newShape:a}=t;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${s.shape}`);if(r.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${r.shape}`);if(a.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${a.shape}`);const i=Array.from(e.readSync(r.dataId)),l=e.readSync(s.dataId),u=Array.from(e.readSync(a.dataId)),[h,d,p]=Det(l,s.shape,s.dtype,i,u);return[e.makeTensorInfo(d,s.dtype,h),e.makeTensorInfo([p.length],a.dtype,new Int32Array(p))]}const Xut={kernelName:Tv,backendName:"webgl",kernelFunc:qut};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kut(n){const{inputs:t,backend:e}=n,{data:s,indices:r,segmentIds:a}=t;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${r.shape}`);if(a.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${a.shape}`);const i=e.readSync(s.dataId),l=e.readSync(r.dataId),u=e.readSync(a.dataId),[h,d]=aF(i,s.shape,s.dtype,l,u,!0);return e.makeTensorInfo(d,s.dtype,h)}const Yut={kernelName:$v,backendName:"webgl",kernelFunc:Kut};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zut(n){const{inputs:t,backend:e}=n,{data:s,indices:r,segmentIds:a}=t;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${r.shape}`);if(a.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${a.shape}`);const i=e.readSync(s.dataId),l=e.readSync(r.dataId),u=e.readSync(a.dataId),[h,d]=aF(i,s.shape,s.dtype,l,u);return e.makeTensorInfo(d,s.dtype,h)}const Qut={kernelName:kv,backendName:"webgl",kernelFunc:Zut};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jut(n){const{inputs:t,backend:e,attrs:s}=n,{sparseIndices:r,sparseValues:a,defaultValue:i}=t,{outputShape:l}=s,{sliceRank:u,numUpdates:h,sliceSize:d,strides:p,outputSize:m}=Qo(a,r,l),y=!1;if(a.dtype==="string"){const S=e.bufferSync(r),C=e.bufferSync(a),$=ki(e.readSync(i.dataId)[0]),T=$et(S,C,l,m,d,h,u,p,$,y);return e.makeTensorInfo(l,T.dtype,T.values)}const b=new PS(h,u,r.shape.length,a.shape.length,p,[m,1],y),x=e.runWebGLProgram(b,[a,r,i],a.dtype),v=$t({inputs:{x},backend:e,attrs:{shape:l}});return e.disposeIntermediateTensorInfo(x),v}const tct={kernelName:Iv,backendName:"webgl",kernelFunc:Jut};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ect(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{numOrSizeSplits:a,axis:i}=s,l=re(i,r.shape)[0],u=Qw(r,a,l),h=r.shape.length,d=new Array(h).fill(0),p=r.shape.slice();return u.map(m=>{const y=[...p];y[l]=m;const b=Hu({inputs:{x:r},backend:e,attrs:{begin:d,size:y}});return d[l]+=m,b})}const nct={kernelName:Ng,backendName:"webgl",kernelFunc:ect};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gk="return sqrt(x);",sct=me({opSnippet:Gk,packedOpSnippet:Gk,cpuKernelImpl:Aet}),rct={kernelName:dd,backendName:"webgl",kernelFunc:sct};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const act="return x * x;",ict=me({opSnippet:act}),oct={kernelName:Ev,backendName:"webgl",kernelFunc:ict};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wk="return (a - b) * (a - b);",lct=Xn({opSnippet:Wk,packedOpSnippet:Wk}),uct={kernelName:fd,backendName:"webgl",kernelFunc:lct};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cct(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t;if(r.dtype!=="string")throw new Error("Input must be of datatype string");const a=e.readSync(r.dataId),i=Pa(a),l=Ret(i,"string",s);return e.makeTensorInfo(r.shape,"string",l)}const hct={kernelName:$g,backendName:"webgl",kernelFunc:cct};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dct({inputs:n,attrs:t,backend:e}){const{x:s}=n,r=kr+`
    return x > 0.0 ? 1.0 : float(${t.alpha});
  `,a=new na(s.shape,r);return e.runWebGLProgram(a,[s],s.dtype)}const fct={kernelName:bd,backendName:"webgl",kernelFunc:dct};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pct{constructor(t,e,s){this.variableNames=["x"],this.outputShape=s;const r=s.length,a=$e(s.length),i=$e(s.length);let l="";if(r===1)l="coords * strides + begin";else{let u=0;l=s.map((h,d)=>(u++,s.length===1?`coords * strides[${d}] + begin[${d}]`:`coords[${u-1}] * strides[${d}] + begin[${d}]`)).join(",")}this.userCode=`
      ${a} begin = ${a}(${t});
      ${a} strides = ${a}(${e});

      void main() {
        ${i} coords = getOutputCoords();
        setOutput(getX(${l}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mct(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{begin:a,end:i,strides:l,beginMask:u,endMask:h,ellipsisMask:d,newAxisMask:p,shrinkAxisMask:m}=s,{finalShapeSparse:y,finalShape:b,isIdentity:x,sliceDim0:v,isSimpleSlice:S,begin:C,end:$,strides:T}=_w(r.shape,a,i,l,u,h,d,p,m);let I;if(x)I=$t({inputs:{x:r},backend:e,attrs:{shape:b}});else if(v||S){F(r.shape.length>=1,()=>`Input must have rank at least 1, got: ${r.shape.length}`);const R=Aw(C,$,T),L=Hu({inputs:{x:r},backend:e,attrs:{begin:C,size:R}});I=$t({inputs:{x:L},backend:e,attrs:{shape:b}}),e.disposeIntermediateTensorInfo(L)}else if(e.shouldExecuteOnCPU([r])){const L=e.readSync(r.dataId),_=te(r.shape,r.dtype,L),M=Oet(y,_,T,C);I=e.makeTensorInfo(b,r.dtype,M.values)}else{const L=new pct(C,T,y);I=e.runWebGLProgram(L,[r],r.dtype)}const A=$t({inputs:{x:I},backend:e,attrs:{shape:b}});return e.disposeIntermediateTensorInfo(I),A}const gct={kernelName:Dv,backendName:"webgl",kernelFunc:mct};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yct(n){const{inputs:t,backend:e,attrs:s}=n,{separator:r,nGramWidths:a,leftPad:i,rightPad:l,padWidth:u,preserveShortSequences:h}=s,{data:d,dataSplits:p}=t,m=e.readSync(d.dataId),y=e.readSync(p.dataId),[b,x]=_et(m,y,r,a,i,l,u,h);return[e.makeTensorInfo([b.length],"string",b),e.makeTensorInfo(p.shape,"int32",x)]}const bct={kernelName:Av,backendName:"webgl",kernelFunc:yct};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xct(n){const{inputs:t,backend:e,attrs:s}=n,{skipEmpty:r}=s,{input:a,delimiter:i}=t;if(a.dtype!=="string")throw new Error("Input must be of datatype string");if(a.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${a.shape}`);if(i.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${i.shape}`);const l=e.readSync(a.dataId),u=e.readSync(i.dataId)[0],[h,d,p]=Fet(l,u,r),m=d.length;return[e.makeTensorInfo([m,2],"int32",h),e.makeTensorInfo([m],"string",d),e.makeTensorInfo([2],"int32",new Int32Array(p))]}const vct={kernelName:Rv,backendName:"webgl",kernelFunc:xct};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wct(n){const{inputs:t,backend:e,attrs:s}=n,{numBuckets:r}=s,{input:a}=t;if(a.dtype!=="string")throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");const i=e.readSync(a.dataId),l=Let(i,r);return e.makeTensorInfo(a.shape,"int32",l)}const Sct={kernelName:Ov,backendName:"webgl",kernelFunc:wct};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cct="return tan(x);",Nct=me({opSnippet:Cct}),Tct={kernelName:md,backendName:"webgl",kernelFunc:Nct};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $ct=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,kct=me({opSnippet:$ct}),Ict={kernelName:gd,backendName:"webgl",kernelFunc:kct};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ect(n){const{inputs:t,backend:e,attrs:s}=n,{tensor:r,indices:a,updates:i}=t,{sliceRank:l,numUpdates:u,sliceSize:h,strides:d,outputSize:p}=Qo(i,a,r.shape),m=[p/h,h];if(p===0)return e.makeTensorInfo(r.shape,a.dtype);const y=$t({inputs:{x:a},backend:e,attrs:{shape:[u,l]}}),b=$t({inputs:{x:i},backend:e,attrs:{shape:[u,h]}}),x=$t({inputs:{x:r},backend:e,attrs:{shape:m}}),v=new PS(u,l,y.shape.length,b.shape.length,d,m,!1,!0),S=e.runWebGLProgram(v,[b,y,x],x.dtype),C=$t({inputs:{x:S},backend:e,attrs:{shape:r.shape}});return e.disposeIntermediateTensorInfo(y),e.disposeIntermediateTensorInfo(b),e.disposeIntermediateTensorInfo(x),e.disposeIntermediateTensorInfo(S),C}const Dct={kernelName:Sv,backendName:"webgl",kernelFunc:Ect};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Act{constructor(t,e){this.variableNames=["A"];const s=new Array(t.length);for(let i=0;i<s.length;i++)s[i]=t[i]*e[i];this.outputShape=s,this.rank=s.length;const r=$e(this.rank),a=Rct(t);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        setOutput(getA(${a}));
      }
    `}}function Rct(n){const t=n.length;if(t>5)throw Error(`Tile for rank ${t} is not yet supported`);if(t===1)return`imod(resRC, ${n[0]})`;const e=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],s=[];for(let r=0;r<n.length;r++)s.push(`imod(${e[r]}, ${n[r]})`);return s.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LF(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{reps:a}=s;if(r.dtype==="string"||r.shape.length>5){const u=e.readSync(r.dataId),h=r.dtype==="string"?u.map(m=>ki(m)):u,d=te(r.shape,r.dtype,h),p=Met(d,a);return e.makeTensorInfo(p.shape,p.dtype,p.values)}const i=new Act(r.shape,a);return e.runWebGLProgram(i,[r],r.dtype)}const Oct={kernelName:yd,backendName:"webgl",kernelFunc:LF};class _ct{constructor(t){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=t,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class Fct{constructor(t){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=t,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yo(n,t){t!==null&&n.disposeIntermediateTensorInfo(t)}function Hk(n){let t=1;for(;t<n;)t*=2;return t}function Lct(n){const{inputs:t,backend:e,attrs:s}=n,{x:r}=t,{k:a,sorted:i}=s,l=ut().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),u=ut().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),h=r.shape,d=h[h.length-1];if(e.shouldExecuteOnCPU([r])||d<l||a>u){const M=e.readSync(r.dataId),[D,W]=Bet(M,h,r.dtype,a,i);return[e.makeTensorInfo(D.shape,D.dtype,D.values),e.makeTensorInfo(W.shape,W.dtype,W.values)]}if(a===0)return h[h.length-1]=0,[e.makeTensorInfo(h,r.dtype,[]),e.makeTensorInfo(h,"int32",[])];if(d===1)return[r,Gd({attrs:{shape:h,dtype:"int32",value:0},backend:e})];const p=e.texData.get(r.dataId),m=p!==null&&p.isPacked,y=m?e.unpackTensor(r):r,x=mt(h)/d,v=$t({inputs:{x:y},attrs:{shape:[x,d]},backend:e});m&&yo(e,y);const S=Hk(a),C=Hk(d);let $=null;const T=()=>$===null?[v,v]:[v,$],I=(M,D,W)=>{const et=T(),nt=new _ct(W),U=[[d],[$===null?1:0],[Number.NEGATIVE_INFINITY],[M],[D]],Y=$;$=e.runWebGLProgram(nt,et,"int32",U),yo(e,Y)};for(let M=1;M<S;M*=2){const D=M*2;for(let W=M;W>=1;W/=2)I(D,W,[x,C])}for(let M=C;M>S;M/=2){const D=T(),W=new Fct([x,M/2]),nt=[[d],[$===null?1:0],[S]],tt=$;$=e.runWebGLProgram(W,D,"int32",nt),yo(e,tt);const U=S/2,Y=U*2;for(let Z=U;Z>=1;Z/=2)I(Y,Z,$.shape)}let A=$;$=Hu({inputs:{x:$},backend:e,attrs:{begin:0,size:[x,a]}}),yo(e,A);let R=IF({inputs:{x:v,indices:$},backend:e,attrs:{axis:1,batchDims:1}});yo(e,v);const L=h.slice(0,-1);L.push(a),A=$,$=$t({inputs:{x:$},attrs:{shape:L},backend:e}),yo(e,A);const _=R;return R=$t({inputs:{x:R},attrs:{shape:L},backend:e}),yo(e,_),[R,$]}const zct={kernelName:_v,backendName:"webgl",kernelFunc:Lct};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Mct{constructor(t,e,s,r,a,i){this.variableNames=["Image","Transforms"],this.outputShape=i;const l=s==="nearest"?1:2;let u;switch(r){case"constant":u=1;break;case"reflect":u=2;break;case"wrap":u=3;break;case"nearest":u=4;break;default:u=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${u} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${u} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${u} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${t} && 0 <= coordX && coordX < ${e}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${a});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${a});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${e}));
                float mapY = mapCoord(inY, float(${t}));

                if (${l} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bct(n){const{inputs:t,backend:e,attrs:s}=n,{image:r,transforms:a}=t,{interpolation:i,fillMode:l,fillValue:u,outputShape:h}=s,[d,p,m,y]=r.shape,[b,x]=h??[p,m],v=[d,b,x,y],S=new Mct(p,m,i,l,u,v);return e.runWebGLProgram(S,[r,a],"float32")}const Pct={kernelName:Fv,backendName:"webgl",kernelFunc:Bct};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vct(n){const{inputs:t,attrs:e,backend:s}=n,{axis:r}=e,{x:a}=t;Pd(a,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const i=s.readSync(a.dataId),{outputValues:l,outputShape:u,indices:h}=Pet(i,r,a.shape,a.dtype);return[s.makeTensorInfo(u,a.dtype,l),s.makeTensorInfo([h.length],"int32",h)]}const Uct={kernelName:Lv,backendName:"webgl",kernelFunc:Vct};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gct(n){const{inputs:t,backend:e,attrs:s}=n,{value:r}=t;let{axis:a}=s;a<0&&(a+=r.shape.length);const i=r,l=i.shape.length,u=r.shape[a],h=new Array(l-1);let d=0;for(let x=0;x<l;x++)x!==a&&(h[d++]=i.shape[x]);const p=[],m=new Array(l).fill(0),y=i.shape.slice();y[a]=1;const b=new Array(u);for(let x=0;x<b.length;x++){m[a]=x;const v=Hu({inputs:{x:i},backend:e,attrs:{begin:m,size:y}}),S=$t({inputs:{x:v},backend:e,attrs:{shape:h}});b[x]=S,p.push(v)}return p.forEach(x=>e.disposeIntermediateTensorInfo(x)),b}const Wct={kernelName:kg,backendName:"webgl",kernelFunc:Gct};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Hct{constructor(t,e){this.variableNames=["x","segmentIds"];const s=t.windowSize,r=t.batchSize,a=t.inSize,i=t.numSegments,l=i*Math.ceil(a/s);this.outputShape=[r,l];const u="0.0",h="sumValue",d=Math.floor(s/4)*4,p=s%4,m=`
        sumValue += dot(values, segFilter);
    `;let y="";a%s>0&&(y=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return initializationValue;
        }
      `);let b="";a%s>0&&(b=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${u};

      float getValue(int batch, int inIdx) {
        ${y}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${b}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${i})) * float(${s}));
        int currentSeg = int(mod(float(outIdx), float(${i})));

        float sumValue = 0.0;

        for (int i = 0; i < ${d}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${m}
        }

        int inIdx = inOffset + ${d};
        if (${p===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${m}
        } else if (${p===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${m}
        } else if (${p===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${m}
        }
        setOutput(${h});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jct(n){const{inputs:t,backend:e,attrs:s}=n,{x:r,segmentIds:a}=t,{numSegments:i}=s,l=r.shape.length,u=[];let h=0;const d=qe([h],l);let p=r;d!=null&&(p=cs({inputs:{x:r},backend:e,attrs:{perm:d}}),u.push(p),h=ln(1,l)[0]);const m=fA(p.shape,h,i),y=mt([p.shape[h]]),b=$t({inputs:{x:p},backend:e,attrs:{shape:[-1,y]}});u.push(b);const x=Mv(r.dtype),v=(T,I,A,R,L)=>{const _=T.shape[0],M=T.shape[1],D=dA(M,L),W={windowSize:D,inSize:M,batchSize:_,numSegments:L},et=new Hct(W,I),nt=e.compileAndRun(et,[T,A],R);if(u.push(nt),nt.shape[1]===L)return nt;const tt=FF({backend:e,attrs:{start:0,stop:L,step:1,dtype:"float32"}}),U=LF({inputs:{x:tt},backend:e,attrs:{reps:[M/D]}});return u.push(tt),u.push(U),v(nt,I,U,R,L)},S=v(b,"unsortedSegmentSum",a,x,i),C=$t({inputs:{x:S},backend:e,attrs:{shape:m}});let $=C;if(d!=null){u.push(C);const T=Wi(d);$=cs({inputs:{x:$},backend:e,attrs:{perm:T}})}return u.forEach(T=>e.disposeIntermediateTensorInfo(T)),$}const qct={kernelName:Ig,backendName:"webgl",kernelFunc:jct};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xct=[Ant,Ont,Lnt,Bnt,Vnt,Wnt,jnt,Xnt,Qnt,tst,sst,ist,ust,fst,gst,bst,vst,Nst,$st,Ist,Rst,Bst,Vst,Hst,qst,Jst,ert,art,pnt,lrt,frt,yrt,Crt,$rt,Irt,Drt,Rrt,Lrt,Brt,Urt,Wrt,jrt,Xrt,Zrt,Jrt,sat,aat,lat,hat,fat,yat,wat,Tat,Iat,Aat,Rat,_at,Lat,Mat,Pat,Uat,jat,Kat,Qat,tit,sit,iit,cit,pit,fnt,git,hrt,xit,Sit,Tit,gnt,Eit,Oit,Fit,Bit,Uit,jit,Kit,Jit,sot,iot,lot,dot,pot,got,vot,Sot,Not,$ot,Iot,Rot,Lot,Pot,Xot,xnt,Qot,elt,rlt,olt,Kst,clt,dlt,plt,ylt,wlt,bnt,Clt,Tlt,klt,Elt,Dlt,Yst,Wot,Olt,zlt,Vlt,wnt,Hlt,Xlt,Qlt,eut,aut,out,cut,fut,gut,xut,Sut,Tut,Eut,Rut,Lut,But,zst,jot,Uut,Wut,jut,Xut,Yut,Qut,tct,nct,rct,oct,uct,hct,fct,gct,bct,vct,Sct,Hot,Int,Tct,Ict,Dct,Oct,zct,Pct,Ent,Uct,Wct,qct,hlt];for(const n of Xct)BI(n);/**
    * @license
    * Copyright 2023 Google LLC. All Rights Reserved.
    * Licensed under the Apache License, Version 2.0 (the "License");
    * you may not use this file except in compliance with the License.
    * You may obtain a copy of the License at
    *
    * http://www.apache.org/licenses/LICENSE-2.0
    *
    * Unless required by applicable law or agreed to in writing, software
    * distributed under the License is distributed on an "AS IS" BASIS,
    * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    * See the License for the specific language governing permissions and
    * limitations under the License.
    * =============================================================================
    */function zi(n,t,e,s){return new(e||(e=Promise))(function(r,a){function i(h){try{u(s.next(h))}catch(d){a(d)}}function l(h){try{u(s.throw(h))}catch(d){a(d)}}function u(h){var d;h.done?r(h.value):(d=h.value,d instanceof e?d:new e(function(p){p(d)})).then(i,l)}u((s=s.apply(n,[])).next())})}function Mi(n,t){var e,s,r,a,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function l(u){return function(h){return function(d){if(e)throw new TypeError("Generator is already executing.");for(;a&&(a=0,d[0]&&(i=0)),i;)try{if(e=1,s&&(r=2&d[0]?s.return:d[0]?s.throw||((r=s.return)&&r.call(s),0):s.next)&&!(r=r.call(s,d[1])).done)return r;switch(s=0,r&&(d=[2&d[0],r.value]),d[0]){case 0:case 1:r=d;break;case 4:return i.label++,{value:d[1],done:!1};case 5:i.label++,s=d[1],d=[0];continue;case 7:d=i.ops.pop(),i.trys.pop();continue;default:if(r=i.trys,!((r=r.length>0&&r[r.length-1])||d[0]!==6&&d[0]!==2)){i=0;continue}if(d[0]===3&&(!r||d[1]>r[0]&&d[1]<r[3])){i.label=d[1];break}if(d[0]===6&&i.label<r[1]){i.label=r[1],r=d;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(d);break}r[2]&&i.ops.pop(),i.trys.pop();continue}d=t.call(n,i)}catch(p){d=[6,p],s=0}finally{e=r=0}if(5&d[0])throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}([u,h])}}}function ql(n,t,e){if(e||arguments.length===2)for(var s,r=0,a=t.length;r<a;r++)!s&&r in t||(s||(s=Array.prototype.slice.call(t,0,r)),s[r]=t[r]);return n.concat(s||Array.prototype.slice.call(t))}function VS(n){return[Math.abs(n.endPoint[0]-n.startPoint[0]),Math.abs(n.endPoint[1]-n.startPoint[1])]}function ym(n){return[n.startPoint[0]+(n.endPoint[0]-n.startPoint[0])/2,n.startPoint[1]+(n.endPoint[1]-n.startPoint[1])/2]}function jk(n,t){t===void 0&&(t=1.5);var e=ym(n),s=VS(n),r=[t*s[0]/2,t*s[1]/2];return{startPoint:[e[0]-r[0],e[1]-r[1]],endPoint:[e[0]+r[0],e[1]+r[1]],palmLandmarks:n.palmLandmarks}}function qk(n){var t=ym(n),e=VS(n),s=Math.max.apply(Math,e)/2;return{startPoint:[t[0]-s,t[1]-s],endPoint:[t[0]+s,t[1]+s],palmLandmarks:n.palmLandmarks}}function Xk(n,t){var e=[n.endPoint[0]-n.startPoint[0],n.endPoint[1]-n.startPoint[1]],s=[e[0]*t[0],e[1]*t[1]];return{startPoint:[n.startPoint[0]+s[0],n.startPoint[1]+s[1]],endPoint:[n.endPoint[0]+s[0],n.endPoint[1]+s[1]],palmLandmarks:n.palmLandmarks}}var Kct=function(){function n(t,e,s,r,a,i){this.model=t,this.width=e,this.height=s,this.iouThreshold=a,this.scoreThreshold=i,this.anchors=r.map(function(l){return[l.x_center,l.y_center]}),this.anchorsTensor=iu(this.anchors),this.inputSizeTensor=Un([e,s]),this.doubleInputSizeTensor=Un([2*e,2*s])}return n.prototype.normalizeBoxes=function(t){var e=this;return at(function(){var s=Qt(t,[0,0],[-1,2]),r=Qt(t,[0,2],[-1,2]),a=St(_t(s,e.inputSizeTensor),e.anchorsTensor),i=_t(r,e.doubleInputSizeTensor),l=X(Rt(a,i),e.inputSizeTensor),u=X(St(a,i),e.inputSizeTensor);return Hv([l,u],1)})},n.prototype.normalizeLandmarks=function(t,e){var s=this;return at(function(){var r=St(_t(J(t,[-1,7,2]),s.inputSizeTensor),s.anchors[e]);return X(r,s.inputSizeTensor)})},n.prototype.getBoundingBoxes=function(t){return zi(this,void 0,void 0,function(){var e,s,r,a,i,l,u,h,d,p,m,y,b,x,v,S=this;return Mi(this,function(C){switch(C.label){case 0:return e=at(function(){return X(Rt(t,.5),2)}),Bv()==="webgl"?(r=ut().get("WEBGL_PACK_DEPTHWISECONV"),ut().set("WEBGL_PACK_DEPTHWISECONV",!0),s=this.model.predict(e),ut().set("WEBGL_PACK_DEPTHWISECONV",r)):s=this.model.predict(e),a=Ma(s),i=at(function(){return Ma(Fr(Qt(a,[0,0],[-1,1])))}),l=Qt(a,[0,1],[-1,4]),u=this.normalizeBoxes(l),h=console.warn,console.warn=function(){},d=Es.nonMaxSuppression(u,i,1,this.iouThreshold,this.scoreThreshold),console.warn=h,[4,d.array()];case 1:return p=C.sent(),m=[e,s,d,a,u,l,i],p.length===0?(m.forEach(function($){return $.dispose()}),[2,null]):(y=p[0],b=Qt(u,[y,0],[1,-1]),x=Qt(a,[y,5],[1,14]),v=at(function(){return J(S.normalizeLandmarks(x,y),[-1,2])}),m.push(x),m.forEach(function($){return $.dispose()}),[2,{boxes:b,palmLandmarks:v}])}})})},n.prototype.estimateHandBounds=function(t){return zi(this,void 0,void 0,function(){var e,s,r,a,i,l,u,h,d=this;return Mi(this,function(p){switch(p.label){case 0:return e=t.shape[1],s=t.shape[2],r=at(function(){return _t(Es.resizeBilinear(t,[d.width,d.height]),255)}),[4,this.getBoundingBoxes(r)];case 1:return(a=p.sent())===null?(r.dispose(),[2,null]):(i=a.boxes.arraySync(),l=i[0].slice(0,2),u=i[0].slice(2,4),h=a.palmLandmarks.arraySync(),r.dispose(),a.boxes.dispose(),a.palmLandmarks.dispose(),[2,(m={startPoint:l,endPoint:u,palmLandmarks:h},y=[s/this.width,e/this.height],{startPoint:[m.startPoint[0]*y[0],m.startPoint[1]*y[1]],endPoint:[m.endPoint[0]*y[0],m.endPoint[1]*y[1]],palmLandmarks:m.palmLandmarks.map(function(b){return[b[0]*y[0],b[1]*y[1]]})})])}var m,y})})},n}(),cx={thumb:[1,2,3,4],indexFinger:[5,6,7,8],middleFinger:[9,10,11,12],ringFinger:[13,14,15,16],pinky:[17,18,19,20],palmBase:[0]};function Yct(n,t){var e,s=Math.PI/2-Math.atan2(-(t[1]-n[1]),t[0]-n[0]);return(e=s)-2*Math.PI*Math.floor((e+Math.PI)/(2*Math.PI))}var Kk=function(n,t){return[[1,0,n],[0,1,t],[0,0,1]]};function $o(n,t){for(var e=0,s=0;s<n.length;s++)e+=n[s]*t[s];return e}function Zct(n,t){for(var e=[],s=0;s<n.length;s++)e.push(n[s][t]);return e}function Yk(n,t){for(var e=[],s=n.length,r=0;r<s;r++){e.push([]);for(var a=0;a<s;a++)e[r].push($o(n[r],Zct(t,a)))}return e}function Zk(n,t){var e=Math.cos(n),s=Math.sin(n),r=[[e,-s,0],[s,e,0],[0,0,1]],a=Yk(Kk(t[0],t[1]),r);return Yk(a,Kk(-t[0],-t[1]))}function Qk(n,t){return[$o(n,t[0]),$o(n,t[1])]}var Qct=[0,-.4],Jct=[0,-.1],Jk=[0,5,9,13,17,1,2],tht=function(){function n(t,e,s,r,a,i){this.boundingBoxDetector=t,this.meshDetector=e,this.meshWidth=s,this.meshHeight=r,this.maxContinuousChecks=a,this.detectionConfidence=i,this.regionsOfInterest=[],this.runsWithoutHandDetector=0,this.maxHandsNumber=1}return n.prototype.getBoxForPalmLandmarks=function(t,e){var s=t.map(function(r){return Qk(ql(ql([],r,!0),[1],!1),e)});return jk(qk(Xk(this.calculateLandmarksBoundingBox(s),Qct)),3)},n.prototype.getBoxForHandLandmarks=function(t){for(var e=jk(qk(Xk(this.calculateLandmarksBoundingBox(t),Jct)),1.65),s=[],r=0;r<Jk.length;r++)s.push(t[Jk[r]].slice(0,2));return e.palmLandmarks=s,e},n.prototype.transformRawCoords=function(t,e,s,r){var a,i,l,u,h=this,d=VS(e),p=[d[0]/this.meshWidth,d[1]/this.meshHeight],m=t.map(function(C){return[p[0]*(C[0]-h.meshWidth/2),p[1]*(C[1]-h.meshHeight/2),C[2]]}),y=Zk(s,[0,0]),b=m.map(function(C){return ql(ql([],Qk(C,y),!0),[C[2]],!1)}),x=(i=[[(a=r)[0][0],a[1][0]],[a[0][1],a[1][1]]],l=[a[0][2],a[1][2]],u=[-$o(i[0],l),-$o(i[1],l)],[i[0].concat(u[0]),i[1].concat(u[1]),[0,0,1]]),v=ql(ql([],ym(e),!0),[1],!1),S=[$o(v,x[0]),$o(v,x[1])];return b.map(function(C){return[C[0]+S[0],C[1]+S[1],C[2]]})},n.prototype.estimateHand=function(t){return zi(this,void 0,void 0,function(){var e,s,r,a,i,l,u,h,d,p,m,y,b,x,v,S,C,$,T,I;return Mi(this,function(A){switch(A.label){case 0:return(e=this.shouldUpdateRegionsOfInterest())!==!0?[3,2]:[4,this.boundingBoxDetector.estimateHandBounds(t)];case 1:return(s=A.sent())===null?(t.dispose(),this.regionsOfInterest=[],[2,null]):(this.updateRegionsOfInterest(s,!0),this.runsWithoutHandDetector=0,[3,3]);case 2:this.runsWithoutHandDetector++,A.label=3;case 3:return r=this.regionsOfInterest[0],a=Yct(r.palmLandmarks[0],r.palmLandmarks[2]),i=ym(r),l=[i[0]/t.shape[2],i[1]/t.shape[1]],u=Es.rotateWithOffset(t,a,0,l),h=Zk(-a,i),d=e===!0?this.getBoxForPalmLandmarks(r.palmLandmarks,h):r,p=function(R,L,_){var M=L.shape[1],D=L.shape[2],W=[[R.startPoint[1]/M,R.startPoint[0]/D,R.endPoint[1]/M,R.endPoint[0]/D]];return Es.cropAndResize(L,W,[0],_)}(d,u,[this.meshWidth,this.meshHeight]),m=_t(p,255),p.dispose(),u.dispose(),Bv()==="webgl"?(b=ut().get("WEBGL_PACK_DEPTHWISECONV"),ut().set("WEBGL_PACK_DEPTHWISECONV",!0),y=this.meshDetector.predict(m),ut().set("WEBGL_PACK_DEPTHWISECONV",b)):y=this.meshDetector.predict(m),x=y[0],v=y[1],m.dispose(),S=x.dataSync()[0],x.dispose(),S<this.detectionConfidence?(v.dispose(),this.regionsOfInterest=[],[2,null]):(C=J(v,[-1,3]),$=C.arraySync(),v.dispose(),C.dispose(),T=this.transformRawCoords($,d,a,h),I=this.getBoxForHandLandmarks(T),this.updateRegionsOfInterest(I,!1),[2,{landmarks:T,handInViewConfidence:S,boundingBox:{topLeft:I.startPoint,bottomRight:I.endPoint}}])}})})},n.prototype.calculateLandmarksBoundingBox=function(t){var e=t.map(function(r){return r[0]}),s=t.map(function(r){return r[1]});return{startPoint:[Math.min.apply(Math,e),Math.min.apply(Math,s)],endPoint:[Math.max.apply(Math,e),Math.max.apply(Math,s)]}},n.prototype.updateRegionsOfInterest=function(t,e){if(e)this.regionsOfInterest=[t];else{var s=this.regionsOfInterest[0],r=0;if(s!=null&&s.startPoint!=null){var a=t.startPoint,i=a[0],l=a[1],u=t.endPoint,h=u[0],d=u[1],p=s.startPoint,m=p[0],y=p[1],b=s.endPoint,x=b[0],v=b[1],S=Math.max(i,m),C=Math.max(l,y),$=(Math.min(h,x)-S)*(Math.min(d,v)-C);r=$/((h-i)*(d-l)+(x-m)*(v-l)-$)}this.regionsOfInterest[0]=r>.8?s:t}},n.prototype.shouldUpdateRegionsOfInterest=function(){return this.regionsOfInterest.length!==this.maxHandsNumber||this.runsWithoutHandDetector>=this.maxContinuousChecks},n}();function eht(){return zi(this,void 0,void 0,function(){return Mi(this,function(n){return[2,FO("https://tfhub.dev/mediapipe/tfjs-model/handdetector/1/default/1",{fromTFHub:!0})]})})}function nht(){return zi(this,void 0,void 0,function(){return Mi(this,function(n){return[2,FO("https://tfhub.dev/mediapipe/tfjs-model/handskeleton/1/default/1",{fromTFHub:!0})]})})}function sht(){return zi(this,void 0,void 0,function(){return Mi(this,function(n){return[2,QM("https://tfhub.dev/mediapipe/tfjs-model/handskeleton/1/default/1/anchors.json?tfjs-format=file").then(function(t){return t.json()})]})})}function zF(n){var t={},e=t.maxContinuousChecks,s=e===void 0?1/0:e,r=t.detectionConfidence,a=r===void 0?.8:r,i=t.iouThreshold,l=i===void 0?.3:i,u=t.scoreThreshold,h=u===void 0?.5:u;return zi(this,void 0,void 0,function(){var d,p,m,y,b,x;return Mi(this,function(v){switch(v.label){case 0:return[4,Promise.all([sht(),eht(),nht()])];case 1:return d=v.sent(),p=d[0],m=d[1],y=d[2],b=new Kct(m,256,256,p,l,h),x=new tht(b,y,256,256,s,a),[2,new rht(x)]}})})}var rht=function(){function n(t){this.pipeline=t}return n.getAnnotations=function(){return cx},n.prototype.estimateHands=function(t,e){return e===void 0&&(e=!1),zi(this,void 0,void 0,function(){var s,r,a,i,l,u,h,d,p;return Mi(this,function(m){switch(m.label){case 0:return s=function(y){return y instanceof Me?[y.shape[0],y.shape[1]]:[y.height,y.width]}(t),r=s[1],a=at(function(){return t instanceof Me||(t=WH(t)),Qn(kt(t,"float32"))}),[4,this.pipeline.estimateHand(a)];case 1:if(i=m.sent(),a.dispose(),i===null)return[2,[]];for(l=i,e===!0&&(l=function(y,b){var x=y.handInViewConfidence,v=y.landmarks,S=y.boundingBox;return{handInViewConfidence:x,landmarks:v.map(function(C){return[b-1-C[0],C[1],C[2]]}),boundingBox:{topLeft:[b-1-S.topLeft[0],S.topLeft[1]],bottomRight:[b-1-S.bottomRight[0],S.bottomRight[1]]}}}(i,r)),u={},h=0,d=Object.keys(cx);h<d.length;h++)p=d[h],u[p]=cx[p].map(function(y){return l.landmarks[y]});return[2,[{handInViewConfidence:l.handInViewConfidence,boundingBox:l.boundingBox,landmarks:l.landmarks,annotations:u}]]}})})},n}(),Op={exports:{}},aht=Op.exports,tI;function iht(){return tI||(tI=1,function(n,t){(function(s,r){n.exports=r(Cm())})(aht,function(e){return function(s){var r={};function a(i){if(r[i])return r[i].exports;var l=r[i]={i,l:!1,exports:{}};return s[i].call(l.exports,l,l.exports,a),l.l=!0,l.exports}return a.m=s,a.c=r,a.d=function(i,l,u){a.o(i,l)||Object.defineProperty(i,l,{enumerable:!0,get:u})},a.r=function(i){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})},a.t=function(i,l){if(l&1&&(i=a(i)),l&8||l&4&&typeof i=="object"&&i&&i.__esModule)return i;var u=Object.create(null);if(a.r(u),Object.defineProperty(u,"default",{enumerable:!0,value:i}),l&2&&typeof i!="string")for(var h in i)a.d(u,h,(function(d){return i[d]}).bind(null,h));return u},a.n=function(i){var l=i&&i.__esModule?function(){return i.default}:function(){return i};return a.d(l,"a",l),l},a.o=function(i,l){return Object.prototype.hasOwnProperty.call(i,l)},a.p="",a(a.s="./src/react-webcam.tsx")}({"./src/react-webcam.tsx":function(s,r,a){a.r(r);var i=a("react"),l=function(){var m=function(y,b){return m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,v){x.__proto__=v}||function(x,v){for(var S in v)v.hasOwnProperty(S)&&(x[S]=v[S])},m(y,b)};return function(y,b){m(y,b);function x(){this.constructor=y}y.prototype=b===null?Object.create(b):(x.prototype=b.prototype,new x)}}(),u=function(){return u=Object.assign||function(m){for(var y,b=1,x=arguments.length;b<x;b++){y=arguments[b];for(var v in y)Object.prototype.hasOwnProperty.call(y,v)&&(m[v]=y[v])}return m},u.apply(this,arguments)},h=function(m,y){var b={};for(var x in m)Object.prototype.hasOwnProperty.call(m,x)&&y.indexOf(x)<0&&(b[x]=m[x]);if(m!=null&&typeof Object.getOwnPropertySymbols=="function")for(var v=0,x=Object.getOwnPropertySymbols(m);v<x.length;v++)y.indexOf(x[v])<0&&Object.prototype.propertyIsEnumerable.call(m,x[v])&&(b[x[v]]=m[x[v]]);return b};(function(){typeof window>"u"||(navigator.mediaDevices===void 0&&(navigator.mediaDevices={}),navigator.mediaDevices.getUserMedia===void 0&&(navigator.mediaDevices.getUserMedia=function(y){var b=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;return b?new Promise(function(x,v){b.call(navigator,y,x,v)}):Promise.reject(new Error("getUserMedia is not implemented in this browser"))}))})();function d(){return!!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)}var p=function(m){l(y,m);function y(b){var x=m.call(this,b)||this;return x.canvas=null,x.ctx=null,x.requestUserMediaId=0,x.unmounted=!1,x.state={hasUserMedia:!1},x}return y.prototype.componentDidMount=function(){var b=this,x=b.state,v=b.props;if(this.unmounted=!1,!d()){v.onUserMediaError("getUserMedia not supported");return}x.hasUserMedia||this.requestUserMedia(),v.children&&typeof v.children!="function"&&console.warn("children must be a function")},y.prototype.componentDidUpdate=function(b){var x=this.props;if(!d()){x.onUserMediaError("getUserMedia not supported");return}var v=JSON.stringify(b.audioConstraints)!==JSON.stringify(x.audioConstraints),S=JSON.stringify(b.videoConstraints)!==JSON.stringify(x.videoConstraints),C=b.minScreenshotWidth!==x.minScreenshotWidth,$=b.minScreenshotHeight!==x.minScreenshotHeight;(S||C||$)&&(this.canvas=null,this.ctx=null),(v||S)&&(this.stopAndCleanup(),this.requestUserMedia())},y.prototype.componentWillUnmount=function(){this.unmounted=!0,this.stopAndCleanup()},y.stopMediaStream=function(b){b&&(b.getVideoTracks&&b.getAudioTracks?(b.getVideoTracks().map(function(x){b.removeTrack(x),x.stop()}),b.getAudioTracks().map(function(x){b.removeTrack(x),x.stop()})):b.stop())},y.prototype.stopAndCleanup=function(){var b=this.state;b.hasUserMedia&&(y.stopMediaStream(this.stream),b.src&&window.URL.revokeObjectURL(b.src))},y.prototype.getScreenshot=function(b){var x=this,v=x.state,S=x.props;if(!v.hasUserMedia)return null;var C=this.getCanvas(b);return C&&C.toDataURL(S.screenshotFormat,S.screenshotQuality)},y.prototype.getCanvas=function(b){var x=this,v=x.state,S=x.props;if(!this.video||!v.hasUserMedia||!this.video.videoHeight)return null;if(!this.ctx){var C=this.video.videoWidth,$=this.video.videoHeight;if(!this.props.forceScreenshotSourceSize){var T=C/$;C=S.minScreenshotWidth||this.video.clientWidth,$=C/T,S.minScreenshotHeight&&$<S.minScreenshotHeight&&($=S.minScreenshotHeight,C=$*T)}this.canvas=document.createElement("canvas"),this.canvas.width=(b==null?void 0:b.width)||C,this.canvas.height=(b==null?void 0:b.height)||$,this.ctx=this.canvas.getContext("2d")}var I=this,A=I.ctx,R=I.canvas;return A&&R&&(R.width=(b==null?void 0:b.width)||R.width,R.height=(b==null?void 0:b.height)||R.height,S.mirrored&&(A.translate(R.width,0),A.scale(-1,1)),A.imageSmoothingEnabled=S.imageSmoothing,A.drawImage(this.video,0,0,(b==null?void 0:b.width)||R.width,(b==null?void 0:b.height)||R.height),S.mirrored&&(A.scale(-1,1),A.translate(-R.width,0))),R},y.prototype.requestUserMedia=function(){var b=this,x=this.props,v=function($,T){var I={video:typeof T<"u"?T:!0};x.audio&&(I.audio=typeof $<"u"?$:!0),b.requestUserMediaId++;var A=b.requestUserMediaId;navigator.mediaDevices.getUserMedia(I).then(function(R){b.unmounted||A!==b.requestUserMediaId?y.stopMediaStream(R):b.handleUserMedia(null,R)}).catch(function(R){b.handleUserMedia(R)})};if("mediaDevices"in navigator)v(x.audioConstraints,x.videoConstraints);else{var S=function($){return{optional:[{sourceId:$}]}},C=function($){var T=$.deviceId;return typeof T=="string"?T:Array.isArray(T)&&T.length>0?T[0]:typeof T=="object"&&T.ideal?T.ideal:null};MediaStreamTrack.getSources(function($){var T=null,I=null;$.forEach(function(L){L.kind==="audio"?T=L.id:L.kind==="video"&&(I=L.id)});var A=C(x.audioConstraints);A&&(T=A);var R=C(x.videoConstraints);R&&(I=R),v(S(T),S(I))})}},y.prototype.handleUserMedia=function(b,x){var v=this.props;if(b||!x){this.setState({hasUserMedia:!1}),v.onUserMediaError(b);return}this.stream=x;try{this.video&&(this.video.srcObject=x),this.setState({hasUserMedia:!0})}catch{this.setState({hasUserMedia:!0,src:window.URL.createObjectURL(x)})}v.onUserMedia(x)},y.prototype.render=function(){var b=this,x=this,v=x.state,S=x.props,C=S.audio;S.forceScreenshotSourceSize;var $=S.disablePictureInPicture;S.onUserMedia,S.onUserMediaError,S.screenshotFormat,S.screenshotQuality,S.minScreenshotWidth,S.minScreenshotHeight,S.audioConstraints,S.videoConstraints,S.imageSmoothing;var T=S.mirrored,I=S.style,A=I===void 0?{}:I,R=S.children,L=h(S,["audio","forceScreenshotSourceSize","disablePictureInPicture","onUserMedia","onUserMediaError","screenshotFormat","screenshotQuality","minScreenshotWidth","minScreenshotHeight","audioConstraints","videoConstraints","imageSmoothing","mirrored","style","children"]),_=T?u(u({},A),{transform:(A.transform||"")+" scaleX(-1)"}):A,M={getScreenshot:this.getScreenshot.bind(this)};return i.createElement(i.Fragment,null,i.createElement("video",u({autoPlay:!0,disablePictureInPicture:$,src:v.src,muted:!C,playsInline:!0,ref:function(D){b.video=D},style:_},L)),R&&R(M))},y.defaultProps={audio:!1,disablePictureInPicture:!1,forceScreenshotSourceSize:!1,imageSmoothing:!0,mirrored:!1,onUserMedia:function(){},onUserMediaError:function(){},screenshotFormat:"image/webp",screenshotQuality:.92},y}(i.Component);r.default=p},react:function(s,r){s.exports=e}}).default})}(Op)),Op.exports}var oht=iht();const MF=Sm(oht),BF=(n,t)=>{n.length>0&&n.forEach(e=>{const s=e.landmarks;for(let a=0;a<s.length;a++){const i=s[a][0],l=s[a][1];t.beginPath(),t.arc(i,l,5,0,3*Math.PI),t.fillStyle="indigo",t.fill()}const r=[[0,1,2,3,4],[0,5,6,7,8],[0,9,10,11,12],[0,13,14,15,16],[0,17,18,19,20]];for(let a=0;a<r.length;a++){const i=r[a];for(let l=0;l<i.length-1;l++){const u=i[l],h=i[l+1];t.beginPath(),t.moveTo(s[u][0],s[u][1]),t.lineTo(s[h][0],s[h][1]),t.strokeStyle="plum",t.lineWidth=4,t.stroke()}}})};var _p={exports:{}},lht=_p.exports,eI;function uht(){return eI||(eI=1,function(n,t){(function(e,s){n.exports=s()})(typeof self<"u"?self:lht,function(){return function(e){var s={};function r(a){if(s[a])return s[a].exports;var i=s[a]={i:a,l:!1,exports:{}};return e[a].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=s,r.d=function(a,i,l){r.o(a,i)||Object.defineProperty(a,i,{enumerable:!0,get:l})},r.r=function(a){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},r.t=function(a,i){if(1&i&&(a=r(a)),8&i||4&i&&typeof a=="object"&&a&&a.__esModule)return a;var l=Object.create(null);if(r.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:a}),2&i&&typeof a!="string")for(var u in a)r.d(l,u,(function(h){return a[h]}).bind(null,u));return l},r.n=function(a){var i=a&&a.__esModule?function(){return a.default}:function(){return a};return r.d(i,"a",i),i},r.o=function(a,i){return Object.prototype.hasOwnProperty.call(a,i)},r.p="",r(r.s=0)}([function(e,s,r){r.r(s);var a={};function i(G){return(i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(O){return typeof O}:function(O){return O&&typeof Symbol=="function"&&O.constructor===Symbol&&O!==Symbol.prototype?"symbol":typeof O})(G)}r.r(a),r.d(a,"VictoryGesture",function(){return et}),r.d(a,"ThumbsUpGesture",function(){return Z});var l={Thumb:0,Index:1,Middle:2,Ring:3,Pinky:4,all:[0,1,2,3,4],nameMapping:{0:"Thumb",1:"Index",2:"Middle",3:"Ring",4:"Pinky"},pointsMapping:{0:[[0,1],[1,2],[2,3],[3,4]],1:[[0,5],[5,6],[6,7],[7,8]],2:[[0,9],[9,10],[10,11],[11,12]],3:[[0,13],[13,14],[14,15],[15,16]],4:[[0,17],[17,18],[18,19],[19,20]]},getName:function(G){return i(this.nameMapping[G])!==void 0&&this.nameMapping[G]},getPoints:function(G){return i(this.pointsMapping[G])!==void 0&&this.pointsMapping[G]}},u={NoCurl:0,HalfCurl:1,FullCurl:2,nameMapping:{0:"No Curl",1:"Half Curl",2:"Full Curl"},getName:function(G){return i(this.nameMapping[G])!==void 0&&this.nameMapping[G]}},h={VerticalUp:0,VerticalDown:1,HorizontalLeft:2,HorizontalRight:3,DiagonalUpRight:4,DiagonalUpLeft:5,DiagonalDownRight:6,DiagonalDownLeft:7,nameMapping:{0:"Vertical Up",1:"Vertical Down",2:"Horizontal Left",3:"Horizontal Right",4:"Diagonal Up Right",5:"Diagonal Up Left",6:"Diagonal Down Right",7:"Diagonal Down Left"},getName:function(G){return i(this.nameMapping[G])!==void 0&&this.nameMapping[G]}};function d(G,O){var V=typeof Symbol<"u"&&G[Symbol.iterator]||G["@@iterator"];if(!V){if(Array.isArray(G)||(V=function(ht,xt){if(ht){if(typeof ht=="string")return p(ht,xt);var Ct=Object.prototype.toString.call(ht).slice(8,-1);if(Ct==="Object"&&ht.constructor&&(Ct=ht.constructor.name),Ct==="Map"||Ct==="Set")return Array.from(ht);if(Ct==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Ct))return p(ht,xt)}}(G))||O){V&&(G=V);var P=0,H=function(){};return{s:H,n:function(){return P>=G.length?{done:!0}:{done:!1,value:G[P++]}},e:function(ht){throw ht},f:H}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Q,ot=!0,lt=!1;return{s:function(){V=V.call(G)},n:function(){var ht=V.next();return ot=ht.done,ht},e:function(ht){lt=!0,Q=ht},f:function(){try{ot||V.return==null||V.return()}finally{if(lt)throw Q}}}}function p(G,O){(O==null||O>G.length)&&(O=G.length);for(var V=0,P=new Array(O);V<O;V++)P[V]=G[V];return P}function m(G,O){var V=Object.keys(G);if(Object.getOwnPropertySymbols){var P=Object.getOwnPropertySymbols(G);O&&(P=P.filter(function(H){return Object.getOwnPropertyDescriptor(G,H).enumerable})),V.push.apply(V,P)}return V}function y(G){for(var O=1;O<arguments.length;O++){var V=arguments[O]!=null?arguments[O]:{};O%2?m(Object(V),!0).forEach(function(P){b(G,P,V[P])}):Object.getOwnPropertyDescriptors?Object.defineProperties(G,Object.getOwnPropertyDescriptors(V)):m(Object(V)).forEach(function(P){Object.defineProperty(G,P,Object.getOwnPropertyDescriptor(V,P))})}return G}function b(G,O,V){return O in G?Object.defineProperty(G,O,{value:V,enumerable:!0,configurable:!0,writable:!0}):G[O]=V,G}function x(G,O){for(var V=0;V<O.length;V++){var P=O[V];P.enumerable=P.enumerable||!1,P.configurable=!0,"value"in P&&(P.writable=!0),Object.defineProperty(G,P.key,P)}}var v=function(){function G(P){(function(H,Q){if(!(H instanceof Q))throw new TypeError("Cannot call a class as a function")})(this,G),this.options=y(y({},{HALF_CURL_START_LIMIT:60,NO_CURL_START_LIMIT:130,DISTANCE_VOTE_POWER:1.1,SINGLE_ANGLE_VOTE_POWER:.9,TOTAL_ANGLE_VOTE_POWER:1.6}),P)}var O,V;return O=G,(V=[{key:"estimate",value:function(P){var H,Q=[],ot=[],lt=d(l.all);try{for(lt.s();!(H=lt.n()).done;){var ht,xt=H.value,Ct=l.getPoints(xt),Dt=[],It=[],Ot=d(Ct);try{for(Ot.s();!(ht=Ot.n()).done;){var Xt=ht.value,Kt=P[Xt[0]],Zt=P[Xt[1]],Ht=this.getSlopes(Kt,Zt),jt=Ht[0],ie=Ht[1];Dt.push(jt),It.push(ie)}}catch(ss){Ot.e(ss)}finally{Ot.f()}Q.push(Dt),ot.push(It)}}catch(ss){lt.e(ss)}finally{lt.f()}var mn,ve=[],Xe=[],ke=d(l.all);try{for(ke.s();!(mn=ke.n()).done;){var tn=mn.value,en=tn==l.Thumb?1:0,hn=l.getPoints(tn),Ke=P[hn[en][0]],Oe=P[hn[en+1][1]],nn=P[hn[3][1]],Pe=this.estimateFingerCurl(Ke,Oe,nn),Wr=this.calculateFingerDirection(Ke,Oe,nn,Q[tn].slice(en));ve[tn]=Pe,Xe[tn]=Wr}}catch(ss){ke.e(ss)}finally{ke.f()}return{curls:ve,directions:Xe}}},{key:"getSlopes",value:function(P,H){var Q=this.calculateSlope(P[0],P[1],H[0],H[1]);return P.length==2?Q:[Q,this.calculateSlope(P[1],P[2],H[1],H[2])]}},{key:"angleOrientationAt",value:function(P){var H=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,Q=0,ot=0,lt=0;return P>=75&&P<=105?Q=1*H:P>=25&&P<=155?ot=1*H:lt=1*H,[Q,ot,lt]}},{key:"estimateFingerCurl",value:function(P,H,Q){var ot=P[0]-H[0],lt=P[0]-Q[0],ht=H[0]-Q[0],xt=P[1]-H[1],Ct=P[1]-Q[1],Dt=H[1]-Q[1],It=P[2]-H[2],Ot=P[2]-Q[2],Xt=H[2]-Q[2],Kt=Math.sqrt(ot*ot+xt*xt+It*It),Zt=Math.sqrt(lt*lt+Ct*Ct+Ot*Ot),Ht=Math.sqrt(ht*ht+Dt*Dt+Xt*Xt),jt=(Ht*Ht+Kt*Kt-Zt*Zt)/(2*Ht*Kt);jt>1?jt=1:jt<-1&&(jt=-1);var ie=Math.acos(jt);return(ie=57.2958*ie%180)>this.options.NO_CURL_START_LIMIT?u.NoCurl:ie>this.options.HALF_CURL_START_LIMIT?u.HalfCurl:u.FullCurl}},{key:"estimateHorizontalDirection",value:function(P,H,Q,ot){return ot==Math.abs(P)?P>0?h.HorizontalLeft:h.HorizontalRight:ot==Math.abs(H)?H>0?h.HorizontalLeft:h.HorizontalRight:Q>0?h.HorizontalLeft:h.HorizontalRight}},{key:"estimateVerticalDirection",value:function(P,H,Q,ot){return ot==Math.abs(P)?P<0?h.VerticalDown:h.VerticalUp:ot==Math.abs(H)?H<0?h.VerticalDown:h.VerticalUp:Q<0?h.VerticalDown:h.VerticalUp}},{key:"estimateDiagonalDirection",value:function(P,H,Q,ot,lt,ht,xt,Ct){var Dt=this.estimateVerticalDirection(P,H,Q,ot),It=this.estimateHorizontalDirection(lt,ht,xt,Ct);return Dt==h.VerticalUp?It==h.HorizontalLeft?h.DiagonalUpLeft:h.DiagonalUpRight:It==h.HorizontalLeft?h.DiagonalDownLeft:h.DiagonalDownRight}},{key:"calculateFingerDirection",value:function(P,H,Q,ot){var lt=P[0]-H[0],ht=P[0]-Q[0],xt=H[0]-Q[0],Ct=P[1]-H[1],Dt=P[1]-Q[1],It=H[1]-Q[1],Ot=Math.max(Math.abs(lt),Math.abs(ht),Math.abs(xt)),Xt=Math.max(Math.abs(Ct),Math.abs(Dt),Math.abs(It)),Kt=0,Zt=0,Ht=0,jt=Xt/(Ot+1e-5);jt>1.5?Kt+=this.options.DISTANCE_VOTE_POWER:jt>.66?Zt+=this.options.DISTANCE_VOTE_POWER:Ht+=this.options.DISTANCE_VOTE_POWER;var ie=Math.sqrt(lt*lt+Ct*Ct),mn=Math.sqrt(ht*ht+Dt*Dt),ve=Math.sqrt(xt*xt+It*It),Xe=Math.max(ie,mn,ve),ke=P[0],tn=P[1],en=Q[0],hn=Q[1];Xe==ie?(en=Q[0],hn=Q[1]):Xe==ve&&(ke=H[0],tn=H[1]);var Ke=[ke,tn],Oe=[en,hn],nn=this.getSlopes(Ke,Oe),Pe=this.angleOrientationAt(nn,this.options.TOTAL_ANGLE_VOTE_POWER);Kt+=Pe[0],Zt+=Pe[1],Ht+=Pe[2];var Wr,ss=d(ot);try{for(ss.s();!(Wr=ss.n()).done;){var Ku=Wr.value,Vs=this.angleOrientationAt(Ku,this.options.SINGLE_ANGLE_VOTE_POWER);Kt+=Vs[0],Zt+=Vs[1],Ht+=Vs[2]}}catch(qa){ss.e(qa)}finally{ss.f()}return Kt==Math.max(Kt,Zt,Ht)?this.estimateVerticalDirection(Dt,Ct,It,Xt):Ht==Math.max(Zt,Ht)?this.estimateHorizontalDirection(ht,lt,xt,Ot):this.estimateDiagonalDirection(Dt,Ct,It,Xt,ht,lt,xt,Ot)}},{key:"calculateSlope",value:function(P,H,Q,ot){var lt=(H-ot)/(P-Q),ht=180*Math.atan(lt)/Math.PI;return ht<=0?ht=-ht:ht>0&&(ht=180-ht),ht}}])&&x(O.prototype,V),G}();function S(G,O){var V=typeof Symbol<"u"&&G[Symbol.iterator]||G["@@iterator"];if(!V){if(Array.isArray(G)||(V=function(ht,xt){if(ht){if(typeof ht=="string")return C(ht,xt);var Ct=Object.prototype.toString.call(ht).slice(8,-1);if(Ct==="Object"&&ht.constructor&&(Ct=ht.constructor.name),Ct==="Map"||Ct==="Set")return Array.from(ht);if(Ct==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Ct))return C(ht,xt)}}(G))||O){V&&(G=V);var P=0,H=function(){};return{s:H,n:function(){return P>=G.length?{done:!0}:{done:!1,value:G[P++]}},e:function(ht){throw ht},f:H}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Q,ot=!0,lt=!1;return{s:function(){V=V.call(G)},n:function(){var ht=V.next();return ot=ht.done,ht},e:function(ht){lt=!0,Q=ht},f:function(){try{ot||V.return==null||V.return()}finally{if(lt)throw Q}}}}function C(G,O){(O==null||O>G.length)&&(O=G.length);for(var V=0,P=new Array(O);V<O;V++)P[V]=G[V];return P}function $(G,O){if(!(G instanceof O))throw new TypeError("Cannot call a class as a function")}function T(G,O){for(var V=0;V<O.length;V++){var P=O[V];P.enumerable=P.enumerable||!1,P.configurable=!0,"value"in P&&(P.writable=!0),Object.defineProperty(G,P.key,P)}}var I=function(){function G(P){var H=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};$(this,G),this.estimator=new v(H),this.gestures=P}var O,V;return O=G,(V=[{key:"estimate",value:function(P,H){var Q,ot=[],lt=this.estimator.estimate(P),ht=[],xt=S(l.all);try{for(xt.s();!(Q=xt.n()).done;){var Ct=Q.value;ht.push([l.getName(Ct),u.getName(lt.curls[Ct]),h.getName(lt.directions[Ct])])}}catch(Kt){xt.e(Kt)}finally{xt.f()}var Dt,It=S(this.gestures);try{for(It.s();!(Dt=It.n()).done;){var Ot=Dt.value,Xt=Ot.matchAgainst(lt.curls,lt.directions);Xt>=H&&ot.push({name:Ot.name,score:Xt})}}catch(Kt){It.e(Kt)}finally{It.f()}return{poseData:ht,gestures:ot}}}])&&T(O.prototype,V),G}();function A(G,O){return function(V){if(Array.isArray(V))return V}(G)||function(V,P){var H=V==null?null:typeof Symbol<"u"&&V[Symbol.iterator]||V["@@iterator"];if(H!=null){var Q,ot,lt=[],ht=!0,xt=!1;try{for(H=H.call(V);!(ht=(Q=H.next()).done)&&(lt.push(Q.value),!P||lt.length!==P);ht=!0);}catch(Ct){xt=!0,ot=Ct}finally{try{ht||H.return==null||H.return()}finally{if(xt)throw ot}}return lt}}(G,O)||L(G,O)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function R(G,O){var V=typeof Symbol<"u"&&G[Symbol.iterator]||G["@@iterator"];if(!V){if(Array.isArray(G)||(V=L(G))||O){V&&(G=V);var P=0,H=function(){};return{s:H,n:function(){return P>=G.length?{done:!0}:{done:!1,value:G[P++]}},e:function(ht){throw ht},f:H}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Q,ot=!0,lt=!1;return{s:function(){V=V.call(G)},n:function(){var ht=V.next();return ot=ht.done,ht},e:function(ht){lt=!0,Q=ht},f:function(){try{ot||V.return==null||V.return()}finally{if(lt)throw Q}}}}function L(G,O){if(G){if(typeof G=="string")return _(G,O);var V=Object.prototype.toString.call(G).slice(8,-1);return V==="Object"&&G.constructor&&(V=G.constructor.name),V==="Map"||V==="Set"?Array.from(G):V==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(V)?_(G,O):void 0}}function _(G,O){(O==null||O>G.length)&&(O=G.length);for(var V=0,P=new Array(O);V<O;V++)P[V]=G[V];return P}function M(G,O){for(var V=0;V<O.length;V++){var P=O[V];P.enumerable=P.enumerable||!1,P.configurable=!0,"value"in P&&(P.writable=!0),Object.defineProperty(G,P.key,P)}}var D=function(){function G(P){(function(H,Q){if(!(H instanceof Q))throw new TypeError("Cannot call a class as a function")})(this,G),this.name=P,this.curls={},this.directions={}}var O,V;return O=G,(V=[{key:"addCurl",value:function(P,H){var Q=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;this.curls[P]===void 0&&(this.curls[P]=[]),this.curls[P].push([H,Q])}},{key:"addDirection",value:function(P,H){var Q=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;this.directions[P]===void 0&&(this.directions[P]=[]),this.directions[P].push([H,Q])}},{key:"matchAgainst",value:function(P,H){var Q=0,ot=0;for(var lt in P){var ht=P[lt],xt=this.curls[lt];if(xt!==void 0){ot++;var Ct,Dt=!1,It=0,Ot=R(xt);try{for(Ot.s();!(Ct=Ot.n()).done;){var Xt=A(Ct.value,2),Kt=Xt[0],Zt=Xt[1];if(ht==Kt){Q+=Zt,It=Math.max(It,Zt),Dt=!0;break}}}catch(Ke){Ot.e(Ke)}finally{Ot.f()}Dt||(Q-=It)}}for(var Ht in H){var jt=H[Ht],ie=this.directions[Ht];if(ie!==void 0){ot++;var mn,ve=!1,Xe=0,ke=R(ie);try{for(ke.s();!(mn=ke.n()).done;){var tn=A(mn.value,2),en=tn[0],hn=tn[1];if(jt==en){Q+=hn,Xe=Math.max(Xe,hn),ve=!0;break}}}catch(Ke){ke.e(Ke)}finally{ke.f()}ve||(Q-=Xe)}}return Q/ot*10}}])&&M(O.prototype,V),G}(),W=new D("victory");W.addDirection(l.Thumb,h.VerticalUp,1),W.addDirection(l.Thumb,h.DiagonalUpLeft,1),W.addDirection(l.Thumb,h.DiagonalUpRight,1),W.addCurl(l.Index,u.NoCurl,1),W.addDirection(l.Index,h.VerticalUp,1),W.addDirection(l.Index,h.DiagonalUpLeft,1),W.addDirection(l.Index,h.DiagonalUpRight,1),W.addDirection(l.Index,h.HorizontalLeft,1),W.addDirection(l.Index,h.HorizontalRight,1),W.addCurl(l.Middle,u.NoCurl,1),W.addDirection(l.Middle,h.VerticalUp,1),W.addDirection(l.Middle,h.DiagonalUpLeft,1),W.addDirection(l.Middle,h.DiagonalUpRight,1),W.addDirection(l.Middle,h.HorizontalLeft,1),W.addDirection(l.Middle,h.HorizontalRight,1),W.addCurl(l.Ring,u.FullCurl,1),W.addCurl(l.Ring,u.HalfCurl,.9),W.addCurl(l.Pinky,u.FullCurl,1),W.addCurl(l.Pinky,u.HalfCurl,.9);var et=W,nt=new D("thumbs_up");nt.addCurl(l.Thumb,u.NoCurl,1),nt.addDirection(l.Thumb,h.VerticalUp,1),nt.addDirection(l.Thumb,h.DiagonalUpLeft,.9),nt.addDirection(l.Thumb,h.DiagonalUpRight,.9);for(var tt=0,U=[l.Index,l.Middle,l.Ring,l.Pinky];tt<U.length;tt++){var Y=U[tt];nt.addCurl(Y,u.FullCurl,1),nt.addCurl(Y,u.HalfCurl,.9)}nt.addDirection(l.Index,h.DiagonalUpLeft,1),nt.addDirection(l.Index,h.HorizontalLeft,1),nt.addDirection(l.Index,h.HorizontalRight,1),nt.addDirection(l.Index,h.DiagonalUpRight,1);var Z=nt;s.default={GestureEstimator:I,GestureDescription:D,Finger:l,FingerCurl:u,FingerDirection:h,Gestures:a}}]).default})}(_p)),_p.exports}var yt=uht(),Ds=function(){return Ds=Object.assign||function(t){for(var e,s=1,r=arguments.length;s<r;s++){e=arguments[s];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])}return t},Ds.apply(this,arguments)};function bm(n,t,e){if(e||arguments.length===2)for(var s=0,r=t.length,a;s<r;s++)(a||!(s in t))&&(a||(a=Array.prototype.slice.call(t,0,s)),a[s]=t[s]);return n.concat(a||Array.prototype.slice.call(t))}var Ve="-ms-",ih="-moz-",we="-webkit-",PF="comm",vy="rule",US="decl",cht="@import",VF="@keyframes",hht="@layer",UF=Math.abs,GS=String.fromCharCode,w1=Object.assign;function dht(n,t){return Bn(n,0)^45?(((t<<2^Bn(n,0))<<2^Bn(n,1))<<2^Bn(n,2))<<2^Bn(n,3):0}function GF(n){return n.trim()}function Ea(n,t){return(n=t.exec(n))?n[0]:n}function ne(n,t,e){return n.replace(t,e)}function Fp(n,t,e){return n.indexOf(t,e)}function Bn(n,t){return n.charCodeAt(t)|0}function wu(n,t,e){return n.slice(t,e)}function ea(n){return n.length}function WF(n){return n.length}function rh(n,t){return t.push(n),n}function fht(n,t){return n.map(t).join("")}function nI(n,t){return n.filter(function(e){return!Ea(e,t)})}var wy=1,Su=1,HF=0,Nr=0,xn=0,ju="";function Sy(n,t,e,s,r,a,i,l){return{value:n,root:t,parent:e,type:s,props:r,children:a,line:wy,column:Su,length:i,return:"",siblings:l}}function yi(n,t){return w1(Sy("",null,null,"",null,null,0,n.siblings),n,{length:-n.length},t)}function Xl(n){for(;n.root;)n=yi(n.root,{children:[n]});rh(n,n.siblings)}function pht(){return xn}function mht(){return xn=Nr>0?Bn(ju,--Nr):0,Su--,xn===10&&(Su=1,wy--),xn}function zr(){return xn=Nr<HF?Bn(ju,Nr++):0,Su++,xn===10&&(Su=1,wy++),xn}function Do(){return Bn(ju,Nr)}function Lp(){return Nr}function Cy(n,t){return wu(ju,n,t)}function S1(n){switch(n){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function ght(n){return wy=Su=1,HF=ea(ju=n),Nr=0,[]}function yht(n){return ju="",n}function hx(n){return GF(Cy(Nr-1,C1(n===91?n+2:n===40?n+1:n)))}function bht(n){for(;(xn=Do())&&xn<33;)zr();return S1(n)>2||S1(xn)>3?"":" "}function xht(n,t){for(;--t&&zr()&&!(xn<48||xn>102||xn>57&&xn<65||xn>70&&xn<97););return Cy(n,Lp()+(t<6&&Do()==32&&zr()==32))}function C1(n){for(;zr();)switch(xn){case n:return Nr;case 34:case 39:n!==34&&n!==39&&C1(xn);break;case 40:n===41&&C1(n);break;case 92:zr();break}return Nr}function vht(n,t){for(;zr()&&n+xn!==57;)if(n+xn===84&&Do()===47)break;return"/*"+Cy(t,Nr-1)+"*"+GS(n===47?n:zr())}function wht(n){for(;!S1(Do());)zr();return Cy(n,Nr)}function Sht(n){return yht(zp("",null,null,null,[""],n=ght(n),0,[0],n))}function zp(n,t,e,s,r,a,i,l,u){for(var h=0,d=0,p=i,m=0,y=0,b=0,x=1,v=1,S=1,C=0,$="",T=r,I=a,A=s,R=$;v;)switch(b=C,C=zr()){case 40:if(b!=108&&Bn(R,p-1)==58){Fp(R+=ne(hx(C),"&","&\f"),"&\f",UF(h?l[h-1]:0))!=-1&&(S=-1);break}case 34:case 39:case 91:R+=hx(C);break;case 9:case 10:case 13:case 32:R+=bht(b);break;case 92:R+=xht(Lp()-1,7);continue;case 47:switch(Do()){case 42:case 47:rh(Cht(vht(zr(),Lp()),t,e,u),u);break;default:R+="/"}break;case 123*x:l[h++]=ea(R)*S;case 125*x:case 59:case 0:switch(C){case 0:case 125:v=0;case 59+d:S==-1&&(R=ne(R,/\f/g,"")),y>0&&ea(R)-p&&rh(y>32?rI(R+";",s,e,p-1,u):rI(ne(R," ","")+";",s,e,p-2,u),u);break;case 59:R+=";";default:if(rh(A=sI(R,t,e,h,d,r,l,$,T=[],I=[],p,a),a),C===123)if(d===0)zp(R,t,A,A,T,a,p,l,I);else switch(m===99&&Bn(R,3)===110?100:m){case 100:case 108:case 109:case 115:zp(n,A,A,s&&rh(sI(n,A,A,0,0,r,l,$,r,T=[],p,I),I),r,I,p,l,s?T:I);break;default:zp(R,A,A,A,[""],I,0,l,I)}}h=d=y=0,x=S=1,$=R="",p=i;break;case 58:p=1+ea(R),y=b;default:if(x<1){if(C==123)--x;else if(C==125&&x++==0&&mht()==125)continue}switch(R+=GS(C),C*x){case 38:S=d>0?1:(R+="\f",-1);break;case 44:l[h++]=(ea(R)-1)*S,S=1;break;case 64:Do()===45&&(R+=hx(zr())),m=Do(),d=p=ea($=R+=wht(Lp())),C++;break;case 45:b===45&&ea(R)==2&&(x=0)}}return a}function sI(n,t,e,s,r,a,i,l,u,h,d,p){for(var m=r-1,y=r===0?a:[""],b=WF(y),x=0,v=0,S=0;x<s;++x)for(var C=0,$=wu(n,m+1,m=UF(v=i[x])),T=n;C<b;++C)(T=GF(v>0?y[C]+" "+$:ne($,/&\f/g,y[C])))&&(u[S++]=T);return Sy(n,t,e,r===0?vy:l,u,h,d,p)}function Cht(n,t,e,s){return Sy(n,t,e,PF,GS(pht()),wu(n,2,-2),0,s)}function rI(n,t,e,s,r){return Sy(n,t,e,US,wu(n,0,s),wu(n,s+1,-1),s,r)}function jF(n,t,e){switch(dht(n,t)){case 5103:return we+"print-"+n+n;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return we+n+n;case 4789:return ih+n+n;case 5349:case 4246:case 4810:case 6968:case 2756:return we+n+ih+n+Ve+n+n;case 5936:switch(Bn(n,t+11)){case 114:return we+n+Ve+ne(n,/[svh]\w+-[tblr]{2}/,"tb")+n;case 108:return we+n+Ve+ne(n,/[svh]\w+-[tblr]{2}/,"tb-rl")+n;case 45:return we+n+Ve+ne(n,/[svh]\w+-[tblr]{2}/,"lr")+n}case 6828:case 4268:case 2903:return we+n+Ve+n+n;case 6165:return we+n+Ve+"flex-"+n+n;case 5187:return we+n+ne(n,/(\w+).+(:[^]+)/,we+"box-$1$2"+Ve+"flex-$1$2")+n;case 5443:return we+n+Ve+"flex-item-"+ne(n,/flex-|-self/g,"")+(Ea(n,/flex-|baseline/)?"":Ve+"grid-row-"+ne(n,/flex-|-self/g,""))+n;case 4675:return we+n+Ve+"flex-line-pack"+ne(n,/align-content|flex-|-self/g,"")+n;case 5548:return we+n+Ve+ne(n,"shrink","negative")+n;case 5292:return we+n+Ve+ne(n,"basis","preferred-size")+n;case 6060:return we+"box-"+ne(n,"-grow","")+we+n+Ve+ne(n,"grow","positive")+n;case 4554:return we+ne(n,/([^-])(transform)/g,"$1"+we+"$2")+n;case 6187:return ne(ne(ne(n,/(zoom-|grab)/,we+"$1"),/(image-set)/,we+"$1"),n,"")+n;case 5495:case 3959:return ne(n,/(image-set\([^]*)/,we+"$1$`$1");case 4968:return ne(ne(n,/(.+:)(flex-)?(.*)/,we+"box-pack:$3"+Ve+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+we+n+n;case 4200:if(!Ea(n,/flex-|baseline/))return Ve+"grid-column-align"+wu(n,t)+n;break;case 2592:case 3360:return Ve+ne(n,"template-","")+n;case 4384:case 3616:return e&&e.some(function(s,r){return t=r,Ea(s.props,/grid-\w+-end/)})?~Fp(n+(e=e[t].value),"span",0)?n:Ve+ne(n,"-start","")+n+Ve+"grid-row-span:"+(~Fp(e,"span",0)?Ea(e,/\d+/):+Ea(e,/\d+/)-+Ea(n,/\d+/))+";":Ve+ne(n,"-start","")+n;case 4896:case 4128:return e&&e.some(function(s){return Ea(s.props,/grid-\w+-start/)})?n:Ve+ne(ne(n,"-end","-span"),"span ","")+n;case 4095:case 3583:case 4068:case 2532:return ne(n,/(.+)-inline(.+)/,we+"$1$2")+n;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(ea(n)-1-t>6)switch(Bn(n,t+1)){case 109:if(Bn(n,t+4)!==45)break;case 102:return ne(n,/(.+:)(.+)-([^]+)/,"$1"+we+"$2-$3$1"+ih+(Bn(n,t+3)==108?"$3":"$2-$3"))+n;case 115:return~Fp(n,"stretch",0)?jF(ne(n,"stretch","fill-available"),t,e)+n:n}break;case 5152:case 5920:return ne(n,/(.+?):(\d+)(\s*\/\s*(span)?\s*(\d+))?(.*)/,function(s,r,a,i,l,u,h){return Ve+r+":"+a+h+(i?Ve+r+"-span:"+(l?u:+u-+a)+h:"")+n});case 4949:if(Bn(n,t+6)===121)return ne(n,":",":"+we)+n;break;case 6444:switch(Bn(n,Bn(n,14)===45?18:11)){case 120:return ne(n,/(.+:)([^;\s!]+)(;|(\s+)?!.+)?/,"$1"+we+(Bn(n,14)===45?"inline-":"")+"box$3$1"+we+"$2$3$1"+Ve+"$2box$3")+n;case 100:return ne(n,":",":"+Ve)+n}break;case 5719:case 2647:case 2135:case 3927:case 2391:return ne(n,"scroll-","scroll-snap-")+n}return n}function xm(n,t){for(var e="",s=0;s<n.length;s++)e+=t(n[s],s,n,t)||"";return e}function Nht(n,t,e,s){switch(n.type){case hht:if(n.children.length)break;case cht:case US:return n.return=n.return||n.value;case PF:return"";case VF:return n.return=n.value+"{"+xm(n.children,s)+"}";case vy:if(!ea(n.value=n.props.join(",")))return""}return ea(e=xm(n.children,s))?n.return=n.value+"{"+e+"}":""}function Tht(n){var t=WF(n);return function(e,s,r,a){for(var i="",l=0;l<t;l++)i+=n[l](e,s,r,a)||"";return i}}function $ht(n){return function(t){t.root||(t=t.return)&&n(t)}}function kht(n,t,e,s){if(n.length>-1&&!n.return)switch(n.type){case US:n.return=jF(n.value,n.length,e);return;case VF:return xm([yi(n,{value:ne(n.value,"@","@"+we)})],s);case vy:if(n.length)return fht(e=n.props,function(r){switch(Ea(r,s=/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":Xl(yi(n,{props:[ne(r,/:(read-\w+)/,":"+ih+"$1")]})),Xl(yi(n,{props:[r]})),w1(n,{props:nI(e,s)});break;case"::placeholder":Xl(yi(n,{props:[ne(r,/:(plac\w+)/,":"+we+"input-$1")]})),Xl(yi(n,{props:[ne(r,/:(plac\w+)/,":"+ih+"$1")]})),Xl(yi(n,{props:[ne(r,/:(plac\w+)/,Ve+"input-$1")]})),Xl(yi(n,{props:[r]})),w1(n,{props:nI(e,s)});break}return""})}}var Iht={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},Ks={},Cu=typeof process<"u"&&Ks!==void 0&&(Ks.REACT_APP_SC_ATTR||Ks.SC_ATTR)||"data-styled",qF="active",XF="data-styled-version",Ny="6.1.18",WS=`/*!sc*/
`,vm=typeof window<"u"&&typeof document<"u",Eht=!!(typeof SC_DISABLE_SPEEDY=="boolean"?SC_DISABLE_SPEEDY:typeof process<"u"&&Ks!==void 0&&Ks.REACT_APP_SC_DISABLE_SPEEDY!==void 0&&Ks.REACT_APP_SC_DISABLE_SPEEDY!==""?Ks.REACT_APP_SC_DISABLE_SPEEDY!=="false"&&Ks.REACT_APP_SC_DISABLE_SPEEDY:typeof process<"u"&&Ks!==void 0&&Ks.SC_DISABLE_SPEEDY!==void 0&&Ks.SC_DISABLE_SPEEDY!==""&&Ks.SC_DISABLE_SPEEDY!=="false"&&Ks.SC_DISABLE_SPEEDY),Ty=Object.freeze([]),Nu=Object.freeze({});function Dht(n,t,e){return e===void 0&&(e=Nu),n.theme!==e.theme&&n.theme||t||e.theme}var KF=new Set(["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","track","u","ul","use","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"]),Aht=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,Rht=/(^-|-$)/g;function aI(n){return n.replace(Aht,"-").replace(Rht,"")}var Oht=/(a)(d)/gi,xp=52,iI=function(n){return String.fromCharCode(n+(n>25?39:97))};function N1(n){var t,e="";for(t=Math.abs(n);t>xp;t=t/xp|0)e=iI(t%xp)+e;return(iI(t%xp)+e).replace(Oht,"$1-$2")}var dx,YF=5381,Jl=function(n,t){for(var e=t.length;e;)n=33*n^t.charCodeAt(--e);return n},ZF=function(n){return Jl(YF,n)};function _ht(n){return N1(ZF(n)>>>0)}function Fht(n){return n.displayName||n.name||"Component"}function fx(n){return typeof n=="string"&&!0}var QF=typeof Symbol=="function"&&Symbol.for,JF=QF?Symbol.for("react.memo"):60115,Lht=QF?Symbol.for("react.forward_ref"):60112,zht={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},Mht={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},t3={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},Bht=((dx={})[Lht]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},dx[JF]=t3,dx);function oI(n){return("type"in(t=n)&&t.type.$$typeof)===JF?t3:"$$typeof"in n?Bht[n.$$typeof]:zht;var t}var Pht=Object.defineProperty,Vht=Object.getOwnPropertyNames,lI=Object.getOwnPropertySymbols,Uht=Object.getOwnPropertyDescriptor,Ght=Object.getPrototypeOf,uI=Object.prototype;function e3(n,t,e){if(typeof t!="string"){if(uI){var s=Ght(t);s&&s!==uI&&e3(n,s,e)}var r=Vht(t);lI&&(r=r.concat(lI(t)));for(var a=oI(n),i=oI(t),l=0;l<r.length;++l){var u=r[l];if(!(u in Mht||e&&e[u]||i&&u in i||a&&u in a)){var h=Uht(t,u);try{Pht(n,u,h)}catch{}}}}return n}function Tu(n){return typeof n=="function"}function HS(n){return typeof n=="object"&&"styledComponentId"in n}function ko(n,t){return n&&t?"".concat(n," ").concat(t):n||t||""}function cI(n,t){if(n.length===0)return"";for(var e=n[0],s=1;s<n.length;s++)e+=n[s];return e}function Sh(n){return n!==null&&typeof n=="object"&&n.constructor.name===Object.name&&!("props"in n&&n.$$typeof)}function T1(n,t,e){if(e===void 0&&(e=!1),!e&&!Sh(n)&&!Array.isArray(n))return t;if(Array.isArray(t))for(var s=0;s<t.length;s++)n[s]=T1(n[s],t[s]);else if(Sh(t))for(var s in t)n[s]=T1(n[s],t[s]);return n}function jS(n,t){Object.defineProperty(n,"toString",{value:t})}function Wd(n){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];return new Error("An error occurred. See https://github.com/styled-components/styled-components/blob/main/packages/styled-components/src/utils/errors.md#".concat(n," for more information.").concat(t.length>0?" Args: ".concat(t.join(", ")):""))}var Wht=function(){function n(t){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=t}return n.prototype.indexOfGroup=function(t){for(var e=0,s=0;s<t;s++)e+=this.groupSizes[s];return e},n.prototype.insertRules=function(t,e){if(t>=this.groupSizes.length){for(var s=this.groupSizes,r=s.length,a=r;t>=a;)if((a<<=1)<0)throw Wd(16,"".concat(t));this.groupSizes=new Uint32Array(a),this.groupSizes.set(s),this.length=a;for(var i=r;i<a;i++)this.groupSizes[i]=0}for(var l=this.indexOfGroup(t+1),u=(i=0,e.length);i<u;i++)this.tag.insertRule(l,e[i])&&(this.groupSizes[t]++,l++)},n.prototype.clearGroup=function(t){if(t<this.length){var e=this.groupSizes[t],s=this.indexOfGroup(t),r=s+e;this.groupSizes[t]=0;for(var a=s;a<r;a++)this.tag.deleteRule(s)}},n.prototype.getGroup=function(t){var e="";if(t>=this.length||this.groupSizes[t]===0)return e;for(var s=this.groupSizes[t],r=this.indexOfGroup(t),a=r+s,i=r;i<a;i++)e+="".concat(this.tag.getRule(i)).concat(WS);return e},n}(),Mp=new Map,wm=new Map,Bp=1,vp=function(n){if(Mp.has(n))return Mp.get(n);for(;wm.has(Bp);)Bp++;var t=Bp++;return Mp.set(n,t),wm.set(t,n),t},Hht=function(n,t){Bp=t+1,Mp.set(n,t),wm.set(t,n)},jht="style[".concat(Cu,"][").concat(XF,'="').concat(Ny,'"]'),qht=new RegExp("^".concat(Cu,'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)')),Xht=function(n,t,e){for(var s,r=e.split(","),a=0,i=r.length;a<i;a++)(s=r[a])&&n.registerName(t,s)},Kht=function(n,t){for(var e,s=((e=t.textContent)!==null&&e!==void 0?e:"").split(WS),r=[],a=0,i=s.length;a<i;a++){var l=s[a].trim();if(l){var u=l.match(qht);if(u){var h=0|parseInt(u[1],10),d=u[2];h!==0&&(Hht(d,h),Xht(n,d,u[3]),n.getTag().insertRules(h,r)),r.length=0}else r.push(l)}}},hI=function(n){for(var t=document.querySelectorAll(jht),e=0,s=t.length;e<s;e++){var r=t[e];r&&r.getAttribute(Cu)!==qF&&(Kht(n,r),r.parentNode&&r.parentNode.removeChild(r))}};function Yht(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:null}var n3=function(n){var t=document.head,e=n||t,s=document.createElement("style"),r=function(l){var u=Array.from(l.querySelectorAll("style[".concat(Cu,"]")));return u[u.length-1]}(e),a=r!==void 0?r.nextSibling:null;s.setAttribute(Cu,qF),s.setAttribute(XF,Ny);var i=Yht();return i&&s.setAttribute("nonce",i),e.insertBefore(s,a),s},Zht=function(){function n(t){this.element=n3(t),this.element.appendChild(document.createTextNode("")),this.sheet=function(e){if(e.sheet)return e.sheet;for(var s=document.styleSheets,r=0,a=s.length;r<a;r++){var i=s[r];if(i.ownerNode===e)return i}throw Wd(17)}(this.element),this.length=0}return n.prototype.insertRule=function(t,e){try{return this.sheet.insertRule(e,t),this.length++,!0}catch{return!1}},n.prototype.deleteRule=function(t){this.sheet.deleteRule(t),this.length--},n.prototype.getRule=function(t){var e=this.sheet.cssRules[t];return e&&e.cssText?e.cssText:""},n}(),Qht=function(){function n(t){this.element=n3(t),this.nodes=this.element.childNodes,this.length=0}return n.prototype.insertRule=function(t,e){if(t<=this.length&&t>=0){var s=document.createTextNode(e);return this.element.insertBefore(s,this.nodes[t]||null),this.length++,!0}return!1},n.prototype.deleteRule=function(t){this.element.removeChild(this.nodes[t]),this.length--},n.prototype.getRule=function(t){return t<this.length?this.nodes[t].textContent:""},n}(),Jht=function(){function n(t){this.rules=[],this.length=0}return n.prototype.insertRule=function(t,e){return t<=this.length&&(this.rules.splice(t,0,e),this.length++,!0)},n.prototype.deleteRule=function(t){this.rules.splice(t,1),this.length--},n.prototype.getRule=function(t){return t<this.length?this.rules[t]:""},n}(),dI=vm,tdt={isServer:!vm,useCSSOMInjection:!Eht},s3=function(){function n(t,e,s){t===void 0&&(t=Nu),e===void 0&&(e={});var r=this;this.options=Ds(Ds({},tdt),t),this.gs=e,this.names=new Map(s),this.server=!!t.isServer,!this.server&&vm&&dI&&(dI=!1,hI(this)),jS(this,function(){return function(a){for(var i=a.getTag(),l=i.length,u="",h=function(p){var m=function(S){return wm.get(S)}(p);if(m===void 0)return"continue";var y=a.names.get(m),b=i.getGroup(p);if(y===void 0||!y.size||b.length===0)return"continue";var x="".concat(Cu,".g").concat(p,'[id="').concat(m,'"]'),v="";y!==void 0&&y.forEach(function(S){S.length>0&&(v+="".concat(S,","))}),u+="".concat(b).concat(x,'{content:"').concat(v,'"}').concat(WS)},d=0;d<l;d++)h(d);return u}(r)})}return n.registerId=function(t){return vp(t)},n.prototype.rehydrate=function(){!this.server&&vm&&hI(this)},n.prototype.reconstructWithOptions=function(t,e){return e===void 0&&(e=!0),new n(Ds(Ds({},this.options),t),this.gs,e&&this.names||void 0)},n.prototype.allocateGSInstance=function(t){return this.gs[t]=(this.gs[t]||0)+1},n.prototype.getTag=function(){return this.tag||(this.tag=(t=function(e){var s=e.useCSSOMInjection,r=e.target;return e.isServer?new Jht(r):s?new Zht(r):new Qht(r)}(this.options),new Wht(t)));var t},n.prototype.hasNameForId=function(t,e){return this.names.has(t)&&this.names.get(t).has(e)},n.prototype.registerName=function(t,e){if(vp(t),this.names.has(t))this.names.get(t).add(e);else{var s=new Set;s.add(e),this.names.set(t,s)}},n.prototype.insertRules=function(t,e,s){this.registerName(t,e),this.getTag().insertRules(vp(t),s)},n.prototype.clearNames=function(t){this.names.has(t)&&this.names.get(t).clear()},n.prototype.clearRules=function(t){this.getTag().clearGroup(vp(t)),this.clearNames(t)},n.prototype.clearTag=function(){this.tag=void 0},n}(),edt=/&/g,ndt=/^\s*\/\/.*$/gm;function r3(n,t){return n.map(function(e){return e.type==="rule"&&(e.value="".concat(t," ").concat(e.value),e.value=e.value.replaceAll(",",",".concat(t," ")),e.props=e.props.map(function(s){return"".concat(t," ").concat(s)})),Array.isArray(e.children)&&e.type!=="@keyframes"&&(e.children=r3(e.children,t)),e})}function sdt(n){var t,e,s,r=Nu,a=r.options,i=a===void 0?Nu:a,l=r.plugins,u=l===void 0?Ty:l,h=function(m,y,b){return b.startsWith(e)&&b.endsWith(e)&&b.replaceAll(e,"").length>0?".".concat(t):m},d=u.slice();d.push(function(m){m.type===vy&&m.value.includes("&")&&(m.props[0]=m.props[0].replace(edt,e).replace(s,h))}),i.prefix&&d.push(kht),d.push(Nht);var p=function(m,y,b,x){y===void 0&&(y=""),b===void 0&&(b=""),x===void 0&&(x="&"),t=x,e=y,s=new RegExp("\\".concat(e,"\\b"),"g");var v=m.replace(ndt,""),S=Sht(b||y?"".concat(b," ").concat(y," { ").concat(v," }"):v);i.namespace&&(S=r3(S,i.namespace));var C=[];return xm(S,Tht(d.concat($ht(function($){return C.push($)})))),C};return p.hash=u.length?u.reduce(function(m,y){return y.name||Wd(15),Jl(m,y.name)},YF).toString():"",p}var rdt=new s3,$1=sdt(),a3=Oo.createContext({shouldForwardProp:void 0,styleSheet:rdt,stylis:$1});a3.Consumer;Oo.createContext(void 0);function fI(){return Et.useContext(a3)}var adt=function(){function n(t,e){var s=this;this.inject=function(r,a){a===void 0&&(a=$1);var i=s.name+a.hash;r.hasNameForId(s.id,i)||r.insertRules(s.id,i,a(s.rules,i,"@keyframes"))},this.name=t,this.id="sc-keyframes-".concat(t),this.rules=e,jS(this,function(){throw Wd(12,String(s.name))})}return n.prototype.getName=function(t){return t===void 0&&(t=$1),this.name+t.hash},n}(),idt=function(n){return n>="A"&&n<="Z"};function pI(n){for(var t="",e=0;e<n.length;e++){var s=n[e];if(e===1&&s==="-"&&n[0]==="-")return n;idt(s)?t+="-"+s.toLowerCase():t+=s}return t.startsWith("ms-")?"-"+t:t}var i3=function(n){return n==null||n===!1||n===""},o3=function(n){var t,e,s=[];for(var r in n){var a=n[r];n.hasOwnProperty(r)&&!i3(a)&&(Array.isArray(a)&&a.isCss||Tu(a)?s.push("".concat(pI(r),":"),a,";"):Sh(a)?s.push.apply(s,bm(bm(["".concat(r," {")],o3(a),!1),["}"],!1)):s.push("".concat(pI(r),": ").concat((t=r,(e=a)==null||typeof e=="boolean"||e===""?"":typeof e!="number"||e===0||t in Iht||t.startsWith("--")?String(e).trim():"".concat(e,"px")),";")))}return s};function Ao(n,t,e,s){if(i3(n))return[];if(HS(n))return[".".concat(n.styledComponentId)];if(Tu(n)){if(!Tu(a=n)||a.prototype&&a.prototype.isReactComponent||!t)return[n];var r=n(t);return Ao(r,t,e,s)}var a;return n instanceof adt?e?(n.inject(e,s),[n.getName(s)]):[n]:Sh(n)?o3(n):Array.isArray(n)?Array.prototype.concat.apply(Ty,n.map(function(i){return Ao(i,t,e,s)})):[n.toString()]}function odt(n){for(var t=0;t<n.length;t+=1){var e=n[t];if(Tu(e)&&!HS(e))return!1}return!0}var ldt=ZF(Ny),udt=function(){function n(t,e,s){this.rules=t,this.staticRulesId="",this.isStatic=(s===void 0||s.isStatic)&&odt(t),this.componentId=e,this.baseHash=Jl(ldt,e),this.baseStyle=s,s3.registerId(e)}return n.prototype.generateAndInjectStyles=function(t,e,s){var r=this.baseStyle?this.baseStyle.generateAndInjectStyles(t,e,s):"";if(this.isStatic&&!s.hash)if(this.staticRulesId&&e.hasNameForId(this.componentId,this.staticRulesId))r=ko(r,this.staticRulesId);else{var a=cI(Ao(this.rules,t,e,s)),i=N1(Jl(this.baseHash,a)>>>0);if(!e.hasNameForId(this.componentId,i)){var l=s(a,".".concat(i),void 0,this.componentId);e.insertRules(this.componentId,i,l)}r=ko(r,i),this.staticRulesId=i}else{for(var u=Jl(this.baseHash,s.hash),h="",d=0;d<this.rules.length;d++){var p=this.rules[d];if(typeof p=="string")h+=p;else if(p){var m=cI(Ao(p,t,e,s));u=Jl(u,m+d),h+=m}}if(h){var y=N1(u>>>0);e.hasNameForId(this.componentId,y)||e.insertRules(this.componentId,y,s(h,".".concat(y),void 0,this.componentId)),r=ko(r,y)}}return r},n}(),l3=Oo.createContext(void 0);l3.Consumer;var px={};function cdt(n,t,e){var s=HS(n),r=n,a=!fx(n),i=t.attrs,l=i===void 0?Ty:i,u=t.componentId,h=u===void 0?function(T,I){var A=typeof T!="string"?"sc":aI(T);px[A]=(px[A]||0)+1;var R="".concat(A,"-").concat(_ht(Ny+A+px[A]));return I?"".concat(I,"-").concat(R):R}(t.displayName,t.parentComponentId):u,d=t.displayName,p=d===void 0?function(T){return fx(T)?"styled.".concat(T):"Styled(".concat(Fht(T),")")}(n):d,m=t.displayName&&t.componentId?"".concat(aI(t.displayName),"-").concat(t.componentId):t.componentId||h,y=s&&r.attrs?r.attrs.concat(l).filter(Boolean):l,b=t.shouldForwardProp;if(s&&r.shouldForwardProp){var x=r.shouldForwardProp;if(t.shouldForwardProp){var v=t.shouldForwardProp;b=function(T,I){return x(T,I)&&v(T,I)}}else b=x}var S=new udt(e,m,s?r.componentStyle:void 0);function C(T,I){return function(A,R,L){var _=A.attrs,M=A.componentStyle,D=A.defaultProps,W=A.foldedComponentIds,et=A.styledComponentId,nt=A.target,tt=Oo.useContext(l3),U=fI(),Y=A.shouldForwardProp||U.shouldForwardProp,Z=Dht(R,tt,D)||Nu,G=function(ot,lt,ht){for(var xt,Ct=Ds(Ds({},lt),{className:void 0,theme:ht}),Dt=0;Dt<ot.length;Dt+=1){var It=Tu(xt=ot[Dt])?xt(Ct):xt;for(var Ot in It)Ct[Ot]=Ot==="className"?ko(Ct[Ot],It[Ot]):Ot==="style"?Ds(Ds({},Ct[Ot]),It[Ot]):It[Ot]}return lt.className&&(Ct.className=ko(Ct.className,lt.className)),Ct}(_,R,Z),O=G.as||nt,V={};for(var P in G)G[P]===void 0||P[0]==="$"||P==="as"||P==="theme"&&G.theme===Z||(P==="forwardedAs"?V.as=G.forwardedAs:Y&&!Y(P,O)||(V[P]=G[P]));var H=function(ot,lt){var ht=fI(),xt=ot.generateAndInjectStyles(lt,ht.styleSheet,ht.stylis);return xt}(M,G),Q=ko(W,et);return H&&(Q+=" "+H),G.className&&(Q+=" "+G.className),V[fx(O)&&!KF.has(O)?"class":"className"]=Q,L&&(V.ref=L),Et.createElement(O,V)}($,T,I)}C.displayName=p;var $=Oo.forwardRef(C);return $.attrs=y,$.componentStyle=S,$.displayName=p,$.shouldForwardProp=b,$.foldedComponentIds=s?ko(r.foldedComponentIds,r.styledComponentId):"",$.styledComponentId=m,$.target=s?r.target:n,Object.defineProperty($,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(T){this._foldedDefaultProps=s?function(I){for(var A=[],R=1;R<arguments.length;R++)A[R-1]=arguments[R];for(var L=0,_=A;L<_.length;L++)T1(I,_[L],!0);return I}({},r.defaultProps,T):T}}),jS($,function(){return".".concat($.styledComponentId)}),a&&e3($,n,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0}),$}function mI(n,t){for(var e=[n[0]],s=0,r=t.length;s<r;s+=1)e.push(t[s],n[s+1]);return e}var gI=function(n){return Object.assign(n,{isCss:!0})};function hdt(n){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];if(Tu(n)||Sh(n))return gI(Ao(mI(Ty,bm([n],t,!0))));var s=n;return t.length===0&&s.length===1&&typeof s[0]=="string"?Ao(s):gI(Ao(mI(s,t)))}function k1(n,t,e){if(e===void 0&&(e=Nu),!t)throw Wd(1,t);var s=function(r){for(var a=[],i=1;i<arguments.length;i++)a[i-1]=arguments[i];return n(t,e,hdt.apply(void 0,bm([r],a,!1)))};return s.attrs=function(r){return k1(n,t,Ds(Ds({},e),{attrs:Array.prototype.concat(e.attrs,r).filter(Boolean)}))},s.withConfig=function(r){return k1(n,t,Ds(Ds({},e),r))},s}var u3=function(n){return k1(cdt,n)},Je=u3;KF.forEach(function(n){Je[n]=u3(n)});const qu=new yt.GestureDescription("thumbs up"),Va=new yt.GestureDescription("ok"),da=new yt.GestureDescription("victory"),Xu=new yt.GestureDescription("point"),I1=new yt.GestureDescription("hello"),$u=new yt.GestureDescription("thank you"),Ro=new yt.GestureDescription("help"),Hd=new yt.GestureDescription("please");qu.addCurl(yt.Finger.Thumb,yt.FingerCurl.NoCurl,1);qu.addDirection(yt.Finger.Thumb,yt.FingerDirection.VerticalUp,1);qu.addDirection(yt.Finger.Thumb,yt.FingerDirection.DiagonalUpRight,.9);qu.addDirection(yt.Finger.Thumb,yt.FingerDirection.DiagonalUpLeft,.9);for(let n of[yt.Finger.Index,yt.Finger.Middle,yt.Finger.Ring,yt.Finger.Pinky])qu.addCurl(n,yt.FingerCurl.FullCurl,1);Va.addCurl(yt.Finger.Thumb,yt.FingerCurl.HalfCurl,1);Va.addCurl(yt.Finger.Index,yt.FingerCurl.HalfCurl,1);Va.addDirection(yt.Finger.Thumb,yt.FingerDirection.DiagonalUpLeft,1);Va.addDirection(yt.Finger.Thumb,yt.FingerDirection.DiagonalUpRight,1);Va.addDirection(yt.Finger.Index,yt.FingerDirection.DiagonalUpLeft,1);Va.addDirection(yt.Finger.Index,yt.FingerDirection.DiagonalUpRight,1);for(let n of[yt.Finger.Middle,yt.Finger.Ring,yt.Finger.Pinky])Va.addCurl(n,yt.FingerCurl.NoCurl,1),Va.addDirection(n,yt.FingerDirection.VerticalUp,1);da.addCurl(yt.Finger.Index,yt.FingerCurl.NoCurl,1);da.addCurl(yt.Finger.Middle,yt.FingerCurl.NoCurl,1);da.addDirection(yt.Finger.Index,yt.FingerDirection.VerticalUp,1);da.addDirection(yt.Finger.Middle,yt.FingerDirection.VerticalUp,1);da.addDirection(yt.Finger.Index,yt.FingerDirection.DiagonalUpLeft,.9);da.addDirection(yt.Finger.Index,yt.FingerDirection.DiagonalUpRight,.9);da.addDirection(yt.Finger.Middle,yt.FingerDirection.DiagonalUpLeft,.9);da.addDirection(yt.Finger.Middle,yt.FingerDirection.DiagonalUpRight,.9);for(let n of[yt.Finger.Thumb,yt.Finger.Ring,yt.Finger.Pinky])da.addCurl(n,yt.FingerCurl.FullCurl,.9);Xu.addCurl(yt.Finger.Index,yt.FingerCurl.NoCurl,1);Xu.addDirection(yt.Finger.Index,yt.FingerDirection.VerticalUp,1);Xu.addDirection(yt.Finger.Index,yt.FingerDirection.DiagonalUpLeft,.8);Xu.addDirection(yt.Finger.Index,yt.FingerDirection.DiagonalUpRight,.8);for(let n of[yt.Finger.Thumb,yt.Finger.Middle,yt.Finger.Ring,yt.Finger.Pinky])Xu.addCurl(n,yt.FingerCurl.FullCurl,.9);for(let n of[yt.Finger.Thumb,yt.Finger.Index,yt.Finger.Middle,yt.Finger.Ring,yt.Finger.Pinky])I1.addCurl(n,yt.FingerCurl.NoCurl,1),I1.addDirection(n,yt.FingerDirection.VerticalUp,1);$u.addCurl(yt.Finger.Thumb,yt.FingerCurl.NoCurl,1);$u.addDirection(yt.Finger.Thumb,yt.FingerDirection.DiagonalUpLeft,1);$u.addDirection(yt.Finger.Thumb,yt.FingerDirection.DiagonalUpRight,1);for(let n of[yt.Finger.Index,yt.Finger.Middle,yt.Finger.Ring,yt.Finger.Pinky])$u.addCurl(n,yt.FingerCurl.NoCurl,1),$u.addDirection(n,yt.FingerDirection.VerticalUp,1);Ro.addCurl(yt.Finger.Thumb,yt.FingerCurl.NoCurl,1);Ro.addDirection(yt.Finger.Thumb,yt.FingerDirection.HorizontalLeft,1);Ro.addDirection(yt.Finger.Thumb,yt.FingerDirection.HorizontalRight,1);for(let n of[yt.Finger.Index,yt.Finger.Middle,yt.Finger.Ring,yt.Finger.Pinky])Ro.addCurl(n,yt.FingerCurl.NoCurl,1),Ro.addDirection(n,yt.FingerDirection.HorizontalLeft,1),Ro.addDirection(n,yt.FingerDirection.HorizontalRight,1);Hd.addCurl(yt.Finger.Thumb,yt.FingerCurl.HalfCurl,1);Hd.addDirection(yt.Finger.Thumb,yt.FingerDirection.DiagonalUpLeft,1);Hd.addDirection(yt.Finger.Thumb,yt.FingerDirection.DiagonalUpRight,1);for(let n of[yt.Finger.Index,yt.Finger.Middle,yt.Finger.Ring,yt.Finger.Pinky])Hd.addCurl(n,yt.FingerCurl.FullCurl,1);const mx=[qu,Va,da,Xu,I1,$u,Ro,Hd],ku="gestureDatasets",ddt={thumb:[0,1,2,3,4],indexFinger:[0,5,6,7,8],middleFinger:[0,9,10,11,12],ringFinger:[0,13,14,15,16],pinky:[0,17,18,19,20]},yI=()=>{const n=localStorage.getItem(ku);if(!n)return mx;try{const e=JSON.parse(n).map(s=>{const r=new yt.GestureDescription(s.name);if(!s.frames||s.frames.length===0)return console.warn(`No frames found for gesture: ${s.name}`),r;const a=fdt(s.frames),i={thumb:yt.Finger.Thumb,indexFinger:yt.Finger.Index,middleFinger:yt.Finger.Middle,ringFinger:yt.Finger.Ring,pinky:yt.Finger.Pinky};return Object.entries(ddt).forEach(([l,u])=>{const h=u.map(m=>a[m]),d=pdt(h),p=mdt(h);r.addCurl(i[l],d.type,d.confidence),r.addDirection(i[l],p.type,p.confidence)}),r});return[...mx,...e]}catch(t){return console.error("Error loading custom gestures:",t),mx}},fdt=n=>{const t=Array(21).fill().map(()=>[0,0,0]);return n.forEach(e=>{e.forEach((s,r)=>{t[r][0]+=s[0]/n.length,t[r][1]+=s[1]/n.length,t[r][2]+=s[2]/n.length})}),t},pdt=n=>{if(n.length<2)return{type:yt.FingerCurl.NoCurl,confidence:1};const t=n[n.length-1],e=n[1],s=t[1]-e[1];return s<-20?{type:yt.FingerCurl.NoCurl,confidence:1}:s>30?{type:yt.FingerCurl.FullCurl,confidence:1}:{type:yt.FingerCurl.HalfCurl,confidence:1}},mdt=n=>{if(n.length<2)return{type:yt.FingerDirection.VerticalUp,confidence:1};const t=n[n.length-1],e=n[1],s=t[0]-e[0],r=t[1]-e[1];return Math.abs(r)>Math.abs(s)?r<0?{type:yt.FingerDirection.VerticalUp,confidence:1}:{type:yt.FingerDirection.VerticalDown,confidence:1}:s>0?{type:yt.FingerDirection.HorizontalRight,confidence:1}:{type:yt.FingerDirection.HorizontalLeft,confidence:1}},gdt=n=>{try{const t=localStorage.getItem(ku),e=t?JSON.parse(t):[];return e.push(n),localStorage.setItem(ku,JSON.stringify(e)),!0}catch(t){return console.error("Error saving gesture dataset:",t),!1}},ydt=n=>{try{const t=localStorage.getItem(ku);if(!t)return!1;const e=JSON.parse(t);return e.splice(n,1),localStorage.setItem(ku,JSON.stringify(e)),!0}catch(t){return console.error("Error deleting gesture dataset:",t),!1}},bdt=()=>{try{return localStorage.removeItem(ku),!0}catch(n){return console.error("Error deleting all gesture datasets:",n),!1}},xdt=()=>{try{const n=localStorage.getItem("gestureDatasets");return n?JSON.parse(n):[]}catch(n){return console.error("Error loading saved gestures:",n),[]}},vdt=(n,t)=>{if(!n||!t||n.length!==t.length)return 0;let e=0;const s=[4,8,12,16,20];for(const i of s){const l=n[i][0]-t[i][0],u=n[i][1]-t[i][1];e+=l*l+u*u}return Math.max(0,1-e/5e4)},wdt=n=>{if(!n||n.length===0)return null;const t=n[0].length,e=Array(t).fill().map(()=>[0,0,0]);for(const s of n)for(let r=0;r<t;r++)e[r][0]+=s[r][0]/n.length,e[r][1]+=s[r][1]/n.length,e[r][2]+=s[r][2]/n.length;return e},bI=n=>{if(!n||n.length===0)return null;const t=n[0][0],e=n[0][1];return n.map(r=>[r[0]-t,r[1]-e,r[2]])},Sdt=n=>{if(!n||n.length===0)return null;const t=xdt();if(t.length===0)return null;const e=bI(n);let s=null,r=0;for(const i of t){if(!i.frames||i.frames.length===0)continue;const l=wdt(i.frames),u=bI(l),h=vdt(e,u);console.log(`Gesture ${i.name} similarity: ${h.toFixed(3)}`),h>r&&(r=h,s={name:i.name,score:h})}return s&&s.score>=.5?s:null},Cdt=Je.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  margin-top: 20px;
`,Ndt=Je.div`
  position: relative;
`,Tdt=Je(MF)`
  width: 640px;
  height: 480px;
`,$dt=Je.canvas`
  position: absolute;
  top: 0;
  left: 0;
  width: 640px;
  height: 480px;
`,xI=Je.div`
  margin-top: 20px;
  padding: 15px;
  border: 1px solid #ccc;
  border-radius: 8px;
  width: 600px;
  text-align: center;
`,kdt=Je.a`
  position: fixed;
  bottom: 10px;
  right: 10px;
  color: #ccc;
  text-decoration: none;
  font-size: 12px;
  &:hover {
    color: #999;
  }
`;function Idt(){const n=Et.useRef(null),t=Et.useRef(null),[e,s]=Et.useState(""),[r,a]=Et.useState(!0),[i,l]=Et.useState([]),[u,h]=Et.useState([]),[d,p]=Et.useState(!1),[m,y]=Et.useState({}),[b,x]=Et.useState("direct"),[v,S]=Et.useState(""),C=async()=>{const R=await zF();console.log("Handpose model loaded."),setInterval(()=>{$(R)},100)};Et.useEffect(()=>{C(),gB().then(()=>{console.log("TensorFlow.js is ready")});const R=yI();console.log("Loaded gestures:",R.map(L=>L.name)),h(R)},[]),Et.useEffect(()=>{const R=()=>{if(document.visibilityState==="visible"){const L=yI();h(L)}};return document.addEventListener("visibilitychange",R),()=>{document.removeEventListener("visibilitychange",R)}},[]),Et.useEffect(()=>{if(e&&r&&e!=="No gesture detected"&&e!==v){const R=new SpeechSynthesisUtterance(e);speechSynthesis.speak(R),S(e)}},[e,r,v]);const $=async R=>{if(n.current&&n.current.video.readyState===4){const L=n.current.video,_=n.current.video.videoWidth,M=n.current.video.videoHeight;n.current.video.width=_,n.current.video.height=M,t.current.width=_,t.current.height=M;const D=await R.estimateHands(L),W=t.current.getContext("2d");if(BF(D,W),D.length>0){const et=D[0].landmarks;let nt="No gesture detected";if(b==="direct"){const tt=Sdt(et);tt?(nt=tt.name,y({[tt.name]:tt.score.toFixed(2)})):y({})}else{const U=await new yt.GestureEstimator(u).estimate(et,6.5);if(U.gestures&&U.gestures.length>0){const Y=U.gestures.map(O=>O.score),Z={};U.gestures.forEach(O=>{Z[O.name]=O.score.toFixed(2)}),y(Z);const G=Y.indexOf(Math.max(...Y));nt=U.gestures[G].name}}nt!==e&&(console.log(`Recognized gesture: ${nt}`),s(nt),nt!=="No gesture detected"&&(i.length===0||nt!==i[0])&&l(tt=>[nt,...tt].slice(0,10)))}else e!=="No gesture detected"&&(s("No gesture detected"),y({}))}},T=()=>{a(!r)},I=()=>{p(!d)},A=()=>{x(R=>R==="direct"?"fingerpose":"direct")};return Nt.jsxs(Cdt,{children:[Nt.jsx("h1",{children:"Hand Sign Gesture Recognition"}),Nt.jsxs(Ndt,{children:[Nt.jsx(Tdt,{ref:n,mirrored:!0}),Nt.jsx($dt,{ref:t})]}),Nt.jsxs(xI,{children:[Nt.jsx("h2",{children:"Recognized Gesture"}),Nt.jsx("p",{style:{fontSize:"24px",fontWeight:"bold"},children:e}),Nt.jsxs("div",{style:{display:"flex",gap:"10px",justifyContent:"center"},children:[Nt.jsx("button",{onClick:T,children:r?"Disable Speech":"Enable Speech"}),Nt.jsx("button",{onClick:I,children:d?"Hide Debug Info":"Show Debug Info"}),Nt.jsxs("button",{onClick:A,children:["Method: ",b==="direct"?"Direct Compare":"Fingerpose"]})]}),d&&Nt.jsxs("div",{style:{marginTop:"10px",textAlign:"left"},children:[Nt.jsx("h3",{children:"Debug Information"}),Nt.jsxs("p",{children:["Recognition Method: ",Nt.jsx("strong",{children:b})]}),Nt.jsxs("p",{children:["Loaded Gestures: ",u.map(R=>R.name).join(", ")]}),Nt.jsx("h4",{children:"Confidence Scores:"}),Nt.jsx("ul",{children:Object.entries(m).map(([R,L])=>Nt.jsxs("li",{children:[R,": ",L]},R))})]})]}),Nt.jsxs(xI,{children:[Nt.jsx("h2",{children:"History"}),Nt.jsx("ul",{style:{listStyleType:"none",padding:0},children:i.map((R,L)=>Nt.jsx("li",{children:R},L))})]}),Nt.jsx(kdt,{href:"/admin",children:"Admin"})]})}const vI=Je.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  margin-top: 20px;
  max-width: 1200px;
  margin: 0 auto;
  padding: 20px;
`,Edt=Je.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  margin-top: 100px;
  padding: 30px;
  border: 1px solid #ccc;
  border-radius: 8px;
  width: 400px;
`,gx=Je.input`
  margin: 10px 0;
  padding: 10px;
  width: 100%;
  border-radius: 4px;
  border: 1px solid #ccc;
`,xo=Je.button`
  margin-top: 15px;
  padding: 10px 20px;
  background-color: #4285f4;
  color: white;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  font-size: 16px;
  &:hover {
    background-color: #3367d6;
  }
`,wp=Je(xo)`
  background-color: #f44336;
  &:hover {
    background-color: #d32f2f;
  }
`,yx=Je.div`
  margin: 20px 0;
  padding: 20px;
  border: 1px solid #ccc;
  border-radius: 8px;
  width: 100%;
`,bx=Je.button`
  padding: 10px 20px;
  margin-right: 10px;
  background-color: ${n=>n.active?"#4285f4":"#f1f1f1"};
  color: ${n=>n.active?"white":"black"};
  border: none;
  border-radius: 4px 4px 0 0;
  cursor: pointer;
  &:hover {
    background-color: ${n=>n.active?"#3367d6":"#e0e0e0"};
  }
`,xx=Je.div`
  display: ${n=>n.active?"block":"none"};
  padding: 20px;
  border: 1px solid #ccc;
  border-top: none;
  width: 100%;
`,Ddt=Je.div`
  position: relative;
  margin: 20px 0;
`,Adt=Je(MF)`
  width: 640px;
  height: 480px;
`,Rdt=Je.canvas`
  position: absolute;
  top: 0;
  left: 0;
  width: 640px;
  height: 480px;
`,Odt=Je.div`
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
  gap: 20px;
  width: 100%;
  margin-top: 20px;
`,_dt=Je.div`
  padding: 15px;
  border: 1px solid #ccc;
  border-radius: 8px;
  display: flex;
  flex-direction: column;
  align-items: center;
`,Fdt=Je.div`
  margin-top: 10px;
  padding: 10px;
  border-radius: 4px;
  font-weight: bold;
  color: white;
  background-color: ${n=>n.type==="success"?"#4caf50":n.type==="error"?"#f44336":"#2196f3"};
`,Ldt=Je.div`
  width: 100%;
  height: 10px;
  background-color: #e0e0e0;
  border-radius: 5px;
  margin: 10px 0;
  overflow: hidden;
`,zdt=Je.div`
  height: 100%;
  background-color: #4285f4;
  width: ${n=>n.progress}%;
  transition: width 0.3s ease;
`;function Mdt(){const[n,t]=Et.useState(!1),[e,s]=Et.useState(""),[r,a]=Et.useState(""),[i,l]=Et.useState(""),[u,h]=Et.useState("datasets"),[d,p]=Et.useState(""),[m,y]=Et.useState([]),[b,x]=Et.useState(!1),[v,S]=Et.useState(null),C=Et.useRef(null),$=Et.useRef(null),[T,I]=Et.useState(null),[A,R]=Et.useState([]),[L,_]=Et.useState({message:"",type:""}),[M,D]=Et.useState(0),[W,et]=Et.useState(!1);Et.useEffect(()=>{const P=localStorage.getItem("gestureDatasets");P&&y(JSON.parse(P))},[]),Et.useEffect(()=>{m.length>0&&localStorage.setItem("gestureDatasets",JSON.stringify(m))},[m]),Et.useEffect(()=>{n&&(async()=>{const H=await zF();I(H),console.log("Handpose model loaded in admin")})()},[n]),Et.useEffect(()=>{if(b&&T&&C.current&&$.current){_({message:"Getting ready...",type:"info"});const P=setInterval(async()=>{if(C.current&&C.current.video.readyState===4){const H=C.current.video,Q=C.current.video.videoWidth,ot=C.current.video.videoHeight;C.current.video.width=Q,C.current.video.height=ot,$.current.width=Q,$.current.height=ot;const lt=await T.estimateHands(H),ht=$.current.getContext("2d");if(BF(lt,ht),lt.length>0){R(Ct=>[...Ct,lt[0].landmarks]),et(!0);const xt=Math.min(Math.floor(A.length/30*100),100);D(xt),W||_({message:"Hand detected! Recording gesture...",type:"success"})}else et(!1),A.length===0&&_({message:"No hand detected. Please show your hand in the camera.",type:"error"})}},100);return()=>clearInterval(P)}},[b,T,W,A.length]);const nt=()=>{e==="admin"&&r==="admin123"?(t(!0),l("")):l("Invalid username or password")},tt=()=>{t(!1),s(""),a("")},U=()=>{if(!d){_({message:"Please enter a gesture name",type:"error"});return}x(!0),R([]),D(0),_({message:"Getting ready for recording...",type:"info"})},Y=()=>{if(x(!1),A.length===0){_({message:"No frames captured. Please try again.",type:"error"});return}if(A.length<10){_({message:"Too few frames captured. Please try again for longer.",type:"error"});return}const P={name:d,frames:A,createdAt:new Date().toISOString()};y(H=>[...H,P]),gdt(P),p(""),R([]),D(0),_({message:`Success! Gesture "${d}" recorded with ${A.length} frames.`,type:"success"})},Z=P=>{if(confirm("Are you sure you want to delete this dataset?")){const H=[...m];H.splice(P,1),y(H),ydt(P)}},G=()=>{confirm("Are you sure you want to delete ALL datasets? This cannot be undone.")&&(y([]),bdt())},O=()=>{const P=m.map(Q=>{const ot=new yt.GestureDescription(Q.name);Q.frames.reduce((ht,xt,Ct,Dt)=>(xt.forEach((It,Ot)=>{ht[Ot]||(ht[Ot]=[0,0,0]),ht[Ot][0]+=It[0]/Dt.length,ht[Ot][1]+=It[1]/Dt.length,ht[Ot][2]+=It[2]/Dt.length}),ht),[]);const lt=[yt.Finger.Thumb,yt.Finger.Index,yt.Finger.Middle,yt.Finger.Ring,yt.Finger.Pinky];for(let ht=0;ht<5;ht++){const xt=lt[ht];ot.addCurl(xt,yt.FingerCurl.NoCurl,1),ot.addDirection(xt,yt.FingerDirection.VerticalUp,1)}return ot}),H=`
// Generated gesture configurations
import { Finger, FingerCurl, FingerDirection, GestureDescription } from 'fingerpose';

// Define gestures
${P.map((Q,ot)=>`const ${Q.name.replace(/\s+/g,"")}Gesture = new GestureDescription('${Q.name}');`).join(`
`)}

// Add gesture configurations
// ... Configuration code would be generated here ...

// Export all gestures
export const gestures = [
  ${P.map(Q=>Q.name.replace(/\s+/g,"")+"Gesture").join(`,
  `)}
];`;console.log(H),alert("Gesture configurations exported to console. In a real app, you would save this to a file.")},V=P=>{S(P),h("details")};return n?Nt.jsxs(vI,{children:[Nt.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%"},children:[Nt.jsx("h1",{children:"Hand Gesture Admin Panel"}),Nt.jsx(xo,{onClick:tt,children:"Logout"})]}),Nt.jsxs("div",{style:{display:"flex",width:"100%",marginTop:"20px"},children:[Nt.jsx(bx,{active:u==="datasets",onClick:()=>h("datasets"),children:"Datasets"}),Nt.jsx(bx,{active:u==="train",onClick:()=>h("train"),children:"Train New Gesture"}),Nt.jsx(bx,{active:u==="details"&&v!==null,onClick:()=>v!==null&&h("details"),disabled:v===null,children:"Dataset Details"})]}),Nt.jsx(xx,{active:u==="datasets",children:Nt.jsxs(yx,{children:[Nt.jsx("h2",{children:"Gesture Datasets"}),m.length===0?Nt.jsx("p",{children:"No datasets available. Train a new gesture to get started."}):Nt.jsxs(Nt.Fragment,{children:[Nt.jsx(Odt,{children:m.map((P,H)=>Nt.jsxs(_dt,{children:[Nt.jsx("h3",{children:P.name}),Nt.jsxs("p",{children:["Frames: ",P.frames.length]}),Nt.jsxs("p",{children:["Created: ",new Date(P.createdAt).toLocaleDateString()]}),Nt.jsxs("div",{style:{display:"flex",gap:"10px",marginTop:"10px"},children:[Nt.jsx(xo,{onClick:()=>V(H),children:"View"}),Nt.jsx(wp,{onClick:()=>Z(H),children:"Delete"})]})]},H))}),Nt.jsxs("div",{style:{marginTop:"20px",display:"flex",gap:"10px"},children:[Nt.jsx(xo,{onClick:O,children:"Export Configurations"}),Nt.jsx(wp,{onClick:G,children:"Delete All Datasets"})]})]})]})}),Nt.jsx(xx,{active:u==="train",children:Nt.jsxs(yx,{children:[Nt.jsx("h2",{children:"Train New Gesture"}),Nt.jsxs("div",{children:[Nt.jsx(gx,{type:"text",placeholder:"Gesture Name",value:d,onChange:P=>p(P.target.value),disabled:b}),b?Nt.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[Nt.jsx(wp,{onClick:Y,children:"Stop Recording"}),Nt.jsxs("p",{children:["Recording... ",A.length," frames captured"]})]}):Nt.jsx(xo,{onClick:U,children:"Start Recording"}),L.message&&Nt.jsx(Fdt,{type:L.type,children:L.message}),b&&Nt.jsxs(Nt.Fragment,{children:[Nt.jsx(Ldt,{children:Nt.jsx(zdt,{progress:M})}),Nt.jsxs("p",{children:["Training progress: ",M,"% (We recommend at least 30 frames)"]})]})]}),b&&Nt.jsxs(Ddt,{children:[Nt.jsx(Adt,{ref:C,mirrored:!0}),Nt.jsx(Rdt,{ref:$})]}),Nt.jsxs("div",{style:{marginTop:"20px"},children:[Nt.jsx("h3",{children:"Instructions:"}),Nt.jsxs("ol",{children:[Nt.jsx("li",{children:"Enter a name for your new gesture"}),Nt.jsx("li",{children:'Click "Start Recording"'}),Nt.jsx("li",{children:"Perform the gesture repeatedly for a few seconds"}),Nt.jsx("li",{children:"Make sure your hand is clearly visible in the camera"}),Nt.jsx("li",{children:"Try to maintain consistent hand position for best results"}),Nt.jsx("li",{children:'Click "Stop Recording" when done'}),Nt.jsx("li",{children:"Your gesture will be saved automatically"}),Nt.jsx("li",{children:"Aim for at least 30 frames for reliable recognition"})]})]})]})}),Nt.jsx(xx,{active:u==="details"&&v!==null,children:v!==null&&m[v]&&Nt.jsxs(yx,{children:[Nt.jsxs("h2",{children:["Dataset: ",m[v].name]}),Nt.jsxs("p",{children:["Created: ",new Date(m[v].createdAt).toLocaleString()]}),Nt.jsxs("p",{children:["Total Frames: ",m[v].frames.length]}),Nt.jsxs("div",{style:{marginTop:"20px"},children:[Nt.jsx("h3",{children:"Actions:"}),Nt.jsxs("div",{style:{display:"flex",gap:"10px"},children:[Nt.jsx(wp,{onClick:()=>Z(v),children:"Delete Dataset"}),Nt.jsx(xo,{onClick:()=>h("datasets"),children:"Back to Datasets"})]})]}),Nt.jsxs("div",{style:{marginTop:"20px"},children:[Nt.jsx("h3",{children:"Technical Details:"}),Nt.jsx("pre",{style:{background:"#f5f5f5",padding:"10px",borderRadius:"4px",maxHeight:"200px",overflow:"auto"},children:JSON.stringify(m[v],null,2)})]})]})})]}):Nt.jsx(vI,{children:Nt.jsxs(Edt,{children:[Nt.jsx("h1",{children:"Admin Login"}),i&&Nt.jsx("p",{style:{color:"red"},children:i}),Nt.jsx(gx,{type:"text",placeholder:"Username",value:e,onChange:P=>s(P.target.value)}),Nt.jsx(gx,{type:"password",placeholder:"Password",value:r,onChange:P=>a(P.target.value)}),Nt.jsx(xo,{onClick:nt,children:"Login"})]})})}const Bdt="/gesture2speech";_z.createRoot(document.getElementById("root")).render(Nt.jsx(Oo.StrictMode,{children:Nt.jsx(SM,{basename:Bdt,children:Nt.jsxs(xM,{children:[Nt.jsx(wx,{path:"/",element:Nt.jsx(Idt,{})}),Nt.jsx(wx,{path:"/admin",element:Nt.jsx(Mdt,{})})]})})}));
//# sourceMappingURL=index-xbicFrM9.js.map
